(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))f(y);new MutationObserver(y=>{for(const v of y)if(v.type==="childList")for(const T of v.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&f(T)}).observe(document,{childList:!0,subtree:!0});function s(y){const v={};return y.integrity&&(v.integrity=y.integrity),y.referrerpolicy&&(v.referrerPolicy=y.referrerpolicy),y.crossorigin==="use-credentials"?v.credentials="include":y.crossorigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function f(y){if(y.ep)return;y.ep=!0;const v=s(y);fetch(y.href,v)}})();var Ou=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function V2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Jt={exports:{}},gn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $h=Symbol.for("react.element"),$2=Symbol.for("react.portal"),j2=Symbol.for("react.fragment"),G2=Symbol.for("react.strict_mode"),q2=Symbol.for("react.profiler"),Z2=Symbol.for("react.provider"),W2=Symbol.for("react.context"),H2=Symbol.for("react.forward_ref"),X2=Symbol.for("react.suspense"),Y2=Symbol.for("react.memo"),K2=Symbol.for("react.lazy"),xv=Symbol.iterator;function J2(t){return t===null||typeof t!="object"?null:(t=xv&&t[xv]||t["@@iterator"],typeof t=="function"?t:null)}var ox={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ax=Object.assign,sx={};function fc(t,i,s){this.props=t,this.context=i,this.refs=sx,this.updater=s||ox}fc.prototype.isReactComponent={};fc.prototype.setState=function(t,i){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,i,"setState")};fc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function lx(){}lx.prototype=fc.prototype;function qg(t,i,s){this.props=t,this.context=i,this.refs=sx,this.updater=s||ox}var Zg=qg.prototype=new lx;Zg.constructor=qg;ax(Zg,fc.prototype);Zg.isPureReactComponent=!0;var bv=Array.isArray,ux=Object.prototype.hasOwnProperty,Wg={current:null},cx={key:!0,ref:!0,__self:!0,__source:!0};function hx(t,i,s){var f,y={},v=null,T=null;if(i!=null)for(f in i.ref!==void 0&&(T=i.ref),i.key!==void 0&&(v=""+i.key),i)ux.call(i,f)&&!cx.hasOwnProperty(f)&&(y[f]=i[f]);var u=arguments.length-2;if(u===1)y.children=s;else if(1<u){for(var F=Array(u),W=0;W<u;W++)F[W]=arguments[W+2];y.children=F}if(t&&t.defaultProps)for(f in u=t.defaultProps,u)y[f]===void 0&&(y[f]=u[f]);return{$$typeof:$h,type:t,key:v,ref:T,props:y,_owner:Wg.current}}function Q2(t,i){return{$$typeof:$h,type:t.type,key:i,ref:t.ref,props:t.props,_owner:t._owner}}function Hg(t){return typeof t=="object"&&t!==null&&t.$$typeof===$h}function eS(t){var i={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(s){return i[s]})}var wv=/\/+/g;function rm(t,i){return typeof t=="object"&&t!==null&&t.key!=null?eS(""+t.key):i.toString(36)}function rp(t,i,s,f,y){var v=typeof t;(v==="undefined"||v==="boolean")&&(t=null);var T=!1;if(t===null)T=!0;else switch(v){case"string":case"number":T=!0;break;case"object":switch(t.$$typeof){case $h:case $2:T=!0}}if(T)return T=t,y=y(T),t=f===""?"."+rm(T,0):f,bv(y)?(s="",t!=null&&(s=t.replace(wv,"$&/")+"/"),rp(y,i,s,"",function(W){return W})):y!=null&&(Hg(y)&&(y=Q2(y,s+(!y.key||T&&T.key===y.key?"":(""+y.key).replace(wv,"$&/")+"/")+t)),i.push(y)),1;if(T=0,f=f===""?".":f+":",bv(t))for(var u=0;u<t.length;u++){v=t[u];var F=f+rm(v,u);T+=rp(v,i,s,F,y)}else if(F=J2(t),typeof F=="function")for(t=F.call(t),u=0;!(v=t.next()).done;)v=v.value,F=f+rm(v,u++),T+=rp(v,i,s,F,y);else if(v==="object")throw i=String(t),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return T}function Id(t,i,s){if(t==null)return t;var f=[],y=0;return rp(t,f,"","",function(v){return i.call(s,v,y++)}),f}function tS(t){if(t._status===-1){var i=t._result;i=i(),i.then(function(s){(t._status===0||t._status===-1)&&(t._status=1,t._result=s)},function(s){(t._status===0||t._status===-1)&&(t._status=2,t._result=s)}),t._status===-1&&(t._status=0,t._result=i)}if(t._status===1)return t._result.default;throw t._result}var Xi={current:null},ip={transition:null},nS={ReactCurrentDispatcher:Xi,ReactCurrentBatchConfig:ip,ReactCurrentOwner:Wg};gn.Children={map:Id,forEach:function(t,i,s){Id(t,function(){i.apply(this,arguments)},s)},count:function(t){var i=0;return Id(t,function(){i++}),i},toArray:function(t){return Id(t,function(i){return i})||[]},only:function(t){if(!Hg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};gn.Component=fc;gn.Fragment=j2;gn.Profiler=q2;gn.PureComponent=qg;gn.StrictMode=G2;gn.Suspense=X2;gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nS;gn.cloneElement=function(t,i,s){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var f=ax({},t.props),y=t.key,v=t.ref,T=t._owner;if(i!=null){if(i.ref!==void 0&&(v=i.ref,T=Wg.current),i.key!==void 0&&(y=""+i.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(F in i)ux.call(i,F)&&!cx.hasOwnProperty(F)&&(f[F]=i[F]===void 0&&u!==void 0?u[F]:i[F])}var F=arguments.length-2;if(F===1)f.children=s;else if(1<F){u=Array(F);for(var W=0;W<F;W++)u[W]=arguments[W+2];f.children=u}return{$$typeof:$h,type:t.type,key:y,ref:v,props:f,_owner:T}};gn.createContext=function(t){return t={$$typeof:W2,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Z2,_context:t},t.Consumer=t};gn.createElement=hx;gn.createFactory=function(t){var i=hx.bind(null,t);return i.type=t,i};gn.createRef=function(){return{current:null}};gn.forwardRef=function(t){return{$$typeof:H2,render:t}};gn.isValidElement=Hg;gn.lazy=function(t){return{$$typeof:K2,_payload:{_status:-1,_result:t},_init:tS}};gn.memo=function(t,i){return{$$typeof:Y2,type:t,compare:i===void 0?null:i}};gn.startTransition=function(t){var i=ip.transition;ip.transition={};try{t()}finally{ip.transition=i}};gn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};gn.useCallback=function(t,i){return Xi.current.useCallback(t,i)};gn.useContext=function(t){return Xi.current.useContext(t)};gn.useDebugValue=function(){};gn.useDeferredValue=function(t){return Xi.current.useDeferredValue(t)};gn.useEffect=function(t,i){return Xi.current.useEffect(t,i)};gn.useId=function(){return Xi.current.useId()};gn.useImperativeHandle=function(t,i,s){return Xi.current.useImperativeHandle(t,i,s)};gn.useInsertionEffect=function(t,i){return Xi.current.useInsertionEffect(t,i)};gn.useLayoutEffect=function(t,i){return Xi.current.useLayoutEffect(t,i)};gn.useMemo=function(t,i){return Xi.current.useMemo(t,i)};gn.useReducer=function(t,i,s){return Xi.current.useReducer(t,i,s)};gn.useRef=function(t){return Xi.current.useRef(t)};gn.useState=function(t){return Xi.current.useState(t)};gn.useSyncExternalStore=function(t,i,s){return Xi.current.useSyncExternalStore(t,i,s)};gn.useTransition=function(){return Xi.current.useTransition()};gn.version="18.2.0";(function(t){t.exports=gn})(Jt);const au=V2(Jt.exports);var Om={},dx={exports:{}},Fo={},px={exports:{}},fx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function i(at,Pt){var Qe=at.length;at.push(Pt);e:for(;0<Qe;){var yn=Qe-1>>>1,Ln=at[yn];if(0<y(Ln,Pt))at[yn]=Pt,at[Qe]=Ln,Qe=yn;else break e}}function s(at){return at.length===0?null:at[0]}function f(at){if(at.length===0)return null;var Pt=at[0],Qe=at.pop();if(Qe!==Pt){at[0]=Qe;e:for(var yn=0,Ln=at.length,Ei=Ln>>>1;yn<Ei;){var Yr=2*(yn+1)-1,Kr=at[Yr],Cr=Yr+1,ci=at[Cr];if(0>y(Kr,Qe))Cr<Ln&&0>y(ci,Kr)?(at[yn]=ci,at[Cr]=Qe,yn=Cr):(at[yn]=Kr,at[Yr]=Qe,yn=Yr);else if(Cr<Ln&&0>y(ci,Qe))at[yn]=ci,at[Cr]=Qe,yn=Cr;else break e}}return Pt}function y(at,Pt){var Qe=at.sortIndex-Pt.sortIndex;return Qe!==0?Qe:at.id-Pt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var v=performance;t.unstable_now=function(){return v.now()}}else{var T=Date,u=T.now();t.unstable_now=function(){return T.now()-u}}var F=[],W=[],ie=1,ne=null,G=3,we=!1,Me=!1,Ce=!1,Ze=typeof setTimeout=="function"?setTimeout:null,re=typeof clearTimeout=="function"?clearTimeout:null,J=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function se(at){for(var Pt=s(W);Pt!==null;){if(Pt.callback===null)f(W);else if(Pt.startTime<=at)f(W),Pt.sortIndex=Pt.expirationTime,i(F,Pt);else break;Pt=s(W)}}function Te(at){if(Ce=!1,se(at),!Me)if(s(F)!==null)Me=!0,mt(ze);else{var Pt=s(W);Pt!==null&&Un(Te,Pt.startTime-at)}}function ze(at,Pt){Me=!1,Ce&&(Ce=!1,re(Xe),Xe=-1),we=!0;var Qe=G;try{for(se(Pt),ne=s(F);ne!==null&&(!(ne.expirationTime>Pt)||at&&!Zt());){var yn=ne.callback;if(typeof yn=="function"){ne.callback=null,G=ne.priorityLevel;var Ln=yn(ne.expirationTime<=Pt);Pt=t.unstable_now(),typeof Ln=="function"?ne.callback=Ln:ne===s(F)&&f(F),se(Pt)}else f(F);ne=s(F)}if(ne!==null)var Ei=!0;else{var Yr=s(W);Yr!==null&&Un(Te,Yr.startTime-Pt),Ei=!1}return Ei}finally{ne=null,G=Qe,we=!1}}var He=!1,it=null,Xe=-1,Ut=5,xt=-1;function Zt(){return!(t.unstable_now()-xt<Ut)}function dn(){if(it!==null){var at=t.unstable_now();xt=at;var Pt=!0;try{Pt=it(!0,at)}finally{Pt?An():(He=!1,it=null)}}else He=!1}var An;if(typeof J=="function")An=function(){J(dn)};else if(typeof MessageChannel<"u"){var sn=new MessageChannel,zn=sn.port2;sn.port1.onmessage=dn,An=function(){zn.postMessage(null)}}else An=function(){Ze(dn,0)};function mt(at){it=at,He||(He=!0,An())}function Un(at,Pt){Xe=Ze(function(){at(t.unstable_now())},Pt)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(at){at.callback=null},t.unstable_continueExecution=function(){Me||we||(Me=!0,mt(ze))},t.unstable_forceFrameRate=function(at){0>at||125<at?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ut=0<at?Math.floor(1e3/at):5},t.unstable_getCurrentPriorityLevel=function(){return G},t.unstable_getFirstCallbackNode=function(){return s(F)},t.unstable_next=function(at){switch(G){case 1:case 2:case 3:var Pt=3;break;default:Pt=G}var Qe=G;G=Pt;try{return at()}finally{G=Qe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(at,Pt){switch(at){case 1:case 2:case 3:case 4:case 5:break;default:at=3}var Qe=G;G=at;try{return Pt()}finally{G=Qe}},t.unstable_scheduleCallback=function(at,Pt,Qe){var yn=t.unstable_now();switch(typeof Qe=="object"&&Qe!==null?(Qe=Qe.delay,Qe=typeof Qe=="number"&&0<Qe?yn+Qe:yn):Qe=yn,at){case 1:var Ln=-1;break;case 2:Ln=250;break;case 5:Ln=1073741823;break;case 4:Ln=1e4;break;default:Ln=5e3}return Ln=Qe+Ln,at={id:ie++,callback:Pt,priorityLevel:at,startTime:Qe,expirationTime:Ln,sortIndex:-1},Qe>yn?(at.sortIndex=Qe,i(W,at),s(F)===null&&at===s(W)&&(Ce?(re(Xe),Xe=-1):Ce=!0,Un(Te,Qe-yn))):(at.sortIndex=Ln,i(F,at),Me||we||(Me=!0,mt(ze))),at},t.unstable_shouldYield=Zt,t.unstable_wrapCallback=function(at){var Pt=G;return function(){var Qe=G;G=Pt;try{return at.apply(this,arguments)}finally{G=Qe}}}})(fx);(function(t){t.exports=fx})(px);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mx=Jt.exports,Ro=px.exports;function Ye(t){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+t,s=1;s<arguments.length;s++)i+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+t+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gx=new Set,xh={};function mu(t,i){ac(t,i),ac(t+"Capture",i)}function ac(t,i){for(xh[t]=i,t=0;t<i.length;t++)gx.add(i[t])}var Ss=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bm=Object.prototype.hasOwnProperty,rS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Sv={},Ev={};function iS(t){return Bm.call(Ev,t)?!0:Bm.call(Sv,t)?!1:rS.test(t)?Ev[t]=!0:(Sv[t]=!0,!1)}function oS(t,i,s,f){if(s!==null&&s.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return f?!1:s!==null?!s.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function aS(t,i,s,f){if(i===null||typeof i>"u"||oS(t,i,s,f))return!0;if(f)return!1;if(s!==null)switch(s.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function Yi(t,i,s,f,y,v,T){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=f,this.attributeNamespace=y,this.mustUseProperty=s,this.propertyName=t,this.type=i,this.sanitizeURL=v,this.removeEmptyString=T}var Si={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Si[t]=new Yi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var i=t[0];Si[i]=new Yi(i,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Si[t]=new Yi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Si[t]=new Yi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Si[t]=new Yi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Si[t]=new Yi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Si[t]=new Yi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Si[t]=new Yi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Si[t]=new Yi(t,5,!1,t.toLowerCase(),null,!1,!1)});var Xg=/[\-:]([a-z])/g;function Yg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var i=t.replace(Xg,Yg);Si[i]=new Yi(i,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var i=t.replace(Xg,Yg);Si[i]=new Yi(i,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var i=t.replace(Xg,Yg);Si[i]=new Yi(i,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Si[t]=new Yi(t,1,!1,t.toLowerCase(),null,!1,!1)});Si.xlinkHref=new Yi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Si[t]=new Yi(t,1,!1,t.toLowerCase(),null,!0,!0)});function Kg(t,i,s,f){var y=Si.hasOwnProperty(i)?Si[i]:null;(y!==null?y.type!==0:f||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(aS(i,s,y,f)&&(s=null),f||y===null?iS(i)&&(s===null?t.removeAttribute(i):t.setAttribute(i,""+s)):y.mustUseProperty?t[y.propertyName]=s===null?y.type===3?!1:"":s:(i=y.attributeName,f=y.attributeNamespace,s===null?t.removeAttribute(i):(y=y.type,s=y===3||y===4&&s===!0?"":""+s,f?t.setAttributeNS(f,i,s):t.setAttribute(i,s))))}var As=mx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Pd=Symbol.for("react.element"),Bu=Symbol.for("react.portal"),Nu=Symbol.for("react.fragment"),Jg=Symbol.for("react.strict_mode"),Nm=Symbol.for("react.profiler"),yx=Symbol.for("react.provider"),_x=Symbol.for("react.context"),Qg=Symbol.for("react.forward_ref"),Um=Symbol.for("react.suspense"),Vm=Symbol.for("react.suspense_list"),ey=Symbol.for("react.memo"),el=Symbol.for("react.lazy"),vx=Symbol.for("react.offscreen"),Tv=Symbol.iterator;function Wc(t){return t===null||typeof t!="object"?null:(t=Tv&&t[Tv]||t["@@iterator"],typeof t=="function"?t:null)}var fr=Object.assign,im;function th(t){if(im===void 0)try{throw Error()}catch(s){var i=s.stack.trim().match(/\n( *(at )?)/);im=i&&i[1]||""}return`
`+im+t}var om=!1;function am(t,i){if(!t||om)return"";om=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(W){var f=W}Reflect.construct(t,[],i)}else{try{i.call()}catch(W){f=W}t.call(i.prototype)}else{try{throw Error()}catch(W){f=W}t()}}catch(W){if(W&&f&&typeof W.stack=="string"){for(var y=W.stack.split(`
`),v=f.stack.split(`
`),T=y.length-1,u=v.length-1;1<=T&&0<=u&&y[T]!==v[u];)u--;for(;1<=T&&0<=u;T--,u--)if(y[T]!==v[u]){if(T!==1||u!==1)do if(T--,u--,0>u||y[T]!==v[u]){var F=`
`+y[T].replace(" at new "," at ");return t.displayName&&F.includes("<anonymous>")&&(F=F.replace("<anonymous>",t.displayName)),F}while(1<=T&&0<=u);break}}}finally{om=!1,Error.prepareStackTrace=s}return(t=t?t.displayName||t.name:"")?th(t):""}function sS(t){switch(t.tag){case 5:return th(t.type);case 16:return th("Lazy");case 13:return th("Suspense");case 19:return th("SuspenseList");case 0:case 2:case 15:return t=am(t.type,!1),t;case 11:return t=am(t.type.render,!1),t;case 1:return t=am(t.type,!0),t;default:return""}}function $m(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Nu:return"Fragment";case Bu:return"Portal";case Nm:return"Profiler";case Jg:return"StrictMode";case Um:return"Suspense";case Vm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _x:return(t.displayName||"Context")+".Consumer";case yx:return(t._context.displayName||"Context")+".Provider";case Qg:var i=t.render;return t=t.displayName,t||(t=i.displayName||i.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ey:return i=t.displayName||null,i!==null?i:$m(t.type)||"Memo";case el:i=t._payload,t=t._init;try{return $m(t(i))}catch{}}return null}function lS(t){var i=t.type;switch(t.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=i.render,t=t.displayName||t.name||"",i.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $m(i);case 8:return i===Jg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function gl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function xx(t){var i=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function uS(t){var i=xx(t)?"checked":"value",s=Object.getOwnPropertyDescriptor(t.constructor.prototype,i),f=""+t[i];if(!t.hasOwnProperty(i)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var y=s.get,v=s.set;return Object.defineProperty(t,i,{configurable:!0,get:function(){return y.call(this)},set:function(T){f=""+T,v.call(this,T)}}),Object.defineProperty(t,i,{enumerable:s.enumerable}),{getValue:function(){return f},setValue:function(T){f=""+T},stopTracking:function(){t._valueTracker=null,delete t[i]}}}}function Ad(t){t._valueTracker||(t._valueTracker=uS(t))}function bx(t){if(!t)return!1;var i=t._valueTracker;if(!i)return!0;var s=i.getValue(),f="";return t&&(f=xx(t)?t.checked?"true":"false":t.value),t=f,t!==s?(i.setValue(t),!0):!1}function _p(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function jm(t,i){var s=i.checked;return fr({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s!=null?s:t._wrapperState.initialChecked})}function kv(t,i){var s=i.defaultValue==null?"":i.defaultValue,f=i.checked!=null?i.checked:i.defaultChecked;s=gl(i.value!=null?i.value:s),t._wrapperState={initialChecked:f,initialValue:s,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function wx(t,i){i=i.checked,i!=null&&Kg(t,"checked",i,!1)}function Gm(t,i){wx(t,i);var s=gl(i.value),f=i.type;if(s!=null)f==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+s):t.value!==""+s&&(t.value=""+s);else if(f==="submit"||f==="reset"){t.removeAttribute("value");return}i.hasOwnProperty("value")?qm(t,i.type,s):i.hasOwnProperty("defaultValue")&&qm(t,i.type,gl(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(t.defaultChecked=!!i.defaultChecked)}function Cv(t,i,s){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var f=i.type;if(!(f!=="submit"&&f!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+t._wrapperState.initialValue,s||i===t.value||(t.value=i),t.defaultValue=i}s=t.name,s!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,s!==""&&(t.name=s)}function qm(t,i,s){(i!=="number"||_p(t.ownerDocument)!==t)&&(s==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+s&&(t.defaultValue=""+s))}var nh=Array.isArray;function Qu(t,i,s,f){if(t=t.options,i){i={};for(var y=0;y<s.length;y++)i["$"+s[y]]=!0;for(s=0;s<t.length;s++)y=i.hasOwnProperty("$"+t[s].value),t[s].selected!==y&&(t[s].selected=y),y&&f&&(t[s].defaultSelected=!0)}else{for(s=""+gl(s),i=null,y=0;y<t.length;y++){if(t[y].value===s){t[y].selected=!0,f&&(t[y].defaultSelected=!0);return}i!==null||t[y].disabled||(i=t[y])}i!==null&&(i.selected=!0)}}function Zm(t,i){if(i.dangerouslySetInnerHTML!=null)throw Error(Ye(91));return fr({},i,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Iv(t,i){var s=i.value;if(s==null){if(s=i.children,i=i.defaultValue,s!=null){if(i!=null)throw Error(Ye(92));if(nh(s)){if(1<s.length)throw Error(Ye(93));s=s[0]}i=s}i==null&&(i=""),s=i}t._wrapperState={initialValue:gl(s)}}function Sx(t,i){var s=gl(i.value),f=gl(i.defaultValue);s!=null&&(s=""+s,s!==t.value&&(t.value=s),i.defaultValue==null&&t.defaultValue!==s&&(t.defaultValue=s)),f!=null&&(t.defaultValue=""+f)}function Pv(t){var i=t.textContent;i===t._wrapperState.initialValue&&i!==""&&i!==null&&(t.value=i)}function Ex(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wm(t,i){return t==null||t==="http://www.w3.org/1999/xhtml"?Ex(i):t==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Md,Tx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,s,f,y){MSApp.execUnsafeLocalFunction(function(){return t(i,s,f,y)})}:t}(function(t,i){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=i;else{for(Md=Md||document.createElement("div"),Md.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Md.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;i.firstChild;)t.appendChild(i.firstChild)}});function bh(t,i){if(i){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=i;return}}t.textContent=i}var sh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cS=["Webkit","ms","Moz","O"];Object.keys(sh).forEach(function(t){cS.forEach(function(i){i=i+t.charAt(0).toUpperCase()+t.substring(1),sh[i]=sh[t]})});function kx(t,i,s){return i==null||typeof i=="boolean"||i===""?"":s||typeof i!="number"||i===0||sh.hasOwnProperty(t)&&sh[t]?(""+i).trim():i+"px"}function Cx(t,i){t=t.style;for(var s in i)if(i.hasOwnProperty(s)){var f=s.indexOf("--")===0,y=kx(s,i[s],f);s==="float"&&(s="cssFloat"),f?t.setProperty(s,y):t[s]=y}}var hS=fr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Hm(t,i){if(i){if(hS[t]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(Ye(137,t));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(Ye(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(Ye(61))}if(i.style!=null&&typeof i.style!="object")throw Error(Ye(62))}}function Xm(t,i){if(t.indexOf("-")===-1)return typeof i.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ym=null;function ty(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Km=null,ec=null,tc=null;function Av(t){if(t=qh(t)){if(typeof Km!="function")throw Error(Ye(280));var i=t.stateNode;i&&(i=Kp(i),Km(t.stateNode,t.type,i))}}function Ix(t){ec?tc?tc.push(t):tc=[t]:ec=t}function Px(){if(ec){var t=ec,i=tc;if(tc=ec=null,Av(t),i)for(t=0;t<i.length;t++)Av(i[t])}}function Ax(t,i){return t(i)}function Mx(){}var sm=!1;function zx(t,i,s){if(sm)return t(i,s);sm=!0;try{return Ax(t,i,s)}finally{sm=!1,(ec!==null||tc!==null)&&(Mx(),Px())}}function wh(t,i){var s=t.stateNode;if(s===null)return null;var f=Kp(s);if(f===null)return null;s=f[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(t=t.type,f=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!f;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(Ye(231,i,typeof s));return s}var Jm=!1;if(Ss)try{var Hc={};Object.defineProperty(Hc,"passive",{get:function(){Jm=!0}}),window.addEventListener("test",Hc,Hc),window.removeEventListener("test",Hc,Hc)}catch{Jm=!1}function dS(t,i,s,f,y,v,T,u,F){var W=Array.prototype.slice.call(arguments,3);try{i.apply(s,W)}catch(ie){this.onError(ie)}}var lh=!1,vp=null,xp=!1,Qm=null,pS={onError:function(t){lh=!0,vp=t}};function fS(t,i,s,f,y,v,T,u,F){lh=!1,vp=null,dS.apply(pS,arguments)}function mS(t,i,s,f,y,v,T,u,F){if(fS.apply(this,arguments),lh){if(lh){var W=vp;lh=!1,vp=null}else throw Error(Ye(198));xp||(xp=!0,Qm=W)}}function gu(t){var i=t,s=t;if(t.alternate)for(;i.return;)i=i.return;else{t=i;do i=t,(i.flags&4098)!==0&&(s=i.return),t=i.return;while(t)}return i.tag===3?s:null}function Lx(t){if(t.tag===13){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function Mv(t){if(gu(t)!==t)throw Error(Ye(188))}function gS(t){var i=t.alternate;if(!i){if(i=gu(t),i===null)throw Error(Ye(188));return i!==t?null:t}for(var s=t,f=i;;){var y=s.return;if(y===null)break;var v=y.alternate;if(v===null){if(f=y.return,f!==null){s=f;continue}break}if(y.child===v.child){for(v=y.child;v;){if(v===s)return Mv(y),t;if(v===f)return Mv(y),i;v=v.sibling}throw Error(Ye(188))}if(s.return!==f.return)s=y,f=v;else{for(var T=!1,u=y.child;u;){if(u===s){T=!0,s=y,f=v;break}if(u===f){T=!0,f=y,s=v;break}u=u.sibling}if(!T){for(u=v.child;u;){if(u===s){T=!0,s=v,f=y;break}if(u===f){T=!0,f=v,s=y;break}u=u.sibling}if(!T)throw Error(Ye(189))}}if(s.alternate!==f)throw Error(Ye(190))}if(s.tag!==3)throw Error(Ye(188));return s.stateNode.current===s?t:i}function Dx(t){return t=gS(t),t!==null?Rx(t):null}function Rx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var i=Rx(t);if(i!==null)return i;t=t.sibling}return null}var Fx=Ro.unstable_scheduleCallback,zv=Ro.unstable_cancelCallback,yS=Ro.unstable_shouldYield,_S=Ro.unstable_requestPaint,kr=Ro.unstable_now,vS=Ro.unstable_getCurrentPriorityLevel,ny=Ro.unstable_ImmediatePriority,Ox=Ro.unstable_UserBlockingPriority,bp=Ro.unstable_NormalPriority,xS=Ro.unstable_LowPriority,Bx=Ro.unstable_IdlePriority,Wp=null,Xa=null;function bS(t){if(Xa&&typeof Xa.onCommitFiberRoot=="function")try{Xa.onCommitFiberRoot(Wp,t,void 0,(t.current.flags&128)===128)}catch{}}var wa=Math.clz32?Math.clz32:ES,wS=Math.log,SS=Math.LN2;function ES(t){return t>>>=0,t===0?32:31-(wS(t)/SS|0)|0}var zd=64,Ld=4194304;function rh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function wp(t,i){var s=t.pendingLanes;if(s===0)return 0;var f=0,y=t.suspendedLanes,v=t.pingedLanes,T=s&268435455;if(T!==0){var u=T&~y;u!==0?f=rh(u):(v&=T,v!==0&&(f=rh(v)))}else T=s&~y,T!==0?f=rh(T):v!==0&&(f=rh(v));if(f===0)return 0;if(i!==0&&i!==f&&(i&y)===0&&(y=f&-f,v=i&-i,y>=v||y===16&&(v&4194240)!==0))return i;if((f&4)!==0&&(f|=s&16),i=t.entangledLanes,i!==0)for(t=t.entanglements,i&=f;0<i;)s=31-wa(i),y=1<<s,f|=t[s],i&=~y;return f}function TS(t,i){switch(t){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kS(t,i){for(var s=t.suspendedLanes,f=t.pingedLanes,y=t.expirationTimes,v=t.pendingLanes;0<v;){var T=31-wa(v),u=1<<T,F=y[T];F===-1?((u&s)===0||(u&f)!==0)&&(y[T]=TS(u,i)):F<=i&&(t.expiredLanes|=u),v&=~u}}function eg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Nx(){var t=zd;return zd<<=1,(zd&4194240)===0&&(zd=64),t}function lm(t){for(var i=[],s=0;31>s;s++)i.push(t);return i}function jh(t,i,s){t.pendingLanes|=i,i!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,i=31-wa(i),t[i]=s}function CS(t,i){var s=t.pendingLanes&~i;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=i,t.mutableReadLanes&=i,t.entangledLanes&=i,i=t.entanglements;var f=t.eventTimes;for(t=t.expirationTimes;0<s;){var y=31-wa(s),v=1<<y;i[y]=0,f[y]=-1,t[y]=-1,s&=~v}}function ry(t,i){var s=t.entangledLanes|=i;for(t=t.entanglements;s;){var f=31-wa(s),y=1<<f;y&i|t[f]&i&&(t[f]|=i),s&=~y}}var On=0;function Ux(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var Vx,iy,$x,jx,Gx,tg=!1,Dd=[],ll=null,ul=null,cl=null,Sh=new Map,Eh=new Map,nl=[],IS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lv(t,i){switch(t){case"focusin":case"focusout":ll=null;break;case"dragenter":case"dragleave":ul=null;break;case"mouseover":case"mouseout":cl=null;break;case"pointerover":case"pointerout":Sh.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Eh.delete(i.pointerId)}}function Xc(t,i,s,f,y,v){return t===null||t.nativeEvent!==v?(t={blockedOn:i,domEventName:s,eventSystemFlags:f,nativeEvent:v,targetContainers:[y]},i!==null&&(i=qh(i),i!==null&&iy(i)),t):(t.eventSystemFlags|=f,i=t.targetContainers,y!==null&&i.indexOf(y)===-1&&i.push(y),t)}function PS(t,i,s,f,y){switch(i){case"focusin":return ll=Xc(ll,t,i,s,f,y),!0;case"dragenter":return ul=Xc(ul,t,i,s,f,y),!0;case"mouseover":return cl=Xc(cl,t,i,s,f,y),!0;case"pointerover":var v=y.pointerId;return Sh.set(v,Xc(Sh.get(v)||null,t,i,s,f,y)),!0;case"gotpointercapture":return v=y.pointerId,Eh.set(v,Xc(Eh.get(v)||null,t,i,s,f,y)),!0}return!1}function qx(t){var i=Ql(t.target);if(i!==null){var s=gu(i);if(s!==null){if(i=s.tag,i===13){if(i=Lx(s),i!==null){t.blockedOn=i,Gx(t.priority,function(){$x(s)});return}}else if(i===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function op(t){if(t.blockedOn!==null)return!1;for(var i=t.targetContainers;0<i.length;){var s=ng(t.domEventName,t.eventSystemFlags,i[0],t.nativeEvent);if(s===null){s=t.nativeEvent;var f=new s.constructor(s.type,s);Ym=f,s.target.dispatchEvent(f),Ym=null}else return i=qh(s),i!==null&&iy(i),t.blockedOn=s,!1;i.shift()}return!0}function Dv(t,i,s){op(t)&&s.delete(i)}function AS(){tg=!1,ll!==null&&op(ll)&&(ll=null),ul!==null&&op(ul)&&(ul=null),cl!==null&&op(cl)&&(cl=null),Sh.forEach(Dv),Eh.forEach(Dv)}function Yc(t,i){t.blockedOn===i&&(t.blockedOn=null,tg||(tg=!0,Ro.unstable_scheduleCallback(Ro.unstable_NormalPriority,AS)))}function Th(t){function i(y){return Yc(y,t)}if(0<Dd.length){Yc(Dd[0],t);for(var s=1;s<Dd.length;s++){var f=Dd[s];f.blockedOn===t&&(f.blockedOn=null)}}for(ll!==null&&Yc(ll,t),ul!==null&&Yc(ul,t),cl!==null&&Yc(cl,t),Sh.forEach(i),Eh.forEach(i),s=0;s<nl.length;s++)f=nl[s],f.blockedOn===t&&(f.blockedOn=null);for(;0<nl.length&&(s=nl[0],s.blockedOn===null);)qx(s),s.blockedOn===null&&nl.shift()}var nc=As.ReactCurrentBatchConfig,Sp=!0;function MS(t,i,s,f){var y=On,v=nc.transition;nc.transition=null;try{On=1,oy(t,i,s,f)}finally{On=y,nc.transition=v}}function zS(t,i,s,f){var y=On,v=nc.transition;nc.transition=null;try{On=4,oy(t,i,s,f)}finally{On=y,nc.transition=v}}function oy(t,i,s,f){if(Sp){var y=ng(t,i,s,f);if(y===null)_m(t,i,f,Ep,s),Lv(t,f);else if(PS(y,t,i,s,f))f.stopPropagation();else if(Lv(t,f),i&4&&-1<IS.indexOf(t)){for(;y!==null;){var v=qh(y);if(v!==null&&Vx(v),v=ng(t,i,s,f),v===null&&_m(t,i,f,Ep,s),v===y)break;y=v}y!==null&&f.stopPropagation()}else _m(t,i,f,null,s)}}var Ep=null;function ng(t,i,s,f){if(Ep=null,t=ty(f),t=Ql(t),t!==null)if(i=gu(t),i===null)t=null;else if(s=i.tag,s===13){if(t=Lx(i),t!==null)return t;t=null}else if(s===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;t=null}else i!==t&&(t=null);return Ep=t,null}function Zx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(vS()){case ny:return 1;case Ox:return 4;case bp:case xS:return 16;case Bx:return 536870912;default:return 16}default:return 16}}var il=null,ay=null,ap=null;function Wx(){if(ap)return ap;var t,i=ay,s=i.length,f,y="value"in il?il.value:il.textContent,v=y.length;for(t=0;t<s&&i[t]===y[t];t++);var T=s-t;for(f=1;f<=T&&i[s-f]===y[v-f];f++);return ap=y.slice(t,1<f?1-f:void 0)}function sp(t){var i=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&i===13&&(t=13)):t=i,t===10&&(t=13),32<=t||t===13?t:0}function Rd(){return!0}function Rv(){return!1}function Oo(t){function i(s,f,y,v,T){this._reactName=s,this._targetInst=y,this.type=f,this.nativeEvent=v,this.target=T,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(s=t[u],this[u]=s?s(v):v[u]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Rd:Rv,this.isPropagationStopped=Rv,this}return fr(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=Rd)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=Rd)},persist:function(){},isPersistent:Rd}),i}var mc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sy=Oo(mc),Gh=fr({},mc,{view:0,detail:0}),LS=Oo(Gh),um,cm,Kc,Hp=fr({},Gh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ly,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Kc&&(Kc&&t.type==="mousemove"?(um=t.screenX-Kc.screenX,cm=t.screenY-Kc.screenY):cm=um=0,Kc=t),um)},movementY:function(t){return"movementY"in t?t.movementY:cm}}),Fv=Oo(Hp),DS=fr({},Hp,{dataTransfer:0}),RS=Oo(DS),FS=fr({},Gh,{relatedTarget:0}),hm=Oo(FS),OS=fr({},mc,{animationName:0,elapsedTime:0,pseudoElement:0}),BS=Oo(OS),NS=fr({},mc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),US=Oo(NS),VS=fr({},mc,{data:0}),Ov=Oo(VS),$S={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},GS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qS(t){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(t):(t=GS[t])?!!i[t]:!1}function ly(){return qS}var ZS=fr({},Gh,{key:function(t){if(t.key){var i=$S[t.key]||t.key;if(i!=="Unidentified")return i}return t.type==="keypress"?(t=sp(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?jS[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ly,charCode:function(t){return t.type==="keypress"?sp(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?sp(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),WS=Oo(ZS),HS=fr({},Hp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bv=Oo(HS),XS=fr({},Gh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ly}),YS=Oo(XS),KS=fr({},mc,{propertyName:0,elapsedTime:0,pseudoElement:0}),JS=Oo(KS),QS=fr({},Hp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),eE=Oo(QS),tE=[9,13,27,32],uy=Ss&&"CompositionEvent"in window,uh=null;Ss&&"documentMode"in document&&(uh=document.documentMode);var nE=Ss&&"TextEvent"in window&&!uh,Hx=Ss&&(!uy||uh&&8<uh&&11>=uh),Nv=String.fromCharCode(32),Uv=!1;function Xx(t,i){switch(t){case"keyup":return tE.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Uu=!1;function rE(t,i){switch(t){case"compositionend":return Yx(i);case"keypress":return i.which!==32?null:(Uv=!0,Nv);case"textInput":return t=i.data,t===Nv&&Uv?null:t;default:return null}}function iE(t,i){if(Uu)return t==="compositionend"||!uy&&Xx(t,i)?(t=Wx(),ap=ay=il=null,Uu=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Hx&&i.locale!=="ko"?null:i.data;default:return null}}var oE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vv(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i==="input"?!!oE[t.type]:i==="textarea"}function Kx(t,i,s,f){Ix(f),i=Tp(i,"onChange"),0<i.length&&(s=new sy("onChange","change",null,s,f),t.push({event:s,listeners:i}))}var ch=null,kh=null;function aE(t){l1(t,0)}function Xp(t){var i=ju(t);if(bx(i))return t}function sE(t,i){if(t==="change")return i}var Jx=!1;if(Ss){var dm;if(Ss){var pm="oninput"in document;if(!pm){var $v=document.createElement("div");$v.setAttribute("oninput","return;"),pm=typeof $v.oninput=="function"}dm=pm}else dm=!1;Jx=dm&&(!document.documentMode||9<document.documentMode)}function jv(){ch&&(ch.detachEvent("onpropertychange",Qx),kh=ch=null)}function Qx(t){if(t.propertyName==="value"&&Xp(kh)){var i=[];Kx(i,kh,t,ty(t)),zx(aE,i)}}function lE(t,i,s){t==="focusin"?(jv(),ch=i,kh=s,ch.attachEvent("onpropertychange",Qx)):t==="focusout"&&jv()}function uE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Xp(kh)}function cE(t,i){if(t==="click")return Xp(i)}function hE(t,i){if(t==="input"||t==="change")return Xp(i)}function dE(t,i){return t===i&&(t!==0||1/t===1/i)||t!==t&&i!==i}var Ea=typeof Object.is=="function"?Object.is:dE;function Ch(t,i){if(Ea(t,i))return!0;if(typeof t!="object"||t===null||typeof i!="object"||i===null)return!1;var s=Object.keys(t),f=Object.keys(i);if(s.length!==f.length)return!1;for(f=0;f<s.length;f++){var y=s[f];if(!Bm.call(i,y)||!Ea(t[y],i[y]))return!1}return!0}function Gv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function qv(t,i){var s=Gv(t);t=0;for(var f;s;){if(s.nodeType===3){if(f=t+s.textContent.length,t<=i&&f>=i)return{node:s,offset:i-t};t=f}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Gv(s)}}function e1(t,i){return t&&i?t===i?!0:t&&t.nodeType===3?!1:i&&i.nodeType===3?e1(t,i.parentNode):"contains"in t?t.contains(i):t.compareDocumentPosition?!!(t.compareDocumentPosition(i)&16):!1:!1}function t1(){for(var t=window,i=_p();i instanceof t.HTMLIFrameElement;){try{var s=typeof i.contentWindow.location.href=="string"}catch{s=!1}if(s)t=i.contentWindow;else break;i=_p(t.document)}return i}function cy(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i&&(i==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||i==="textarea"||t.contentEditable==="true")}function pE(t){var i=t1(),s=t.focusedElem,f=t.selectionRange;if(i!==s&&s&&s.ownerDocument&&e1(s.ownerDocument.documentElement,s)){if(f!==null&&cy(s)){if(i=f.start,t=f.end,t===void 0&&(t=i),"selectionStart"in s)s.selectionStart=i,s.selectionEnd=Math.min(t,s.value.length);else if(t=(i=s.ownerDocument||document)&&i.defaultView||window,t.getSelection){t=t.getSelection();var y=s.textContent.length,v=Math.min(f.start,y);f=f.end===void 0?v:Math.min(f.end,y),!t.extend&&v>f&&(y=f,f=v,v=y),y=qv(s,v);var T=qv(s,f);y&&T&&(t.rangeCount!==1||t.anchorNode!==y.node||t.anchorOffset!==y.offset||t.focusNode!==T.node||t.focusOffset!==T.offset)&&(i=i.createRange(),i.setStart(y.node,y.offset),t.removeAllRanges(),v>f?(t.addRange(i),t.extend(T.node,T.offset)):(i.setEnd(T.node,T.offset),t.addRange(i)))}}for(i=[],t=s;t=t.parentNode;)t.nodeType===1&&i.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<i.length;s++)t=i[s],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var fE=Ss&&"documentMode"in document&&11>=document.documentMode,Vu=null,rg=null,hh=null,ig=!1;function Zv(t,i,s){var f=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;ig||Vu==null||Vu!==_p(f)||(f=Vu,"selectionStart"in f&&cy(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),hh&&Ch(hh,f)||(hh=f,f=Tp(rg,"onSelect"),0<f.length&&(i=new sy("onSelect","select",null,i,s),t.push({event:i,listeners:f}),i.target=Vu)))}function Fd(t,i){var s={};return s[t.toLowerCase()]=i.toLowerCase(),s["Webkit"+t]="webkit"+i,s["Moz"+t]="moz"+i,s}var $u={animationend:Fd("Animation","AnimationEnd"),animationiteration:Fd("Animation","AnimationIteration"),animationstart:Fd("Animation","AnimationStart"),transitionend:Fd("Transition","TransitionEnd")},fm={},n1={};Ss&&(n1=document.createElement("div").style,"AnimationEvent"in window||(delete $u.animationend.animation,delete $u.animationiteration.animation,delete $u.animationstart.animation),"TransitionEvent"in window||delete $u.transitionend.transition);function Yp(t){if(fm[t])return fm[t];if(!$u[t])return t;var i=$u[t],s;for(s in i)if(i.hasOwnProperty(s)&&s in n1)return fm[t]=i[s];return t}var r1=Yp("animationend"),i1=Yp("animationiteration"),o1=Yp("animationstart"),a1=Yp("transitionend"),s1=new Map,Wv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bl(t,i){s1.set(t,i),mu(i,[t])}for(var mm=0;mm<Wv.length;mm++){var gm=Wv[mm],mE=gm.toLowerCase(),gE=gm[0].toUpperCase()+gm.slice(1);bl(mE,"on"+gE)}bl(r1,"onAnimationEnd");bl(i1,"onAnimationIteration");bl(o1,"onAnimationStart");bl("dblclick","onDoubleClick");bl("focusin","onFocus");bl("focusout","onBlur");bl(a1,"onTransitionEnd");ac("onMouseEnter",["mouseout","mouseover"]);ac("onMouseLeave",["mouseout","mouseover"]);ac("onPointerEnter",["pointerout","pointerover"]);ac("onPointerLeave",["pointerout","pointerover"]);mu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));mu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));mu("onBeforeInput",["compositionend","keypress","textInput","paste"]);mu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));mu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));mu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ih="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yE=new Set("cancel close invalid load scroll toggle".split(" ").concat(ih));function Hv(t,i,s){var f=t.type||"unknown-event";t.currentTarget=s,mS(f,i,void 0,t),t.currentTarget=null}function l1(t,i){i=(i&4)!==0;for(var s=0;s<t.length;s++){var f=t[s],y=f.event;f=f.listeners;e:{var v=void 0;if(i)for(var T=f.length-1;0<=T;T--){var u=f[T],F=u.instance,W=u.currentTarget;if(u=u.listener,F!==v&&y.isPropagationStopped())break e;Hv(y,u,W),v=F}else for(T=0;T<f.length;T++){if(u=f[T],F=u.instance,W=u.currentTarget,u=u.listener,F!==v&&y.isPropagationStopped())break e;Hv(y,u,W),v=F}}}if(xp)throw t=Qm,xp=!1,Qm=null,t}function Jn(t,i){var s=i[ug];s===void 0&&(s=i[ug]=new Set);var f=t+"__bubble";s.has(f)||(u1(i,t,2,!1),s.add(f))}function ym(t,i,s){var f=0;i&&(f|=4),u1(s,t,f,i)}var Od="_reactListening"+Math.random().toString(36).slice(2);function Ih(t){if(!t[Od]){t[Od]=!0,gx.forEach(function(s){s!=="selectionchange"&&(yE.has(s)||ym(s,!1,t),ym(s,!0,t))});var i=t.nodeType===9?t:t.ownerDocument;i===null||i[Od]||(i[Od]=!0,ym("selectionchange",!1,i))}}function u1(t,i,s,f){switch(Zx(i)){case 1:var y=MS;break;case 4:y=zS;break;default:y=oy}s=y.bind(null,i,s,t),y=void 0,!Jm||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(y=!0),f?y!==void 0?t.addEventListener(i,s,{capture:!0,passive:y}):t.addEventListener(i,s,!0):y!==void 0?t.addEventListener(i,s,{passive:y}):t.addEventListener(i,s,!1)}function _m(t,i,s,f,y){var v=f;if((i&1)===0&&(i&2)===0&&f!==null)e:for(;;){if(f===null)return;var T=f.tag;if(T===3||T===4){var u=f.stateNode.containerInfo;if(u===y||u.nodeType===8&&u.parentNode===y)break;if(T===4)for(T=f.return;T!==null;){var F=T.tag;if((F===3||F===4)&&(F=T.stateNode.containerInfo,F===y||F.nodeType===8&&F.parentNode===y))return;T=T.return}for(;u!==null;){if(T=Ql(u),T===null)return;if(F=T.tag,F===5||F===6){f=v=T;continue e}u=u.parentNode}}f=f.return}zx(function(){var W=v,ie=ty(s),ne=[];e:{var G=s1.get(t);if(G!==void 0){var we=sy,Me=t;switch(t){case"keypress":if(sp(s)===0)break e;case"keydown":case"keyup":we=WS;break;case"focusin":Me="focus",we=hm;break;case"focusout":Me="blur",we=hm;break;case"beforeblur":case"afterblur":we=hm;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=Fv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=RS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=YS;break;case r1:case i1:case o1:we=BS;break;case a1:we=JS;break;case"scroll":we=LS;break;case"wheel":we=eE;break;case"copy":case"cut":case"paste":we=US;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=Bv}var Ce=(i&4)!==0,Ze=!Ce&&t==="scroll",re=Ce?G!==null?G+"Capture":null:G;Ce=[];for(var J=W,se;J!==null;){se=J;var Te=se.stateNode;if(se.tag===5&&Te!==null&&(se=Te,re!==null&&(Te=wh(J,re),Te!=null&&Ce.push(Ph(J,Te,se)))),Ze)break;J=J.return}0<Ce.length&&(G=new we(G,Me,null,s,ie),ne.push({event:G,listeners:Ce}))}}if((i&7)===0){e:{if(G=t==="mouseover"||t==="pointerover",we=t==="mouseout"||t==="pointerout",G&&s!==Ym&&(Me=s.relatedTarget||s.fromElement)&&(Ql(Me)||Me[Es]))break e;if((we||G)&&(G=ie.window===ie?ie:(G=ie.ownerDocument)?G.defaultView||G.parentWindow:window,we?(Me=s.relatedTarget||s.toElement,we=W,Me=Me?Ql(Me):null,Me!==null&&(Ze=gu(Me),Me!==Ze||Me.tag!==5&&Me.tag!==6)&&(Me=null)):(we=null,Me=W),we!==Me)){if(Ce=Fv,Te="onMouseLeave",re="onMouseEnter",J="mouse",(t==="pointerout"||t==="pointerover")&&(Ce=Bv,Te="onPointerLeave",re="onPointerEnter",J="pointer"),Ze=we==null?G:ju(we),se=Me==null?G:ju(Me),G=new Ce(Te,J+"leave",we,s,ie),G.target=Ze,G.relatedTarget=se,Te=null,Ql(ie)===W&&(Ce=new Ce(re,J+"enter",Me,s,ie),Ce.target=se,Ce.relatedTarget=Ze,Te=Ce),Ze=Te,we&&Me)t:{for(Ce=we,re=Me,J=0,se=Ce;se;se=Fu(se))J++;for(se=0,Te=re;Te;Te=Fu(Te))se++;for(;0<J-se;)Ce=Fu(Ce),J--;for(;0<se-J;)re=Fu(re),se--;for(;J--;){if(Ce===re||re!==null&&Ce===re.alternate)break t;Ce=Fu(Ce),re=Fu(re)}Ce=null}else Ce=null;we!==null&&Xv(ne,G,we,Ce,!1),Me!==null&&Ze!==null&&Xv(ne,Ze,Me,Ce,!0)}}e:{if(G=W?ju(W):window,we=G.nodeName&&G.nodeName.toLowerCase(),we==="select"||we==="input"&&G.type==="file")var ze=sE;else if(Vv(G))if(Jx)ze=hE;else{ze=uE;var He=lE}else(we=G.nodeName)&&we.toLowerCase()==="input"&&(G.type==="checkbox"||G.type==="radio")&&(ze=cE);if(ze&&(ze=ze(t,W))){Kx(ne,ze,s,ie);break e}He&&He(t,G,W),t==="focusout"&&(He=G._wrapperState)&&He.controlled&&G.type==="number"&&qm(G,"number",G.value)}switch(He=W?ju(W):window,t){case"focusin":(Vv(He)||He.contentEditable==="true")&&(Vu=He,rg=W,hh=null);break;case"focusout":hh=rg=Vu=null;break;case"mousedown":ig=!0;break;case"contextmenu":case"mouseup":case"dragend":ig=!1,Zv(ne,s,ie);break;case"selectionchange":if(fE)break;case"keydown":case"keyup":Zv(ne,s,ie)}var it;if(uy)e:{switch(t){case"compositionstart":var Xe="onCompositionStart";break e;case"compositionend":Xe="onCompositionEnd";break e;case"compositionupdate":Xe="onCompositionUpdate";break e}Xe=void 0}else Uu?Xx(t,s)&&(Xe="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(Xe="onCompositionStart");Xe&&(Hx&&s.locale!=="ko"&&(Uu||Xe!=="onCompositionStart"?Xe==="onCompositionEnd"&&Uu&&(it=Wx()):(il=ie,ay="value"in il?il.value:il.textContent,Uu=!0)),He=Tp(W,Xe),0<He.length&&(Xe=new Ov(Xe,t,null,s,ie),ne.push({event:Xe,listeners:He}),it?Xe.data=it:(it=Yx(s),it!==null&&(Xe.data=it)))),(it=nE?rE(t,s):iE(t,s))&&(W=Tp(W,"onBeforeInput"),0<W.length&&(ie=new Ov("onBeforeInput","beforeinput",null,s,ie),ne.push({event:ie,listeners:W}),ie.data=it))}l1(ne,i)})}function Ph(t,i,s){return{instance:t,listener:i,currentTarget:s}}function Tp(t,i){for(var s=i+"Capture",f=[];t!==null;){var y=t,v=y.stateNode;y.tag===5&&v!==null&&(y=v,v=wh(t,s),v!=null&&f.unshift(Ph(t,v,y)),v=wh(t,i),v!=null&&f.push(Ph(t,v,y))),t=t.return}return f}function Fu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Xv(t,i,s,f,y){for(var v=i._reactName,T=[];s!==null&&s!==f;){var u=s,F=u.alternate,W=u.stateNode;if(F!==null&&F===f)break;u.tag===5&&W!==null&&(u=W,y?(F=wh(s,v),F!=null&&T.unshift(Ph(s,F,u))):y||(F=wh(s,v),F!=null&&T.push(Ph(s,F,u)))),s=s.return}T.length!==0&&t.push({event:i,listeners:T})}var _E=/\r\n?/g,vE=/\u0000|\uFFFD/g;function Yv(t){return(typeof t=="string"?t:""+t).replace(_E,`
`).replace(vE,"")}function Bd(t,i,s){if(i=Yv(i),Yv(t)!==i&&s)throw Error(Ye(425))}function kp(){}var og=null,ag=null;function sg(t,i){return t==="textarea"||t==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var lg=typeof setTimeout=="function"?setTimeout:void 0,xE=typeof clearTimeout=="function"?clearTimeout:void 0,Kv=typeof Promise=="function"?Promise:void 0,bE=typeof queueMicrotask=="function"?queueMicrotask:typeof Kv<"u"?function(t){return Kv.resolve(null).then(t).catch(wE)}:lg;function wE(t){setTimeout(function(){throw t})}function vm(t,i){var s=i,f=0;do{var y=s.nextSibling;if(t.removeChild(s),y&&y.nodeType===8)if(s=y.data,s==="/$"){if(f===0){t.removeChild(y),Th(i);return}f--}else s!=="$"&&s!=="$?"&&s!=="$!"||f++;s=y}while(s);Th(i)}function hl(t){for(;t!=null;t=t.nextSibling){var i=t.nodeType;if(i===1||i===3)break;if(i===8){if(i=t.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return t}function Jv(t){t=t.previousSibling;for(var i=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"){if(i===0)return t;i--}else s==="/$"&&i++}t=t.previousSibling}return null}var gc=Math.random().toString(36).slice(2),Wa="__reactFiber$"+gc,Ah="__reactProps$"+gc,Es="__reactContainer$"+gc,ug="__reactEvents$"+gc,SE="__reactListeners$"+gc,EE="__reactHandles$"+gc;function Ql(t){var i=t[Wa];if(i)return i;for(var s=t.parentNode;s;){if(i=s[Es]||s[Wa]){if(s=i.alternate,i.child!==null||s!==null&&s.child!==null)for(t=Jv(t);t!==null;){if(s=t[Wa])return s;t=Jv(t)}return i}t=s,s=t.parentNode}return null}function qh(t){return t=t[Wa]||t[Es],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ju(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ye(33))}function Kp(t){return t[Ah]||null}var cg=[],Gu=-1;function wl(t){return{current:t}}function er(t){0>Gu||(t.current=cg[Gu],cg[Gu]=null,Gu--)}function Xn(t,i){Gu++,cg[Gu]=t.current,t.current=i}var yl={},Oi=wl(yl),po=wl(!1),su=yl;function sc(t,i){var s=t.type.contextTypes;if(!s)return yl;var f=t.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===i)return f.__reactInternalMemoizedMaskedChildContext;var y={},v;for(v in s)y[v]=i[v];return f&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=y),y}function fo(t){return t=t.childContextTypes,t!=null}function Cp(){er(po),er(Oi)}function Qv(t,i,s){if(Oi.current!==yl)throw Error(Ye(168));Xn(Oi,i),Xn(po,s)}function c1(t,i,s){var f=t.stateNode;if(i=i.childContextTypes,typeof f.getChildContext!="function")return s;f=f.getChildContext();for(var y in f)if(!(y in i))throw Error(Ye(108,lS(t)||"Unknown",y));return fr({},s,f)}function Ip(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||yl,su=Oi.current,Xn(Oi,t),Xn(po,po.current),!0}function e0(t,i,s){var f=t.stateNode;if(!f)throw Error(Ye(169));s?(t=c1(t,i,su),f.__reactInternalMemoizedMergedChildContext=t,er(po),er(Oi),Xn(Oi,t)):er(po),Xn(po,s)}var _s=null,Jp=!1,xm=!1;function h1(t){_s===null?_s=[t]:_s.push(t)}function TE(t){Jp=!0,h1(t)}function Sl(){if(!xm&&_s!==null){xm=!0;var t=0,i=On;try{var s=_s;for(On=1;t<s.length;t++){var f=s[t];do f=f(!0);while(f!==null)}_s=null,Jp=!1}catch(y){throw _s!==null&&(_s=_s.slice(t+1)),Fx(ny,Sl),y}finally{On=i,xm=!1}}return null}var qu=[],Zu=0,Pp=null,Ap=0,ea=[],ta=0,lu=null,xs=1,bs="";function Yl(t,i){qu[Zu++]=Ap,qu[Zu++]=Pp,Pp=t,Ap=i}function d1(t,i,s){ea[ta++]=xs,ea[ta++]=bs,ea[ta++]=lu,lu=t;var f=xs;t=bs;var y=32-wa(f)-1;f&=~(1<<y),s+=1;var v=32-wa(i)+y;if(30<v){var T=y-y%5;v=(f&(1<<T)-1).toString(32),f>>=T,y-=T,xs=1<<32-wa(i)+y|s<<y|f,bs=v+t}else xs=1<<v|s<<y|f,bs=t}function hy(t){t.return!==null&&(Yl(t,1),d1(t,1,0))}function dy(t){for(;t===Pp;)Pp=qu[--Zu],qu[Zu]=null,Ap=qu[--Zu],qu[Zu]=null;for(;t===lu;)lu=ea[--ta],ea[ta]=null,bs=ea[--ta],ea[ta]=null,xs=ea[--ta],ea[ta]=null}var Do=null,Lo=null,lr=!1,xa=null;function p1(t,i){var s=na(5,null,null,0);s.elementType="DELETED",s.stateNode=i,s.return=t,i=t.deletions,i===null?(t.deletions=[s],t.flags|=16):i.push(s)}function t0(t,i){switch(t.tag){case 5:var s=t.type;return i=i.nodeType!==1||s.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(t.stateNode=i,Do=t,Lo=hl(i.firstChild),!0):!1;case 6:return i=t.pendingProps===""||i.nodeType!==3?null:i,i!==null?(t.stateNode=i,Do=t,Lo=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(s=lu!==null?{id:xs,overflow:bs}:null,t.memoizedState={dehydrated:i,treeContext:s,retryLane:1073741824},s=na(18,null,null,0),s.stateNode=i,s.return=t,t.child=s,Do=t,Lo=null,!0):!1;default:return!1}}function hg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function dg(t){if(lr){var i=Lo;if(i){var s=i;if(!t0(t,i)){if(hg(t))throw Error(Ye(418));i=hl(s.nextSibling);var f=Do;i&&t0(t,i)?p1(f,s):(t.flags=t.flags&-4097|2,lr=!1,Do=t)}}else{if(hg(t))throw Error(Ye(418));t.flags=t.flags&-4097|2,lr=!1,Do=t}}}function n0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Do=t}function Nd(t){if(t!==Do)return!1;if(!lr)return n0(t),lr=!0,!1;var i;if((i=t.tag!==3)&&!(i=t.tag!==5)&&(i=t.type,i=i!=="head"&&i!=="body"&&!sg(t.type,t.memoizedProps)),i&&(i=Lo)){if(hg(t))throw f1(),Error(Ye(418));for(;i;)p1(t,i),i=hl(i.nextSibling)}if(n0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ye(317));e:{for(t=t.nextSibling,i=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"){if(i===0){Lo=hl(t.nextSibling);break e}i--}else s!=="$"&&s!=="$!"&&s!=="$?"||i++}t=t.nextSibling}Lo=null}}else Lo=Do?hl(t.stateNode.nextSibling):null;return!0}function f1(){for(var t=Lo;t;)t=hl(t.nextSibling)}function lc(){Lo=Do=null,lr=!1}function py(t){xa===null?xa=[t]:xa.push(t)}var kE=As.ReactCurrentBatchConfig;function _a(t,i){if(t&&t.defaultProps){i=fr({},i),t=t.defaultProps;for(var s in t)i[s]===void 0&&(i[s]=t[s]);return i}return i}var Mp=wl(null),zp=null,Wu=null,fy=null;function my(){fy=Wu=zp=null}function gy(t){var i=Mp.current;er(Mp),t._currentValue=i}function pg(t,i,s){for(;t!==null;){var f=t.alternate;if((t.childLanes&i)!==i?(t.childLanes|=i,f!==null&&(f.childLanes|=i)):f!==null&&(f.childLanes&i)!==i&&(f.childLanes|=i),t===s)break;t=t.return}}function rc(t,i){zp=t,fy=Wu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&i)!==0&&(co=!0),t.firstContext=null)}function ia(t){var i=t._currentValue;if(fy!==t)if(t={context:t,memoizedValue:i,next:null},Wu===null){if(zp===null)throw Error(Ye(308));Wu=t,zp.dependencies={lanes:0,firstContext:t}}else Wu=Wu.next=t;return i}var eu=null;function yy(t){eu===null?eu=[t]:eu.push(t)}function m1(t,i,s,f){var y=i.interleaved;return y===null?(s.next=s,yy(i)):(s.next=y.next,y.next=s),i.interleaved=s,Ts(t,f)}function Ts(t,i){t.lanes|=i;var s=t.alternate;for(s!==null&&(s.lanes|=i),s=t,t=t.return;t!==null;)t.childLanes|=i,s=t.alternate,s!==null&&(s.childLanes|=i),s=t,t=t.return;return s.tag===3?s.stateNode:null}var tl=!1;function _y(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function g1(t,i){t=t.updateQueue,i.updateQueue===t&&(i.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ws(t,i){return{eventTime:t,lane:i,tag:0,payload:null,callback:null,next:null}}function dl(t,i,s){var f=t.updateQueue;if(f===null)return null;if(f=f.shared,(kn&2)!==0){var y=f.pending;return y===null?i.next=i:(i.next=y.next,y.next=i),f.pending=i,Ts(t,s)}return y=f.interleaved,y===null?(i.next=i,yy(f)):(i.next=y.next,y.next=i),f.interleaved=i,Ts(t,s)}function lp(t,i,s){if(i=i.updateQueue,i!==null&&(i=i.shared,(s&4194240)!==0)){var f=i.lanes;f&=t.pendingLanes,s|=f,i.lanes=s,ry(t,s)}}function r0(t,i){var s=t.updateQueue,f=t.alternate;if(f!==null&&(f=f.updateQueue,s===f)){var y=null,v=null;if(s=s.firstBaseUpdate,s!==null){do{var T={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};v===null?y=v=T:v=v.next=T,s=s.next}while(s!==null);v===null?y=v=i:v=v.next=i}else y=v=i;s={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:v,shared:f.shared,effects:f.effects},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=i:t.next=i,s.lastBaseUpdate=i}function Lp(t,i,s,f){var y=t.updateQueue;tl=!1;var v=y.firstBaseUpdate,T=y.lastBaseUpdate,u=y.shared.pending;if(u!==null){y.shared.pending=null;var F=u,W=F.next;F.next=null,T===null?v=W:T.next=W,T=F;var ie=t.alternate;ie!==null&&(ie=ie.updateQueue,u=ie.lastBaseUpdate,u!==T&&(u===null?ie.firstBaseUpdate=W:u.next=W,ie.lastBaseUpdate=F))}if(v!==null){var ne=y.baseState;T=0,ie=W=F=null,u=v;do{var G=u.lane,we=u.eventTime;if((f&G)===G){ie!==null&&(ie=ie.next={eventTime:we,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var Me=t,Ce=u;switch(G=i,we=s,Ce.tag){case 1:if(Me=Ce.payload,typeof Me=="function"){ne=Me.call(we,ne,G);break e}ne=Me;break e;case 3:Me.flags=Me.flags&-65537|128;case 0:if(Me=Ce.payload,G=typeof Me=="function"?Me.call(we,ne,G):Me,G==null)break e;ne=fr({},ne,G);break e;case 2:tl=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,G=y.effects,G===null?y.effects=[u]:G.push(u))}else we={eventTime:we,lane:G,tag:u.tag,payload:u.payload,callback:u.callback,next:null},ie===null?(W=ie=we,F=ne):ie=ie.next=we,T|=G;if(u=u.next,u===null){if(u=y.shared.pending,u===null)break;G=u,u=G.next,G.next=null,y.lastBaseUpdate=G,y.shared.pending=null}}while(1);if(ie===null&&(F=ne),y.baseState=F,y.firstBaseUpdate=W,y.lastBaseUpdate=ie,i=y.shared.interleaved,i!==null){y=i;do T|=y.lane,y=y.next;while(y!==i)}else v===null&&(y.shared.lanes=0);cu|=T,t.lanes=T,t.memoizedState=ne}}function i0(t,i,s){if(t=i.effects,i.effects=null,t!==null)for(i=0;i<t.length;i++){var f=t[i],y=f.callback;if(y!==null){if(f.callback=null,f=s,typeof y!="function")throw Error(Ye(191,y));y.call(f)}}}var y1=new mx.Component().refs;function fg(t,i,s,f){i=t.memoizedState,s=s(f,i),s=s==null?i:fr({},i,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var Qp={isMounted:function(t){return(t=t._reactInternals)?gu(t)===t:!1},enqueueSetState:function(t,i,s){t=t._reactInternals;var f=Hi(),y=fl(t),v=ws(f,y);v.payload=i,s!=null&&(v.callback=s),i=dl(t,v,y),i!==null&&(Sa(i,t,y,f),lp(i,t,y))},enqueueReplaceState:function(t,i,s){t=t._reactInternals;var f=Hi(),y=fl(t),v=ws(f,y);v.tag=1,v.payload=i,s!=null&&(v.callback=s),i=dl(t,v,y),i!==null&&(Sa(i,t,y,f),lp(i,t,y))},enqueueForceUpdate:function(t,i){t=t._reactInternals;var s=Hi(),f=fl(t),y=ws(s,f);y.tag=2,i!=null&&(y.callback=i),i=dl(t,y,f),i!==null&&(Sa(i,t,f,s),lp(i,t,f))}};function o0(t,i,s,f,y,v,T){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(f,v,T):i.prototype&&i.prototype.isPureReactComponent?!Ch(s,f)||!Ch(y,v):!0}function _1(t,i,s){var f=!1,y=yl,v=i.contextType;return typeof v=="object"&&v!==null?v=ia(v):(y=fo(i)?su:Oi.current,f=i.contextTypes,v=(f=f!=null)?sc(t,y):yl),i=new i(s,v),t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Qp,t.stateNode=i,i._reactInternals=t,f&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=y,t.__reactInternalMemoizedMaskedChildContext=v),i}function a0(t,i,s,f){t=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(s,f),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(s,f),i.state!==t&&Qp.enqueueReplaceState(i,i.state,null)}function mg(t,i,s,f){var y=t.stateNode;y.props=s,y.state=t.memoizedState,y.refs=y1,_y(t);var v=i.contextType;typeof v=="object"&&v!==null?y.context=ia(v):(v=fo(i)?su:Oi.current,y.context=sc(t,v)),y.state=t.memoizedState,v=i.getDerivedStateFromProps,typeof v=="function"&&(fg(t,i,v,s),y.state=t.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(i=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),i!==y.state&&Qp.enqueueReplaceState(y,y.state,null),Lp(t,s,y,f),y.state=t.memoizedState),typeof y.componentDidMount=="function"&&(t.flags|=4194308)}function Jc(t,i,s){if(t=s.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(Ye(309));var f=s.stateNode}if(!f)throw Error(Ye(147,t));var y=f,v=""+t;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===v?i.ref:(i=function(T){var u=y.refs;u===y1&&(u=y.refs={}),T===null?delete u[v]:u[v]=T},i._stringRef=v,i)}if(typeof t!="string")throw Error(Ye(284));if(!s._owner)throw Error(Ye(290,t))}return t}function Ud(t,i){throw t=Object.prototype.toString.call(i),Error(Ye(31,t==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":t))}function s0(t){var i=t._init;return i(t._payload)}function v1(t){function i(re,J){if(t){var se=re.deletions;se===null?(re.deletions=[J],re.flags|=16):se.push(J)}}function s(re,J){if(!t)return null;for(;J!==null;)i(re,J),J=J.sibling;return null}function f(re,J){for(re=new Map;J!==null;)J.key!==null?re.set(J.key,J):re.set(J.index,J),J=J.sibling;return re}function y(re,J){return re=ml(re,J),re.index=0,re.sibling=null,re}function v(re,J,se){return re.index=se,t?(se=re.alternate,se!==null?(se=se.index,se<J?(re.flags|=2,J):se):(re.flags|=2,J)):(re.flags|=1048576,J)}function T(re){return t&&re.alternate===null&&(re.flags|=2),re}function u(re,J,se,Te){return J===null||J.tag!==6?(J=Cm(se,re.mode,Te),J.return=re,J):(J=y(J,se),J.return=re,J)}function F(re,J,se,Te){var ze=se.type;return ze===Nu?ie(re,J,se.props.children,Te,se.key):J!==null&&(J.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===el&&s0(ze)===J.type)?(Te=y(J,se.props),Te.ref=Jc(re,J,se),Te.return=re,Te):(Te=fp(se.type,se.key,se.props,null,re.mode,Te),Te.ref=Jc(re,J,se),Te.return=re,Te)}function W(re,J,se,Te){return J===null||J.tag!==4||J.stateNode.containerInfo!==se.containerInfo||J.stateNode.implementation!==se.implementation?(J=Im(se,re.mode,Te),J.return=re,J):(J=y(J,se.children||[]),J.return=re,J)}function ie(re,J,se,Te,ze){return J===null||J.tag!==7?(J=ou(se,re.mode,Te,ze),J.return=re,J):(J=y(J,se),J.return=re,J)}function ne(re,J,se){if(typeof J=="string"&&J!==""||typeof J=="number")return J=Cm(""+J,re.mode,se),J.return=re,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case Pd:return se=fp(J.type,J.key,J.props,null,re.mode,se),se.ref=Jc(re,null,J),se.return=re,se;case Bu:return J=Im(J,re.mode,se),J.return=re,J;case el:var Te=J._init;return ne(re,Te(J._payload),se)}if(nh(J)||Wc(J))return J=ou(J,re.mode,se,null),J.return=re,J;Ud(re,J)}return null}function G(re,J,se,Te){var ze=J!==null?J.key:null;if(typeof se=="string"&&se!==""||typeof se=="number")return ze!==null?null:u(re,J,""+se,Te);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case Pd:return se.key===ze?F(re,J,se,Te):null;case Bu:return se.key===ze?W(re,J,se,Te):null;case el:return ze=se._init,G(re,J,ze(se._payload),Te)}if(nh(se)||Wc(se))return ze!==null?null:ie(re,J,se,Te,null);Ud(re,se)}return null}function we(re,J,se,Te,ze){if(typeof Te=="string"&&Te!==""||typeof Te=="number")return re=re.get(se)||null,u(J,re,""+Te,ze);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case Pd:return re=re.get(Te.key===null?se:Te.key)||null,F(J,re,Te,ze);case Bu:return re=re.get(Te.key===null?se:Te.key)||null,W(J,re,Te,ze);case el:var He=Te._init;return we(re,J,se,He(Te._payload),ze)}if(nh(Te)||Wc(Te))return re=re.get(se)||null,ie(J,re,Te,ze,null);Ud(J,Te)}return null}function Me(re,J,se,Te){for(var ze=null,He=null,it=J,Xe=J=0,Ut=null;it!==null&&Xe<se.length;Xe++){it.index>Xe?(Ut=it,it=null):Ut=it.sibling;var xt=G(re,it,se[Xe],Te);if(xt===null){it===null&&(it=Ut);break}t&&it&&xt.alternate===null&&i(re,it),J=v(xt,J,Xe),He===null?ze=xt:He.sibling=xt,He=xt,it=Ut}if(Xe===se.length)return s(re,it),lr&&Yl(re,Xe),ze;if(it===null){for(;Xe<se.length;Xe++)it=ne(re,se[Xe],Te),it!==null&&(J=v(it,J,Xe),He===null?ze=it:He.sibling=it,He=it);return lr&&Yl(re,Xe),ze}for(it=f(re,it);Xe<se.length;Xe++)Ut=we(it,re,Xe,se[Xe],Te),Ut!==null&&(t&&Ut.alternate!==null&&it.delete(Ut.key===null?Xe:Ut.key),J=v(Ut,J,Xe),He===null?ze=Ut:He.sibling=Ut,He=Ut);return t&&it.forEach(function(Zt){return i(re,Zt)}),lr&&Yl(re,Xe),ze}function Ce(re,J,se,Te){var ze=Wc(se);if(typeof ze!="function")throw Error(Ye(150));if(se=ze.call(se),se==null)throw Error(Ye(151));for(var He=ze=null,it=J,Xe=J=0,Ut=null,xt=se.next();it!==null&&!xt.done;Xe++,xt=se.next()){it.index>Xe?(Ut=it,it=null):Ut=it.sibling;var Zt=G(re,it,xt.value,Te);if(Zt===null){it===null&&(it=Ut);break}t&&it&&Zt.alternate===null&&i(re,it),J=v(Zt,J,Xe),He===null?ze=Zt:He.sibling=Zt,He=Zt,it=Ut}if(xt.done)return s(re,it),lr&&Yl(re,Xe),ze;if(it===null){for(;!xt.done;Xe++,xt=se.next())xt=ne(re,xt.value,Te),xt!==null&&(J=v(xt,J,Xe),He===null?ze=xt:He.sibling=xt,He=xt);return lr&&Yl(re,Xe),ze}for(it=f(re,it);!xt.done;Xe++,xt=se.next())xt=we(it,re,Xe,xt.value,Te),xt!==null&&(t&&xt.alternate!==null&&it.delete(xt.key===null?Xe:xt.key),J=v(xt,J,Xe),He===null?ze=xt:He.sibling=xt,He=xt);return t&&it.forEach(function(dn){return i(re,dn)}),lr&&Yl(re,Xe),ze}function Ze(re,J,se,Te){if(typeof se=="object"&&se!==null&&se.type===Nu&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case Pd:e:{for(var ze=se.key,He=J;He!==null;){if(He.key===ze){if(ze=se.type,ze===Nu){if(He.tag===7){s(re,He.sibling),J=y(He,se.props.children),J.return=re,re=J;break e}}else if(He.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===el&&s0(ze)===He.type){s(re,He.sibling),J=y(He,se.props),J.ref=Jc(re,He,se),J.return=re,re=J;break e}s(re,He);break}else i(re,He);He=He.sibling}se.type===Nu?(J=ou(se.props.children,re.mode,Te,se.key),J.return=re,re=J):(Te=fp(se.type,se.key,se.props,null,re.mode,Te),Te.ref=Jc(re,J,se),Te.return=re,re=Te)}return T(re);case Bu:e:{for(He=se.key;J!==null;){if(J.key===He)if(J.tag===4&&J.stateNode.containerInfo===se.containerInfo&&J.stateNode.implementation===se.implementation){s(re,J.sibling),J=y(J,se.children||[]),J.return=re,re=J;break e}else{s(re,J);break}else i(re,J);J=J.sibling}J=Im(se,re.mode,Te),J.return=re,re=J}return T(re);case el:return He=se._init,Ze(re,J,He(se._payload),Te)}if(nh(se))return Me(re,J,se,Te);if(Wc(se))return Ce(re,J,se,Te);Ud(re,se)}return typeof se=="string"&&se!==""||typeof se=="number"?(se=""+se,J!==null&&J.tag===6?(s(re,J.sibling),J=y(J,se),J.return=re,re=J):(s(re,J),J=Cm(se,re.mode,Te),J.return=re,re=J),T(re)):s(re,J)}return Ze}var uc=v1(!0),x1=v1(!1),Zh={},Ya=wl(Zh),Mh=wl(Zh),zh=wl(Zh);function tu(t){if(t===Zh)throw Error(Ye(174));return t}function vy(t,i){switch(Xn(zh,i),Xn(Mh,t),Xn(Ya,Zh),t=i.nodeType,t){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Wm(null,"");break;default:t=t===8?i.parentNode:i,i=t.namespaceURI||null,t=t.tagName,i=Wm(i,t)}er(Ya),Xn(Ya,i)}function cc(){er(Ya),er(Mh),er(zh)}function b1(t){tu(zh.current);var i=tu(Ya.current),s=Wm(i,t.type);i!==s&&(Xn(Mh,t),Xn(Ya,s))}function xy(t){Mh.current===t&&(er(Ya),er(Mh))}var dr=wl(0);function Dp(t){for(var i=t;i!==null;){if(i.tag===13){var s=i.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var bm=[];function by(){for(var t=0;t<bm.length;t++)bm[t]._workInProgressVersionPrimary=null;bm.length=0}var up=As.ReactCurrentDispatcher,wm=As.ReactCurrentBatchConfig,uu=0,pr=null,Wr=null,li=null,Rp=!1,dh=!1,Lh=0,CE=0;function Di(){throw Error(Ye(321))}function wy(t,i){if(i===null)return!1;for(var s=0;s<i.length&&s<t.length;s++)if(!Ea(t[s],i[s]))return!1;return!0}function Sy(t,i,s,f,y,v){if(uu=v,pr=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,up.current=t===null||t.memoizedState===null?ME:zE,t=s(f,y),dh){v=0;do{if(dh=!1,Lh=0,25<=v)throw Error(Ye(301));v+=1,li=Wr=null,i.updateQueue=null,up.current=LE,t=s(f,y)}while(dh)}if(up.current=Fp,i=Wr!==null&&Wr.next!==null,uu=0,li=Wr=pr=null,Rp=!1,i)throw Error(Ye(300));return t}function Ey(){var t=Lh!==0;return Lh=0,t}function Za(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return li===null?pr.memoizedState=li=t:li=li.next=t,li}function oa(){if(Wr===null){var t=pr.alternate;t=t!==null?t.memoizedState:null}else t=Wr.next;var i=li===null?pr.memoizedState:li.next;if(i!==null)li=i,Wr=t;else{if(t===null)throw Error(Ye(310));Wr=t,t={memoizedState:Wr.memoizedState,baseState:Wr.baseState,baseQueue:Wr.baseQueue,queue:Wr.queue,next:null},li===null?pr.memoizedState=li=t:li=li.next=t}return li}function Dh(t,i){return typeof i=="function"?i(t):i}function Sm(t){var i=oa(),s=i.queue;if(s===null)throw Error(Ye(311));s.lastRenderedReducer=t;var f=Wr,y=f.baseQueue,v=s.pending;if(v!==null){if(y!==null){var T=y.next;y.next=v.next,v.next=T}f.baseQueue=y=v,s.pending=null}if(y!==null){v=y.next,f=f.baseState;var u=T=null,F=null,W=v;do{var ie=W.lane;if((uu&ie)===ie)F!==null&&(F=F.next={lane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),f=W.hasEagerState?W.eagerState:t(f,W.action);else{var ne={lane:ie,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null};F===null?(u=F=ne,T=f):F=F.next=ne,pr.lanes|=ie,cu|=ie}W=W.next}while(W!==null&&W!==v);F===null?T=f:F.next=u,Ea(f,i.memoizedState)||(co=!0),i.memoizedState=f,i.baseState=T,i.baseQueue=F,s.lastRenderedState=f}if(t=s.interleaved,t!==null){y=t;do v=y.lane,pr.lanes|=v,cu|=v,y=y.next;while(y!==t)}else y===null&&(s.lanes=0);return[i.memoizedState,s.dispatch]}function Em(t){var i=oa(),s=i.queue;if(s===null)throw Error(Ye(311));s.lastRenderedReducer=t;var f=s.dispatch,y=s.pending,v=i.memoizedState;if(y!==null){s.pending=null;var T=y=y.next;do v=t(v,T.action),T=T.next;while(T!==y);Ea(v,i.memoizedState)||(co=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),s.lastRenderedState=v}return[v,f]}function w1(){}function S1(t,i){var s=pr,f=oa(),y=i(),v=!Ea(f.memoizedState,y);if(v&&(f.memoizedState=y,co=!0),f=f.queue,Ty(k1.bind(null,s,f,t),[t]),f.getSnapshot!==i||v||li!==null&&li.memoizedState.tag&1){if(s.flags|=2048,Rh(9,T1.bind(null,s,f,y,i),void 0,null),ui===null)throw Error(Ye(349));(uu&30)!==0||E1(s,i,y)}return y}function E1(t,i,s){t.flags|=16384,t={getSnapshot:i,value:s},i=pr.updateQueue,i===null?(i={lastEffect:null,stores:null},pr.updateQueue=i,i.stores=[t]):(s=i.stores,s===null?i.stores=[t]:s.push(t))}function T1(t,i,s,f){i.value=s,i.getSnapshot=f,C1(i)&&I1(t)}function k1(t,i,s){return s(function(){C1(i)&&I1(t)})}function C1(t){var i=t.getSnapshot;t=t.value;try{var s=i();return!Ea(t,s)}catch{return!0}}function I1(t){var i=Ts(t,1);i!==null&&Sa(i,t,1,-1)}function l0(t){var i=Za();return typeof t=="function"&&(t=t()),i.memoizedState=i.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dh,lastRenderedState:t},i.queue=t,t=t.dispatch=AE.bind(null,pr,t),[i.memoizedState,t]}function Rh(t,i,s,f){return t={tag:t,create:i,destroy:s,deps:f,next:null},i=pr.updateQueue,i===null?(i={lastEffect:null,stores:null},pr.updateQueue=i,i.lastEffect=t.next=t):(s=i.lastEffect,s===null?i.lastEffect=t.next=t:(f=s.next,s.next=t,t.next=f,i.lastEffect=t)),t}function P1(){return oa().memoizedState}function cp(t,i,s,f){var y=Za();pr.flags|=t,y.memoizedState=Rh(1|i,s,void 0,f===void 0?null:f)}function ef(t,i,s,f){var y=oa();f=f===void 0?null:f;var v=void 0;if(Wr!==null){var T=Wr.memoizedState;if(v=T.destroy,f!==null&&wy(f,T.deps)){y.memoizedState=Rh(i,s,v,f);return}}pr.flags|=t,y.memoizedState=Rh(1|i,s,v,f)}function u0(t,i){return cp(8390656,8,t,i)}function Ty(t,i){return ef(2048,8,t,i)}function A1(t,i){return ef(4,2,t,i)}function M1(t,i){return ef(4,4,t,i)}function z1(t,i){if(typeof i=="function")return t=t(),i(t),function(){i(null)};if(i!=null)return t=t(),i.current=t,function(){i.current=null}}function L1(t,i,s){return s=s!=null?s.concat([t]):null,ef(4,4,z1.bind(null,i,t),s)}function ky(){}function D1(t,i){var s=oa();i=i===void 0?null:i;var f=s.memoizedState;return f!==null&&i!==null&&wy(i,f[1])?f[0]:(s.memoizedState=[t,i],t)}function R1(t,i){var s=oa();i=i===void 0?null:i;var f=s.memoizedState;return f!==null&&i!==null&&wy(i,f[1])?f[0]:(t=t(),s.memoizedState=[t,i],t)}function F1(t,i,s){return(uu&21)===0?(t.baseState&&(t.baseState=!1,co=!0),t.memoizedState=s):(Ea(s,i)||(s=Nx(),pr.lanes|=s,cu|=s,t.baseState=!0),i)}function IE(t,i){var s=On;On=s!==0&&4>s?s:4,t(!0);var f=wm.transition;wm.transition={};try{t(!1),i()}finally{On=s,wm.transition=f}}function O1(){return oa().memoizedState}function PE(t,i,s){var f=fl(t);if(s={lane:f,action:s,hasEagerState:!1,eagerState:null,next:null},B1(t))N1(i,s);else if(s=m1(t,i,s,f),s!==null){var y=Hi();Sa(s,t,f,y),U1(s,i,f)}}function AE(t,i,s){var f=fl(t),y={lane:f,action:s,hasEagerState:!1,eagerState:null,next:null};if(B1(t))N1(i,y);else{var v=t.alternate;if(t.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var T=i.lastRenderedState,u=v(T,s);if(y.hasEagerState=!0,y.eagerState=u,Ea(u,T)){var F=i.interleaved;F===null?(y.next=y,yy(i)):(y.next=F.next,F.next=y),i.interleaved=y;return}}catch{}finally{}s=m1(t,i,y,f),s!==null&&(y=Hi(),Sa(s,t,f,y),U1(s,i,f))}}function B1(t){var i=t.alternate;return t===pr||i!==null&&i===pr}function N1(t,i){dh=Rp=!0;var s=t.pending;s===null?i.next=i:(i.next=s.next,s.next=i),t.pending=i}function U1(t,i,s){if((s&4194240)!==0){var f=i.lanes;f&=t.pendingLanes,s|=f,i.lanes=s,ry(t,s)}}var Fp={readContext:ia,useCallback:Di,useContext:Di,useEffect:Di,useImperativeHandle:Di,useInsertionEffect:Di,useLayoutEffect:Di,useMemo:Di,useReducer:Di,useRef:Di,useState:Di,useDebugValue:Di,useDeferredValue:Di,useTransition:Di,useMutableSource:Di,useSyncExternalStore:Di,useId:Di,unstable_isNewReconciler:!1},ME={readContext:ia,useCallback:function(t,i){return Za().memoizedState=[t,i===void 0?null:i],t},useContext:ia,useEffect:u0,useImperativeHandle:function(t,i,s){return s=s!=null?s.concat([t]):null,cp(4194308,4,z1.bind(null,i,t),s)},useLayoutEffect:function(t,i){return cp(4194308,4,t,i)},useInsertionEffect:function(t,i){return cp(4,2,t,i)},useMemo:function(t,i){var s=Za();return i=i===void 0?null:i,t=t(),s.memoizedState=[t,i],t},useReducer:function(t,i,s){var f=Za();return i=s!==void 0?s(i):i,f.memoizedState=f.baseState=i,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:i},f.queue=t,t=t.dispatch=PE.bind(null,pr,t),[f.memoizedState,t]},useRef:function(t){var i=Za();return t={current:t},i.memoizedState=t},useState:l0,useDebugValue:ky,useDeferredValue:function(t){return Za().memoizedState=t},useTransition:function(){var t=l0(!1),i=t[0];return t=IE.bind(null,t[1]),Za().memoizedState=t,[i,t]},useMutableSource:function(){},useSyncExternalStore:function(t,i,s){var f=pr,y=Za();if(lr){if(s===void 0)throw Error(Ye(407));s=s()}else{if(s=i(),ui===null)throw Error(Ye(349));(uu&30)!==0||E1(f,i,s)}y.memoizedState=s;var v={value:s,getSnapshot:i};return y.queue=v,u0(k1.bind(null,f,v,t),[t]),f.flags|=2048,Rh(9,T1.bind(null,f,v,s,i),void 0,null),s},useId:function(){var t=Za(),i=ui.identifierPrefix;if(lr){var s=bs,f=xs;s=(f&~(1<<32-wa(f)-1)).toString(32)+s,i=":"+i+"R"+s,s=Lh++,0<s&&(i+="H"+s.toString(32)),i+=":"}else s=CE++,i=":"+i+"r"+s.toString(32)+":";return t.memoizedState=i},unstable_isNewReconciler:!1},zE={readContext:ia,useCallback:D1,useContext:ia,useEffect:Ty,useImperativeHandle:L1,useInsertionEffect:A1,useLayoutEffect:M1,useMemo:R1,useReducer:Sm,useRef:P1,useState:function(){return Sm(Dh)},useDebugValue:ky,useDeferredValue:function(t){var i=oa();return F1(i,Wr.memoizedState,t)},useTransition:function(){var t=Sm(Dh)[0],i=oa().memoizedState;return[t,i]},useMutableSource:w1,useSyncExternalStore:S1,useId:O1,unstable_isNewReconciler:!1},LE={readContext:ia,useCallback:D1,useContext:ia,useEffect:Ty,useImperativeHandle:L1,useInsertionEffect:A1,useLayoutEffect:M1,useMemo:R1,useReducer:Em,useRef:P1,useState:function(){return Em(Dh)},useDebugValue:ky,useDeferredValue:function(t){var i=oa();return Wr===null?i.memoizedState=t:F1(i,Wr.memoizedState,t)},useTransition:function(){var t=Em(Dh)[0],i=oa().memoizedState;return[t,i]},useMutableSource:w1,useSyncExternalStore:S1,useId:O1,unstable_isNewReconciler:!1};function hc(t,i){try{var s="",f=i;do s+=sS(f),f=f.return;while(f);var y=s}catch(v){y=`
Error generating stack: `+v.message+`
`+v.stack}return{value:t,source:i,stack:y,digest:null}}function Tm(t,i,s){return{value:t,source:null,stack:s!=null?s:null,digest:i!=null?i:null}}function gg(t,i){try{console.error(i.value)}catch(s){setTimeout(function(){throw s})}}var DE=typeof WeakMap=="function"?WeakMap:Map;function V1(t,i,s){s=ws(-1,s),s.tag=3,s.payload={element:null};var f=i.value;return s.callback=function(){Bp||(Bp=!0,kg=f),gg(t,i)},s}function $1(t,i,s){s=ws(-1,s),s.tag=3;var f=t.type.getDerivedStateFromError;if(typeof f=="function"){var y=i.value;s.payload=function(){return f(y)},s.callback=function(){gg(t,i)}}var v=t.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(s.callback=function(){gg(t,i),typeof f!="function"&&(pl===null?pl=new Set([this]):pl.add(this));var T=i.stack;this.componentDidCatch(i.value,{componentStack:T!==null?T:""})}),s}function c0(t,i,s){var f=t.pingCache;if(f===null){f=t.pingCache=new DE;var y=new Set;f.set(i,y)}else y=f.get(i),y===void 0&&(y=new Set,f.set(i,y));y.has(s)||(y.add(s),t=HE.bind(null,t,i,s),i.then(t,t))}function h0(t){do{var i;if((i=t.tag===13)&&(i=t.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return t;t=t.return}while(t!==null);return null}function d0(t,i,s,f,y){return(t.mode&1)===0?(t===i?t.flags|=65536:(t.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(i=ws(-1,1),i.tag=2,dl(s,i,1))),s.lanes|=1),t):(t.flags|=65536,t.lanes=y,t)}var RE=As.ReactCurrentOwner,co=!1;function Wi(t,i,s,f){i.child=t===null?x1(i,null,s,f):uc(i,t.child,s,f)}function p0(t,i,s,f,y){s=s.render;var v=i.ref;return rc(i,y),f=Sy(t,i,s,f,v,y),s=Ey(),t!==null&&!co?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~y,ks(t,i,y)):(lr&&s&&hy(i),i.flags|=1,Wi(t,i,f,y),i.child)}function f0(t,i,s,f,y){if(t===null){var v=s.type;return typeof v=="function"&&!Dy(v)&&v.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(i.tag=15,i.type=v,j1(t,i,v,f,y)):(t=fp(s.type,null,f,i,i.mode,y),t.ref=i.ref,t.return=i,i.child=t)}if(v=t.child,(t.lanes&y)===0){var T=v.memoizedProps;if(s=s.compare,s=s!==null?s:Ch,s(T,f)&&t.ref===i.ref)return ks(t,i,y)}return i.flags|=1,t=ml(v,f),t.ref=i.ref,t.return=i,i.child=t}function j1(t,i,s,f,y){if(t!==null){var v=t.memoizedProps;if(Ch(v,f)&&t.ref===i.ref)if(co=!1,i.pendingProps=f=v,(t.lanes&y)!==0)(t.flags&131072)!==0&&(co=!0);else return i.lanes=t.lanes,ks(t,i,y)}return yg(t,i,s,f,y)}function G1(t,i,s){var f=i.pendingProps,y=f.children,v=t!==null?t.memoizedState:null;if(f.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xn(Xu,zo),zo|=s;else{if((s&1073741824)===0)return t=v!==null?v.baseLanes|s:s,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:t,cachePool:null,transitions:null},i.updateQueue=null,Xn(Xu,zo),zo|=t,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=v!==null?v.baseLanes:s,Xn(Xu,zo),zo|=f}else v!==null?(f=v.baseLanes|s,i.memoizedState=null):f=s,Xn(Xu,zo),zo|=f;return Wi(t,i,y,s),i.child}function q1(t,i){var s=i.ref;(t===null&&s!==null||t!==null&&t.ref!==s)&&(i.flags|=512,i.flags|=2097152)}function yg(t,i,s,f,y){var v=fo(s)?su:Oi.current;return v=sc(i,v),rc(i,y),s=Sy(t,i,s,f,v,y),f=Ey(),t!==null&&!co?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~y,ks(t,i,y)):(lr&&f&&hy(i),i.flags|=1,Wi(t,i,s,y),i.child)}function m0(t,i,s,f,y){if(fo(s)){var v=!0;Ip(i)}else v=!1;if(rc(i,y),i.stateNode===null)hp(t,i),_1(i,s,f),mg(i,s,f,y),f=!0;else if(t===null){var T=i.stateNode,u=i.memoizedProps;T.props=u;var F=T.context,W=s.contextType;typeof W=="object"&&W!==null?W=ia(W):(W=fo(s)?su:Oi.current,W=sc(i,W));var ie=s.getDerivedStateFromProps,ne=typeof ie=="function"||typeof T.getSnapshotBeforeUpdate=="function";ne||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(u!==f||F!==W)&&a0(i,T,f,W),tl=!1;var G=i.memoizedState;T.state=G,Lp(i,f,T,y),F=i.memoizedState,u!==f||G!==F||po.current||tl?(typeof ie=="function"&&(fg(i,s,ie,f),F=i.memoizedState),(u=tl||o0(i,s,u,f,G,F,W))?(ne||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(i.flags|=4194308)):(typeof T.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=f,i.memoizedState=F),T.props=f,T.state=F,T.context=W,f=u):(typeof T.componentDidMount=="function"&&(i.flags|=4194308),f=!1)}else{T=i.stateNode,g1(t,i),u=i.memoizedProps,W=i.type===i.elementType?u:_a(i.type,u),T.props=W,ne=i.pendingProps,G=T.context,F=s.contextType,typeof F=="object"&&F!==null?F=ia(F):(F=fo(s)?su:Oi.current,F=sc(i,F));var we=s.getDerivedStateFromProps;(ie=typeof we=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(u!==ne||G!==F)&&a0(i,T,f,F),tl=!1,G=i.memoizedState,T.state=G,Lp(i,f,T,y);var Me=i.memoizedState;u!==ne||G!==Me||po.current||tl?(typeof we=="function"&&(fg(i,s,we,f),Me=i.memoizedState),(W=tl||o0(i,s,W,f,G,Me,F)||!1)?(ie||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(f,Me,F),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(f,Me,F)),typeof T.componentDidUpdate=="function"&&(i.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof T.componentDidUpdate!="function"||u===t.memoizedProps&&G===t.memoizedState||(i.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&G===t.memoizedState||(i.flags|=1024),i.memoizedProps=f,i.memoizedState=Me),T.props=f,T.state=Me,T.context=F,f=W):(typeof T.componentDidUpdate!="function"||u===t.memoizedProps&&G===t.memoizedState||(i.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&G===t.memoizedState||(i.flags|=1024),f=!1)}return _g(t,i,s,f,v,y)}function _g(t,i,s,f,y,v){q1(t,i);var T=(i.flags&128)!==0;if(!f&&!T)return y&&e0(i,s,!1),ks(t,i,v);f=i.stateNode,RE.current=i;var u=T&&typeof s.getDerivedStateFromError!="function"?null:f.render();return i.flags|=1,t!==null&&T?(i.child=uc(i,t.child,null,v),i.child=uc(i,null,u,v)):Wi(t,i,u,v),i.memoizedState=f.state,y&&e0(i,s,!0),i.child}function Z1(t){var i=t.stateNode;i.pendingContext?Qv(t,i.pendingContext,i.pendingContext!==i.context):i.context&&Qv(t,i.context,!1),vy(t,i.containerInfo)}function g0(t,i,s,f,y){return lc(),py(y),i.flags|=256,Wi(t,i,s,f),i.child}var vg={dehydrated:null,treeContext:null,retryLane:0};function xg(t){return{baseLanes:t,cachePool:null,transitions:null}}function W1(t,i,s){var f=i.pendingProps,y=dr.current,v=!1,T=(i.flags&128)!==0,u;if((u=T)||(u=t!==null&&t.memoizedState===null?!1:(y&2)!==0),u?(v=!0,i.flags&=-129):(t===null||t.memoizedState!==null)&&(y|=1),Xn(dr,y&1),t===null)return dg(i),t=i.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((i.mode&1)===0?i.lanes=1:t.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(T=f.children,t=f.fallback,v?(f=i.mode,v=i.child,T={mode:"hidden",children:T},(f&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=T):v=rf(T,f,0,null),t=ou(t,f,s,null),v.return=i,t.return=i,v.sibling=t,i.child=v,i.child.memoizedState=xg(s),i.memoizedState=vg,t):Cy(i,T));if(y=t.memoizedState,y!==null&&(u=y.dehydrated,u!==null))return FE(t,i,T,f,u,y,s);if(v){v=f.fallback,T=i.mode,y=t.child,u=y.sibling;var F={mode:"hidden",children:f.children};return(T&1)===0&&i.child!==y?(f=i.child,f.childLanes=0,f.pendingProps=F,i.deletions=null):(f=ml(y,F),f.subtreeFlags=y.subtreeFlags&14680064),u!==null?v=ml(u,v):(v=ou(v,T,s,null),v.flags|=2),v.return=i,f.return=i,f.sibling=v,i.child=f,f=v,v=i.child,T=t.child.memoizedState,T=T===null?xg(s):{baseLanes:T.baseLanes|s,cachePool:null,transitions:T.transitions},v.memoizedState=T,v.childLanes=t.childLanes&~s,i.memoizedState=vg,f}return v=t.child,t=v.sibling,f=ml(v,{mode:"visible",children:f.children}),(i.mode&1)===0&&(f.lanes=s),f.return=i,f.sibling=null,t!==null&&(s=i.deletions,s===null?(i.deletions=[t],i.flags|=16):s.push(t)),i.child=f,i.memoizedState=null,f}function Cy(t,i){return i=rf({mode:"visible",children:i},t.mode,0,null),i.return=t,t.child=i}function Vd(t,i,s,f){return f!==null&&py(f),uc(i,t.child,null,s),t=Cy(i,i.pendingProps.children),t.flags|=2,i.memoizedState=null,t}function FE(t,i,s,f,y,v,T){if(s)return i.flags&256?(i.flags&=-257,f=Tm(Error(Ye(422))),Vd(t,i,T,f)):i.memoizedState!==null?(i.child=t.child,i.flags|=128,null):(v=f.fallback,y=i.mode,f=rf({mode:"visible",children:f.children},y,0,null),v=ou(v,y,T,null),v.flags|=2,f.return=i,v.return=i,f.sibling=v,i.child=f,(i.mode&1)!==0&&uc(i,t.child,null,T),i.child.memoizedState=xg(T),i.memoizedState=vg,v);if((i.mode&1)===0)return Vd(t,i,T,null);if(y.data==="$!"){if(f=y.nextSibling&&y.nextSibling.dataset,f)var u=f.dgst;return f=u,v=Error(Ye(419)),f=Tm(v,f,void 0),Vd(t,i,T,f)}if(u=(T&t.childLanes)!==0,co||u){if(f=ui,f!==null){switch(T&-T){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(f.suspendedLanes|T))!==0?0:y,y!==0&&y!==v.retryLane&&(v.retryLane=y,Ts(t,y),Sa(f,t,y,-1))}return Ly(),f=Tm(Error(Ye(421))),Vd(t,i,T,f)}return y.data==="$?"?(i.flags|=128,i.child=t.child,i=XE.bind(null,t),y._reactRetry=i,null):(t=v.treeContext,Lo=hl(y.nextSibling),Do=i,lr=!0,xa=null,t!==null&&(ea[ta++]=xs,ea[ta++]=bs,ea[ta++]=lu,xs=t.id,bs=t.overflow,lu=i),i=Cy(i,f.children),i.flags|=4096,i)}function y0(t,i,s){t.lanes|=i;var f=t.alternate;f!==null&&(f.lanes|=i),pg(t.return,i,s)}function km(t,i,s,f,y){var v=t.memoizedState;v===null?t.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:f,tail:s,tailMode:y}:(v.isBackwards=i,v.rendering=null,v.renderingStartTime=0,v.last=f,v.tail=s,v.tailMode=y)}function H1(t,i,s){var f=i.pendingProps,y=f.revealOrder,v=f.tail;if(Wi(t,i,f.children,s),f=dr.current,(f&2)!==0)f=f&1|2,i.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=i.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&y0(t,s,i);else if(t.tag===19)y0(t,s,i);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break e;for(;t.sibling===null;){if(t.return===null||t.return===i)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}f&=1}if(Xn(dr,f),(i.mode&1)===0)i.memoizedState=null;else switch(y){case"forwards":for(s=i.child,y=null;s!==null;)t=s.alternate,t!==null&&Dp(t)===null&&(y=s),s=s.sibling;s=y,s===null?(y=i.child,i.child=null):(y=s.sibling,s.sibling=null),km(i,!1,y,s,v);break;case"backwards":for(s=null,y=i.child,i.child=null;y!==null;){if(t=y.alternate,t!==null&&Dp(t)===null){i.child=y;break}t=y.sibling,y.sibling=s,s=y,y=t}km(i,!0,s,null,v);break;case"together":km(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function hp(t,i){(i.mode&1)===0&&t!==null&&(t.alternate=null,i.alternate=null,i.flags|=2)}function ks(t,i,s){if(t!==null&&(i.dependencies=t.dependencies),cu|=i.lanes,(s&i.childLanes)===0)return null;if(t!==null&&i.child!==t.child)throw Error(Ye(153));if(i.child!==null){for(t=i.child,s=ml(t,t.pendingProps),i.child=s,s.return=i;t.sibling!==null;)t=t.sibling,s=s.sibling=ml(t,t.pendingProps),s.return=i;s.sibling=null}return i.child}function OE(t,i,s){switch(i.tag){case 3:Z1(i),lc();break;case 5:b1(i);break;case 1:fo(i.type)&&Ip(i);break;case 4:vy(i,i.stateNode.containerInfo);break;case 10:var f=i.type._context,y=i.memoizedProps.value;Xn(Mp,f._currentValue),f._currentValue=y;break;case 13:if(f=i.memoizedState,f!==null)return f.dehydrated!==null?(Xn(dr,dr.current&1),i.flags|=128,null):(s&i.child.childLanes)!==0?W1(t,i,s):(Xn(dr,dr.current&1),t=ks(t,i,s),t!==null?t.sibling:null);Xn(dr,dr.current&1);break;case 19:if(f=(s&i.childLanes)!==0,(t.flags&128)!==0){if(f)return H1(t,i,s);i.flags|=128}if(y=i.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),Xn(dr,dr.current),f)break;return null;case 22:case 23:return i.lanes=0,G1(t,i,s)}return ks(t,i,s)}var X1,bg,Y1,K1;X1=function(t,i){for(var s=i.child;s!==null;){if(s.tag===5||s.tag===6)t.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};bg=function(){};Y1=function(t,i,s,f){var y=t.memoizedProps;if(y!==f){t=i.stateNode,tu(Ya.current);var v=null;switch(s){case"input":y=jm(t,y),f=jm(t,f),v=[];break;case"select":y=fr({},y,{value:void 0}),f=fr({},f,{value:void 0}),v=[];break;case"textarea":y=Zm(t,y),f=Zm(t,f),v=[];break;default:typeof y.onClick!="function"&&typeof f.onClick=="function"&&(t.onclick=kp)}Hm(s,f);var T;s=null;for(W in y)if(!f.hasOwnProperty(W)&&y.hasOwnProperty(W)&&y[W]!=null)if(W==="style"){var u=y[W];for(T in u)u.hasOwnProperty(T)&&(s||(s={}),s[T]="")}else W!=="dangerouslySetInnerHTML"&&W!=="children"&&W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&W!=="autoFocus"&&(xh.hasOwnProperty(W)?v||(v=[]):(v=v||[]).push(W,null));for(W in f){var F=f[W];if(u=y!=null?y[W]:void 0,f.hasOwnProperty(W)&&F!==u&&(F!=null||u!=null))if(W==="style")if(u){for(T in u)!u.hasOwnProperty(T)||F&&F.hasOwnProperty(T)||(s||(s={}),s[T]="");for(T in F)F.hasOwnProperty(T)&&u[T]!==F[T]&&(s||(s={}),s[T]=F[T])}else s||(v||(v=[]),v.push(W,s)),s=F;else W==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,u=u?u.__html:void 0,F!=null&&u!==F&&(v=v||[]).push(W,F)):W==="children"?typeof F!="string"&&typeof F!="number"||(v=v||[]).push(W,""+F):W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&(xh.hasOwnProperty(W)?(F!=null&&W==="onScroll"&&Jn("scroll",t),v||u===F||(v=[])):(v=v||[]).push(W,F))}s&&(v=v||[]).push("style",s);var W=v;(i.updateQueue=W)&&(i.flags|=4)}};K1=function(t,i,s,f){s!==f&&(i.flags|=4)};function Qc(t,i){if(!lr)switch(t.tailMode){case"hidden":i=t.tail;for(var s=null;i!==null;)i.alternate!==null&&(s=i),i=i.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var f=null;s!==null;)s.alternate!==null&&(f=s),s=s.sibling;f===null?i||t.tail===null?t.tail=null:t.tail.sibling=null:f.sibling=null}}function Ri(t){var i=t.alternate!==null&&t.alternate.child===t.child,s=0,f=0;if(i)for(var y=t.child;y!==null;)s|=y.lanes|y.childLanes,f|=y.subtreeFlags&14680064,f|=y.flags&14680064,y.return=t,y=y.sibling;else for(y=t.child;y!==null;)s|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=t,y=y.sibling;return t.subtreeFlags|=f,t.childLanes=s,i}function BE(t,i,s){var f=i.pendingProps;switch(dy(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ri(i),null;case 1:return fo(i.type)&&Cp(),Ri(i),null;case 3:return f=i.stateNode,cc(),er(po),er(Oi),by(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(t===null||t.child===null)&&(Nd(i)?i.flags|=4:t===null||t.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,xa!==null&&(Pg(xa),xa=null))),bg(t,i),Ri(i),null;case 5:xy(i);var y=tu(zh.current);if(s=i.type,t!==null&&i.stateNode!=null)Y1(t,i,s,f,y),t.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!f){if(i.stateNode===null)throw Error(Ye(166));return Ri(i),null}if(t=tu(Ya.current),Nd(i)){f=i.stateNode,s=i.type;var v=i.memoizedProps;switch(f[Wa]=i,f[Ah]=v,t=(i.mode&1)!==0,s){case"dialog":Jn("cancel",f),Jn("close",f);break;case"iframe":case"object":case"embed":Jn("load",f);break;case"video":case"audio":for(y=0;y<ih.length;y++)Jn(ih[y],f);break;case"source":Jn("error",f);break;case"img":case"image":case"link":Jn("error",f),Jn("load",f);break;case"details":Jn("toggle",f);break;case"input":kv(f,v),Jn("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!v.multiple},Jn("invalid",f);break;case"textarea":Iv(f,v),Jn("invalid",f)}Hm(s,v),y=null;for(var T in v)if(v.hasOwnProperty(T)){var u=v[T];T==="children"?typeof u=="string"?f.textContent!==u&&(v.suppressHydrationWarning!==!0&&Bd(f.textContent,u,t),y=["children",u]):typeof u=="number"&&f.textContent!==""+u&&(v.suppressHydrationWarning!==!0&&Bd(f.textContent,u,t),y=["children",""+u]):xh.hasOwnProperty(T)&&u!=null&&T==="onScroll"&&Jn("scroll",f)}switch(s){case"input":Ad(f),Cv(f,v,!0);break;case"textarea":Ad(f),Pv(f);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(f.onclick=kp)}f=y,i.updateQueue=f,f!==null&&(i.flags|=4)}else{T=y.nodeType===9?y:y.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Ex(s)),t==="http://www.w3.org/1999/xhtml"?s==="script"?(t=T.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof f.is=="string"?t=T.createElement(s,{is:f.is}):(t=T.createElement(s),s==="select"&&(T=t,f.multiple?T.multiple=!0:f.size&&(T.size=f.size))):t=T.createElementNS(t,s),t[Wa]=i,t[Ah]=f,X1(t,i,!1,!1),i.stateNode=t;e:{switch(T=Xm(s,f),s){case"dialog":Jn("cancel",t),Jn("close",t),y=f;break;case"iframe":case"object":case"embed":Jn("load",t),y=f;break;case"video":case"audio":for(y=0;y<ih.length;y++)Jn(ih[y],t);y=f;break;case"source":Jn("error",t),y=f;break;case"img":case"image":case"link":Jn("error",t),Jn("load",t),y=f;break;case"details":Jn("toggle",t),y=f;break;case"input":kv(t,f),y=jm(t,f),Jn("invalid",t);break;case"option":y=f;break;case"select":t._wrapperState={wasMultiple:!!f.multiple},y=fr({},f,{value:void 0}),Jn("invalid",t);break;case"textarea":Iv(t,f),y=Zm(t,f),Jn("invalid",t);break;default:y=f}Hm(s,y),u=y;for(v in u)if(u.hasOwnProperty(v)){var F=u[v];v==="style"?Cx(t,F):v==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,F!=null&&Tx(t,F)):v==="children"?typeof F=="string"?(s!=="textarea"||F!=="")&&bh(t,F):typeof F=="number"&&bh(t,""+F):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(xh.hasOwnProperty(v)?F!=null&&v==="onScroll"&&Jn("scroll",t):F!=null&&Kg(t,v,F,T))}switch(s){case"input":Ad(t),Cv(t,f,!1);break;case"textarea":Ad(t),Pv(t);break;case"option":f.value!=null&&t.setAttribute("value",""+gl(f.value));break;case"select":t.multiple=!!f.multiple,v=f.value,v!=null?Qu(t,!!f.multiple,v,!1):f.defaultValue!=null&&Qu(t,!!f.multiple,f.defaultValue,!0);break;default:typeof y.onClick=="function"&&(t.onclick=kp)}switch(s){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Ri(i),null;case 6:if(t&&i.stateNode!=null)K1(t,i,t.memoizedProps,f);else{if(typeof f!="string"&&i.stateNode===null)throw Error(Ye(166));if(s=tu(zh.current),tu(Ya.current),Nd(i)){if(f=i.stateNode,s=i.memoizedProps,f[Wa]=i,(v=f.nodeValue!==s)&&(t=Do,t!==null))switch(t.tag){case 3:Bd(f.nodeValue,s,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Bd(f.nodeValue,s,(t.mode&1)!==0)}v&&(i.flags|=4)}else f=(s.nodeType===9?s:s.ownerDocument).createTextNode(f),f[Wa]=i,i.stateNode=f}return Ri(i),null;case 13:if(er(dr),f=i.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(lr&&Lo!==null&&(i.mode&1)!==0&&(i.flags&128)===0)f1(),lc(),i.flags|=98560,v=!1;else if(v=Nd(i),f!==null&&f.dehydrated!==null){if(t===null){if(!v)throw Error(Ye(318));if(v=i.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(Ye(317));v[Wa]=i}else lc(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Ri(i),v=!1}else xa!==null&&(Pg(xa),xa=null),v=!0;if(!v)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=s,i):(f=f!==null,f!==(t!==null&&t.memoizedState!==null)&&f&&(i.child.flags|=8192,(i.mode&1)!==0&&(t===null||(dr.current&1)!==0?Hr===0&&(Hr=3):Ly())),i.updateQueue!==null&&(i.flags|=4),Ri(i),null);case 4:return cc(),bg(t,i),t===null&&Ih(i.stateNode.containerInfo),Ri(i),null;case 10:return gy(i.type._context),Ri(i),null;case 17:return fo(i.type)&&Cp(),Ri(i),null;case 19:if(er(dr),v=i.memoizedState,v===null)return Ri(i),null;if(f=(i.flags&128)!==0,T=v.rendering,T===null)if(f)Qc(v,!1);else{if(Hr!==0||t!==null&&(t.flags&128)!==0)for(t=i.child;t!==null;){if(T=Dp(t),T!==null){for(i.flags|=128,Qc(v,!1),f=T.updateQueue,f!==null&&(i.updateQueue=f,i.flags|=4),i.subtreeFlags=0,f=s,s=i.child;s!==null;)v=s,t=f,v.flags&=14680066,T=v.alternate,T===null?(v.childLanes=0,v.lanes=t,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=T.childLanes,v.lanes=T.lanes,v.child=T.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=T.memoizedProps,v.memoizedState=T.memoizedState,v.updateQueue=T.updateQueue,v.type=T.type,t=T.dependencies,v.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s=s.sibling;return Xn(dr,dr.current&1|2),i.child}t=t.sibling}v.tail!==null&&kr()>dc&&(i.flags|=128,f=!0,Qc(v,!1),i.lanes=4194304)}else{if(!f)if(t=Dp(T),t!==null){if(i.flags|=128,f=!0,s=t.updateQueue,s!==null&&(i.updateQueue=s,i.flags|=4),Qc(v,!0),v.tail===null&&v.tailMode==="hidden"&&!T.alternate&&!lr)return Ri(i),null}else 2*kr()-v.renderingStartTime>dc&&s!==1073741824&&(i.flags|=128,f=!0,Qc(v,!1),i.lanes=4194304);v.isBackwards?(T.sibling=i.child,i.child=T):(s=v.last,s!==null?s.sibling=T:i.child=T,v.last=T)}return v.tail!==null?(i=v.tail,v.rendering=i,v.tail=i.sibling,v.renderingStartTime=kr(),i.sibling=null,s=dr.current,Xn(dr,f?s&1|2:s&1),i):(Ri(i),null);case 22:case 23:return zy(),f=i.memoizedState!==null,t!==null&&t.memoizedState!==null!==f&&(i.flags|=8192),f&&(i.mode&1)!==0?(zo&1073741824)!==0&&(Ri(i),i.subtreeFlags&6&&(i.flags|=8192)):Ri(i),null;case 24:return null;case 25:return null}throw Error(Ye(156,i.tag))}function NE(t,i){switch(dy(i),i.tag){case 1:return fo(i.type)&&Cp(),t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 3:return cc(),er(po),er(Oi),by(),t=i.flags,(t&65536)!==0&&(t&128)===0?(i.flags=t&-65537|128,i):null;case 5:return xy(i),null;case 13:if(er(dr),t=i.memoizedState,t!==null&&t.dehydrated!==null){if(i.alternate===null)throw Error(Ye(340));lc()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 19:return er(dr),null;case 4:return cc(),null;case 10:return gy(i.type._context),null;case 22:case 23:return zy(),null;case 24:return null;default:return null}}var $d=!1,Fi=!1,UE=typeof WeakSet=="function"?WeakSet:Set,Et=null;function Hu(t,i){var s=t.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(f){vr(t,i,f)}else s.current=null}function wg(t,i,s){try{s()}catch(f){vr(t,i,f)}}var _0=!1;function VE(t,i){if(og=Sp,t=t1(),cy(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else e:{s=(s=t.ownerDocument)&&s.defaultView||window;var f=s.getSelection&&s.getSelection();if(f&&f.rangeCount!==0){s=f.anchorNode;var y=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{s.nodeType,v.nodeType}catch{s=null;break e}var T=0,u=-1,F=-1,W=0,ie=0,ne=t,G=null;t:for(;;){for(var we;ne!==s||y!==0&&ne.nodeType!==3||(u=T+y),ne!==v||f!==0&&ne.nodeType!==3||(F=T+f),ne.nodeType===3&&(T+=ne.nodeValue.length),(we=ne.firstChild)!==null;)G=ne,ne=we;for(;;){if(ne===t)break t;if(G===s&&++W===y&&(u=T),G===v&&++ie===f&&(F=T),(we=ne.nextSibling)!==null)break;ne=G,G=ne.parentNode}ne=we}s=u===-1||F===-1?null:{start:u,end:F}}else s=null}s=s||{start:0,end:0}}else s=null;for(ag={focusedElem:t,selectionRange:s},Sp=!1,Et=i;Et!==null;)if(i=Et,t=i.child,(i.subtreeFlags&1028)!==0&&t!==null)t.return=i,Et=t;else for(;Et!==null;){i=Et;try{var Me=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Me!==null){var Ce=Me.memoizedProps,Ze=Me.memoizedState,re=i.stateNode,J=re.getSnapshotBeforeUpdate(i.elementType===i.type?Ce:_a(i.type,Ce),Ze);re.__reactInternalSnapshotBeforeUpdate=J}break;case 3:var se=i.stateNode.containerInfo;se.nodeType===1?se.textContent="":se.nodeType===9&&se.documentElement&&se.removeChild(se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ye(163))}}catch(Te){vr(i,i.return,Te)}if(t=i.sibling,t!==null){t.return=i.return,Et=t;break}Et=i.return}return Me=_0,_0=!1,Me}function ph(t,i,s){var f=i.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var y=f=f.next;do{if((y.tag&t)===t){var v=y.destroy;y.destroy=void 0,v!==void 0&&wg(i,s,v)}y=y.next}while(y!==f)}}function tf(t,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&t)===t){var f=s.create;s.destroy=f()}s=s.next}while(s!==i)}}function Sg(t){var i=t.ref;if(i!==null){var s=t.stateNode;switch(t.tag){case 5:t=s;break;default:t=s}typeof i=="function"?i(t):i.current=t}}function J1(t){var i=t.alternate;i!==null&&(t.alternate=null,J1(i)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(i=t.stateNode,i!==null&&(delete i[Wa],delete i[Ah],delete i[ug],delete i[SE],delete i[EE])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Q1(t){return t.tag===5||t.tag===3||t.tag===4}function v0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Q1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Eg(t,i,s){var f=t.tag;if(f===5||f===6)t=t.stateNode,i?s.nodeType===8?s.parentNode.insertBefore(t,i):s.insertBefore(t,i):(s.nodeType===8?(i=s.parentNode,i.insertBefore(t,s)):(i=s,i.appendChild(t)),s=s._reactRootContainer,s!=null||i.onclick!==null||(i.onclick=kp));else if(f!==4&&(t=t.child,t!==null))for(Eg(t,i,s),t=t.sibling;t!==null;)Eg(t,i,s),t=t.sibling}function Tg(t,i,s){var f=t.tag;if(f===5||f===6)t=t.stateNode,i?s.insertBefore(t,i):s.appendChild(t);else if(f!==4&&(t=t.child,t!==null))for(Tg(t,i,s),t=t.sibling;t!==null;)Tg(t,i,s),t=t.sibling}var bi=null,va=!1;function Js(t,i,s){for(s=s.child;s!==null;)eb(t,i,s),s=s.sibling}function eb(t,i,s){if(Xa&&typeof Xa.onCommitFiberUnmount=="function")try{Xa.onCommitFiberUnmount(Wp,s)}catch{}switch(s.tag){case 5:Fi||Hu(s,i);case 6:var f=bi,y=va;bi=null,Js(t,i,s),bi=f,va=y,bi!==null&&(va?(t=bi,s=s.stateNode,t.nodeType===8?t.parentNode.removeChild(s):t.removeChild(s)):bi.removeChild(s.stateNode));break;case 18:bi!==null&&(va?(t=bi,s=s.stateNode,t.nodeType===8?vm(t.parentNode,s):t.nodeType===1&&vm(t,s),Th(t)):vm(bi,s.stateNode));break;case 4:f=bi,y=va,bi=s.stateNode.containerInfo,va=!0,Js(t,i,s),bi=f,va=y;break;case 0:case 11:case 14:case 15:if(!Fi&&(f=s.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){y=f=f.next;do{var v=y,T=v.destroy;v=v.tag,T!==void 0&&((v&2)!==0||(v&4)!==0)&&wg(s,i,T),y=y.next}while(y!==f)}Js(t,i,s);break;case 1:if(!Fi&&(Hu(s,i),f=s.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=s.memoizedProps,f.state=s.memoizedState,f.componentWillUnmount()}catch(u){vr(s,i,u)}Js(t,i,s);break;case 21:Js(t,i,s);break;case 22:s.mode&1?(Fi=(f=Fi)||s.memoizedState!==null,Js(t,i,s),Fi=f):Js(t,i,s);break;default:Js(t,i,s)}}function x0(t){var i=t.updateQueue;if(i!==null){t.updateQueue=null;var s=t.stateNode;s===null&&(s=t.stateNode=new UE),i.forEach(function(f){var y=YE.bind(null,t,f);s.has(f)||(s.add(f),f.then(y,y))})}}function ya(t,i){var s=i.deletions;if(s!==null)for(var f=0;f<s.length;f++){var y=s[f];try{var v=t,T=i,u=T;e:for(;u!==null;){switch(u.tag){case 5:bi=u.stateNode,va=!1;break e;case 3:bi=u.stateNode.containerInfo,va=!0;break e;case 4:bi=u.stateNode.containerInfo,va=!0;break e}u=u.return}if(bi===null)throw Error(Ye(160));eb(v,T,y),bi=null,va=!1;var F=y.alternate;F!==null&&(F.return=null),y.return=null}catch(W){vr(y,i,W)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)tb(i,t),i=i.sibling}function tb(t,i){var s=t.alternate,f=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ya(i,t),qa(t),f&4){try{ph(3,t,t.return),tf(3,t)}catch(Ce){vr(t,t.return,Ce)}try{ph(5,t,t.return)}catch(Ce){vr(t,t.return,Ce)}}break;case 1:ya(i,t),qa(t),f&512&&s!==null&&Hu(s,s.return);break;case 5:if(ya(i,t),qa(t),f&512&&s!==null&&Hu(s,s.return),t.flags&32){var y=t.stateNode;try{bh(y,"")}catch(Ce){vr(t,t.return,Ce)}}if(f&4&&(y=t.stateNode,y!=null)){var v=t.memoizedProps,T=s!==null?s.memoizedProps:v,u=t.type,F=t.updateQueue;if(t.updateQueue=null,F!==null)try{u==="input"&&v.type==="radio"&&v.name!=null&&wx(y,v),Xm(u,T);var W=Xm(u,v);for(T=0;T<F.length;T+=2){var ie=F[T],ne=F[T+1];ie==="style"?Cx(y,ne):ie==="dangerouslySetInnerHTML"?Tx(y,ne):ie==="children"?bh(y,ne):Kg(y,ie,ne,W)}switch(u){case"input":Gm(y,v);break;case"textarea":Sx(y,v);break;case"select":var G=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!v.multiple;var we=v.value;we!=null?Qu(y,!!v.multiple,we,!1):G!==!!v.multiple&&(v.defaultValue!=null?Qu(y,!!v.multiple,v.defaultValue,!0):Qu(y,!!v.multiple,v.multiple?[]:"",!1))}y[Ah]=v}catch(Ce){vr(t,t.return,Ce)}}break;case 6:if(ya(i,t),qa(t),f&4){if(t.stateNode===null)throw Error(Ye(162));y=t.stateNode,v=t.memoizedProps;try{y.nodeValue=v}catch(Ce){vr(t,t.return,Ce)}}break;case 3:if(ya(i,t),qa(t),f&4&&s!==null&&s.memoizedState.isDehydrated)try{Th(i.containerInfo)}catch(Ce){vr(t,t.return,Ce)}break;case 4:ya(i,t),qa(t);break;case 13:ya(i,t),qa(t),y=t.child,y.flags&8192&&(v=y.memoizedState!==null,y.stateNode.isHidden=v,!v||y.alternate!==null&&y.alternate.memoizedState!==null||(Ay=kr())),f&4&&x0(t);break;case 22:if(ie=s!==null&&s.memoizedState!==null,t.mode&1?(Fi=(W=Fi)||ie,ya(i,t),Fi=W):ya(i,t),qa(t),f&8192){if(W=t.memoizedState!==null,(t.stateNode.isHidden=W)&&!ie&&(t.mode&1)!==0)for(Et=t,ie=t.child;ie!==null;){for(ne=Et=ie;Et!==null;){switch(G=Et,we=G.child,G.tag){case 0:case 11:case 14:case 15:ph(4,G,G.return);break;case 1:Hu(G,G.return);var Me=G.stateNode;if(typeof Me.componentWillUnmount=="function"){f=G,s=G.return;try{i=f,Me.props=i.memoizedProps,Me.state=i.memoizedState,Me.componentWillUnmount()}catch(Ce){vr(f,s,Ce)}}break;case 5:Hu(G,G.return);break;case 22:if(G.memoizedState!==null){w0(ne);continue}}we!==null?(we.return=G,Et=we):w0(ne)}ie=ie.sibling}e:for(ie=null,ne=t;;){if(ne.tag===5){if(ie===null){ie=ne;try{y=ne.stateNode,W?(v=y.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(u=ne.stateNode,F=ne.memoizedProps.style,T=F!=null&&F.hasOwnProperty("display")?F.display:null,u.style.display=kx("display",T))}catch(Ce){vr(t,t.return,Ce)}}}else if(ne.tag===6){if(ie===null)try{ne.stateNode.nodeValue=W?"":ne.memoizedProps}catch(Ce){vr(t,t.return,Ce)}}else if((ne.tag!==22&&ne.tag!==23||ne.memoizedState===null||ne===t)&&ne.child!==null){ne.child.return=ne,ne=ne.child;continue}if(ne===t)break e;for(;ne.sibling===null;){if(ne.return===null||ne.return===t)break e;ie===ne&&(ie=null),ne=ne.return}ie===ne&&(ie=null),ne.sibling.return=ne.return,ne=ne.sibling}}break;case 19:ya(i,t),qa(t),f&4&&x0(t);break;case 21:break;default:ya(i,t),qa(t)}}function qa(t){var i=t.flags;if(i&2){try{e:{for(var s=t.return;s!==null;){if(Q1(s)){var f=s;break e}s=s.return}throw Error(Ye(160))}switch(f.tag){case 5:var y=f.stateNode;f.flags&32&&(bh(y,""),f.flags&=-33);var v=v0(t);Tg(t,v,y);break;case 3:case 4:var T=f.stateNode.containerInfo,u=v0(t);Eg(t,u,T);break;default:throw Error(Ye(161))}}catch(F){vr(t,t.return,F)}t.flags&=-3}i&4096&&(t.flags&=-4097)}function $E(t,i,s){Et=t,nb(t)}function nb(t,i,s){for(var f=(t.mode&1)!==0;Et!==null;){var y=Et,v=y.child;if(y.tag===22&&f){var T=y.memoizedState!==null||$d;if(!T){var u=y.alternate,F=u!==null&&u.memoizedState!==null||Fi;u=$d;var W=Fi;if($d=T,(Fi=F)&&!W)for(Et=y;Et!==null;)T=Et,F=T.child,T.tag===22&&T.memoizedState!==null?S0(y):F!==null?(F.return=T,Et=F):S0(y);for(;v!==null;)Et=v,nb(v),v=v.sibling;Et=y,$d=u,Fi=W}b0(t)}else(y.subtreeFlags&8772)!==0&&v!==null?(v.return=y,Et=v):b0(t)}}function b0(t){for(;Et!==null;){var i=Et;if((i.flags&8772)!==0){var s=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Fi||tf(5,i);break;case 1:var f=i.stateNode;if(i.flags&4&&!Fi)if(s===null)f.componentDidMount();else{var y=i.elementType===i.type?s.memoizedProps:_a(i.type,s.memoizedProps);f.componentDidUpdate(y,s.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var v=i.updateQueue;v!==null&&i0(i,v,f);break;case 3:var T=i.updateQueue;if(T!==null){if(s=null,i.child!==null)switch(i.child.tag){case 5:s=i.child.stateNode;break;case 1:s=i.child.stateNode}i0(i,T,s)}break;case 5:var u=i.stateNode;if(s===null&&i.flags&4){s=u;var F=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":F.autoFocus&&s.focus();break;case"img":F.src&&(s.src=F.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var W=i.alternate;if(W!==null){var ie=W.memoizedState;if(ie!==null){var ne=ie.dehydrated;ne!==null&&Th(ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ye(163))}Fi||i.flags&512&&Sg(i)}catch(G){vr(i,i.return,G)}}if(i===t){Et=null;break}if(s=i.sibling,s!==null){s.return=i.return,Et=s;break}Et=i.return}}function w0(t){for(;Et!==null;){var i=Et;if(i===t){Et=null;break}var s=i.sibling;if(s!==null){s.return=i.return,Et=s;break}Et=i.return}}function S0(t){for(;Et!==null;){var i=Et;try{switch(i.tag){case 0:case 11:case 15:var s=i.return;try{tf(4,i)}catch(F){vr(i,s,F)}break;case 1:var f=i.stateNode;if(typeof f.componentDidMount=="function"){var y=i.return;try{f.componentDidMount()}catch(F){vr(i,y,F)}}var v=i.return;try{Sg(i)}catch(F){vr(i,v,F)}break;case 5:var T=i.return;try{Sg(i)}catch(F){vr(i,T,F)}}}catch(F){vr(i,i.return,F)}if(i===t){Et=null;break}var u=i.sibling;if(u!==null){u.return=i.return,Et=u;break}Et=i.return}}var jE=Math.ceil,Op=As.ReactCurrentDispatcher,Iy=As.ReactCurrentOwner,ra=As.ReactCurrentBatchConfig,kn=0,ui=null,Br=null,wi=0,zo=0,Xu=wl(0),Hr=0,Fh=null,cu=0,nf=0,Py=0,fh=null,uo=null,Ay=0,dc=1/0,ys=null,Bp=!1,kg=null,pl=null,jd=!1,ol=null,Np=0,mh=0,Cg=null,dp=-1,pp=0;function Hi(){return(kn&6)!==0?kr():dp!==-1?dp:dp=kr()}function fl(t){return(t.mode&1)===0?1:(kn&2)!==0&&wi!==0?wi&-wi:kE.transition!==null?(pp===0&&(pp=Nx()),pp):(t=On,t!==0||(t=window.event,t=t===void 0?16:Zx(t.type)),t)}function Sa(t,i,s,f){if(50<mh)throw mh=0,Cg=null,Error(Ye(185));jh(t,s,f),((kn&2)===0||t!==ui)&&(t===ui&&((kn&2)===0&&(nf|=s),Hr===4&&rl(t,wi)),mo(t,f),s===1&&kn===0&&(i.mode&1)===0&&(dc=kr()+500,Jp&&Sl()))}function mo(t,i){var s=t.callbackNode;kS(t,i);var f=wp(t,t===ui?wi:0);if(f===0)s!==null&&zv(s),t.callbackNode=null,t.callbackPriority=0;else if(i=f&-f,t.callbackPriority!==i){if(s!=null&&zv(s),i===1)t.tag===0?TE(E0.bind(null,t)):h1(E0.bind(null,t)),bE(function(){(kn&6)===0&&Sl()}),s=null;else{switch(Ux(f)){case 1:s=ny;break;case 4:s=Ox;break;case 16:s=bp;break;case 536870912:s=Bx;break;default:s=bp}s=cb(s,rb.bind(null,t))}t.callbackPriority=i,t.callbackNode=s}}function rb(t,i){if(dp=-1,pp=0,(kn&6)!==0)throw Error(Ye(327));var s=t.callbackNode;if(ic()&&t.callbackNode!==s)return null;var f=wp(t,t===ui?wi:0);if(f===0)return null;if((f&30)!==0||(f&t.expiredLanes)!==0||i)i=Up(t,f);else{i=f;var y=kn;kn|=2;var v=ob();(ui!==t||wi!==i)&&(ys=null,dc=kr()+500,iu(t,i));do try{ZE();break}catch(u){ib(t,u)}while(1);my(),Op.current=v,kn=y,Br!==null?i=0:(ui=null,wi=0,i=Hr)}if(i!==0){if(i===2&&(y=eg(t),y!==0&&(f=y,i=Ig(t,y))),i===1)throw s=Fh,iu(t,0),rl(t,f),mo(t,kr()),s;if(i===6)rl(t,f);else{if(y=t.current.alternate,(f&30)===0&&!GE(y)&&(i=Up(t,f),i===2&&(v=eg(t),v!==0&&(f=v,i=Ig(t,v))),i===1))throw s=Fh,iu(t,0),rl(t,f),mo(t,kr()),s;switch(t.finishedWork=y,t.finishedLanes=f,i){case 0:case 1:throw Error(Ye(345));case 2:Kl(t,uo,ys);break;case 3:if(rl(t,f),(f&130023424)===f&&(i=Ay+500-kr(),10<i)){if(wp(t,0)!==0)break;if(y=t.suspendedLanes,(y&f)!==f){Hi(),t.pingedLanes|=t.suspendedLanes&y;break}t.timeoutHandle=lg(Kl.bind(null,t,uo,ys),i);break}Kl(t,uo,ys);break;case 4:if(rl(t,f),(f&4194240)===f)break;for(i=t.eventTimes,y=-1;0<f;){var T=31-wa(f);v=1<<T,T=i[T],T>y&&(y=T),f&=~v}if(f=y,f=kr()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*jE(f/1960))-f,10<f){t.timeoutHandle=lg(Kl.bind(null,t,uo,ys),f);break}Kl(t,uo,ys);break;case 5:Kl(t,uo,ys);break;default:throw Error(Ye(329))}}}return mo(t,kr()),t.callbackNode===s?rb.bind(null,t):null}function Ig(t,i){var s=fh;return t.current.memoizedState.isDehydrated&&(iu(t,i).flags|=256),t=Up(t,i),t!==2&&(i=uo,uo=s,i!==null&&Pg(i)),t}function Pg(t){uo===null?uo=t:uo.push.apply(uo,t)}function GE(t){for(var i=t;;){if(i.flags&16384){var s=i.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var f=0;f<s.length;f++){var y=s[f],v=y.getSnapshot;y=y.value;try{if(!Ea(v(),y))return!1}catch{return!1}}}if(s=i.child,i.subtreeFlags&16384&&s!==null)s.return=i,i=s;else{if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function rl(t,i){for(i&=~Py,i&=~nf,t.suspendedLanes|=i,t.pingedLanes&=~i,t=t.expirationTimes;0<i;){var s=31-wa(i),f=1<<s;t[s]=-1,i&=~f}}function E0(t){if((kn&6)!==0)throw Error(Ye(327));ic();var i=wp(t,0);if((i&1)===0)return mo(t,kr()),null;var s=Up(t,i);if(t.tag!==0&&s===2){var f=eg(t);f!==0&&(i=f,s=Ig(t,f))}if(s===1)throw s=Fh,iu(t,0),rl(t,i),mo(t,kr()),s;if(s===6)throw Error(Ye(345));return t.finishedWork=t.current.alternate,t.finishedLanes=i,Kl(t,uo,ys),mo(t,kr()),null}function My(t,i){var s=kn;kn|=1;try{return t(i)}finally{kn=s,kn===0&&(dc=kr()+500,Jp&&Sl())}}function hu(t){ol!==null&&ol.tag===0&&(kn&6)===0&&ic();var i=kn;kn|=1;var s=ra.transition,f=On;try{if(ra.transition=null,On=1,t)return t()}finally{On=f,ra.transition=s,kn=i,(kn&6)===0&&Sl()}}function zy(){zo=Xu.current,er(Xu)}function iu(t,i){t.finishedWork=null,t.finishedLanes=0;var s=t.timeoutHandle;if(s!==-1&&(t.timeoutHandle=-1,xE(s)),Br!==null)for(s=Br.return;s!==null;){var f=s;switch(dy(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&Cp();break;case 3:cc(),er(po),er(Oi),by();break;case 5:xy(f);break;case 4:cc();break;case 13:er(dr);break;case 19:er(dr);break;case 10:gy(f.type._context);break;case 22:case 23:zy()}s=s.return}if(ui=t,Br=t=ml(t.current,null),wi=zo=i,Hr=0,Fh=null,Py=nf=cu=0,uo=fh=null,eu!==null){for(i=0;i<eu.length;i++)if(s=eu[i],f=s.interleaved,f!==null){s.interleaved=null;var y=f.next,v=s.pending;if(v!==null){var T=v.next;v.next=y,f.next=T}s.pending=f}eu=null}return t}function ib(t,i){do{var s=Br;try{if(my(),up.current=Fp,Rp){for(var f=pr.memoizedState;f!==null;){var y=f.queue;y!==null&&(y.pending=null),f=f.next}Rp=!1}if(uu=0,li=Wr=pr=null,dh=!1,Lh=0,Iy.current=null,s===null||s.return===null){Hr=1,Fh=i,Br=null;break}e:{var v=t,T=s.return,u=s,F=i;if(i=wi,u.flags|=32768,F!==null&&typeof F=="object"&&typeof F.then=="function"){var W=F,ie=u,ne=ie.tag;if((ie.mode&1)===0&&(ne===0||ne===11||ne===15)){var G=ie.alternate;G?(ie.updateQueue=G.updateQueue,ie.memoizedState=G.memoizedState,ie.lanes=G.lanes):(ie.updateQueue=null,ie.memoizedState=null)}var we=h0(T);if(we!==null){we.flags&=-257,d0(we,T,u,v,i),we.mode&1&&c0(v,W,i),i=we,F=W;var Me=i.updateQueue;if(Me===null){var Ce=new Set;Ce.add(F),i.updateQueue=Ce}else Me.add(F);break e}else{if((i&1)===0){c0(v,W,i),Ly();break e}F=Error(Ye(426))}}else if(lr&&u.mode&1){var Ze=h0(T);if(Ze!==null){(Ze.flags&65536)===0&&(Ze.flags|=256),d0(Ze,T,u,v,i),py(hc(F,u));break e}}v=F=hc(F,u),Hr!==4&&(Hr=2),fh===null?fh=[v]:fh.push(v),v=T;do{switch(v.tag){case 3:v.flags|=65536,i&=-i,v.lanes|=i;var re=V1(v,F,i);r0(v,re);break e;case 1:u=F;var J=v.type,se=v.stateNode;if((v.flags&128)===0&&(typeof J.getDerivedStateFromError=="function"||se!==null&&typeof se.componentDidCatch=="function"&&(pl===null||!pl.has(se)))){v.flags|=65536,i&=-i,v.lanes|=i;var Te=$1(v,u,i);r0(v,Te);break e}}v=v.return}while(v!==null)}sb(s)}catch(ze){i=ze,Br===s&&s!==null&&(Br=s=s.return);continue}break}while(1)}function ob(){var t=Op.current;return Op.current=Fp,t===null?Fp:t}function Ly(){(Hr===0||Hr===3||Hr===2)&&(Hr=4),ui===null||(cu&268435455)===0&&(nf&268435455)===0||rl(ui,wi)}function Up(t,i){var s=kn;kn|=2;var f=ob();(ui!==t||wi!==i)&&(ys=null,iu(t,i));do try{qE();break}catch(y){ib(t,y)}while(1);if(my(),kn=s,Op.current=f,Br!==null)throw Error(Ye(261));return ui=null,wi=0,Hr}function qE(){for(;Br!==null;)ab(Br)}function ZE(){for(;Br!==null&&!yS();)ab(Br)}function ab(t){var i=ub(t.alternate,t,zo);t.memoizedProps=t.pendingProps,i===null?sb(t):Br=i,Iy.current=null}function sb(t){var i=t;do{var s=i.alternate;if(t=i.return,(i.flags&32768)===0){if(s=BE(s,i,zo),s!==null){Br=s;return}}else{if(s=NE(s,i),s!==null){s.flags&=32767,Br=s;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Hr=6,Br=null;return}}if(i=i.sibling,i!==null){Br=i;return}Br=i=t}while(i!==null);Hr===0&&(Hr=5)}function Kl(t,i,s){var f=On,y=ra.transition;try{ra.transition=null,On=1,WE(t,i,s,f)}finally{ra.transition=y,On=f}return null}function WE(t,i,s,f){do ic();while(ol!==null);if((kn&6)!==0)throw Error(Ye(327));s=t.finishedWork;var y=t.finishedLanes;if(s===null)return null;if(t.finishedWork=null,t.finishedLanes=0,s===t.current)throw Error(Ye(177));t.callbackNode=null,t.callbackPriority=0;var v=s.lanes|s.childLanes;if(CS(t,v),t===ui&&(Br=ui=null,wi=0),(s.subtreeFlags&2064)===0&&(s.flags&2064)===0||jd||(jd=!0,cb(bp,function(){return ic(),null})),v=(s.flags&15990)!==0,(s.subtreeFlags&15990)!==0||v){v=ra.transition,ra.transition=null;var T=On;On=1;var u=kn;kn|=4,Iy.current=null,VE(t,s),tb(s,t),pE(ag),Sp=!!og,ag=og=null,t.current=s,$E(s),_S(),kn=u,On=T,ra.transition=v}else t.current=s;if(jd&&(jd=!1,ol=t,Np=y),v=t.pendingLanes,v===0&&(pl=null),bS(s.stateNode),mo(t,kr()),i!==null)for(f=t.onRecoverableError,s=0;s<i.length;s++)y=i[s],f(y.value,{componentStack:y.stack,digest:y.digest});if(Bp)throw Bp=!1,t=kg,kg=null,t;return(Np&1)!==0&&t.tag!==0&&ic(),v=t.pendingLanes,(v&1)!==0?t===Cg?mh++:(mh=0,Cg=t):mh=0,Sl(),null}function ic(){if(ol!==null){var t=Ux(Np),i=ra.transition,s=On;try{if(ra.transition=null,On=16>t?16:t,ol===null)var f=!1;else{if(t=ol,ol=null,Np=0,(kn&6)!==0)throw Error(Ye(331));var y=kn;for(kn|=4,Et=t.current;Et!==null;){var v=Et,T=v.child;if((Et.flags&16)!==0){var u=v.deletions;if(u!==null){for(var F=0;F<u.length;F++){var W=u[F];for(Et=W;Et!==null;){var ie=Et;switch(ie.tag){case 0:case 11:case 15:ph(8,ie,v)}var ne=ie.child;if(ne!==null)ne.return=ie,Et=ne;else for(;Et!==null;){ie=Et;var G=ie.sibling,we=ie.return;if(J1(ie),ie===W){Et=null;break}if(G!==null){G.return=we,Et=G;break}Et=we}}}var Me=v.alternate;if(Me!==null){var Ce=Me.child;if(Ce!==null){Me.child=null;do{var Ze=Ce.sibling;Ce.sibling=null,Ce=Ze}while(Ce!==null)}}Et=v}}if((v.subtreeFlags&2064)!==0&&T!==null)T.return=v,Et=T;else e:for(;Et!==null;){if(v=Et,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:ph(9,v,v.return)}var re=v.sibling;if(re!==null){re.return=v.return,Et=re;break e}Et=v.return}}var J=t.current;for(Et=J;Et!==null;){T=Et;var se=T.child;if((T.subtreeFlags&2064)!==0&&se!==null)se.return=T,Et=se;else e:for(T=J;Et!==null;){if(u=Et,(u.flags&2048)!==0)try{switch(u.tag){case 0:case 11:case 15:tf(9,u)}}catch(ze){vr(u,u.return,ze)}if(u===T){Et=null;break e}var Te=u.sibling;if(Te!==null){Te.return=u.return,Et=Te;break e}Et=u.return}}if(kn=y,Sl(),Xa&&typeof Xa.onPostCommitFiberRoot=="function")try{Xa.onPostCommitFiberRoot(Wp,t)}catch{}f=!0}return f}finally{On=s,ra.transition=i}}return!1}function T0(t,i,s){i=hc(s,i),i=V1(t,i,1),t=dl(t,i,1),i=Hi(),t!==null&&(jh(t,1,i),mo(t,i))}function vr(t,i,s){if(t.tag===3)T0(t,t,s);else for(;i!==null;){if(i.tag===3){T0(i,t,s);break}else if(i.tag===1){var f=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(pl===null||!pl.has(f))){t=hc(s,t),t=$1(i,t,1),i=dl(i,t,1),t=Hi(),i!==null&&(jh(i,1,t),mo(i,t));break}}i=i.return}}function HE(t,i,s){var f=t.pingCache;f!==null&&f.delete(i),i=Hi(),t.pingedLanes|=t.suspendedLanes&s,ui===t&&(wi&s)===s&&(Hr===4||Hr===3&&(wi&130023424)===wi&&500>kr()-Ay?iu(t,0):Py|=s),mo(t,i)}function lb(t,i){i===0&&((t.mode&1)===0?i=1:(i=Ld,Ld<<=1,(Ld&130023424)===0&&(Ld=4194304)));var s=Hi();t=Ts(t,i),t!==null&&(jh(t,i,s),mo(t,s))}function XE(t){var i=t.memoizedState,s=0;i!==null&&(s=i.retryLane),lb(t,s)}function YE(t,i){var s=0;switch(t.tag){case 13:var f=t.stateNode,y=t.memoizedState;y!==null&&(s=y.retryLane);break;case 19:f=t.stateNode;break;default:throw Error(Ye(314))}f!==null&&f.delete(i),lb(t,s)}var ub;ub=function(t,i,s){if(t!==null)if(t.memoizedProps!==i.pendingProps||po.current)co=!0;else{if((t.lanes&s)===0&&(i.flags&128)===0)return co=!1,OE(t,i,s);co=(t.flags&131072)!==0}else co=!1,lr&&(i.flags&1048576)!==0&&d1(i,Ap,i.index);switch(i.lanes=0,i.tag){case 2:var f=i.type;hp(t,i),t=i.pendingProps;var y=sc(i,Oi.current);rc(i,s),y=Sy(null,i,f,t,y,s);var v=Ey();return i.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,fo(f)?(v=!0,Ip(i)):v=!1,i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,_y(i),y.updater=Qp,i.stateNode=y,y._reactInternals=i,mg(i,f,t,s),i=_g(null,i,f,!0,v,s)):(i.tag=0,lr&&v&&hy(i),Wi(null,i,y,s),i=i.child),i;case 16:f=i.elementType;e:{switch(hp(t,i),t=i.pendingProps,y=f._init,f=y(f._payload),i.type=f,y=i.tag=JE(f),t=_a(f,t),y){case 0:i=yg(null,i,f,t,s);break e;case 1:i=m0(null,i,f,t,s);break e;case 11:i=p0(null,i,f,t,s);break e;case 14:i=f0(null,i,f,_a(f.type,t),s);break e}throw Error(Ye(306,f,""))}return i;case 0:return f=i.type,y=i.pendingProps,y=i.elementType===f?y:_a(f,y),yg(t,i,f,y,s);case 1:return f=i.type,y=i.pendingProps,y=i.elementType===f?y:_a(f,y),m0(t,i,f,y,s);case 3:e:{if(Z1(i),t===null)throw Error(Ye(387));f=i.pendingProps,v=i.memoizedState,y=v.element,g1(t,i),Lp(i,f,null,s);var T=i.memoizedState;if(f=T.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:T.cache,pendingSuspenseBoundaries:T.pendingSuspenseBoundaries,transitions:T.transitions},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){y=hc(Error(Ye(423)),i),i=g0(t,i,f,s,y);break e}else if(f!==y){y=hc(Error(Ye(424)),i),i=g0(t,i,f,s,y);break e}else for(Lo=hl(i.stateNode.containerInfo.firstChild),Do=i,lr=!0,xa=null,s=x1(i,null,f,s),i.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(lc(),f===y){i=ks(t,i,s);break e}Wi(t,i,f,s)}i=i.child}return i;case 5:return b1(i),t===null&&dg(i),f=i.type,y=i.pendingProps,v=t!==null?t.memoizedProps:null,T=y.children,sg(f,y)?T=null:v!==null&&sg(f,v)&&(i.flags|=32),q1(t,i),Wi(t,i,T,s),i.child;case 6:return t===null&&dg(i),null;case 13:return W1(t,i,s);case 4:return vy(i,i.stateNode.containerInfo),f=i.pendingProps,t===null?i.child=uc(i,null,f,s):Wi(t,i,f,s),i.child;case 11:return f=i.type,y=i.pendingProps,y=i.elementType===f?y:_a(f,y),p0(t,i,f,y,s);case 7:return Wi(t,i,i.pendingProps,s),i.child;case 8:return Wi(t,i,i.pendingProps.children,s),i.child;case 12:return Wi(t,i,i.pendingProps.children,s),i.child;case 10:e:{if(f=i.type._context,y=i.pendingProps,v=i.memoizedProps,T=y.value,Xn(Mp,f._currentValue),f._currentValue=T,v!==null)if(Ea(v.value,T)){if(v.children===y.children&&!po.current){i=ks(t,i,s);break e}}else for(v=i.child,v!==null&&(v.return=i);v!==null;){var u=v.dependencies;if(u!==null){T=v.child;for(var F=u.firstContext;F!==null;){if(F.context===f){if(v.tag===1){F=ws(-1,s&-s),F.tag=2;var W=v.updateQueue;if(W!==null){W=W.shared;var ie=W.pending;ie===null?F.next=F:(F.next=ie.next,ie.next=F),W.pending=F}}v.lanes|=s,F=v.alternate,F!==null&&(F.lanes|=s),pg(v.return,s,i),u.lanes|=s;break}F=F.next}}else if(v.tag===10)T=v.type===i.type?null:v.child;else if(v.tag===18){if(T=v.return,T===null)throw Error(Ye(341));T.lanes|=s,u=T.alternate,u!==null&&(u.lanes|=s),pg(T,s,i),T=v.sibling}else T=v.child;if(T!==null)T.return=v;else for(T=v;T!==null;){if(T===i){T=null;break}if(v=T.sibling,v!==null){v.return=T.return,T=v;break}T=T.return}v=T}Wi(t,i,y.children,s),i=i.child}return i;case 9:return y=i.type,f=i.pendingProps.children,rc(i,s),y=ia(y),f=f(y),i.flags|=1,Wi(t,i,f,s),i.child;case 14:return f=i.type,y=_a(f,i.pendingProps),y=_a(f.type,y),f0(t,i,f,y,s);case 15:return j1(t,i,i.type,i.pendingProps,s);case 17:return f=i.type,y=i.pendingProps,y=i.elementType===f?y:_a(f,y),hp(t,i),i.tag=1,fo(f)?(t=!0,Ip(i)):t=!1,rc(i,s),_1(i,f,y),mg(i,f,y,s),_g(null,i,f,!0,t,s);case 19:return H1(t,i,s);case 22:return G1(t,i,s)}throw Error(Ye(156,i.tag))};function cb(t,i){return Fx(t,i)}function KE(t,i,s,f){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function na(t,i,s,f){return new KE(t,i,s,f)}function Dy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function JE(t){if(typeof t=="function")return Dy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Qg)return 11;if(t===ey)return 14}return 2}function ml(t,i){var s=t.alternate;return s===null?(s=na(t.tag,i,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=i,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&14680064,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,i=t.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s}function fp(t,i,s,f,y,v){var T=2;if(f=t,typeof t=="function")Dy(t)&&(T=1);else if(typeof t=="string")T=5;else e:switch(t){case Nu:return ou(s.children,y,v,i);case Jg:T=8,y|=8;break;case Nm:return t=na(12,s,i,y|2),t.elementType=Nm,t.lanes=v,t;case Um:return t=na(13,s,i,y),t.elementType=Um,t.lanes=v,t;case Vm:return t=na(19,s,i,y),t.elementType=Vm,t.lanes=v,t;case vx:return rf(s,y,v,i);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case yx:T=10;break e;case _x:T=9;break e;case Qg:T=11;break e;case ey:T=14;break e;case el:T=16,f=null;break e}throw Error(Ye(130,t==null?t:typeof t,""))}return i=na(T,s,i,y),i.elementType=t,i.type=f,i.lanes=v,i}function ou(t,i,s,f){return t=na(7,t,f,i),t.lanes=s,t}function rf(t,i,s,f){return t=na(22,t,f,i),t.elementType=vx,t.lanes=s,t.stateNode={isHidden:!1},t}function Cm(t,i,s){return t=na(6,t,null,i),t.lanes=s,t}function Im(t,i,s){return i=na(4,t.children!==null?t.children:[],t.key,i),i.lanes=s,i.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},i}function QE(t,i,s,f,y){this.tag=i,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=lm(0),this.expirationTimes=lm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=lm(0),this.identifierPrefix=f,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function Ry(t,i,s,f,y,v,T,u,F){return t=new QE(t,i,s,u,F),i===1?(i=1,v===!0&&(i|=8)):i=0,v=na(3,null,null,i),t.current=v,v.stateNode=t,v.memoizedState={element:f,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},_y(v),t}function eT(t,i,s){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bu,key:f==null?null:""+f,children:t,containerInfo:i,implementation:s}}function hb(t){if(!t)return yl;t=t._reactInternals;e:{if(gu(t)!==t||t.tag!==1)throw Error(Ye(170));var i=t;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(fo(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(Ye(171))}if(t.tag===1){var s=t.type;if(fo(s))return c1(t,s,i)}return i}function db(t,i,s,f,y,v,T,u,F){return t=Ry(s,f,!0,t,y,v,T,u,F),t.context=hb(null),s=t.current,f=Hi(),y=fl(s),v=ws(f,y),v.callback=i!=null?i:null,dl(s,v,y),t.current.lanes=y,jh(t,y,f),mo(t,f),t}function of(t,i,s,f){var y=i.current,v=Hi(),T=fl(y);return s=hb(s),i.context===null?i.context=s:i.pendingContext=s,i=ws(v,T),i.payload={element:t},f=f===void 0?null:f,f!==null&&(i.callback=f),t=dl(y,i,T),t!==null&&(Sa(t,y,T,v),lp(t,y,T)),T}function Vp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function k0(t,i){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<i?s:i}}function Fy(t,i){k0(t,i),(t=t.alternate)&&k0(t,i)}function tT(){return null}var pb=typeof reportError=="function"?reportError:function(t){console.error(t)};function Oy(t){this._internalRoot=t}af.prototype.render=Oy.prototype.render=function(t){var i=this._internalRoot;if(i===null)throw Error(Ye(409));of(t,i,null,null)};af.prototype.unmount=Oy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var i=t.containerInfo;hu(function(){of(null,t,null,null)}),i[Es]=null}};function af(t){this._internalRoot=t}af.prototype.unstable_scheduleHydration=function(t){if(t){var i=jx();t={blockedOn:null,target:t,priority:i};for(var s=0;s<nl.length&&i!==0&&i<nl[s].priority;s++);nl.splice(s,0,t),s===0&&qx(t)}};function By(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function sf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function C0(){}function nT(t,i,s,f,y){if(y){if(typeof f=="function"){var v=f;f=function(){var W=Vp(T);v.call(W)}}var T=db(i,f,t,0,null,!1,!1,"",C0);return t._reactRootContainer=T,t[Es]=T.current,Ih(t.nodeType===8?t.parentNode:t),hu(),T}for(;y=t.lastChild;)t.removeChild(y);if(typeof f=="function"){var u=f;f=function(){var W=Vp(F);u.call(W)}}var F=Ry(t,0,!1,null,null,!1,!1,"",C0);return t._reactRootContainer=F,t[Es]=F.current,Ih(t.nodeType===8?t.parentNode:t),hu(function(){of(i,F,s,f)}),F}function lf(t,i,s,f,y){var v=s._reactRootContainer;if(v){var T=v;if(typeof y=="function"){var u=y;y=function(){var F=Vp(T);u.call(F)}}of(i,T,t,y)}else T=nT(s,i,t,y,f);return Vp(T)}Vx=function(t){switch(t.tag){case 3:var i=t.stateNode;if(i.current.memoizedState.isDehydrated){var s=rh(i.pendingLanes);s!==0&&(ry(i,s|1),mo(i,kr()),(kn&6)===0&&(dc=kr()+500,Sl()))}break;case 13:hu(function(){var f=Ts(t,1);if(f!==null){var y=Hi();Sa(f,t,1,y)}}),Fy(t,1)}};iy=function(t){if(t.tag===13){var i=Ts(t,134217728);if(i!==null){var s=Hi();Sa(i,t,134217728,s)}Fy(t,134217728)}};$x=function(t){if(t.tag===13){var i=fl(t),s=Ts(t,i);if(s!==null){var f=Hi();Sa(s,t,i,f)}Fy(t,i)}};jx=function(){return On};Gx=function(t,i){var s=On;try{return On=t,i()}finally{On=s}};Km=function(t,i,s){switch(i){case"input":if(Gm(t,s),i=s.name,s.type==="radio"&&i!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<s.length;i++){var f=s[i];if(f!==t&&f.form===t.form){var y=Kp(f);if(!y)throw Error(Ye(90));bx(f),Gm(f,y)}}}break;case"textarea":Sx(t,s);break;case"select":i=s.value,i!=null&&Qu(t,!!s.multiple,i,!1)}};Ax=My;Mx=hu;var rT={usingClientEntryPoint:!1,Events:[qh,ju,Kp,Ix,Px,My]},eh={findFiberByHostInstance:Ql,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},iT={bundleType:eh.bundleType,version:eh.version,rendererPackageName:eh.rendererPackageName,rendererConfig:eh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:As.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Dx(t),t===null?null:t.stateNode},findFiberByHostInstance:eh.findFiberByHostInstance||tT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gd.isDisabled&&Gd.supportsFiber)try{Wp=Gd.inject(iT),Xa=Gd}catch{}}Fo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rT;Fo.createPortal=function(t,i){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!By(i))throw Error(Ye(200));return eT(t,i,null,s)};Fo.createRoot=function(t,i){if(!By(t))throw Error(Ye(299));var s=!1,f="",y=pb;return i!=null&&(i.unstable_strictMode===!0&&(s=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onRecoverableError!==void 0&&(y=i.onRecoverableError)),i=Ry(t,1,!1,null,null,s,!1,f,y),t[Es]=i.current,Ih(t.nodeType===8?t.parentNode:t),new Oy(i)};Fo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var i=t._reactInternals;if(i===void 0)throw typeof t.render=="function"?Error(Ye(188)):(t=Object.keys(t).join(","),Error(Ye(268,t)));return t=Dx(i),t=t===null?null:t.stateNode,t};Fo.flushSync=function(t){return hu(t)};Fo.hydrate=function(t,i,s){if(!sf(i))throw Error(Ye(200));return lf(null,t,i,!0,s)};Fo.hydrateRoot=function(t,i,s){if(!By(t))throw Error(Ye(405));var f=s!=null&&s.hydratedSources||null,y=!1,v="",T=pb;if(s!=null&&(s.unstable_strictMode===!0&&(y=!0),s.identifierPrefix!==void 0&&(v=s.identifierPrefix),s.onRecoverableError!==void 0&&(T=s.onRecoverableError)),i=db(i,null,t,1,s!=null?s:null,y,!1,v,T),t[Es]=i.current,Ih(t),f)for(t=0;t<f.length;t++)s=f[t],y=s._getVersion,y=y(s._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[s,y]:i.mutableSourceEagerHydrationData.push(s,y);return new af(i)};Fo.render=function(t,i,s){if(!sf(i))throw Error(Ye(200));return lf(null,t,i,!1,s)};Fo.unmountComponentAtNode=function(t){if(!sf(t))throw Error(Ye(40));return t._reactRootContainer?(hu(function(){lf(null,null,t,!1,function(){t._reactRootContainer=null,t[Es]=null})}),!0):!1};Fo.unstable_batchedUpdates=My;Fo.unstable_renderSubtreeIntoContainer=function(t,i,s,f){if(!sf(s))throw Error(Ye(200));if(t==null||t._reactInternals===void 0)throw Error(Ye(38));return lf(t,i,s,!1,f)};Fo.version="18.2.0-next-9e3b772b8-20220608";(function(t){function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(s){console.error(s)}}i(),t.exports=Fo})(dx);var I0=dx.exports;Om.createRoot=I0.createRoot,Om.hydrateRoot=I0.hydrateRoot;function P0(t,i){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);i&&(f=f.filter(function(y){return Object.getOwnPropertyDescriptor(t,y).enumerable})),s.push.apply(s,f)}return s}function St(t){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?P0(Object(s),!0).forEach(function(f){Xr(t,f,s[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):P0(Object(s)).forEach(function(f){Object.defineProperty(t,f,Object.getOwnPropertyDescriptor(s,f))})}return t}function $p(t){return $p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},$p(t)}function oT(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function A0(t,i){for(var s=0;s<i.length;s++){var f=i[s];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(t,f.key,f)}}function aT(t,i,s){return i&&A0(t.prototype,i),s&&A0(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function Xr(t,i,s){return i in t?Object.defineProperty(t,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[i]=s,t}function Ny(t,i){return lT(t)||cT(t,i)||fb(t,i)||dT()}function Wh(t){return sT(t)||uT(t)||fb(t)||hT()}function sT(t){if(Array.isArray(t))return Ag(t)}function lT(t){if(Array.isArray(t))return t}function uT(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function cT(t,i){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var f=[],y=!0,v=!1,T,u;try{for(s=s.call(t);!(y=(T=s.next()).done)&&(f.push(T.value),!(i&&f.length===i));y=!0);}catch(F){v=!0,u=F}finally{try{!y&&s.return!=null&&s.return()}finally{if(v)throw u}}return f}}function fb(t,i){if(!!t){if(typeof t=="string")return Ag(t,i);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Ag(t,i)}}function Ag(t,i){(i==null||i>t.length)&&(i=t.length);for(var s=0,f=new Array(i);s<i;s++)f[s]=t[s];return f}function hT(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dT(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M0=function(){},Uy={},mb={},gb=null,yb={mark:M0,measure:M0};try{typeof window<"u"&&(Uy=window),typeof document<"u"&&(mb=document),typeof MutationObserver<"u"&&(gb=MutationObserver),typeof performance<"u"&&(yb=performance)}catch{}var pT=Uy.navigator||{},z0=pT.userAgent,L0=z0===void 0?"":z0,_l=Uy,tr=mb,D0=gb,qd=yb;_l.document;var Ms=!!tr.documentElement&&!!tr.head&&typeof tr.addEventListener=="function"&&typeof tr.createElement=="function",_b=~L0.indexOf("MSIE")||~L0.indexOf("Trident/"),Zd,Wd,Hd,Xd,Yd,Cs="___FONT_AWESOME___",Mg=16,vb="fa",xb="svg-inline--fa",du="data-fa-i2svg",zg="data-fa-pseudo-element",fT="data-fa-pseudo-element-pending",Vy="data-prefix",$y="data-icon",R0="fontawesome-i2svg",mT="async",gT=["HTML","HEAD","STYLE","SCRIPT"],bb=function(){try{return!0}catch{return!1}}(),Qn="classic",xr="sharp",jy=[Qn,xr];function Hh(t){return new Proxy(t,{get:function(s,f){return f in s?s[f]:s[Qn]}})}var Oh=Hh((Zd={},Xr(Zd,Qn,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),Xr(Zd,xr,{fa:"solid",fass:"solid","fa-solid":"solid"}),Zd)),Bh=Hh((Wd={},Xr(Wd,Qn,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),Xr(Wd,xr,{solid:"fass"}),Wd)),Nh=Hh((Hd={},Xr(Hd,Qn,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),Xr(Hd,xr,{fass:"fa-solid"}),Hd)),yT=Hh((Xd={},Xr(Xd,Qn,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),Xr(Xd,xr,{"fa-solid":"fass"}),Xd)),_T=/fa(s|r|l|t|d|b|k|ss)?[\-\ ]/,wb="fa-layers-text",vT=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,xT=Hh((Yd={},Xr(Yd,Qn,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),Xr(Yd,xr,{900:"fass"}),Yd)),Sb=[1,2,3,4,5,6,7,8,9,10],bT=Sb.concat([11,12,13,14,15,16,17,18,19,20]),wT=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],nu={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},Uh=new Set;Object.keys(Bh[Qn]).map(Uh.add.bind(Uh));Object.keys(Bh[xr]).map(Uh.add.bind(Uh));var ST=[].concat(jy,Wh(Uh),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",nu.GROUP,nu.SWAP_OPACITY,nu.PRIMARY,nu.SECONDARY]).concat(Sb.map(function(t){return"".concat(t,"x")})).concat(bT.map(function(t){return"w-".concat(t)})),gh=_l.FontAwesomeConfig||{};function ET(t){var i=tr.querySelector("script["+t+"]");if(i)return i.getAttribute(t)}function TT(t){return t===""?!0:t==="false"?!1:t==="true"?!0:t}if(tr&&typeof tr.querySelector=="function"){var kT=[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]];kT.forEach(function(t){var i=Ny(t,2),s=i[0],f=i[1],y=TT(ET(s));y!=null&&(gh[f]=y)})}var Eb={styleDefault:"solid",familyDefault:"classic",cssPrefix:vb,replacementClass:xb,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};gh.familyPrefix&&(gh.cssPrefix=gh.familyPrefix);var pc=St(St({},Eb),gh);pc.autoReplaceSvg||(pc.observeMutations=!1);var zt={};Object.keys(Eb).forEach(function(t){Object.defineProperty(zt,t,{enumerable:!0,set:function(s){pc[t]=s,yh.forEach(function(f){return f(zt)})},get:function(){return pc[t]}})});Object.defineProperty(zt,"familyPrefix",{enumerable:!0,set:function(i){pc.cssPrefix=i,yh.forEach(function(s){return s(zt)})},get:function(){return pc.cssPrefix}});_l.FontAwesomeConfig=zt;var yh=[];function CT(t){return yh.push(t),function(){yh.splice(yh.indexOf(t),1)}}var Qs=Mg,Ha={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function IT(t){if(!(!t||!Ms)){var i=tr.createElement("style");i.setAttribute("type","text/css"),i.innerHTML=t;for(var s=tr.head.childNodes,f=null,y=s.length-1;y>-1;y--){var v=s[y],T=(v.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(T)>-1&&(f=v)}return tr.head.insertBefore(i,f),t}}var PT="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function Vh(){for(var t=12,i="";t-- >0;)i+=PT[Math.random()*62|0];return i}function yc(t){for(var i=[],s=(t||[]).length>>>0;s--;)i[s]=t[s];return i}function Gy(t){return t.classList?yc(t.classList):(t.getAttribute("class")||"").split(" ").filter(function(i){return i})}function Tb(t){return"".concat(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function AT(t){return Object.keys(t||{}).reduce(function(i,s){return i+"".concat(s,'="').concat(Tb(t[s]),'" ')},"").trim()}function uf(t){return Object.keys(t||{}).reduce(function(i,s){return i+"".concat(s,": ").concat(t[s].trim(),";")},"")}function qy(t){return t.size!==Ha.size||t.x!==Ha.x||t.y!==Ha.y||t.rotate!==Ha.rotate||t.flipX||t.flipY}function MT(t){var i=t.transform,s=t.containerWidth,f=t.iconWidth,y={transform:"translate(".concat(s/2," 256)")},v="translate(".concat(i.x*32,", ").concat(i.y*32,") "),T="scale(".concat(i.size/16*(i.flipX?-1:1),", ").concat(i.size/16*(i.flipY?-1:1),") "),u="rotate(".concat(i.rotate," 0 0)"),F={transform:"".concat(v," ").concat(T," ").concat(u)},W={transform:"translate(".concat(f/2*-1," -256)")};return{outer:y,inner:F,path:W}}function zT(t){var i=t.transform,s=t.width,f=s===void 0?Mg:s,y=t.height,v=y===void 0?Mg:y,T=t.startCentered,u=T===void 0?!1:T,F="";return u&&_b?F+="translate(".concat(i.x/Qs-f/2,"em, ").concat(i.y/Qs-v/2,"em) "):u?F+="translate(calc(-50% + ".concat(i.x/Qs,"em), calc(-50% + ").concat(i.y/Qs,"em)) "):F+="translate(".concat(i.x/Qs,"em, ").concat(i.y/Qs,"em) "),F+="scale(".concat(i.size/Qs*(i.flipX?-1:1),", ").concat(i.size/Qs*(i.flipY?-1:1),") "),F+="rotate(".concat(i.rotate,"deg) "),F}var LT=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-counter-scale, 0.25));
          transform: scale(var(--fa-counter-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom right;
          transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom left;
          transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top left;
          transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(var(--fa-li-width, 2em) * -1);
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  -webkit-animation-name: fa-beat;
          animation-name: fa-beat;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  -webkit-animation-name: fa-bounce;
          animation-name: fa-bounce;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  -webkit-animation-name: fa-fade;
          animation-name: fa-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  -webkit-animation-name: fa-beat-fade;
          animation-name: fa-beat-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  -webkit-animation-name: fa-flip;
          animation-name: fa-flip;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  -webkit-animation-name: fa-shake;
          animation-name: fa-shake;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 2s);
          animation-duration: var(--fa-animation-duration, 2s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));
          animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    -webkit-animation-delay: -1ms;
            animation-delay: -1ms;
    -webkit-animation-duration: 1ms;
            animation-duration: 1ms;
    -webkit-animation-iteration-count: 1;
            animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@-webkit-keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@-webkit-keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@-webkit-keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@-webkit-keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@-webkit-keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@-webkit-keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  -webkit-transform: rotate(90deg);
          transform: rotate(90deg);
}

.fa-rotate-180 {
  -webkit-transform: rotate(180deg);
          transform: rotate(180deg);
}

.fa-rotate-270 {
  -webkit-transform: rotate(270deg);
          transform: rotate(270deg);
}

.fa-flip-horizontal {
  -webkit-transform: scale(-1, 1);
          transform: scale(-1, 1);
}

.fa-flip-vertical {
  -webkit-transform: scale(1, -1);
          transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  -webkit-transform: scale(-1, -1);
          transform: scale(-1, -1);
}

.fa-rotate-by {
  -webkit-transform: rotate(var(--fa-rotate-angle, none));
          transform: rotate(var(--fa-rotate-angle, none));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}

.fad.fa-inverse,
.fa-duotone.fa-inverse {
  color: var(--fa-inverse, #fff);
}`;function kb(){var t=vb,i=xb,s=zt.cssPrefix,f=zt.replacementClass,y=LT;if(s!==t||f!==i){var v=new RegExp("\\.".concat(t,"\\-"),"g"),T=new RegExp("\\--".concat(t,"\\-"),"g"),u=new RegExp("\\.".concat(i),"g");y=y.replace(v,".".concat(s,"-")).replace(T,"--".concat(s,"-")).replace(u,".".concat(f))}return y}var F0=!1;function Pm(){zt.autoAddCss&&!F0&&(IT(kb()),F0=!0)}var DT={mixout:function(){return{dom:{css:kb,insertCss:Pm}}},hooks:function(){return{beforeDOMElementCreation:function(){Pm()},beforeI2svg:function(){Pm()}}}},Is=_l||{};Is[Cs]||(Is[Cs]={});Is[Cs].styles||(Is[Cs].styles={});Is[Cs].hooks||(Is[Cs].hooks={});Is[Cs].shims||(Is[Cs].shims=[]);var ba=Is[Cs],Cb=[],RT=function t(){tr.removeEventListener("DOMContentLoaded",t),jp=1,Cb.map(function(i){return i()})},jp=!1;Ms&&(jp=(tr.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(tr.readyState),jp||tr.addEventListener("DOMContentLoaded",RT));function FT(t){!Ms||(jp?setTimeout(t,0):Cb.push(t))}function Xh(t){var i=t.tag,s=t.attributes,f=s===void 0?{}:s,y=t.children,v=y===void 0?[]:y;return typeof t=="string"?Tb(t):"<".concat(i," ").concat(AT(f),">").concat(v.map(Xh).join(""),"</").concat(i,">")}function O0(t,i,s){if(t&&t[i]&&t[i][s])return{prefix:i,iconName:s,icon:t[i][s]}}var OT=function(i,s){return function(f,y,v,T){return i.call(s,f,y,v,T)}},Am=function(i,s,f,y){var v=Object.keys(i),T=v.length,u=y!==void 0?OT(s,y):s,F,W,ie;for(f===void 0?(F=1,ie=i[v[0]]):(F=0,ie=f);F<T;F++)W=v[F],ie=u(ie,i[W],W,i);return ie};function BT(t){for(var i=[],s=0,f=t.length;s<f;){var y=t.charCodeAt(s++);if(y>=55296&&y<=56319&&s<f){var v=t.charCodeAt(s++);(v&64512)==56320?i.push(((y&1023)<<10)+(v&1023)+65536):(i.push(y),s--)}else i.push(y)}return i}function Lg(t){var i=BT(t);return i.length===1?i[0].toString(16):null}function NT(t,i){var s=t.length,f=t.charCodeAt(i),y;return f>=55296&&f<=56319&&s>i+1&&(y=t.charCodeAt(i+1),y>=56320&&y<=57343)?(f-55296)*1024+y-56320+65536:f}function B0(t){return Object.keys(t).reduce(function(i,s){var f=t[s],y=!!f.icon;return y?i[f.iconName]=f.icon:i[s]=f,i},{})}function Dg(t,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},f=s.skipHooks,y=f===void 0?!1:f,v=B0(i);typeof ba.hooks.addPack=="function"&&!y?ba.hooks.addPack(t,B0(i)):ba.styles[t]=St(St({},ba.styles[t]||{}),v),t==="fas"&&Dg("fa",i)}var Kd,Jd,Qd,Yu=ba.styles,UT=ba.shims,VT=(Kd={},Xr(Kd,Qn,Object.values(Nh[Qn])),Xr(Kd,xr,Object.values(Nh[xr])),Kd),Zy=null,Ib={},Pb={},Ab={},Mb={},zb={},$T=(Jd={},Xr(Jd,Qn,Object.keys(Oh[Qn])),Xr(Jd,xr,Object.keys(Oh[xr])),Jd);function jT(t){return~ST.indexOf(t)}function GT(t,i){var s=i.split("-"),f=s[0],y=s.slice(1).join("-");return f===t&&y!==""&&!jT(y)?y:null}var Lb=function(){var i=function(v){return Am(Yu,function(T,u,F){return T[F]=Am(u,v,{}),T},{})};Ib=i(function(y,v,T){if(v[3]&&(y[v[3]]=T),v[2]){var u=v[2].filter(function(F){return typeof F=="number"});u.forEach(function(F){y[F.toString(16)]=T})}return y}),Pb=i(function(y,v,T){if(y[T]=T,v[2]){var u=v[2].filter(function(F){return typeof F=="string"});u.forEach(function(F){y[F]=T})}return y}),zb=i(function(y,v,T){var u=v[2];return y[T]=T,u.forEach(function(F){y[F]=T}),y});var s="far"in Yu||zt.autoFetchSvg,f=Am(UT,function(y,v){var T=v[0],u=v[1],F=v[2];return u==="far"&&!s&&(u="fas"),typeof T=="string"&&(y.names[T]={prefix:u,iconName:F}),typeof T=="number"&&(y.unicodes[T.toString(16)]={prefix:u,iconName:F}),y},{names:{},unicodes:{}});Ab=f.names,Mb=f.unicodes,Zy=cf(zt.styleDefault,{family:zt.familyDefault})};CT(function(t){Zy=cf(t.styleDefault,{family:zt.familyDefault})});Lb();function Wy(t,i){return(Ib[t]||{})[i]}function qT(t,i){return(Pb[t]||{})[i]}function ru(t,i){return(zb[t]||{})[i]}function Db(t){return Ab[t]||{prefix:null,iconName:null}}function ZT(t){var i=Mb[t],s=Wy("fas",t);return i||(s?{prefix:"fas",iconName:s}:null)||{prefix:null,iconName:null}}function vl(){return Zy}var Hy=function(){return{prefix:null,iconName:null,rest:[]}};function cf(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.family,f=s===void 0?Qn:s,y=Oh[f][t],v=Bh[f][t]||Bh[f][y],T=t in ba.styles?t:null;return v||T||null}var N0=(Qd={},Xr(Qd,Qn,Object.keys(Nh[Qn])),Xr(Qd,xr,Object.keys(Nh[xr])),Qd);function hf(t){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=s.skipLookups,y=f===void 0?!1:f,v=(i={},Xr(i,Qn,"".concat(zt.cssPrefix,"-").concat(Qn)),Xr(i,xr,"".concat(zt.cssPrefix,"-").concat(xr)),i),T=null,u=Qn;(t.includes(v[Qn])||t.some(function(W){return N0[Qn].includes(W)}))&&(u=Qn),(t.includes(v[xr])||t.some(function(W){return N0[xr].includes(W)}))&&(u=xr);var F=t.reduce(function(W,ie){var ne=GT(zt.cssPrefix,ie);if(Yu[ie]?(ie=VT[u].includes(ie)?yT[u][ie]:ie,T=ie,W.prefix=ie):$T[u].indexOf(ie)>-1?(T=ie,W.prefix=cf(ie,{family:u})):ne?W.iconName=ne:ie!==zt.replacementClass&&ie!==v[Qn]&&ie!==v[xr]&&W.rest.push(ie),!y&&W.prefix&&W.iconName){var G=T==="fa"?Db(W.iconName):{},we=ru(W.prefix,W.iconName);G.prefix&&(T=null),W.iconName=G.iconName||we||W.iconName,W.prefix=G.prefix||W.prefix,W.prefix==="far"&&!Yu.far&&Yu.fas&&!zt.autoFetchSvg&&(W.prefix="fas")}return W},Hy());return(t.includes("fa-brands")||t.includes("fab"))&&(F.prefix="fab"),(t.includes("fa-duotone")||t.includes("fad"))&&(F.prefix="fad"),!F.prefix&&u===xr&&(Yu.fass||zt.autoFetchSvg)&&(F.prefix="fass",F.iconName=ru(F.prefix,F.iconName)||F.iconName),(F.prefix==="fa"||T==="fa")&&(F.prefix=vl()||"fas"),F}var WT=function(){function t(){oT(this,t),this.definitions={}}return aT(t,[{key:"add",value:function(){for(var s=this,f=arguments.length,y=new Array(f),v=0;v<f;v++)y[v]=arguments[v];var T=y.reduce(this._pullDefinitions,{});Object.keys(T).forEach(function(u){s.definitions[u]=St(St({},s.definitions[u]||{}),T[u]),Dg(u,T[u]);var F=Nh[Qn][u];F&&Dg(F,T[u]),Lb()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(s,f){var y=f.prefix&&f.iconName&&f.icon?{0:f}:f;return Object.keys(y).map(function(v){var T=y[v],u=T.prefix,F=T.iconName,W=T.icon,ie=W[2];s[u]||(s[u]={}),ie.length>0&&ie.forEach(function(ne){typeof ne=="string"&&(s[u][ne]=W)}),s[u][F]=W}),s}}]),t}(),U0=[],Ku={},oc={},HT=Object.keys(oc);function XT(t,i){var s=i.mixoutsTo;return U0=t,Ku={},Object.keys(oc).forEach(function(f){HT.indexOf(f)===-1&&delete oc[f]}),U0.forEach(function(f){var y=f.mixout?f.mixout():{};if(Object.keys(y).forEach(function(T){typeof y[T]=="function"&&(s[T]=y[T]),$p(y[T])==="object"&&Object.keys(y[T]).forEach(function(u){s[T]||(s[T]={}),s[T][u]=y[T][u]})}),f.hooks){var v=f.hooks();Object.keys(v).forEach(function(T){Ku[T]||(Ku[T]=[]),Ku[T].push(v[T])})}f.provides&&f.provides(oc)}),s}function Rg(t,i){for(var s=arguments.length,f=new Array(s>2?s-2:0),y=2;y<s;y++)f[y-2]=arguments[y];var v=Ku[t]||[];return v.forEach(function(T){i=T.apply(null,[i].concat(f))}),i}function pu(t){for(var i=arguments.length,s=new Array(i>1?i-1:0),f=1;f<i;f++)s[f-1]=arguments[f];var y=Ku[t]||[];y.forEach(function(v){v.apply(null,s)})}function Ps(){var t=arguments[0],i=Array.prototype.slice.call(arguments,1);return oc[t]?oc[t].apply(null,i):void 0}function Fg(t){t.prefix==="fa"&&(t.prefix="fas");var i=t.iconName,s=t.prefix||vl();if(!!i)return i=ru(s,i)||i,O0(Rb.definitions,s,i)||O0(ba.styles,s,i)}var Rb=new WT,YT=function(){zt.autoReplaceSvg=!1,zt.observeMutations=!1,pu("noAuto")},KT={i2svg:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Ms?(pu("beforeI2svg",i),Ps("pseudoElements2svg",i),Ps("i2svg",i)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=i.autoReplaceSvgRoot;zt.autoReplaceSvg===!1&&(zt.autoReplaceSvg=!0),zt.observeMutations=!0,FT(function(){QT({autoReplaceSvgRoot:s}),pu("watch",i)})}},JT={icon:function(i){if(i===null)return null;if($p(i)==="object"&&i.prefix&&i.iconName)return{prefix:i.prefix,iconName:ru(i.prefix,i.iconName)||i.iconName};if(Array.isArray(i)&&i.length===2){var s=i[1].indexOf("fa-")===0?i[1].slice(3):i[1],f=cf(i[0]);return{prefix:f,iconName:ru(f,s)||s}}if(typeof i=="string"&&(i.indexOf("".concat(zt.cssPrefix,"-"))>-1||i.match(_T))){var y=hf(i.split(" "),{skipLookups:!0});return{prefix:y.prefix||vl(),iconName:ru(y.prefix,y.iconName)||y.iconName}}if(typeof i=="string"){var v=vl();return{prefix:v,iconName:ru(v,i)||i}}}},Bo={noAuto:YT,config:zt,dom:KT,parse:JT,library:Rb,findIconDefinition:Fg,toHtml:Xh},QT=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=i.autoReplaceSvgRoot,f=s===void 0?tr:s;(Object.keys(ba.styles).length>0||zt.autoFetchSvg)&&Ms&&zt.autoReplaceSvg&&Bo.dom.i2svg({node:f})};function df(t,i){return Object.defineProperty(t,"abstract",{get:i}),Object.defineProperty(t,"html",{get:function(){return t.abstract.map(function(f){return Xh(f)})}}),Object.defineProperty(t,"node",{get:function(){if(!!Ms){var f=tr.createElement("div");return f.innerHTML=t.html,f.children}}}),t}function ek(t){var i=t.children,s=t.main,f=t.mask,y=t.attributes,v=t.styles,T=t.transform;if(qy(T)&&s.found&&!f.found){var u=s.width,F=s.height,W={x:u/F/2,y:.5};y.style=uf(St(St({},v),{},{"transform-origin":"".concat(W.x+T.x/16,"em ").concat(W.y+T.y/16,"em")}))}return[{tag:"svg",attributes:y,children:i}]}function tk(t){var i=t.prefix,s=t.iconName,f=t.children,y=t.attributes,v=t.symbol,T=v===!0?"".concat(i,"-").concat(zt.cssPrefix,"-").concat(s):v;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:St(St({},y),{},{id:T}),children:f}]}]}function Xy(t){var i=t.icons,s=i.main,f=i.mask,y=t.prefix,v=t.iconName,T=t.transform,u=t.symbol,F=t.title,W=t.maskId,ie=t.titleId,ne=t.extra,G=t.watchable,we=G===void 0?!1:G,Me=f.found?f:s,Ce=Me.width,Ze=Me.height,re=y==="fak",J=[zt.replacementClass,v?"".concat(zt.cssPrefix,"-").concat(v):""].filter(function(Ut){return ne.classes.indexOf(Ut)===-1}).filter(function(Ut){return Ut!==""||!!Ut}).concat(ne.classes).join(" "),se={children:[],attributes:St(St({},ne.attributes),{},{"data-prefix":y,"data-icon":v,class:J,role:ne.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(Ce," ").concat(Ze)})},Te=re&&!~ne.classes.indexOf("fa-fw")?{width:"".concat(Ce/Ze*16*.0625,"em")}:{};we&&(se.attributes[du]=""),F&&(se.children.push({tag:"title",attributes:{id:se.attributes["aria-labelledby"]||"title-".concat(ie||Vh())},children:[F]}),delete se.attributes.title);var ze=St(St({},se),{},{prefix:y,iconName:v,main:s,mask:f,maskId:W,transform:T,symbol:u,styles:St(St({},Te),ne.styles)}),He=f.found&&s.found?Ps("generateAbstractMask",ze)||{children:[],attributes:{}}:Ps("generateAbstractIcon",ze)||{children:[],attributes:{}},it=He.children,Xe=He.attributes;return ze.children=it,ze.attributes=Xe,u?tk(ze):ek(ze)}function V0(t){var i=t.content,s=t.width,f=t.height,y=t.transform,v=t.title,T=t.extra,u=t.watchable,F=u===void 0?!1:u,W=St(St(St({},T.attributes),v?{title:v}:{}),{},{class:T.classes.join(" ")});F&&(W[du]="");var ie=St({},T.styles);qy(y)&&(ie.transform=zT({transform:y,startCentered:!0,width:s,height:f}),ie["-webkit-transform"]=ie.transform);var ne=uf(ie);ne.length>0&&(W.style=ne);var G=[];return G.push({tag:"span",attributes:W,children:[i]}),v&&G.push({tag:"span",attributes:{class:"sr-only"},children:[v]}),G}function nk(t){var i=t.content,s=t.title,f=t.extra,y=St(St(St({},f.attributes),s?{title:s}:{}),{},{class:f.classes.join(" ")}),v=uf(f.styles);v.length>0&&(y.style=v);var T=[];return T.push({tag:"span",attributes:y,children:[i]}),s&&T.push({tag:"span",attributes:{class:"sr-only"},children:[s]}),T}var Mm=ba.styles;function Og(t){var i=t[0],s=t[1],f=t.slice(4),y=Ny(f,1),v=y[0],T=null;return Array.isArray(v)?T={tag:"g",attributes:{class:"".concat(zt.cssPrefix,"-").concat(nu.GROUP)},children:[{tag:"path",attributes:{class:"".concat(zt.cssPrefix,"-").concat(nu.SECONDARY),fill:"currentColor",d:v[0]}},{tag:"path",attributes:{class:"".concat(zt.cssPrefix,"-").concat(nu.PRIMARY),fill:"currentColor",d:v[1]}}]}:T={tag:"path",attributes:{fill:"currentColor",d:v}},{found:!0,width:i,height:s,icon:T}}var rk={found:!1,width:512,height:512};function ik(t,i){!bb&&!zt.showMissingIcons&&t&&console.error('Icon with name "'.concat(t,'" and prefix "').concat(i,'" is missing.'))}function Bg(t,i){var s=i;return i==="fa"&&zt.styleDefault!==null&&(i=vl()),new Promise(function(f,y){if(Ps("missingIconAbstract"),s==="fa"){var v=Db(t)||{};t=v.iconName||t,i=v.prefix||i}if(t&&i&&Mm[i]&&Mm[i][t]){var T=Mm[i][t];return f(Og(T))}ik(t,i),f(St(St({},rk),{},{icon:zt.showMissingIcons&&t?Ps("missingIconAbstract")||{}:{}}))})}var $0=function(){},Ng=zt.measurePerformance&&qd&&qd.mark&&qd.measure?qd:{mark:$0,measure:$0},oh='FA "6.2.1"',ok=function(i){return Ng.mark("".concat(oh," ").concat(i," begins")),function(){return Fb(i)}},Fb=function(i){Ng.mark("".concat(oh," ").concat(i," ends")),Ng.measure("".concat(oh," ").concat(i),"".concat(oh," ").concat(i," begins"),"".concat(oh," ").concat(i," ends"))},Yy={begin:ok,end:Fb},mp=function(){};function j0(t){var i=t.getAttribute?t.getAttribute(du):null;return typeof i=="string"}function ak(t){var i=t.getAttribute?t.getAttribute(Vy):null,s=t.getAttribute?t.getAttribute($y):null;return i&&s}function sk(t){return t&&t.classList&&t.classList.contains&&t.classList.contains(zt.replacementClass)}function lk(){if(zt.autoReplaceSvg===!0)return gp.replace;var t=gp[zt.autoReplaceSvg];return t||gp.replace}function uk(t){return tr.createElementNS("http://www.w3.org/2000/svg",t)}function ck(t){return tr.createElement(t)}function Ob(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.ceFn,f=s===void 0?t.tag==="svg"?uk:ck:s;if(typeof t=="string")return tr.createTextNode(t);var y=f(t.tag);Object.keys(t.attributes||[]).forEach(function(T){y.setAttribute(T,t.attributes[T])});var v=t.children||[];return v.forEach(function(T){y.appendChild(Ob(T,{ceFn:f}))}),y}function hk(t){var i=" ".concat(t.outerHTML," ");return i="".concat(i,"Font Awesome fontawesome.com "),i}var gp={replace:function(i){var s=i[0];if(s.parentNode)if(i[1].forEach(function(y){s.parentNode.insertBefore(Ob(y),s)}),s.getAttribute(du)===null&&zt.keepOriginalSource){var f=tr.createComment(hk(s));s.parentNode.replaceChild(f,s)}else s.remove()},nest:function(i){var s=i[0],f=i[1];if(~Gy(s).indexOf(zt.replacementClass))return gp.replace(i);var y=new RegExp("".concat(zt.cssPrefix,"-.*"));if(delete f[0].attributes.id,f[0].attributes.class){var v=f[0].attributes.class.split(" ").reduce(function(u,F){return F===zt.replacementClass||F.match(y)?u.toSvg.push(F):u.toNode.push(F),u},{toNode:[],toSvg:[]});f[0].attributes.class=v.toSvg.join(" "),v.toNode.length===0?s.removeAttribute("class"):s.setAttribute("class",v.toNode.join(" "))}var T=f.map(function(u){return Xh(u)}).join(`
`);s.setAttribute(du,""),s.innerHTML=T}};function G0(t){t()}function Bb(t,i){var s=typeof i=="function"?i:mp;if(t.length===0)s();else{var f=G0;zt.mutateApproach===mT&&(f=_l.requestAnimationFrame||G0),f(function(){var y=lk(),v=Yy.begin("mutate");t.map(y),v(),s()})}}var Ky=!1;function Nb(){Ky=!0}function Ug(){Ky=!1}var Gp=null;function q0(t){if(!!D0&&!!zt.observeMutations){var i=t.treeCallback,s=i===void 0?mp:i,f=t.nodeCallback,y=f===void 0?mp:f,v=t.pseudoElementsCallback,T=v===void 0?mp:v,u=t.observeMutationsRoot,F=u===void 0?tr:u;Gp=new D0(function(W){if(!Ky){var ie=vl();yc(W).forEach(function(ne){if(ne.type==="childList"&&ne.addedNodes.length>0&&!j0(ne.addedNodes[0])&&(zt.searchPseudoElements&&T(ne.target),s(ne.target)),ne.type==="attributes"&&ne.target.parentNode&&zt.searchPseudoElements&&T(ne.target.parentNode),ne.type==="attributes"&&j0(ne.target)&&~wT.indexOf(ne.attributeName))if(ne.attributeName==="class"&&ak(ne.target)){var G=hf(Gy(ne.target)),we=G.prefix,Me=G.iconName;ne.target.setAttribute(Vy,we||ie),Me&&ne.target.setAttribute($y,Me)}else sk(ne.target)&&y(ne.target)})}}),Ms&&Gp.observe(F,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function dk(){!Gp||Gp.disconnect()}function pk(t){var i=t.getAttribute("style"),s=[];return i&&(s=i.split(";").reduce(function(f,y){var v=y.split(":"),T=v[0],u=v.slice(1);return T&&u.length>0&&(f[T]=u.join(":").trim()),f},{})),s}function fk(t){var i=t.getAttribute("data-prefix"),s=t.getAttribute("data-icon"),f=t.innerText!==void 0?t.innerText.trim():"",y=hf(Gy(t));return y.prefix||(y.prefix=vl()),i&&s&&(y.prefix=i,y.iconName=s),y.iconName&&y.prefix||(y.prefix&&f.length>0&&(y.iconName=qT(y.prefix,t.innerText)||Wy(y.prefix,Lg(t.innerText))),!y.iconName&&zt.autoFetchSvg&&t.firstChild&&t.firstChild.nodeType===Node.TEXT_NODE&&(y.iconName=t.firstChild.data)),y}function mk(t){var i=yc(t.attributes).reduce(function(y,v){return y.name!=="class"&&y.name!=="style"&&(y[v.name]=v.value),y},{}),s=t.getAttribute("title"),f=t.getAttribute("data-fa-title-id");return zt.autoA11y&&(s?i["aria-labelledby"]="".concat(zt.replacementClass,"-title-").concat(f||Vh()):(i["aria-hidden"]="true",i.focusable="false")),i}function gk(){return{iconName:null,title:null,titleId:null,prefix:null,transform:Ha,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function Z0(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0},s=fk(t),f=s.iconName,y=s.prefix,v=s.rest,T=mk(t),u=Rg("parseNodeAttributes",{},t),F=i.styleParser?pk(t):[];return St({iconName:f,title:t.getAttribute("title"),titleId:t.getAttribute("data-fa-title-id"),prefix:y,transform:Ha,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:v,styles:F,attributes:T}},u)}var yk=ba.styles;function Ub(t){var i=zt.autoReplaceSvg==="nest"?Z0(t,{styleParser:!1}):Z0(t);return~i.extra.classes.indexOf(wb)?Ps("generateLayersText",t,i):Ps("generateSvgReplacementMutation",t,i)}var xl=new Set;jy.map(function(t){xl.add("fa-".concat(t))});Object.keys(Oh[Qn]).map(xl.add.bind(xl));Object.keys(Oh[xr]).map(xl.add.bind(xl));xl=Wh(xl);function W0(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Ms)return Promise.resolve();var s=tr.documentElement.classList,f=function(ne){return s.add("".concat(R0,"-").concat(ne))},y=function(ne){return s.remove("".concat(R0,"-").concat(ne))},v=zt.autoFetchSvg?xl:jy.map(function(ie){return"fa-".concat(ie)}).concat(Object.keys(yk));v.includes("fa")||v.push("fa");var T=[".".concat(wb,":not([").concat(du,"])")].concat(v.map(function(ie){return".".concat(ie,":not([").concat(du,"])")})).join(", ");if(T.length===0)return Promise.resolve();var u=[];try{u=yc(t.querySelectorAll(T))}catch{}if(u.length>0)f("pending"),y("complete");else return Promise.resolve();var F=Yy.begin("onTree"),W=u.reduce(function(ie,ne){try{var G=Ub(ne);G&&ie.push(G)}catch(we){bb||we.name==="MissingIcon"&&console.error(we)}return ie},[]);return new Promise(function(ie,ne){Promise.all(W).then(function(G){Bb(G,function(){f("active"),f("complete"),y("pending"),typeof i=="function"&&i(),F(),ie()})}).catch(function(G){F(),ne(G)})})}function _k(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Ub(t).then(function(s){s&&Bb([s],i)})}function vk(t){return function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=(i||{}).icon?i:Fg(i||{}),y=s.mask;return y&&(y=(y||{}).icon?y:Fg(y||{})),t(f,St(St({},s),{},{mask:y}))}}var xk=function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=s.transform,y=f===void 0?Ha:f,v=s.symbol,T=v===void 0?!1:v,u=s.mask,F=u===void 0?null:u,W=s.maskId,ie=W===void 0?null:W,ne=s.title,G=ne===void 0?null:ne,we=s.titleId,Me=we===void 0?null:we,Ce=s.classes,Ze=Ce===void 0?[]:Ce,re=s.attributes,J=re===void 0?{}:re,se=s.styles,Te=se===void 0?{}:se;if(!!i){var ze=i.prefix,He=i.iconName,it=i.icon;return df(St({type:"icon"},i),function(){return pu("beforeDOMElementCreation",{iconDefinition:i,params:s}),zt.autoA11y&&(G?J["aria-labelledby"]="".concat(zt.replacementClass,"-title-").concat(Me||Vh()):(J["aria-hidden"]="true",J.focusable="false")),Xy({icons:{main:Og(it),mask:F?Og(F.icon):{found:!1,width:null,height:null,icon:{}}},prefix:ze,iconName:He,transform:St(St({},Ha),y),symbol:T,title:G,maskId:ie,titleId:Me,extra:{attributes:J,styles:Te,classes:Ze}})})}},bk={mixout:function(){return{icon:vk(xk)}},hooks:function(){return{mutationObserverCallbacks:function(s){return s.treeCallback=W0,s.nodeCallback=_k,s}}},provides:function(i){i.i2svg=function(s){var f=s.node,y=f===void 0?tr:f,v=s.callback,T=v===void 0?function(){}:v;return W0(y,T)},i.generateSvgReplacementMutation=function(s,f){var y=f.iconName,v=f.title,T=f.titleId,u=f.prefix,F=f.transform,W=f.symbol,ie=f.mask,ne=f.maskId,G=f.extra;return new Promise(function(we,Me){Promise.all([Bg(y,u),ie.iconName?Bg(ie.iconName,ie.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(Ce){var Ze=Ny(Ce,2),re=Ze[0],J=Ze[1];we([s,Xy({icons:{main:re,mask:J},prefix:u,iconName:y,transform:F,symbol:W,maskId:ne,title:v,titleId:T,extra:G,watchable:!0})])}).catch(Me)})},i.generateAbstractIcon=function(s){var f=s.children,y=s.attributes,v=s.main,T=s.transform,u=s.styles,F=uf(u);F.length>0&&(y.style=F);var W;return qy(T)&&(W=Ps("generateAbstractTransformGrouping",{main:v,transform:T,containerWidth:v.width,iconWidth:v.width})),f.push(W||v.icon),{children:f,attributes:y}}}},wk={mixout:function(){return{layer:function(s){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=f.classes,v=y===void 0?[]:y;return df({type:"layer"},function(){pu("beforeDOMElementCreation",{assembler:s,params:f});var T=[];return s(function(u){Array.isArray(u)?u.map(function(F){T=T.concat(F.abstract)}):T=T.concat(u.abstract)}),[{tag:"span",attributes:{class:["".concat(zt.cssPrefix,"-layers")].concat(Wh(v)).join(" ")},children:T}]})}}}},Sk={mixout:function(){return{counter:function(s){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=f.title,v=y===void 0?null:y,T=f.classes,u=T===void 0?[]:T,F=f.attributes,W=F===void 0?{}:F,ie=f.styles,ne=ie===void 0?{}:ie;return df({type:"counter",content:s},function(){return pu("beforeDOMElementCreation",{content:s,params:f}),nk({content:s.toString(),title:v,extra:{attributes:W,styles:ne,classes:["".concat(zt.cssPrefix,"-layers-counter")].concat(Wh(u))}})})}}}},Ek={mixout:function(){return{text:function(s){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=f.transform,v=y===void 0?Ha:y,T=f.title,u=T===void 0?null:T,F=f.classes,W=F===void 0?[]:F,ie=f.attributes,ne=ie===void 0?{}:ie,G=f.styles,we=G===void 0?{}:G;return df({type:"text",content:s},function(){return pu("beforeDOMElementCreation",{content:s,params:f}),V0({content:s,transform:St(St({},Ha),v),title:u,extra:{attributes:ne,styles:we,classes:["".concat(zt.cssPrefix,"-layers-text")].concat(Wh(W))}})})}}},provides:function(i){i.generateLayersText=function(s,f){var y=f.title,v=f.transform,T=f.extra,u=null,F=null;if(_b){var W=parseInt(getComputedStyle(s).fontSize,10),ie=s.getBoundingClientRect();u=ie.width/W,F=ie.height/W}return zt.autoA11y&&!y&&(T.attributes["aria-hidden"]="true"),Promise.resolve([s,V0({content:s.innerHTML,width:u,height:F,transform:v,title:y,extra:T,watchable:!0})])}}},Tk=new RegExp('"',"ug"),H0=[1105920,1112319];function kk(t){var i=t.replace(Tk,""),s=NT(i,0),f=s>=H0[0]&&s<=H0[1],y=i.length===2?i[0]===i[1]:!1;return{value:Lg(y?i[0]:i),isSecondary:f||y}}function X0(t,i){var s="".concat(fT).concat(i.replace(":","-"));return new Promise(function(f,y){if(t.getAttribute(s)!==null)return f();var v=yc(t.children),T=v.filter(function(it){return it.getAttribute(zg)===i})[0],u=_l.getComputedStyle(t,i),F=u.getPropertyValue("font-family").match(vT),W=u.getPropertyValue("font-weight"),ie=u.getPropertyValue("content");if(T&&!F)return t.removeChild(T),f();if(F&&ie!=="none"&&ie!==""){var ne=u.getPropertyValue("content"),G=~["Sharp"].indexOf(F[2])?xr:Qn,we=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(F[2])?Bh[G][F[2].toLowerCase()]:xT[G][W],Me=kk(ne),Ce=Me.value,Ze=Me.isSecondary,re=F[0].startsWith("FontAwesome"),J=Wy(we,Ce),se=J;if(re){var Te=ZT(Ce);Te.iconName&&Te.prefix&&(J=Te.iconName,we=Te.prefix)}if(J&&!Ze&&(!T||T.getAttribute(Vy)!==we||T.getAttribute($y)!==se)){t.setAttribute(s,se),T&&t.removeChild(T);var ze=gk(),He=ze.extra;He.attributes[zg]=i,Bg(J,we).then(function(it){var Xe=Xy(St(St({},ze),{},{icons:{main:it,mask:Hy()},prefix:we,iconName:se,extra:He,watchable:!0})),Ut=tr.createElement("svg");i==="::before"?t.insertBefore(Ut,t.firstChild):t.appendChild(Ut),Ut.outerHTML=Xe.map(function(xt){return Xh(xt)}).join(`
`),t.removeAttribute(s),f()}).catch(y)}else f()}else f()})}function Ck(t){return Promise.all([X0(t,"::before"),X0(t,"::after")])}function Ik(t){return t.parentNode!==document.head&&!~gT.indexOf(t.tagName.toUpperCase())&&!t.getAttribute(zg)&&(!t.parentNode||t.parentNode.tagName!=="svg")}function Y0(t){if(!!Ms)return new Promise(function(i,s){var f=yc(t.querySelectorAll("*")).filter(Ik).map(Ck),y=Yy.begin("searchPseudoElements");Nb(),Promise.all(f).then(function(){y(),Ug(),i()}).catch(function(){y(),Ug(),s()})})}var Pk={hooks:function(){return{mutationObserverCallbacks:function(s){return s.pseudoElementsCallback=Y0,s}}},provides:function(i){i.pseudoElements2svg=function(s){var f=s.node,y=f===void 0?tr:f;zt.searchPseudoElements&&Y0(y)}}},K0=!1,Ak={mixout:function(){return{dom:{unwatch:function(){Nb(),K0=!0}}}},hooks:function(){return{bootstrap:function(){q0(Rg("mutationObserverCallbacks",{}))},noAuto:function(){dk()},watch:function(s){var f=s.observeMutationsRoot;K0?Ug():q0(Rg("mutationObserverCallbacks",{observeMutationsRoot:f}))}}}},J0=function(i){var s={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return i.toLowerCase().split(" ").reduce(function(f,y){var v=y.toLowerCase().split("-"),T=v[0],u=v.slice(1).join("-");if(T&&u==="h")return f.flipX=!0,f;if(T&&u==="v")return f.flipY=!0,f;if(u=parseFloat(u),isNaN(u))return f;switch(T){case"grow":f.size=f.size+u;break;case"shrink":f.size=f.size-u;break;case"left":f.x=f.x-u;break;case"right":f.x=f.x+u;break;case"up":f.y=f.y-u;break;case"down":f.y=f.y+u;break;case"rotate":f.rotate=f.rotate+u;break}return f},s)},Mk={mixout:function(){return{parse:{transform:function(s){return J0(s)}}}},hooks:function(){return{parseNodeAttributes:function(s,f){var y=f.getAttribute("data-fa-transform");return y&&(s.transform=J0(y)),s}}},provides:function(i){i.generateAbstractTransformGrouping=function(s){var f=s.main,y=s.transform,v=s.containerWidth,T=s.iconWidth,u={transform:"translate(".concat(v/2," 256)")},F="translate(".concat(y.x*32,", ").concat(y.y*32,") "),W="scale(".concat(y.size/16*(y.flipX?-1:1),", ").concat(y.size/16*(y.flipY?-1:1),") "),ie="rotate(".concat(y.rotate," 0 0)"),ne={transform:"".concat(F," ").concat(W," ").concat(ie)},G={transform:"translate(".concat(T/2*-1," -256)")},we={outer:u,inner:ne,path:G};return{tag:"g",attributes:St({},we.outer),children:[{tag:"g",attributes:St({},we.inner),children:[{tag:f.icon.tag,children:f.icon.children,attributes:St(St({},f.icon.attributes),we.path)}]}]}}}},zm={x:0,y:0,width:"100%",height:"100%"};function Q0(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t.attributes&&(t.attributes.fill||i)&&(t.attributes.fill="black"),t}function zk(t){return t.tag==="g"?t.children:[t]}var Lk={hooks:function(){return{parseNodeAttributes:function(s,f){var y=f.getAttribute("data-fa-mask"),v=y?hf(y.split(" ").map(function(T){return T.trim()})):Hy();return v.prefix||(v.prefix=vl()),s.mask=v,s.maskId=f.getAttribute("data-fa-mask-id"),s}}},provides:function(i){i.generateAbstractMask=function(s){var f=s.children,y=s.attributes,v=s.main,T=s.mask,u=s.maskId,F=s.transform,W=v.width,ie=v.icon,ne=T.width,G=T.icon,we=MT({transform:F,containerWidth:ne,iconWidth:W}),Me={tag:"rect",attributes:St(St({},zm),{},{fill:"white"})},Ce=ie.children?{children:ie.children.map(Q0)}:{},Ze={tag:"g",attributes:St({},we.inner),children:[Q0(St({tag:ie.tag,attributes:St(St({},ie.attributes),we.path)},Ce))]},re={tag:"g",attributes:St({},we.outer),children:[Ze]},J="mask-".concat(u||Vh()),se="clip-".concat(u||Vh()),Te={tag:"mask",attributes:St(St({},zm),{},{id:J,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[Me,re]},ze={tag:"defs",children:[{tag:"clipPath",attributes:{id:se},children:zk(G)},Te]};return f.push(ze,{tag:"rect",attributes:St({fill:"currentColor","clip-path":"url(#".concat(se,")"),mask:"url(#".concat(J,")")},zm)}),{children:f,attributes:y}}}},Dk={provides:function(i){var s=!1;_l.matchMedia&&(s=_l.matchMedia("(prefers-reduced-motion: reduce)").matches),i.missingIconAbstract=function(){var f=[],y={fill:"currentColor"},v={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};f.push({tag:"path",attributes:St(St({},y),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var T=St(St({},v),{},{attributeName:"opacity"}),u={tag:"circle",attributes:St(St({},y),{},{cx:"256",cy:"364",r:"28"}),children:[]};return s||u.children.push({tag:"animate",attributes:St(St({},v),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:St(St({},T),{},{values:"1;0;1;1;0;1;"})}),f.push(u),f.push({tag:"path",attributes:St(St({},y),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:s?[]:[{tag:"animate",attributes:St(St({},T),{},{values:"1;0;0;0;0;1;"})}]}),s||f.push({tag:"path",attributes:St(St({},y),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:St(St({},T),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:f}}}},Rk={hooks:function(){return{parseNodeAttributes:function(s,f){var y=f.getAttribute("data-fa-symbol"),v=y===null?!1:y===""?!0:y;return s.symbol=v,s}}}},Fk=[DT,bk,wk,Sk,Ek,Pk,Ak,Mk,Lk,Dk,Rk];XT(Fk,{mixoutsTo:Bo});Bo.noAuto;Bo.config;Bo.library;Bo.dom;var Vg=Bo.parse;Bo.findIconDefinition;Bo.toHtml;var Ok=Bo.icon;Bo.layer;Bo.text;Bo.counter;var hn={exports:{}},Bk="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Nk=Bk,Uk=Nk;function Vb(){}function $b(){}$b.resetWarningCache=Vb;var Vk=function(){function t(f,y,v,T,u,F){if(F!==Uk){var W=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw W.name="Invariant Violation",W}}t.isRequired=t;function i(){return t}var s={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:i,element:t,elementType:t,instanceOf:i,node:t,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:$b,resetWarningCache:Vb};return s.PropTypes=s,s};hn.exports=Vk();function ex(t,i){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);i&&(f=f.filter(function(y){return Object.getOwnPropertyDescriptor(t,y).enumerable})),s.push.apply(s,f)}return s}function al(t){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?ex(Object(s),!0).forEach(function(f){Ju(t,f,s[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ex(Object(s)).forEach(function(f){Object.defineProperty(t,f,Object.getOwnPropertyDescriptor(s,f))})}return t}function qp(t){return qp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},qp(t)}function Ju(t,i,s){return i in t?Object.defineProperty(t,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[i]=s,t}function $k(t,i){if(t==null)return{};var s={},f=Object.keys(t),y,v;for(v=0;v<f.length;v++)y=f[v],!(i.indexOf(y)>=0)&&(s[y]=t[y]);return s}function jk(t,i){if(t==null)return{};var s=$k(t,i),f,y;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(t);for(y=0;y<v.length;y++)f=v[y],!(i.indexOf(f)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,f)||(s[f]=t[f]))}return s}function $g(t){return Gk(t)||qk(t)||Zk(t)||Wk()}function Gk(t){if(Array.isArray(t))return jg(t)}function qk(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Zk(t,i){if(!!t){if(typeof t=="string")return jg(t,i);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return jg(t,i)}}function jg(t,i){(i==null||i>t.length)&&(i=t.length);for(var s=0,f=new Array(i);s<i;s++)f[s]=t[s];return f}function Wk(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hk(t){var i,s=t.beat,f=t.fade,y=t.beatFade,v=t.bounce,T=t.shake,u=t.flash,F=t.spin,W=t.spinPulse,ie=t.spinReverse,ne=t.pulse,G=t.fixedWidth,we=t.inverse,Me=t.border,Ce=t.listItem,Ze=t.flip,re=t.size,J=t.rotation,se=t.pull,Te=(i={"fa-beat":s,"fa-fade":f,"fa-beat-fade":y,"fa-bounce":v,"fa-shake":T,"fa-flash":u,"fa-spin":F,"fa-spin-reverse":ie,"fa-spin-pulse":W,"fa-pulse":ne,"fa-fw":G,"fa-inverse":we,"fa-border":Me,"fa-li":Ce,"fa-flip":Ze===!0,"fa-flip-horizontal":Ze==="horizontal"||Ze==="both","fa-flip-vertical":Ze==="vertical"||Ze==="both"},Ju(i,"fa-".concat(re),typeof re<"u"&&re!==null),Ju(i,"fa-rotate-".concat(J),typeof J<"u"&&J!==null&&J!==0),Ju(i,"fa-pull-".concat(se),typeof se<"u"&&se!==null),Ju(i,"fa-swap-opacity",t.swapOpacity),i);return Object.keys(Te).map(function(ze){return Te[ze]?ze:null}).filter(function(ze){return ze})}function Xk(t){return t=t-0,t===t}function jb(t){return Xk(t)?t:(t=t.replace(/[\-_\s]+(.)?/g,function(i,s){return s?s.toUpperCase():""}),t.substr(0,1).toLowerCase()+t.substr(1))}var Yk=["style"];function Kk(t){return t.charAt(0).toUpperCase()+t.slice(1)}function Jk(t){return t.split(";").map(function(i){return i.trim()}).filter(function(i){return i}).reduce(function(i,s){var f=s.indexOf(":"),y=jb(s.slice(0,f)),v=s.slice(f+1).trim();return y.startsWith("webkit")?i[Kk(y)]=v:i[y]=v,i},{})}function Gb(t,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof i=="string")return i;var f=(i.children||[]).map(function(F){return Gb(t,F)}),y=Object.keys(i.attributes||{}).reduce(function(F,W){var ie=i.attributes[W];switch(W){case"class":F.attrs.className=ie,delete i.attributes.class;break;case"style":F.attrs.style=Jk(ie);break;default:W.indexOf("aria-")===0||W.indexOf("data-")===0?F.attrs[W.toLowerCase()]=ie:F.attrs[jb(W)]=ie}return F},{attrs:{}}),v=s.style,T=v===void 0?{}:v,u=jk(s,Yk);return y.attrs.style=al(al({},y.attrs.style),T),t.apply(void 0,[i.tag,al(al({},y.attrs),u)].concat($g(f)))}var qb=!1;try{qb=!0}catch{}function Qk(){if(!qb&&console&&typeof console.error=="function"){var t;(t=console).error.apply(t,arguments)}}function tx(t){if(t&&qp(t)==="object"&&t.prefix&&t.iconName&&t.icon)return t;if(Vg.icon)return Vg.icon(t);if(t===null)return null;if(t&&qp(t)==="object"&&t.prefix&&t.iconName)return t;if(Array.isArray(t)&&t.length===2)return{prefix:t[0],iconName:t[1]};if(typeof t=="string")return{prefix:"fas",iconName:t}}function Lm(t,i){return Array.isArray(i)&&i.length>0||!Array.isArray(i)&&i?Ju({},t,i):{}}var vs=au.forwardRef(function(t,i){var s=t.icon,f=t.mask,y=t.symbol,v=t.className,T=t.title,u=t.titleId,F=t.maskId,W=tx(s),ie=Lm("classes",[].concat($g(Hk(t)),$g(v.split(" ")))),ne=Lm("transform",typeof t.transform=="string"?Vg.transform(t.transform):t.transform),G=Lm("mask",tx(f)),we=Ok(W,al(al(al(al({},ie),ne),G),{},{symbol:y,title:T,titleId:u,maskId:F}));if(!we)return Qk("Could not find icon",W),null;var Me=we.abstract,Ce={ref:i};return Object.keys(t).forEach(function(Ze){vs.defaultProps.hasOwnProperty(Ze)||(Ce[Ze]=t[Ze])}),eC(Me[0],Ce)});vs.displayName="FontAwesomeIcon";vs.propTypes={beat:hn.exports.bool,border:hn.exports.bool,beatFade:hn.exports.bool,bounce:hn.exports.bool,className:hn.exports.string,fade:hn.exports.bool,flash:hn.exports.bool,mask:hn.exports.oneOfType([hn.exports.object,hn.exports.array,hn.exports.string]),maskId:hn.exports.string,fixedWidth:hn.exports.bool,inverse:hn.exports.bool,flip:hn.exports.oneOf([!0,!1,"horizontal","vertical","both"]),icon:hn.exports.oneOfType([hn.exports.object,hn.exports.array,hn.exports.string]),listItem:hn.exports.bool,pull:hn.exports.oneOf(["right","left"]),pulse:hn.exports.bool,rotation:hn.exports.oneOf([0,90,180,270]),shake:hn.exports.bool,size:hn.exports.oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:hn.exports.bool,spinPulse:hn.exports.bool,spinReverse:hn.exports.bool,symbol:hn.exports.oneOfType([hn.exports.bool,hn.exports.string]),title:hn.exports.string,titleId:hn.exports.string,transform:hn.exports.oneOfType([hn.exports.string,hn.exports.object]),swapOpacity:hn.exports.bool};vs.defaultProps={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1};var eC=Gb.bind(null,au.createElement),tC={prefix:"fas",iconName:"bars",icon:[448,512,["navicon"],"f0c9","M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"]},nC={prefix:"fas",iconName:"user",icon:[448,512,[128100,62144],"f007","M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0S96 57.3 96 128s57.3 128 128 128zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"]},rC={prefix:"fas",iconName:"location-crosshairs",icon:[512,512,["location"],"f601","M256 0c17.7 0 32 14.3 32 32V66.7C368.4 80.1 431.9 143.6 445.3 224H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H445.3C431.9 368.4 368.4 431.9 288 445.3V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V445.3C143.6 431.9 80.1 368.4 66.7 288H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H66.7C80.1 143.6 143.6 80.1 224 66.7V32c0-17.7 14.3-32 32-32zM128 256c0 70.7 57.3 128 128 128s128-57.3 128-128s-57.3-128-128-128s-128 57.3-128 128zm128 80c-44.2 0-80-35.8-80-80s35.8-80 80-80s80 35.8 80 80s-35.8 80-80 80z"]},iC={prefix:"fas",iconName:"magnifying-glass",icon:[512,512,[128269,"search"],"f002","M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"]},oC={prefix:"fas",iconName:"draw-polygon",icon:[448,512,[],"f5ee","M96 151.4V360.6c9.7 5.6 17.8 13.7 23.4 23.4H328.6c0-.1 .1-.2 .1-.3l-4.5-7.9-32-56 0 0c-1.4 .1-2.8 .1-4.2 .1c-35.3 0-64-28.7-64-64s28.7-64 64-64c1.4 0 2.8 0 4.2 .1l0 0 32-56 4.5-7.9-.1-.3H119.4c-5.6 9.7-13.7 17.8-23.4 23.4zM384.3 352c35.2 .2 63.7 28.7 63.7 64c0 35.3-28.7 64-64 64c-23.7 0-44.4-12.9-55.4-32H119.4c-11.1 19.1-31.7 32-55.4 32c-35.3 0-64-28.7-64-64c0-23.7 12.9-44.4 32-55.4V151.4C12.9 140.4 0 119.7 0 96C0 60.7 28.7 32 64 32c23.7 0 44.4 12.9 55.4 32H328.6c11.1-19.1 31.7-32 55.4-32c35.3 0 64 28.7 64 64c0 35.3-28.5 63.8-63.7 64l-4.5 7.9-32 56-2.3 4c4.2 8.5 6.5 18 6.5 28.1s-2.3 19.6-6.5 28.1l2.3 4 32 56 4.5 7.9z"]},Zb={exports:{}};(function(t,i){(function(s,f){t.exports=f()})(Ou,function(){var s,f,y;function v(u,F){if(!s)s=F;else if(!f)f=F;else{var W="var sharedChunk = {}; ("+s+")(sharedChunk); ("+f+")(sharedChunk);",ie={};s(ie),y=F(ie),typeof window<"u"&&(y.workerUrl=window.URL.createObjectURL(new Blob([W],{type:"text/javascript"})))}}v(["exports"],function(u){var F=W;function W(r,e,o,l){this.cx=3*r,this.bx=3*(o-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(l-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=e,this.p2x=o,this.p2y=l}function ie(r,e,o,l){const d=new F(r,e,o,l);return function(m){return d.solve(m)}}W.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,e){if(e===void 0&&(e=1e-6),r<0)return 0;if(r>1)return 1;for(var o=r,l=0;l<8;l++){var d=this.sampleCurveX(o)-r;if(Math.abs(d)<e)return o;var m=this.sampleCurveDerivativeX(o);if(Math.abs(m)<1e-6)break;o-=d/m}var _=0,w=1;for(o=r,l=0;l<20&&(d=this.sampleCurveX(o),!(Math.abs(d-r)<e));l++)r>d?_=o:w=o,o=.5*(w-_)+_;return o},solve:function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))}};const ne=ie(.25,.1,.25,1);function G(r,e,o){return Math.min(o,Math.max(e,r))}function we(r,e,o){const l=o-e,d=((r-e)%l+l)%l+e;return d===e?o:d}function Me(r,...e){for(const o of e)for(const l in o)r[l]=o[l];return r}let Ce=1;function Ze(r,e){r.forEach(o=>{e[o]&&(e[o]=e[o].bind(e))})}function re(r,e,o){const l={};for(const d in r)l[d]=e.call(o||this,r[d],d,r);return l}function J(r,e,o){const l={};for(const d in r)e.call(o||this,r[d],d,r)&&(l[d]=r[d]);return l}function se(r){return Array.isArray(r)?r.map(se):typeof r=="object"&&r?re(r,se):r}const Te={};function ze(r){Te[r]||(typeof console<"u"&&console.warn(r),Te[r]=!0)}function He(r,e,o){return(o.y-r.y)*(e.x-r.x)>(e.y-r.y)*(o.x-r.x)}function it(r){let e=0;for(let o,l,d=0,m=r.length,_=m-1;d<m;_=d++)o=r[d],l=r[_],e+=(l.x-o.x)*(o.y+l.y);return e}function Xe(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ut(r){const e={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,l,d,m)=>{const _=d||m;return e[l]=!_||_.toLowerCase(),""}),e["max-age"]){const o=parseInt(e["max-age"],10);isNaN(o)?delete e["max-age"]:e["max-age"]=o}return e}let xt,Zt,dn=null;function An(r){if(dn==null){const e=r.navigator?r.navigator.userAgent:null;dn=!!r.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return dn}function sn(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const zn={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(r){const e=requestAnimationFrame(r);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(r,e=0){const o=window.document.createElement("canvas"),l=o.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return o.width=r.width,o.height=r.height,l.drawImage(r,0,0,r.width,r.height),l.getImageData(-e,-e,r.width+2*e,r.height+2*e)},resolveURL:r=>(xt||(xt=document.createElement("a")),xt.href=r,xt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Zt==null&&(Zt=matchMedia("(prefers-reduced-motion: reduce)")),Zt.matches)}};var mt=Un;function Un(r,e){this.x=r,this.y=e}Un.prototype={clone:function(){return new Un(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,e){return this.clone()._rotateAround(r,e)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var e=r.x-this.x,o=r.y-this.y;return e*e+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,e){return Math.atan2(this.x*e-this.y*r,this.x*r+this.y*e)},_matMult:function(r){var e=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=e,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var e=Math.cos(r),o=Math.sin(r),l=o*this.x+e*this.y;return this.x=e*this.x-o*this.y,this.y=l,this},_rotateAround:function(r,e){var o=Math.cos(r),l=Math.sin(r),d=e.y+l*(this.x-e.x)+o*(this.y-e.y);return this.x=e.x+o*(this.x-e.x)-l*(this.y-e.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Un.convert=function(r){return r instanceof Un?r:Array.isArray(r)?new Un(r[0],r[1]):r};const at={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Pt="mapbox-tiles";let Qe,yn,Ln=500,Ei=50;function Yr(){typeof caches>"u"||Qe||(Qe=caches.open(Pt))}let Kr=1/0;const Cr={supported:!1,testSupport:function(r){!Jr&&No&&(Ta?Ka(r):ci=r)}};let ci,No,Jr=!1,Ta=!1;function Ka(r){const e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,No),r.isContextLost())return;Cr.supported=!0}catch{}r.deleteTexture(e),Jr=!0}typeof document<"u"&&(No=document.createElement("img"),No.onload=function(){ci&&Ka(ci),ci=null,Ta=!0},No.onerror=function(){Jr=!0,ci=null},No.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Nr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Nr);class Ur extends Error{constructor(e,o,l,d){super(`AJAXError: ${o} (${e}): ${l}`),this.status=e,this.statusText=o,this.url=l,this.body=d}}const go=Xe()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function Ir(r,e){const o=new AbortController,l=new Request(r.url,{method:r.method||"GET",body:r.body,credentials:r.credentials,headers:r.headers,referrer:go(),signal:o.signal});let d=!1,m=!1;return r.type==="json"&&l.headers.set("Accept","application/json"),((_,w,S)=>{if(m)return;const I=Date.now();fetch(l).then(M=>M.ok?((L,O,U)=>{(r.type==="arrayBuffer"?L.arrayBuffer():r.type==="json"?L.json():L.text()).then(V=>{m||(O&&U&&function(te,K,me){if(Yr(),!Qe)return;const Ee={status:K.status,statusText:K.statusText,headers:new Headers};K.headers.forEach((be,Be)=>Ee.headers.set(Be,be));const pe=Ut(K.headers.get("Cache-Control")||"");pe["no-store"]||(pe["max-age"]&&Ee.headers.set("Expires",new Date(me+1e3*pe["max-age"]).toUTCString()),new Date(Ee.headers.get("Expires")).getTime()-me<42e4||function(be,Be){if(yn===void 0)try{new Response(new ReadableStream),yn=!0}catch{yn=!1}yn?Be(be.body):be.blob().then(Be)}(K,be=>{const Be=new Response(be,Ee);Yr(),Qe&&Qe.then(Oe=>Oe.put(function(ft){const vt=ft.indexOf("?");return vt<0?ft:ft.slice(0,vt)}(te.url),Be)).catch(Oe=>ze(Oe.message))}))}(l,O,U),d=!0,e(null,V,L.headers.get("Cache-Control"),L.headers.get("Expires")))}).catch(V=>{m||e(new Error(V.message))})})(M,null,I):M.blob().then(L=>e(new Ur(M.status,M.statusText,r.url,L)))).catch(M=>{M.code!==20&&e(new Error(M.message))})})(),{cancel:()=>{m=!0,d||o.abort()}}}const hi=function(r,e){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){if(Xe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e);if(!Xe()){const l=r.url.substring(0,r.url.indexOf("://"));return(at.REGISTERED_PROTOCOLS[l]||Ir)(r,e)}}if(!(/^file:/.test(o=r.url)||/^file:/.test(go())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Ir(r,e);if(Xe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e,void 0,!0)}var o;return function(l,d){const m=new XMLHttpRequest;m.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const _ in l.headers)m.setRequestHeader(_,l.headers[_]);return l.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=l.credentials==="include",m.onerror=()=>{d(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let _=m.response;if(l.type==="json")try{_=JSON.parse(m.response)}catch(w){return d(w)}d(null,_,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else{const _=new Blob([m.response],{type:m.getResponseHeader("Content-Type")});d(new Ur(m.status,m.statusText,l.url,_))}},m.send(l.body),{cancel:()=>m.abort()}}(r,e)},ka=function(r,e){return hi(Me(r,{type:"arrayBuffer"}),e)};function Ca(r){const e=window.document.createElement("a");return e.href=r,e.protocol===window.document.location.protocol&&e.host===window.document.location.host}const rn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let nr,Uo;nr=[],Uo=0;const Ti=function(r,e){if(Cr.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),Uo>=at.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:r,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return nr.push(m),m}Uo++;let o=!1;const l=()=>{if(!o)for(o=!0,Uo--;nr.length&&Uo<at.MAX_PARALLEL_IMAGE_REQUESTS;){const m=nr.shift(),{requestParameters:_,callback:w,cancelled:S}=m;S||(m.cancel=Ti(_,w).cancel)}},d=ka(r,(m,_,w,S)=>{l(),m?e(m):_&&function(I,M){typeof createImageBitmap=="function"?function(L,O){const U=new Blob([new Uint8Array(L)],{type:"image/png"});createImageBitmap(U).then(V=>{O(null,V)}).catch(V=>{O(new Error(`Could not load image because of ${V.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(I,M):function(L,O){const U=new Image;U.onload=()=>{O(null,U),URL.revokeObjectURL(U.src),U.onload=null,window.requestAnimationFrame(()=>{U.src=rn})},U.onerror=()=>O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const V=new Blob([new Uint8Array(L)],{type:"image/png"});U.src=L.byteLength?URL.createObjectURL(V):rn}(I,M)}(_,(I,M)=>{I!=null?e(I):M!=null&&e(null,M,{cacheControl:w,expires:S})})});return{cancel:()=>{d.cancel(),l()}}};function Ia(r,e,o){o[r]&&o[r].indexOf(e)!==-1||(o[r]=o[r]||[],o[r].push(e))}function Bi(r,e,o){if(o&&o[r]){const l=o[r].indexOf(e);l!==-1&&o[r].splice(l,1)}}class Ki{constructor(e,o={}){Me(this,o),this.type=e}}class aa extends Ki{constructor(e,o={}){super("error",Me({error:e},o))}}class Ji{on(e,o){return this._listeners=this._listeners||{},Ia(e,o,this._listeners),this}off(e,o){return Bi(e,o,this._listeners),Bi(e,o,this._oneTimeListeners),this}once(e,o){return this._oneTimeListeners=this._oneTimeListeners||{},Ia(e,o,this._oneTimeListeners),this}fire(e,o){typeof e=="string"&&(e=new Ki(e,o||{}));const l=e.type;if(this.listens(l)){e.target=this;const d=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const w of d)w.call(this,e);const m=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const w of m)Bi(l,w,this._oneTimeListeners),w.call(this,e);const _=this._eventedParent;_&&(Me(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(e))}else e instanceof aa&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,o){return this._eventedParent=e,this._eventedParentData=o,this}}var Le={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Je{constructor(e,o,l,d){this.message=(e?`${e}: `:"")+l,d&&(this.identifier=d),o!=null&&o.__line__&&(this.line=o.__line__)}}function Yn(r){const e=r.value;return e?[new Je(r.key,e,"constants have been deprecated as of v8")]:[]}function br(r,...e){for(const o of e)for(const l in o)r[l]=o[l];return r}function jt(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Vn(r){if(Array.isArray(r))return r.map(Vn);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const o in r)e[o]=Vn(r[o]);return e}return jt(r)}class di extends Error{constructor(e,o){super(o),this.message=o,this.key=e}}class Pr{constructor(e,o=[]){this.parent=e,this.bindings={};for(const[l,d]of o)this.bindings[l]=d}concat(e){return new Pr(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Kn={kind:"null"},Fe={kind:"number"},Gt={kind:"string"},Bt={kind:"boolean"},wr={kind:"color"},Ni={kind:"object"},Ot={kind:"value"},pn={kind:"collator"},ur={kind:"formatted"},pi={kind:"padding"},rr={kind:"resolvedImage"};function Vr(r,e){return{kind:"array",itemType:r,N:e}}function xn(r){if(r.kind==="array"){const e=xn(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}return r.kind}const Vo=[Kn,Fe,Gt,Bt,wr,ur,Ni,Vr(Ot),pi,rr];function $r(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!$r(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const o of Vo)if(!$r(o,e))return null}}return`Expected ${xn(r)} but found ${xn(e)} instead.`}function $o(r,e){return e.some(o=>o.kind===r.kind)}function yo(r,e){return e.some(o=>o==="null"?r===null:o==="array"?Array.isArray(r):o==="object"?r&&!Array.isArray(r)&&typeof r=="object":o===typeof r)}var _o,vo={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function q(r){return(r=Math.round(r))<0?0:r>255?255:r}function A(r){return q(r[r.length-1]==="%"?parseFloat(r)/100*255:parseInt(r))}function D(r){return(e=r[r.length-1]==="%"?parseFloat(r)/100:parseFloat(r))<0?0:e>1?1:e;var e}function $(r,e,o){return o<0?o+=1:o>1&&(o-=1),6*o<1?r+(e-r)*o*6:2*o<1?e:3*o<2?r+(e-r)*(2/3-o)*6:r}try{_o={}.parseCSSColor=function(r){var e,o=r.replace(/ /g,"").toLowerCase();if(o in vo)return vo[o].slice();if(o[0]==="#")return o.length===4?(e=parseInt(o.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:o.length===7&&(e=parseInt(o.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=o.indexOf("("),d=o.indexOf(")");if(l!==-1&&d+1===o.length){var m=o.substr(0,l),_=o.substr(l+1,d-(l+1)).split(","),w=1;switch(m){case"rgba":if(_.length!==4)return null;w=D(_.pop());case"rgb":return _.length!==3?null:[A(_[0]),A(_[1]),A(_[2]),w];case"hsla":if(_.length!==4)return null;w=D(_.pop());case"hsl":if(_.length!==3)return null;var S=(parseFloat(_[0])%360+360)%360/360,I=D(_[1]),M=D(_[2]),L=M<=.5?M*(I+1):M+I-M*I,O=2*M-L;return[q(255*$(O,L,S+1/3)),q(255*$(O,L,S)),q(255*$(O,L,S-1/3)),w];default:return null}}return null}}catch{}class j{constructor(e,o,l,d=1){this.r=e,this.g=o,this.b=l,this.a=d}static parse(e){if(!e)return;if(e instanceof j)return e;if(typeof e!="string")return;const o=_o(e);return o?new j(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toString(){const[e,o,l,d]=this.toArray();return`rgba(${Math.round(e)},${Math.round(o)},${Math.round(l)},${d})`}toArray(){const{r:e,g:o,b:l,a:d}=this;return d===0?[0,0,0,0]:[255*e/d,255*o/d,255*l/d,d]}}j.black=new j(0,0,0,1),j.white=new j(1,1,1,1),j.transparent=new j(0,0,0,0),j.red=new j(1,0,0,1);class Q{constructor(e,o,l){this.sensitivity=e?o?"variant":"case":o?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,o){return this.collator.compare(e,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ue{constructor(e,o,l,d,m){this.text=e,this.image=o,this.scale=l,this.fontStack=d,this.textColor=m}}class oe{constructor(e){this.sections=e}static fromString(e){return new oe([new ue(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof oe?e:oe.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class ee{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof ee)return e;if(typeof e=="number")return new ee([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const o of e)if(typeof o!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new ee(e)}}toString(){return JSON.stringify(this.values)}}class ce{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new ce({name:e,available:!1}):null}}function Ie(r,e,o,l){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof o=="number"&&o>=0&&o<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[r,e,o,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[r,e,o,l]:[r,e,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ue(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof j||r instanceof Q||r instanceof oe||r instanceof ee||r instanceof ce)return!0;if(Array.isArray(r)){for(const e of r)if(!Ue(e))return!1;return!0}if(typeof r=="object"){for(const e in r)if(!Ue(r[e]))return!1;return!0}return!1}function ke(r){if(r===null)return Kn;if(typeof r=="string")return Gt;if(typeof r=="boolean")return Bt;if(typeof r=="number")return Fe;if(r instanceof j)return wr;if(r instanceof Q)return pn;if(r instanceof oe)return ur;if(r instanceof ee)return pi;if(r instanceof ce)return rr;if(Array.isArray(r)){const e=r.length;let o;for(const l of r){const d=ke(l);if(o){if(o===d)continue;o=Ot;break}o=d}return Vr(o||Ot,e)}return Ni}function gt(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof j||r instanceof oe||r instanceof ee||r instanceof ce?r.toString():JSON.stringify(r)}class _t{constructor(e,o){this.type=e,this.value=o}static parse(e,o){if(e.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ue(e[1]))return o.error("invalid value");const l=e[1];let d=ke(l);const m=o.expectedType;return d.kind!=="array"||d.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(d=m),new _t(d,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class We{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const At={string:Gt,number:Fe,boolean:Bt,object:Ni};class Dt{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");let l,d=1;const m=e[0];if(m==="array"){let w,S;if(e.length>2){const I=e[1];if(typeof I!="string"||!(I in At)||I==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);w=At[I],d++}else w=Ot;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return o.error('The length argument to "array" must be a positive integer literal',2);S=e[2],d++}l=Vr(w,S)}else{if(!At[m])throw new Error(`Types doesn't contain name = ${m}`);l=At[m]}const _=[];for(;d<e.length;d++){const w=o.parse(e[d],d,Ot);if(!w)return null;_.push(w)}return new Dt(l,_)}evaluate(e){for(let o=0;o<this.args.length;o++){const l=this.args[o].evaluate(e);if(!$r(this.type,ke(l)))return l;if(o===this.args.length-1)throw new We(`Expected value to be of type ${xn(this.type)}, but found ${xn(ke(l))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const Qt={"to-boolean":Bt,"to-color":wr,"to-number":Fe,"to-string":Gt};class Ft{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const l=e[0];if(!Qt[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&e.length!==2)return o.error("Expected one argument.");const d=Qt[l],m=[];for(let _=1;_<e.length;_++){const w=o.parse(e[_],_,Ot);if(!w)return null;m.push(w)}return new Ft(d,m)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let o,l;for(const d of this.args){if(o=d.evaluate(e),l=null,o instanceof j)return o;if(typeof o=="string"){const m=e.parseColor(o);if(m)return m}else if(Array.isArray(o)&&(l=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Ie(o[0],o[1],o[2],o[3]),!l))return new j(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new We(l||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}if(this.type.kind==="padding"){let o;for(const l of this.args){o=l.evaluate(e);const d=ee.parse(o);if(d)return d}throw new We(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}if(this.type.kind==="number"){let o=null;for(const l of this.args){if(o=l.evaluate(e),o===null)return 0;const d=Number(o);if(!isNaN(d))return d}throw new We(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?oe.fromString(gt(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?ce.fromString(gt(this.args[0].evaluate(e))):gt(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const qt=["Unknown","Point","LineString","Polygon"];class nn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?qt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let o=this._parseColorCache[e];return o||(o=this._parseColorCache[e]=j.parse(e)),o}}class Nt{constructor(e,o,l,d){this.name=e,this.type=o,this._evaluate=l,this.args=d}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,o){const l=e[0],d=Nt.definitions[l];if(!d)return o.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(d)?d[0]:d.type,_=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,w=_.filter(([I])=>!Array.isArray(I)||I.length===e.length-1);let S=null;for(const[I,M]of w){S=new he(o.registry,o.path,null,o.scope);const L=[];let O=!1;for(let U=1;U<e.length;U++){const V=e[U],te=Array.isArray(I)?I[U-1]:I.type,K=S.parse(V,1+L.length,te);if(!K){O=!0;break}L.push(K)}if(!O)if(Array.isArray(I)&&I.length!==L.length)S.error(`Expected ${I.length} arguments, but found ${L.length} instead.`);else{for(let U=0;U<L.length;U++){const V=Array.isArray(I)?I[U]:I.type,te=L[U];S.concat(U+1).checkSubtype(V,te.type)}if(S.errors.length===0)return new Nt(l,m,M,L)}}if(w.length===1)o.errors.push(...S.errors);else{const I=(w.length?w:_).map(([L])=>{return O=L,Array.isArray(O)?`(${O.map(xn).join(", ")})`:`(${xn(O.type)}...)`;var O}).join(" | "),M=[];for(let L=1;L<e.length;L++){const O=o.parse(e[L],1+M.length);if(!O)return null;M.push(xn(O.type))}o.error(`Expected arguments of type ${I}, but found (${M.join(", ")}) instead.`)}return null}static register(e,o){Nt.definitions=o;for(const l in o)e[l]=Nt}}class cr{constructor(e,o,l){this.type=pn,this.locale=l,this.caseSensitive=e,this.diacriticSensitive=o}static parse(e,o){if(e.length!==2)return o.error("Expected one argument.");const l=e[1];if(typeof l!="object"||Array.isArray(l))return o.error("Collator options argument must be an object.");const d=o.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,Bt);if(!d)return null;const m=o.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,Bt);if(!m)return null;let _=null;return l.locale&&(_=o.parse(l.locale,1,Gt),!_)?null:new cr(d,m,_)}evaluate(e){return new Q(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const Dn=8192;function $n(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function jr(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function sa(r,e){const o=(180+r[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,d=Math.pow(2,e.z);return[Math.round(o*d*Dn),Math.round(l*d*Dn)]}function ln(r,e,o){const l=r[0]-e[0],d=r[1]-e[1],m=r[0]-o[0],_=r[1]-o[1];return l*_-m*d==0&&l*m<=0&&d*_<=0}function xo(r,e){let o=!1;for(let _=0,w=e.length;_<w;_++){const S=e[_];for(let I=0,M=S.length;I<M-1;I++){if(ln(r,S[I],S[I+1]))return!1;(d=S[I])[1]>(l=r)[1]!=(m=S[I+1])[1]>l[1]&&l[0]<(m[0]-d[0])*(l[1]-d[1])/(m[1]-d[1])+d[0]&&(o=!o)}}var l,d,m;return o}function zs(r,e){for(let o=0;o<e.length;o++)if(xo(r,e[o]))return!0;return!1}function yu(r,e,o,l){const d=l[0]-o[0],m=l[1]-o[1],_=(r[0]-o[0])*m-d*(r[1]-o[1]),w=(e[0]-o[0])*m-d*(e[1]-o[1]);return _>0&&w<0||_<0&&w>0}function _u(r,e,o){for(const I of o)for(let M=0;M<I.length-1;++M)if((w=[(_=I[M+1])[0]-(m=I[M])[0],_[1]-m[1]])[0]*(S=[(d=e)[0]-(l=r)[0],d[1]-l[1]])[1]-w[1]*S[0]!=0&&yu(l,d,m,_)&&yu(m,_,l,d))return!0;var l,d,m,_,w,S;return!1}function El(r,e){for(let o=0;o<r.length;++o)if(!xo(r[o],e))return!1;for(let o=0;o<r.length-1;++o)if(_u(r[o],r[o+1],e))return!1;return!0}function vu(r,e){for(let o=0;o<e.length;o++)if(El(r,e[o]))return!0;return!1}function Ls(r,e,o){const l=[];for(let d=0;d<r.length;d++){const m=[];for(let _=0;_<r[d].length;_++){const w=sa(r[d][_],o);$n(e,w),m.push(w)}l.push(m)}return l}function Tl(r,e,o){const l=[];for(let d=0;d<r.length;d++){const m=Ls(r[d],e,o);l.push(m)}return l}function xu(r,e,o,l){if(r[0]<o[0]||r[0]>o[2]){const d=.5*l;let m=r[0]-o[0]>d?-l:o[0]-r[0]>d?l:0;m===0&&(m=r[0]-o[2]>d?-l:o[2]-r[0]>d?l:0),r[0]+=m}$n(e,r)}function bu(r,e,o,l){const d=Math.pow(2,l.z)*Dn,m=[l.x*Dn,l.y*Dn],_=[];for(const w of r)for(const S of w){const I=[S.x+m[0],S.y+m[1]];xu(I,e,o,d),_.push(I)}return _}function kl(r,e,o,l){const d=Math.pow(2,l.z)*Dn,m=[l.x*Dn,l.y*Dn],_=[];for(const S of r){const I=[];for(const M of S){const L=[M.x+m[0],M.y+m[1]];$n(e,L),I.push(L)}_.push(I)}if(e[2]-e[0]<=d/2){(w=e)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const S of _)for(const I of S)xu(I,e,o,d)}var w;return _}class x{constructor(e,o){this.type=Bt,this.geojson=e,this.geometries=o}static parse(e,o){if(e.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ue(e[1])){const l=e[1];if(l.type==="FeatureCollection")for(let d=0;d<l.features.length;++d){const m=l.features[d].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new x(l,l.features[d].geometry)}else if(l.type==="Feature"){const d=l.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new x(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new x(l,l)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(o,l){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=o.canonicalID();if(l.type==="Polygon"){const w=Ls(l.coordinates,m,_),S=bu(o.geometry(),d,m,_);if(!jr(d,m))return!1;for(const I of S)if(!xo(I,w))return!1}if(l.type==="MultiPolygon"){const w=Tl(l.coordinates,m,_),S=bu(o.geometry(),d,m,_);if(!jr(d,m))return!1;for(const I of S)if(!zs(I,w))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(o,l){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=o.canonicalID();if(l.type==="Polygon"){const w=Ls(l.coordinates,m,_),S=kl(o.geometry(),d,m,_);if(!jr(d,m))return!1;for(const I of S)if(!El(I,w))return!1}if(l.type==="MultiPolygon"){const w=Tl(l.coordinates,m,_),S=kl(o.geometry(),d,m,_);if(!jr(d,m))return!1;for(const I of S)if(!vu(I,w))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function C(r){if(r instanceof Nt&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof x)return!1;let e=!0;return r.eachChild(o=>{e&&!C(o)&&(e=!1)}),e}function B(r){if(r instanceof Nt&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(o=>{e&&!B(o)&&(e=!1)}),e}function ae(r,e){if(r instanceof Nt&&e.indexOf(r.name)>=0)return!1;let o=!0;return r.eachChild(l=>{o&&!ae(l,e)&&(o=!1)}),o}class _e{constructor(e,o){this.type=o.type,this.name=e,this.boundExpression=o}static parse(e,o){if(e.length!==2||typeof e[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const l=e[1];return o.scope.has(l)?new _e(l,o.scope.get(l)):o.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class he{constructor(e,o=[],l,d=new Pr,m=[]){this.registry=e,this.path=o,this.key=o.map(_=>`[${_}]`).join(""),this.scope=d,this.errors=m,this.expectedType=l}parse(e,o,l,d,m={}){return o?this.concat(o,l,d)._parse(e,m):this._parse(e,m)}_parse(e,o){function l(d,m,_){return _==="assert"?new Dt(m,[d]):_==="coerce"?new Ft(m,[d]):d}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=e[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[d];if(m){let _=m.parse(e,this);if(!_)return null;if(this.expectedType){const w=this.expectedType,S=_.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||S.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(w.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array"){if(this.checkSubtype(w,S))return null}else _=l(_,w,o.typeAnnotation||"coerce");else _=l(_,w,o.typeAnnotation||"coerce");else _=l(_,w,o.typeAnnotation||"assert")}if(!(_ instanceof _t)&&_.type.kind!=="resolvedImage"&&ge(_)){const w=new nn;try{_=new _t(_.type,_.evaluate(w))}catch(S){return this.error(S.message),null}}return _}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,o,l){const d=typeof e=="number"?this.path.concat(e):this.path,m=l?this.scope.concat(l):this.scope;return new he(this.registry,d,o||null,m,this.errors)}error(e,...o){const l=`${this.key}${o.map(d=>`[${d}]`).join("")}`;this.errors.push(new di(l,e))}checkSubtype(e,o){const l=$r(e,o);return l&&this.error(l),l}}function ge(r){if(r instanceof _e)return ge(r.boundExpression);if(r instanceof Nt&&r.name==="error"||r instanceof cr||r instanceof x)return!1;const e=r instanceof Ft||r instanceof Dt;let o=!0;return r.eachChild(l=>{o=e?o&&ge(l):o&&l instanceof _t}),!!o&&C(r)&&ae(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function je(r,e){const o=r.length-1;let l,d,m=0,_=o,w=0;for(;m<=_;)if(w=Math.floor((m+_)/2),l=r[w],d=r[w+1],l<=e){if(w===o||e<d)return w;m=w+1}else{if(!(l>e))throw new We("Input is not a number.");_=w-1}return 0}class Ve{constructor(e,o,l){this.type=e,this.input=o,this.labels=[],this.outputs=[];for(const[d,m]of l)this.labels.push(d),this.outputs.push(m)}static parse(e,o){if(e.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return o.error("Expected an even number of arguments.");const l=o.parse(e[1],1,Fe);if(!l)return null;const d=[];let m=null;o.expectedType&&o.expectedType.kind!=="value"&&(m=o.expectedType);for(let _=1;_<e.length;_+=2){const w=_===1?-1/0:e[_],S=e[_+1],I=_,M=_+1;if(typeof w!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(d.length&&d[d.length-1][0]>=w)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const L=o.parse(S,M,m);if(!L)return null;m=m||L.type,d.push([w,L])}return new Ve(m,l,d)}evaluate(e){const o=this.labels,l=this.outputs;if(o.length===1)return l[0].evaluate(e);const d=this.input.evaluate(e);if(d<=o[0])return l[0].evaluate(e);const m=o.length;return d>=o[m-1]?l[m-1].evaluate(e):l[je(o,d)].evaluate(e)}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Ge(r,e,o){return r*(1-o)+e*o}var xe=Object.freeze({__proto__:null,number:Ge,color:function(r,e,o){return new j(Ge(r.r,e.r,o),Ge(r.g,e.g,o),Ge(r.b,e.b,o),Ge(r.a,e.a,o))},array:function(r,e,o){return r.map((l,d)=>Ge(l,e[d],o))},padding:function(r,e,o){const l=r.values,d=e.values;return new ee([Ge(l[0],d[0],o),Ge(l[1],d[1],o),Ge(l[2],d[2],o),Ge(l[3],d[3],o)])}});const et=.95047,dt=1.08883,Tt=4/29,Rt=6/29,Wn=3*Rt*Rt,Ne=Math.PI/180,yt=180/Math.PI;function _n(r){return r>.008856451679035631?Math.pow(r,1/3):r/Wn+Tt}function mn(r){return r>Rt?r*r*r:Wn*(r-Tt)}function Rn(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function kt(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Xt(r){const e=kt(r.r),o=kt(r.g),l=kt(r.b),d=_n((.4124564*e+.3575761*o+.1804375*l)/et),m=_n((.2126729*e+.7151522*o+.072175*l)/1);return{l:116*m-16,a:500*(d-m),b:200*(m-_n((.0193339*e+.119192*o+.9503041*l)/dt)),alpha:r.a}}function bo(r){let e=(r.l+16)/116,o=isNaN(r.a)?e:e+r.a/500,l=isNaN(r.b)?e:e-r.b/200;return e=1*mn(e),o=et*mn(o),l=dt*mn(l),new j(Rn(3.2404542*o-1.5371385*e-.4985314*l),Rn(-.969266*o+1.8760108*e+.041556*l),Rn(.0556434*o-.2040259*e+1.0572252*l),r.alpha)}function fn(r,e,o){const l=e-r;return r+o*(l>180||l<-180?l-360*Math.round(l/360):l)}const Gr={forward:Xt,reverse:bo,interpolate:function(r,e,o){return{l:Ge(r.l,e.l,o),a:Ge(r.a,e.a,o),b:Ge(r.b,e.b,o),alpha:Ge(r.alpha,e.alpha,o)}}},mr={forward:function(r){const{l:e,a:o,b:l}=Xt(r),d=Math.atan2(l,o)*yt;return{h:d<0?d+360:d,c:Math.sqrt(o*o+l*l),l:e,alpha:r.a}},reverse:function(r){const e=r.h*Ne,o=r.c;return bo({l:r.l,a:Math.cos(e)*o,b:Math.sin(e)*o,alpha:r.alpha})},interpolate:function(r,e,o){return{h:fn(r.h,e.h,o),c:Ge(r.c,e.c,o),l:Ge(r.l,e.l,o),alpha:Ge(r.alpha,e.alpha,o)}}};var Ds=Object.freeze({__proto__:null,lab:Gr,hcl:mr});class Qr{constructor(e,o,l,d,m){this.type=e,this.operator=o,this.interpolation=l,this.input=d,this.labels=[],this.outputs=[];for(const[_,w]of m)this.labels.push(_),this.outputs.push(w)}static interpolationFactor(e,o,l,d){let m=0;if(e.name==="exponential")m=ki(o,e.base,l,d);else if(e.name==="linear")m=ki(o,1,l,d);else if(e.name==="cubic-bezier"){const _=e.controlPoints;m=new F(_[0],_[1],_[2],_[3]).solve(ki(o,1,l,d))}return m}static parse(e,o){let[l,d,m,..._]=e;if(!Array.isArray(d)||d.length===0)return o.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const I=d[1];if(typeof I!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:I}}else{if(d[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const I=d.slice(1);if(I.length!==4||I.some(M=>typeof M!="number"||M<0||M>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:I}}}if(e.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(m=o.parse(m,2,Fe),!m)return null;const w=[];let S=null;l==="interpolate-hcl"||l==="interpolate-lab"?S=wr:o.expectedType&&o.expectedType.kind!=="value"&&(S=o.expectedType);for(let I=0;I<_.length;I+=2){const M=_[I],L=_[I+1],O=I+3,U=I+4;if(typeof M!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(w.length&&w[w.length-1][0]>=M)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',O);const V=o.parse(L,U,S);if(!V)return null;S=S||V.type,w.push([M,V])}return S.kind==="number"||S.kind==="color"||S.kind==="padding"||S.kind==="array"&&S.itemType.kind==="number"&&typeof S.N=="number"?new Qr(S,l,d,m,w):o.error(`Type ${xn(S)} is not interpolatable.`)}evaluate(e){const o=this.labels,l=this.outputs;if(o.length===1)return l[0].evaluate(e);const d=this.input.evaluate(e);if(d<=o[0])return l[0].evaluate(e);const m=o.length;if(d>=o[m-1])return l[m-1].evaluate(e);const _=je(o,d),w=Qr.interpolationFactor(this.interpolation,d,o[_],o[_+1]),S=l[_].evaluate(e),I=l[_+1].evaluate(e);return this.operator==="interpolate"?xe[this.type.kind.toLowerCase()](S,I,w):this.operator==="interpolate-hcl"?mr.reverse(mr.interpolate(mr.forward(S),mr.forward(I),w)):Gr.reverse(Gr.interpolate(Gr.forward(S),Gr.forward(I),w))}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function ki(r,e,o,l){const d=l-o,m=r-o;return d===0?0:e===1?m/d:(Math.pow(e,m)-1)/(Math.pow(e,d)-1)}class Ja{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expectected at least one argument.");let l=null;const d=o.expectedType;d&&d.kind!=="value"&&(l=d);const m=[];for(const w of e.slice(1)){const S=o.parse(w,1+m.length,l,void 0,{typeAnnotation:"omit"});if(!S)return null;l=l||S.type,m.push(S)}if(!l)throw new Error("No output type");const _=d&&m.some(w=>$r(d,w.type));return new Ja(_?Ot:l,m)}evaluate(e){let o,l=null,d=0;for(const m of this.args)if(d++,l=m.evaluate(e),l&&l instanceof ce&&!l.available&&(o||(o=l.name),l=null,d===this.args.length&&(l=o)),l!==null)break;return l}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}class Qa{constructor(e,o){this.type=o.type,this.bindings=[].concat(e),this.result=o}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const o of this.bindings)e(o[1]);e(this.result)}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const l=[];for(let m=1;m<e.length-1;m+=2){const _=e[m];if(typeof _!="string")return o.error(`Expected string, but found ${typeof _} instead.`,m);if(/[^a-zA-Z0-9_]/.test(_))return o.error("Variable names must contain only alphanumeric characters or '_'.",m);const w=o.parse(e[m+1],m+1);if(!w)return null;l.push([_,w])}const d=o.parse(e[e.length-1],e.length-1,o.expectedType,l);return d?new Qa(l,d):null}outputDefined(){return this.result.outputDefined()}}class Cl{constructor(e,o,l){this.type=e,this.index=o,this.input=l}static parse(e,o){if(e.length!==3)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,Fe),d=o.parse(e[2],2,Vr(o.expectedType||Ot));return l&&d?new Cl(d.type.itemType,l,d):null}evaluate(e){const o=this.index.evaluate(e),l=this.input.evaluate(e);if(o<0)throw new We(`Array index out of bounds: ${o} < 0.`);if(o>=l.length)throw new We(`Array index out of bounds: ${o} > ${l.length-1}.`);if(o!==Math.floor(o))throw new We(`Array index must be an integer, but found ${o} instead.`);return l[o]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class Rs{constructor(e,o){this.type=Bt,this.needle=e,this.haystack=o}static parse(e,o){if(e.length!==3)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,Ot),d=o.parse(e[2],2,Ot);return l&&d?$o(l.type,[Bt,Gt,Fe,Kn,Ot])?new Rs(l,d):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${xn(l.type)} instead`):null}evaluate(e){const o=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!l)return!1;if(!yo(o,["boolean","string","number","null"]))throw new We(`Expected first argument to be of type boolean, string, number or null, but found ${xn(ke(o))} instead.`);if(!yo(l,["string","array"]))throw new We(`Expected second argument to be of type array or string, but found ${xn(ke(l))} instead.`);return l.indexOf(o)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class la{constructor(e,o,l){this.type=Fe,this.needle=e,this.haystack=o,this.fromIndex=l}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,Ot),d=o.parse(e[2],2,Ot);if(!l||!d)return null;if(!$o(l.type,[Bt,Gt,Fe,Kn,Ot]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${xn(l.type)} instead`);if(e.length===4){const m=o.parse(e[3],3,Fe);return m?new la(l,d,m):null}return new la(l,d)}evaluate(e){const o=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!yo(o,["boolean","string","number","null"]))throw new We(`Expected first argument to be of type boolean, string, number or null, but found ${xn(ke(o))} instead.`);if(!yo(l,["string","array"]))throw new We(`Expected second argument to be of type array or string, but found ${xn(ke(l))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(e);return l.indexOf(o,d)}return l.indexOf(o)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Fs{constructor(e,o,l,d,m,_){this.inputType=e,this.type=o,this.input=l,this.cases=d,this.outputs=m,this.otherwise=_}static parse(e,o){if(e.length<5)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return o.error("Expected an even number of arguments.");let l,d;o.expectedType&&o.expectedType.kind!=="value"&&(d=o.expectedType);const m={},_=[];for(let I=2;I<e.length-1;I+=2){let M=e[I];const L=e[I+1];Array.isArray(M)||(M=[M]);const O=o.concat(I);if(M.length===0)return O.error("Expected at least one branch label.");for(const V of M){if(typeof V!="number"&&typeof V!="string")return O.error("Branch labels must be numbers or strings.");if(typeof V=="number"&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return O.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof V=="number"&&Math.floor(V)!==V)return O.error("Numeric branch labels must be integer values.");if(l){if(O.checkSubtype(l,ke(V)))return null}else l=ke(V);if(m[String(V)]!==void 0)return O.error("Branch labels must be unique.");m[String(V)]=_.length}const U=o.parse(L,I,d);if(!U)return null;d=d||U.type,_.push(U)}const w=o.parse(e[1],1,Ot);if(!w)return null;const S=o.parse(e[e.length-1],e.length-1,d);return S?w.type.kind!=="value"&&o.concat(1).checkSubtype(l,w.type)?null:new Fs(l,d,w,m,_,S):null}evaluate(e){const o=this.input.evaluate(e);return(ke(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class Os{constructor(e,o,l){this.type=e,this.branches=o,this.otherwise=l}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return o.error("Expected an odd number of arguments.");let l;o.expectedType&&o.expectedType.kind!=="value"&&(l=o.expectedType);const d=[];for(let _=1;_<e.length-1;_+=2){const w=o.parse(e[_],_,Bt);if(!w)return null;const S=o.parse(e[_+1],_+1,l);if(!S)return null;d.push([w,S]),l=l||S.type}const m=o.parse(e[e.length-1],e.length-1,l);if(!m)return null;if(!l)throw new Error("Can't infer output type");return new Os(l,d,m)}evaluate(e){for(const[o,l]of this.branches)if(o.evaluate(e))return l.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[o,l]of this.branches)e(o),e(l);e(this.otherwise)}outputDefined(){return this.branches.every(([e,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class Bs{constructor(e,o,l,d){this.type=e,this.input=o,this.beginIndex=l,this.endIndex=d}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,Ot),d=o.parse(e[2],2,Fe);if(!l||!d)return null;if(!$o(l.type,[Vr(Ot),Gt,Ot]))return o.error(`Expected first argument to be of type array or string, but found ${xn(l.type)} instead`);if(e.length===4){const m=o.parse(e[3],3,Fe);return m?new Bs(l.type,l,d,m):null}return new Bs(l.type,l,d)}evaluate(e){const o=this.input.evaluate(e),l=this.beginIndex.evaluate(e);if(!yo(o,["string","array"]))throw new We(`Expected first argument to be of type array or string, but found ${xn(ke(o))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(e);return o.slice(l,d)}return o.slice(l)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function jo(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Il(r,e,o,l){return l.compare(e,o)===0}function Pa(r,e,o){const l=r!=="=="&&r!=="!=";return class Wb{constructor(m,_,w){this.type=Bt,this.lhs=m,this.rhs=_,this.collator=w,this.hasUntypedArgument=m.type.kind==="value"||_.type.kind==="value"}static parse(m,_){if(m.length!==3&&m.length!==4)return _.error("Expected two or three arguments.");const w=m[0];let S=_.parse(m[1],1,Ot);if(!S)return null;if(!jo(w,S.type))return _.concat(1).error(`"${w}" comparisons are not supported for type '${xn(S.type)}'.`);let I=_.parse(m[2],2,Ot);if(!I)return null;if(!jo(w,I.type))return _.concat(2).error(`"${w}" comparisons are not supported for type '${xn(I.type)}'.`);if(S.type.kind!==I.type.kind&&S.type.kind!=="value"&&I.type.kind!=="value")return _.error(`Cannot compare types '${xn(S.type)}' and '${xn(I.type)}'.`);l&&(S.type.kind==="value"&&I.type.kind!=="value"?S=new Dt(I.type,[S]):S.type.kind!=="value"&&I.type.kind==="value"&&(I=new Dt(S.type,[I])));let M=null;if(m.length===4){if(S.type.kind!=="string"&&I.type.kind!=="string"&&S.type.kind!=="value"&&I.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(M=_.parse(m[3],3,pn),!M)return null}return new Wb(S,I,M)}evaluate(m){const _=this.lhs.evaluate(m),w=this.rhs.evaluate(m);if(l&&this.hasUntypedArgument){const S=ke(_),I=ke(w);if(S.kind!==I.kind||S.kind!=="string"&&S.kind!=="number")throw new We(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${S.kind}, ${I.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const S=ke(_),I=ke(w);if(S.kind!=="string"||I.kind!=="string")return e(m,_,w)}return this.collator?o(m,_,w,this.collator.evaluate(m)):e(m,_,w)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const _c=Pa("==",function(r,e,o){return e===o},Il),Pl=Pa("!=",function(r,e,o){return e!==o},function(r,e,o,l){return!Il(0,e,o,l)}),es=Pa("<",function(r,e,o){return e<o},function(r,e,o,l){return l.compare(e,o)<0}),Al=Pa(">",function(r,e,o){return e>o},function(r,e,o,l){return l.compare(e,o)>0}),Ml=Pa("<=",function(r,e,o){return e<=o},function(r,e,o,l){return l.compare(e,o)<=0}),zl=Pa(">=",function(r,e,o){return e>=o},function(r,e,o,l){return l.compare(e,o)>=0});class ua{constructor(e,o,l,d,m){this.type=Gt,this.number=e,this.locale=o,this.currency=l,this.minFractionDigits=d,this.maxFractionDigits=m}static parse(e,o){if(e.length!==3)return o.error("Expected two arguments.");const l=o.parse(e[1],1,Fe);if(!l)return null;const d=e[2];if(typeof d!="object"||Array.isArray(d))return o.error("NumberFormat options argument must be an object.");let m=null;if(d.locale&&(m=o.parse(d.locale,1,Gt),!m))return null;let _=null;if(d.currency&&(_=o.parse(d.currency,1,Gt),!_))return null;let w=null;if(d["min-fraction-digits"]&&(w=o.parse(d["min-fraction-digits"],1,Fe),!w))return null;let S=null;return d["max-fraction-digits"]&&(S=o.parse(d["max-fraction-digits"],1,Fe),!S)?null:new ua(l,m,_,w,S)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Ns{constructor(e){this.type=ur,this.sections=e}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const l=e[1];if(!Array.isArray(l)&&typeof l=="object")return o.error("First argument must be an image or text section.");const d=[];let m=!1;for(let _=1;_<=e.length-1;++_){const w=e[_];if(m&&typeof w=="object"&&!Array.isArray(w)){m=!1;let S=null;if(w["font-scale"]&&(S=o.parse(w["font-scale"],1,Fe),!S))return null;let I=null;if(w["text-font"]&&(I=o.parse(w["text-font"],1,Vr(Gt)),!I))return null;let M=null;if(w["text-color"]&&(M=o.parse(w["text-color"],1,wr),!M))return null;const L=d[d.length-1];L.scale=S,L.font=I,L.textColor=M}else{const S=o.parse(e[_],1,Ot);if(!S)return null;const I=S.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,d.push({content:S,scale:null,font:null,textColor:null})}}return new Ns(d)}evaluate(e){return new oe(this.sections.map(o=>{const l=o.content.evaluate(e);return ke(l)===rr?new ue("",l,null,null,null):new ue(gt(l),null,o.scale?o.scale.evaluate(e):null,o.font?o.font.evaluate(e).join(","):null,o.textColor?o.textColor.evaluate(e):null)}))}eachChild(e){for(const o of this.sections)e(o.content),o.scale&&e(o.scale),o.font&&e(o.font),o.textColor&&e(o.textColor)}outputDefined(){return!1}}class Ll{constructor(e){this.type=rr,this.input=e}static parse(e,o){if(e.length!==2)return o.error("Expected two arguments.");const l=o.parse(e[1],1,Gt);return l?new Ll(l):o.error("No image name provided.")}evaluate(e){const o=this.input.evaluate(e),l=ce.fromString(o);return l&&e.availableImages&&(l.available=e.availableImages.indexOf(o)>-1),l}eachChild(e){e(this.input)}outputDefined(){return!1}}class Dl{constructor(e){this.type=Fe,this.input=e}static parse(e,o){if(e.length!==2)return o.error(`Expected 1 argument, but found ${e.length-1} instead.`);const l=o.parse(e[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${xn(l.type)} instead.`):new Dl(l):null}evaluate(e){const o=this.input.evaluate(e);if(typeof o=="string"||Array.isArray(o))return o.length;throw new We(`Expected value to be of type string or array, but found ${xn(ke(o))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Aa={"==":_c,"!=":Pl,">":Al,"<":es,">=":zl,"<=":Ml,array:Dt,at:Cl,boolean:Dt,case:Os,coalesce:Ja,collator:cr,format:Ns,image:Ll,in:Rs,"index-of":la,interpolate:Qr,"interpolate-hcl":Qr,"interpolate-lab":Qr,length:Dl,let:Qa,literal:_t,match:Fs,number:Dt,"number-format":ua,object:Dt,slice:Bs,step:Ve,string:Dt,"to-boolean":Ft,"to-color":Ft,"to-number":Ft,"to-string":Ft,var:_e,within:x};function wu(r,[e,o,l,d]){e=e.evaluate(r),o=o.evaluate(r),l=l.evaluate(r);const m=d?d.evaluate(r):1,_=Ie(e,o,l,m);if(_)throw new We(_);return new j(e/255*m,o/255*m,l/255*m,m)}function Rl(r,e){return r in e}function Ma(r,e){const o=e[r];return o===void 0?null:o}function fi(r){return{type:r}}function Qi(r){return{result:"success",value:r}}function Ci(r){return{result:"error",value:r}}function wn(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function wo(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function Yt(r){return!!r.expression&&r.expression.interpolated}function on(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function vn(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function Mn(r){return r}function za(r,e){const o=e.type==="color",l=r.stops&&typeof r.stops[0][0]=="object",d=l||!(l||r.property!==void 0),m=r.type||(Yt(e)?"exponential":"interval");if(o||e.type==="padding"){const I=o?j.parse:ee.parse;(r=br({},r)).stops&&(r.stops=r.stops.map(M=>[M[0],I(M[1])])),r.default=I(r.default?r.default:e.default)}if(r.colorSpace&&r.colorSpace!=="rgb"&&!Ds[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let _,w,S;if(m==="exponential")_=Fl;else if(m==="interval")_=Su;else if(m==="categorical"){_=vc,w=Object.create(null);for(const I of r.stops)w[I[0]]=I[1];S=typeof r.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);_=Us}if(l){const I={},M=[];for(let U=0;U<r.stops.length;U++){const V=r.stops[U],te=V[0].zoom;I[te]===void 0&&(I[te]={zoom:te,type:r.type,property:r.property,default:r.default,stops:[]},M.push(te)),I[te].stops.push([V[0].value,V[1]])}const L=[];for(const U of M)L.push([I[U].zoom,za(I[U],e)]);const O={name:"linear"};return{kind:"composite",interpolationType:O,interpolationFactor:Qr.interpolationFactor.bind(void 0,O),zoomStops:L.map(U=>U[0]),evaluate:({zoom:U},V)=>Fl({stops:L,base:r.base},e,U).evaluate(U,V)}}if(d){const I=m==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:Qr.interpolationFactor.bind(void 0,I),zoomStops:r.stops.map(M=>M[0]),evaluate:({zoom:M})=>_(r,e,M,w,S)}}return{kind:"source",evaluate(I,M){const L=M&&M.properties?M.properties[r.property]:void 0;return L===void 0?La(r.default,e.default):_(r,e,L,w,S)}}}function La(r,e,o){return r!==void 0?r:e!==void 0?e:o!==void 0?o:void 0}function vc(r,e,o,l,d){return La(typeof o===d?l[o]:void 0,r.default,e.default)}function Su(r,e,o){if(on(o)!=="number")return La(r.default,e.default);const l=r.stops.length;if(l===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[l-1][0])return r.stops[l-1][1];const d=je(r.stops.map(m=>m[0]),o);return r.stops[d][1]}function Fl(r,e,o){const l=r.base!==void 0?r.base:1;if(on(o)!=="number")return La(r.default,e.default);const d=r.stops.length;if(d===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[d-1][0])return r.stops[d-1][1];const m=je(r.stops.map(M=>M[0]),o),_=function(M,L,O,U){const V=U-O,te=M-O;return V===0?0:L===1?te/V:(Math.pow(L,te)-1)/(Math.pow(L,V)-1)}(o,l,r.stops[m][0],r.stops[m+1][0]),w=r.stops[m][1],S=r.stops[m+1][1];let I=xe[e.type]||Mn;if(r.colorSpace&&r.colorSpace!=="rgb"){const M=Ds[r.colorSpace];I=(L,O)=>M.reverse(M.interpolate(M.forward(L),M.forward(O),_))}return typeof w.evaluate=="function"?{evaluate(...M){const L=w.evaluate.apply(void 0,M),O=S.evaluate.apply(void 0,M);if(L!==void 0&&O!==void 0)return I(L,O,_)}}:I(w,S,_)}function Us(r,e,o){switch(e.type){case"color":o=j.parse(o);break;case"formatted":o=oe.fromString(o.toString());break;case"resolvedImage":o=ce.fromString(o.toString());break;case"padding":o=ee.parse(o);break;default:on(o)===e.type||e.type==="enum"&&e.values[o]||(o=void 0)}return La(o,r.default,e.default)}Nt.register(Aa,{error:[{kind:"error"},[Gt],(r,[e])=>{throw new We(e.evaluate(r))}],typeof:[Gt,[Ot],(r,[e])=>xn(ke(e.evaluate(r)))],"to-rgba":[Vr(Fe,4),[wr],(r,[e])=>e.evaluate(r).toArray()],rgb:[wr,[Fe,Fe,Fe],wu],rgba:[wr,[Fe,Fe,Fe,Fe],wu],has:{type:Bt,overloads:[[[Gt],(r,[e])=>Rl(e.evaluate(r),r.properties())],[[Gt,Ni],(r,[e,o])=>Rl(e.evaluate(r),o.evaluate(r))]]},get:{type:Ot,overloads:[[[Gt],(r,[e])=>Ma(e.evaluate(r),r.properties())],[[Gt,Ni],(r,[e,o])=>Ma(e.evaluate(r),o.evaluate(r))]]},"feature-state":[Ot,[Gt],(r,[e])=>Ma(e.evaluate(r),r.featureState||{})],properties:[Ni,[],r=>r.properties()],"geometry-type":[Gt,[],r=>r.geometryType()],id:[Ot,[],r=>r.id()],zoom:[Fe,[],r=>r.globals.zoom],"heatmap-density":[Fe,[],r=>r.globals.heatmapDensity||0],"line-progress":[Fe,[],r=>r.globals.lineProgress||0],accumulated:[Ot,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Fe,fi(Fe),(r,e)=>{let o=0;for(const l of e)o+=l.evaluate(r);return o}],"*":[Fe,fi(Fe),(r,e)=>{let o=1;for(const l of e)o*=l.evaluate(r);return o}],"-":{type:Fe,overloads:[[[Fe,Fe],(r,[e,o])=>e.evaluate(r)-o.evaluate(r)],[[Fe],(r,[e])=>-e.evaluate(r)]]},"/":[Fe,[Fe,Fe],(r,[e,o])=>e.evaluate(r)/o.evaluate(r)],"%":[Fe,[Fe,Fe],(r,[e,o])=>e.evaluate(r)%o.evaluate(r)],ln2:[Fe,[],()=>Math.LN2],pi:[Fe,[],()=>Math.PI],e:[Fe,[],()=>Math.E],"^":[Fe,[Fe,Fe],(r,[e,o])=>Math.pow(e.evaluate(r),o.evaluate(r))],sqrt:[Fe,[Fe],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[Fe,[Fe],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[Fe,[Fe],(r,[e])=>Math.log(e.evaluate(r))],log2:[Fe,[Fe],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[Fe,[Fe],(r,[e])=>Math.sin(e.evaluate(r))],cos:[Fe,[Fe],(r,[e])=>Math.cos(e.evaluate(r))],tan:[Fe,[Fe],(r,[e])=>Math.tan(e.evaluate(r))],asin:[Fe,[Fe],(r,[e])=>Math.asin(e.evaluate(r))],acos:[Fe,[Fe],(r,[e])=>Math.acos(e.evaluate(r))],atan:[Fe,[Fe],(r,[e])=>Math.atan(e.evaluate(r))],min:[Fe,fi(Fe),(r,e)=>Math.min(...e.map(o=>o.evaluate(r)))],max:[Fe,fi(Fe),(r,e)=>Math.max(...e.map(o=>o.evaluate(r)))],abs:[Fe,[Fe],(r,[e])=>Math.abs(e.evaluate(r))],round:[Fe,[Fe],(r,[e])=>{const o=e.evaluate(r);return o<0?-Math.round(-o):Math.round(o)}],floor:[Fe,[Fe],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[Fe,[Fe],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[Bt,[Gt,Ot],(r,[e,o])=>r.properties()[e.value]===o.value],"filter-id-==":[Bt,[Ot],(r,[e])=>r.id()===e.value],"filter-type-==":[Bt,[Gt],(r,[e])=>r.geometryType()===e.value],"filter-<":[Bt,[Gt,Ot],(r,[e,o])=>{const l=r.properties()[e.value],d=o.value;return typeof l==typeof d&&l<d}],"filter-id-<":[Bt,[Ot],(r,[e])=>{const o=r.id(),l=e.value;return typeof o==typeof l&&o<l}],"filter->":[Bt,[Gt,Ot],(r,[e,o])=>{const l=r.properties()[e.value],d=o.value;return typeof l==typeof d&&l>d}],"filter-id->":[Bt,[Ot],(r,[e])=>{const o=r.id(),l=e.value;return typeof o==typeof l&&o>l}],"filter-<=":[Bt,[Gt,Ot],(r,[e,o])=>{const l=r.properties()[e.value],d=o.value;return typeof l==typeof d&&l<=d}],"filter-id-<=":[Bt,[Ot],(r,[e])=>{const o=r.id(),l=e.value;return typeof o==typeof l&&o<=l}],"filter->=":[Bt,[Gt,Ot],(r,[e,o])=>{const l=r.properties()[e.value],d=o.value;return typeof l==typeof d&&l>=d}],"filter-id->=":[Bt,[Ot],(r,[e])=>{const o=r.id(),l=e.value;return typeof o==typeof l&&o>=l}],"filter-has":[Bt,[Ot],(r,[e])=>e.value in r.properties()],"filter-has-id":[Bt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Bt,[Vr(Gt)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[Bt,[Vr(Ot)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[Bt,[Gt,Vr(Ot)],(r,[e,o])=>o.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[Bt,[Gt,Vr(Ot)],(r,[e,o])=>function(l,d,m,_){for(;m<=_;){const w=m+_>>1;if(d[w]===l)return!0;d[w]>l?_=w-1:m=w+1}return!1}(r.properties()[e.value],o.value,0,o.value.length-1)],all:{type:Bt,overloads:[[[Bt,Bt],(r,[e,o])=>e.evaluate(r)&&o.evaluate(r)],[fi(Bt),(r,e)=>{for(const o of e)if(!o.evaluate(r))return!1;return!0}]]},any:{type:Bt,overloads:[[[Bt,Bt],(r,[e,o])=>e.evaluate(r)||o.evaluate(r)],[fi(Bt),(r,e)=>{for(const o of e)if(o.evaluate(r))return!0;return!1}]]},"!":[Bt,[Bt],(r,[e])=>!e.evaluate(r)],"is-supported-script":[Bt,[Gt],(r,[e])=>{const o=r.globals&&r.globals.isSupportedScript;return!o||o(e.evaluate(r))}],upcase:[Gt,[Gt],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[Gt,[Gt],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[Gt,fi(Ot),(r,e)=>e.map(o=>gt(o.evaluate(r))).join("")],"resolved-locale":[Gt,[pn],(r,[e])=>e.evaluate(r).resolvedLocale()]});class So{constructor(e,o){this.expression=e,this._warningHistory={},this._evaluator=new nn,this._defaultValue=o?function(l){return l.type==="color"&&vn(l.default)?new j(0,0,0,0):l.type==="color"?j.parse(l.default)||null:l.type==="padding"?ee.parse(l.default)||null:l.default===void 0?null:l.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(e,o,l,d,m,_){return this._evaluator.globals=e,this._evaluator.feature=o,this._evaluator.featureState=l,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(e,o,l,d,m,_){this._evaluator.globals=e,this._evaluator.feature=o||null,this._evaluator.featureState=l||null,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new We(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function ts(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Aa}function Ii(r,e){const o=new he(Aa,[],e?function(d){const m={color:wr,string:Gt,number:Fe,enum:Gt,boolean:Bt,formatted:ur,padding:pi,resolvedImage:rr};return d.type==="array"?Vr(m[d.value]||Ot,d.length):m[d.type]}(e):void 0),l=o.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Qi(new So(l,e)):Ci(o.errors)}class ns{constructor(e,o){this.kind=e,this._styleExpression=o,this.isStateDependent=e!=="constant"&&!B(o.expression)}evaluateWithoutErrorHandling(e,o,l,d,m,_){return this._styleExpression.evaluateWithoutErrorHandling(e,o,l,d,m,_)}evaluate(e,o,l,d,m,_){return this._styleExpression.evaluate(e,o,l,d,m,_)}}class Eo{constructor(e,o,l,d){this.kind=e,this.zoomStops=l,this._styleExpression=o,this.isStateDependent=e!=="camera"&&!B(o.expression),this.interpolationType=d}evaluateWithoutErrorHandling(e,o,l,d,m,_){return this._styleExpression.evaluateWithoutErrorHandling(e,o,l,d,m,_)}evaluate(e,o,l,d,m,_){return this._styleExpression.evaluate(e,o,l,d,m,_)}interpolationFactor(e,o,l){return this.interpolationType?Qr.interpolationFactor(this.interpolationType,e,o,l):0}}function Ol(r,e){const o=Ii(r,e);if(o.result==="error")return o;const l=o.value.expression,d=C(l);if(!d&&!wn(e))return Ci([new di("","data expressions not supported")]);const m=ae(l,["zoom"]);if(!m&&!wo(e))return Ci([new di("","zoom expressions not supported")]);const _=ca(l);return _||m?_ instanceof di?Ci([_]):_ instanceof Qr&&!Yt(e)?Ci([new di("",'"interpolate" expressions cannot be used with this property')]):Qi(_?new Eo(d?"camera":"composite",o.value,_.labels,_ instanceof Qr?_.interpolation:void 0):new ns(d?"constant":"source",o.value)):Ci([new di("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Vs{constructor(e,o){this._parameters=e,this._specification=o,br(this,za(this._parameters,this._specification))}static deserialize(e){return new Vs(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function ca(r){let e=null;if(r instanceof Qa)e=ca(r.result);else if(r instanceof Ja){for(const o of r.args)if(e=ca(o),e)break}else(r instanceof Ve||r instanceof Qr)&&r.input instanceof Nt&&r.input.name==="zoom"&&(e=r);return e instanceof di||r.eachChild(o=>{const l=ca(o);l instanceof di?e=l:!e&&l?e=new di("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&l&&e!==l&&(e=new di("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function mi(r){const e=r.key,o=r.value,l=r.valueSpec||{},d=r.objectElementValidators||{},m=r.style,_=r.styleSpec;let w=[];const S=on(o);if(S!=="object")return[new Je(e,o,`object expected, ${S} found`)];for(const I in o){const M=I.split(".")[0],L=l[M]||l["*"];let O;if(d[M])O=d[M];else if(l[M])O=gi;else if(d["*"])O=d["*"];else{if(!l["*"]){w.push(new Je(e,o[I],`unknown property "${I}"`));continue}O=gi}w=w.concat(O({key:(e&&`${e}.`)+I,value:o[I],valueSpec:L,style:m,styleSpec:_,object:o,objectKey:I},o))}for(const I in l)d[I]||l[I].required&&l[I].default===void 0&&o[I]===void 0&&w.push(new Je(e,o,`missing required property "${I}"`));return w}function Bl(r){const e=r.value,o=r.valueSpec,l=r.style,d=r.styleSpec,m=r.key,_=r.arrayElementValidator||gi;if(on(e)!=="array")return[new Je(m,e,`array expected, ${on(e)} found`)];if(o.length&&e.length!==o.length)return[new Je(m,e,`array length ${o.length} expected, length ${e.length} found`)];if(o["min-length"]&&e.length<o["min-length"])return[new Je(m,e,`array length at least ${o["min-length"]} expected, length ${e.length} found`)];let w={type:o.value,values:o.values};d.$version<7&&(w.function=o.function),on(o.value)==="object"&&(w=o.value);let S=[];for(let I=0;I<e.length;I++)S=S.concat(_({array:e,arrayIndex:I,value:e[I],valueSpec:w,style:l,styleSpec:d,key:`${m}[${I}]`}));return S}function $s(r){const e=r.key,o=r.value,l=r.valueSpec;let d=on(o);return d==="number"&&o!=o&&(d="NaN"),d!=="number"?[new Je(e,o,`number expected, ${d} found`)]:"minimum"in l&&o<l.minimum?[new Je(e,o,`${o} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&o>l.maximum?[new Je(e,o,`${o} is greater than the maximum value ${l.maximum}`)]:[]}function Nl(r){const e=r.valueSpec,o=jt(r.value.type);let l,d,m,_={};const w=o!=="categorical"&&r.value.property===void 0,S=!w,I=on(r.value.stops)==="array"&&on(r.value.stops[0])==="array"&&on(r.value.stops[0][0])==="object",M=mi({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(U){if(o==="identity")return[new Je(U.key,U.value,'identity function may not have a "stops" property')];let V=[];const te=U.value;return V=V.concat(Bl({key:U.key,value:te,valueSpec:U.valueSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:L})),on(te)==="array"&&te.length===0&&V.push(new Je(U.key,te,"array must have at least one stop")),V},default:function(U){return gi({key:U.key,value:U.value,valueSpec:e,style:U.style,styleSpec:U.styleSpec})}}});return o==="identity"&&w&&M.push(new Je(r.key,r.value,'missing required property "property"')),o==="identity"||r.value.stops||M.push(new Je(r.key,r.value,'missing required property "stops"')),o==="exponential"&&r.valueSpec.expression&&!Yt(r.valueSpec)&&M.push(new Je(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(S&&!wn(r.valueSpec)?M.push(new Je(r.key,r.value,"property functions not supported")):w&&!wo(r.valueSpec)&&M.push(new Je(r.key,r.value,"zoom functions not supported"))),o!=="categorical"&&!I||r.value.property!==void 0||M.push(new Je(r.key,r.value,'"property" property is required')),M;function L(U){let V=[];const te=U.value,K=U.key;if(on(te)!=="array")return[new Je(K,te,`array expected, ${on(te)} found`)];if(te.length!==2)return[new Je(K,te,`array length 2 expected, length ${te.length} found`)];if(I){if(on(te[0])!=="object")return[new Je(K,te,`object expected, ${on(te[0])} found`)];if(te[0].zoom===void 0)return[new Je(K,te,"object stop key must have zoom")];if(te[0].value===void 0)return[new Je(K,te,"object stop key must have value")];if(m&&m>jt(te[0].zoom))return[new Je(K,te[0].zoom,"stop zoom values must appear in ascending order")];jt(te[0].zoom)!==m&&(m=jt(te[0].zoom),d=void 0,_={}),V=V.concat(mi({key:`${K}[0]`,value:te[0],valueSpec:{zoom:{}},style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:$s,value:O}}))}else V=V.concat(O({key:`${K}[0]`,value:te[0],valueSpec:{},style:U.style,styleSpec:U.styleSpec},te));return ts(Vn(te[1]))?V.concat([new Je(`${K}[1]`,te[1],"expressions are not allowed in function stops.")]):V.concat(gi({key:`${K}[1]`,value:te[1],valueSpec:e,style:U.style,styleSpec:U.styleSpec}))}function O(U,V){const te=on(U.value),K=jt(U.value),me=U.value!==null?U.value:V;if(l){if(te!==l)return[new Je(U.key,me,`${te} stop domain type must match previous stop domain type ${l}`)]}else l=te;if(te!=="number"&&te!=="string"&&te!=="boolean")return[new Je(U.key,me,"stop domain value must be a number, string, or boolean")];if(te!=="number"&&o!=="categorical"){let Ee=`number expected, ${te} found`;return wn(e)&&o===void 0&&(Ee+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Je(U.key,me,Ee)]}return o!=="categorical"||te!=="number"||isFinite(K)&&Math.floor(K)===K?o!=="categorical"&&te==="number"&&d!==void 0&&K<d?[new Je(U.key,me,"stop domain values must appear in ascending order")]:(d=K,o==="categorical"&&K in _?[new Je(U.key,me,"stop domain values must be unique")]:(_[K]=!0,[])):[new Je(U.key,me,`integer expected, found ${K}`)]}}function Ui(r){const e=(r.expressionContext==="property"?Ol:Ii)(Vn(r.value),r.valueSpec);if(e.result==="error")return e.value.map(l=>new Je(`${r.key}${l.key}`,r.value,l.message));const o=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!o.outputDefined())return[new Je(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!B(o))return[new Je(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!B(o))return[new Je(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!ae(o,["zoom","feature-state"]))return[new Je(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!C(o))return[new Je(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Da(r){const e=r.key,o=r.value,l=r.valueSpec,d=[];return Array.isArray(l.values)?l.values.indexOf(jt(o))===-1&&d.push(new Je(e,o,`expected one of [${l.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(l.values).indexOf(jt(o))===-1&&d.push(new Je(e,o,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(o)} found`)),d}function Ra(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!Ra(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const fe={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ae(r){if(r==null)return{filter:()=>!0,needGeometry:!1};Ra(r)||(r=Sn(r));const e=Ii(r,fe);if(e.result==="error")throw new Error(e.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,l,d)=>e.value.evaluate(o,l,{},d),needGeometry:Mt(r)}}function ot(r,e){return r<e?-1:r>e?1:0}function Mt(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let e=1;e<r.length;e++)if(Mt(r[e]))return!0;return!1}function Sn(r){if(!r)return!0;const e=r[0];return r.length<=1?e!=="any":e==="=="?en(r[1],r[2],"=="):e==="!="?Ar(en(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?en(r[1],r[2],e):e==="any"?(o=r.slice(1),["any"].concat(o.map(Sn))):e==="all"?["all"].concat(r.slice(1).map(Sn)):e==="none"?["all"].concat(r.slice(1).map(Sn).map(Ar)):e==="in"?Fn(r[1],r.slice(2)):e==="!in"?Ar(Fn(r[1],r.slice(2))):e==="has"?Bn(r[1]):e==="!has"?Ar(Bn(r[1])):e!=="within"||r;var o}function en(r,e,o){switch(r){case"$type":return[`filter-type-${o}`,e];case"$id":return[`filter-id-${o}`,e];default:return[`filter-${o}`,r,e]}}function Fn(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(o=>typeof o!=typeof e[0])?["filter-in-large",r,["literal",e.sort(ot)]]:["filter-in-small",r,["literal",e]]}}function Bn(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Ar(r){return["!",r]}function jn(r){return Ra(Vn(r.value))?Ui(br({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ir(r)}function ir(r){const e=r.value,o=r.key;if(on(e)!=="array")return[new Je(o,e,`array expected, ${on(e)} found`)];const l=r.styleSpec;let d,m=[];if(e.length<1)return[new Je(o,e,"filter array must have at least 1 element")];switch(m=m.concat(Da({key:`${o}[0]`,value:e[0],valueSpec:l.filter_operator,style:r.style,styleSpec:r.styleSpec})),jt(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&jt(e[1])==="$type"&&m.push(new Je(o,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&m.push(new Je(o,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(d=on(e[1]),d!=="string"&&m.push(new Je(`${o}[1]`,e[1],`string expected, ${d} found`)));for(let _=2;_<e.length;_++)d=on(e[_]),jt(e[1])==="$type"?m=m.concat(Da({key:`${o}[${_}]`,value:e[_],valueSpec:l.geometry_type,style:r.style,styleSpec:r.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&m.push(new Je(`${o}[${_}]`,e[_],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let _=1;_<e.length;_++)m=m.concat(ir({key:`${o}[${_}]`,value:e[_],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":d=on(e[1]),e.length!==2?m.push(new Je(o,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="string"&&m.push(new Je(`${o}[1]`,e[1],`string expected, ${d} found`));break;case"within":d=on(e[1]),e.length!==2?m.push(new Je(o,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="object"&&m.push(new Je(`${o}[1]`,e[1],`object expected, ${d} found`))}return m}function ei(r,e){const o=r.key,l=r.style,d=r.styleSpec,m=r.value,_=r.objectKey,w=d[`${e}_${r.layerType}`];if(!w)return[];const S=_.match(/^(.*)-transition$/);if(e==="paint"&&S&&w[S[1]]&&w[S[1]].transition)return gi({key:o,value:m,valueSpec:d.transition,style:l,styleSpec:d});const I=r.valueSpec||w[_];if(!I)return[new Je(o,m,`unknown property "${_}"`)];let M;if(on(m)==="string"&&wn(I)&&!I.tokens&&(M=/^{([^}]+)}$/.exec(m)))return[new Je(o,m,`"${_}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(M[1])} }\`.`)];const L=[];return r.layerType==="symbol"&&(_==="text-field"&&l&&!l.glyphs&&L.push(new Je(o,m,'use of "text-field" requires a style "glyphs" property')),_==="text-font"&&vn(Vn(m))&&jt(m.type)==="identity"&&L.push(new Je(o,m,'"text-font" does not support identity functions'))),L.concat(gi({key:r.key,value:m,valueSpec:I,style:l,styleSpec:d,expressionContext:"property",propertyType:e,propertyKey:_}))}function eo(r){return ei(r,"paint")}function Mr(r){return ei(r,"layout")}function to(r){let e=[];const o=r.value,l=r.key,d=r.style,m=r.styleSpec;o.type||o.ref||e.push(new Je(l,o,'either "type" or "ref" is required'));let _=jt(o.type);const w=jt(o.ref);if(o.id){const S=jt(o.id);for(let I=0;I<r.arrayIndex;I++){const M=d.layers[I];jt(M.id)===S&&e.push(new Je(l,o.id,`duplicate layer id "${o.id}", previously used at line ${M.id.__line__}`))}}if("ref"in o){let S;["type","source","source-layer","filter","layout"].forEach(I=>{I in o&&e.push(new Je(l,o[I],`"${I}" is prohibited for ref layers`))}),d.layers.forEach(I=>{jt(I.id)===w&&(S=I)}),S?S.ref?e.push(new Je(l,o.ref,"ref cannot reference another ref layer")):_=jt(S.type):e.push(new Je(l,o.ref,`ref layer "${w}" not found`))}else if(_!=="background")if(o.source){const S=d.sources&&d.sources[o.source],I=S&&jt(S.type);S?I==="vector"&&_==="raster"?e.push(new Je(l,o.source,`layer "${o.id}" requires a raster source`)):I==="raster"&&_!=="raster"?e.push(new Je(l,o.source,`layer "${o.id}" requires a vector source`)):I!=="vector"||o["source-layer"]?I==="raster-dem"&&_!=="hillshade"?e.push(new Je(l,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!o.paint||!o.paint["line-gradient"]||I==="geojson"&&S.lineMetrics||e.push(new Je(l,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Je(l,o,`layer "${o.id}" must specify a "source-layer"`)):e.push(new Je(l,o.source,`source "${o.source}" not found`))}else e.push(new Je(l,o,'missing required property "source"'));return e=e.concat(mi({key:l,value:o,valueSpec:m.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>gi({key:`${l}.type`,value:o.type,valueSpec:m.layer.type,style:r.style,styleSpec:r.styleSpec,object:o,objectKey:"type"}),filter:jn,layout:S=>mi({layer:o,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":I=>Mr(br({layerType:_},I))}}),paint:S=>mi({layer:o,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":I=>eo(br({layerType:_},I))}})}})),e}function Vi(r){const e=r.value,o=r.key,l=on(e);return l!=="string"?[new Je(o,e,`string expected, ${l} found`)]:[]}const rs={promoteId:function({key:r,value:e}){if(on(e)==="string")return Vi({key:r,value:e});{const o=[];for(const l in e)o.push(...Vi({key:`${r}.${l}`,value:e[l]}));return o}}};function no(r){const e=r.value,o=r.key,l=r.styleSpec,d=r.style;if(!e.type)return[new Je(o,e,'"type" is required')];const m=jt(e.type);let _;switch(m){case"vector":case"raster":case"raster-dem":return _=mi({key:o,value:e,valueSpec:l[`source_${m.replace("-","_")}`],style:r.style,styleSpec:l,objectElementValidators:rs}),_;case"geojson":if(_=mi({key:o,value:e,valueSpec:l.source_geojson,style:d,styleSpec:l,objectElementValidators:rs}),e.cluster)for(const w in e.clusterProperties){const[S,I]=e.clusterProperties[w],M=typeof S=="string"?[S,["accumulated"],["get",w]]:S;_.push(...Ui({key:`${o}.${w}.map`,value:I,expressionContext:"cluster-map"})),_.push(...Ui({key:`${o}.${w}.reduce`,value:M,expressionContext:"cluster-reduce"}))}return _;case"video":return mi({key:o,value:e,valueSpec:l.source_video,style:d,styleSpec:l});case"image":return mi({key:o,value:e,valueSpec:l.source_image,style:d,styleSpec:l});case"canvas":return[new Je(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Da({key:`${o}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:d,styleSpec:l})}}function To(r){const e=r.value,o=r.styleSpec,l=o.light,d=r.style;let m=[];const _=on(e);if(e===void 0)return m;if(_!=="object")return m=m.concat([new Je("light",e,`object expected, ${_} found`)]),m;for(const w in e){const S=w.match(/^(.*)-transition$/);m=m.concat(S&&l[S[1]]&&l[S[1]].transition?gi({key:w,value:e[w],valueSpec:o.transition,style:d,styleSpec:o}):l[w]?gi({key:w,value:e[w],valueSpec:l[w],style:d,styleSpec:o}):[new Je(w,e[w],`unknown property "${w}"`)])}return m}function ti(r){const e=r.value,o=r.styleSpec,l=o.terrain,d=r.style;let m=[];const _=on(e);if(e===void 0)return m;if(_!=="object")return m=m.concat([new Je("terrain",e,`object expected, ${_} found`)]),m;for(const w in e)m=m.concat(l[w]?gi({key:w,value:e[w],valueSpec:l[w],style:d,styleSpec:o}):[new Je(w,e[w],`unknown property "${w}"`)]);return m}const is={"*":()=>[],array:Bl,boolean:function(r){const e=r.value,o=r.key,l=on(e);return l!=="boolean"?[new Je(o,e,`boolean expected, ${l} found`)]:[]},number:$s,color:function(r){const e=r.key,o=r.value,l=on(o);return l!=="string"?[new Je(e,o,`color expected, ${l} found`)]:_o(o)===null?[new Je(e,o,`color expected, "${o}" found`)]:[]},constants:Yn,enum:Da,filter:jn,function:Nl,layer:to,object:mi,source:no,light:To,terrain:ti,string:Vi,formatted:function(r){return Vi(r).length===0?[]:Ui(r)},resolvedImage:function(r){return Vi(r).length===0?[]:Ui(r)},padding:function(r){const e=r.key,o=r.value;if(on(o)==="array"){if(o.length<1||o.length>4)return[new Je(e,o,`padding requires 1 to 4 values; ${o.length} values found`)];const l={type:"number"};let d=[];for(let m=0;m<o.length;m++)d=d.concat(gi({key:`${e}[${m}]`,value:o[m],valueSpec:l}));return d}return $s({key:e,value:o,valueSpec:{}})}};function gi(r){const e=r.value,o=r.valueSpec,l=r.styleSpec;return o.expression&&vn(jt(e))?Nl(r):o.expression&&ts(Vn(e))?Ui(r):o.type&&is[o.type]?is[o.type](r):mi(br({},r,{valueSpec:o.type?l[o.type]:o}))}function In(r){const e=r.value,o=r.key,l=Vi(r);return l.length||(e.indexOf("{fontstack}")===-1&&l.push(new Je(o,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&l.push(new Je(o,e,'"glyphs" url must include a "{range}" token'))),l}function an(r,e=Le){let o=[];return o=o.concat(gi({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,objectElementValidators:{glyphs:In,"*":()=>[]}})),r.constants&&(o=o.concat(Yn({key:"constants",value:r.constants,style:r,styleSpec:e}))),os(o)}function os(r){return[].concat(r).sort((e,o)=>e.line-o.line)}function zr(r){return function(...e){return os(r.apply(this,e))}}an.source=zr(no),an.light=zr(To),an.terrain=zr(ti),an.layer=zr(to),an.filter=zr(jn),an.paintProperty=zr(eo),an.layoutProperty=zr(Mr);const ha=an,ni=ha.light,ko=ha.paintProperty,Go=ha.layoutProperty;function qo(r,e){let o=!1;if(e&&e.length)for(const l of e)r.fire(new aa(new Error(l.message))),o=!0;return o}class Zo{constructor(e,o,l){const d=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const _=new Int32Array(this.arrayBuffer);e=_[0],this.d=(o=_[1])+2*(l=_[2]);for(let S=0;S<this.d*this.d;S++){const I=_[3+S],M=_[3+S+1];d.push(I===M?null:_.subarray(I,M))}const w=_[3+d.length+1];this.keys=_.subarray(_[3+d.length],w),this.bboxes=_.subarray(w),this.insert=this._insertReadonly}else{this.d=o+2*l;for(let _=0;_<this.d*this.d;_++)d.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=e,this.padding=l,this.scale=o/e,this.uid=0;const m=l/o*e;this.min=-m,this.max=e+m}insert(e,o,l,d,m){this._forEachCell(o,l,d,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,o,l,d,m,_){this.cells[m].push(_)}query(e,o,l,d,m){const _=this.min,w=this.max;if(e<=_&&o<=_&&w<=l&&w<=d&&!m)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(e,o,l,d,this._queryCell,S,{},m),S}}_queryCell(e,o,l,d,m,_,w,S){const I=this.cells[m];if(I!==null){const M=this.keys,L=this.bboxes;for(let O=0;O<I.length;O++){const U=I[O];if(w[U]===void 0){const V=4*U;(S?S(L[V+0],L[V+1],L[V+2],L[V+3]):e<=L[V+2]&&o<=L[V+3]&&l>=L[V+0]&&d>=L[V+1])?(w[U]=!0,_.push(M[U])):w[U]=!1}}}}_forEachCell(e,o,l,d,m,_,w,S){const I=this._convertToCellCoord(e),M=this._convertToCellCoord(o),L=this._convertToCellCoord(l),O=this._convertToCellCoord(d);for(let U=I;U<=L;U++)for(let V=M;V<=O;V++){const te=this.d*V+U;if((!S||S(this._convertFromCellCoord(U),this._convertFromCellCoord(V),this._convertFromCellCoord(U+1),this._convertFromCellCoord(V+1)))&&m.call(this,e,o,l,d,te,_,w,S))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,o=3+this.cells.length+1+1;let l=0;for(let _=0;_<this.cells.length;_++)l+=this.cells[_].length;const d=new Int32Array(o+l+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let m=o;for(let _=0;_<e.length;_++){const w=e[_];d[3+_]=m,d.set(w,m),m+=w.length}return d[3+e.length]=m,d.set(this.keys,m),m+=this.keys.length,d[3+e.length+1]=m,d.set(this.bboxes,m),m+=this.bboxes.length,d.buffer}static serialize(e,o){const l=e.toArrayBuffer();return o&&o.push(l),{buffer:l}}static deserialize(e){return new Zo(e.buffer)}}const ri={};function lt(r,e,o={}){if(ri[r])throw new Error(`${r} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:r,writeable:!1}),ri[r]={klass:e,omit:o.omit||[],shallow:o.shallow||[]}}lt("Object",Object),lt("TransferableGridIndex",Zo),lt("Color",j),lt("Error",Error),lt("AJAXError",Ur),lt("ResolvedImage",ce),lt("StylePropertyFunction",Vs),lt("StyleExpression",So,{omit:["_evaluator"]}),lt("ZoomDependentExpression",Eo),lt("ZoomConstantExpression",ns),lt("CompoundExpression",Nt,{omit:["_evaluate"]});for(const r in Aa)Aa[r]._classRegistryKey||lt(`Expression_${r}`,Aa[r]);function Ul(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function ro(r,e){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob)return r;if(Ul(r)||sn(r))return e&&e.push(r),r;if(ArrayBuffer.isView(r)){const o=r;return e&&e.push(o.buffer),o}if(r instanceof ImageData)return e&&e.push(r.data.buffer),r;if(Array.isArray(r)){const o=[];for(const l of r)o.push(ro(l,e));return o}if(typeof r=="object"){const o=r.constructor,l=o._classRegistryKey;if(!l)throw new Error("can't serialize object of unregistered class");if(!ri[l])throw new Error(`${l} is not registered.`);const d=o.serialize?o.serialize(r,e):{};if(o.serialize){if(e&&d===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in r){if(!r.hasOwnProperty(m)||ri[l].omit.indexOf(m)>=0)continue;const _=r[m];d[m]=ri[l].shallow.indexOf(m)>=0?_:ro(_,e)}r instanceof Error&&(d.message=r.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(d.$name=l),d}throw new Error("can't serialize object of type "+typeof r)}function io(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||Ul(r)||sn(r)||ArrayBuffer.isView(r)||r instanceof ImageData)return r;if(Array.isArray(r))return r.map(io);if(typeof r=="object"){const e=r.$name||"Object";if(!ri[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:o}=ri[e];if(!o)throw new Error(`can't deserialize unregistered class ${e}`);if(o.deserialize)return o.deserialize(r);const l=Object.create(o.prototype);for(const d of Object.keys(r)){if(d==="$name")continue;const m=r[d];l[d]=ri[e].shallow.indexOf(d)>=0?m:io(m)}return l}throw new Error("can't deserialize object of type "+typeof r)}class Fa{constructor(){this.first=!0}update(e,o){const l=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=o),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=l,!0))}}const tt={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function as(r){for(const e of r)if(xc(e.charCodeAt(0)))return!0;return!1}function js(r){for(const e of r)if(!Oa(e.charCodeAt(0)))return!1;return!0}function Oa(r){return!(tt.Arabic(r)||tt["Arabic Supplement"](r)||tt["Arabic Extended-A"](r)||tt["Arabic Presentation Forms-A"](r)||tt["Arabic Presentation Forms-B"](r))}function xc(r){return!(r!==746&&r!==747&&(r<4352||!(tt["Bopomofo Extended"](r)||tt.Bopomofo(r)||tt["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||tt["CJK Compatibility Ideographs"](r)||tt["CJK Compatibility"](r)||tt["CJK Radicals Supplement"](r)||tt["CJK Strokes"](r)||!(!tt["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||tt["CJK Unified Ideographs Extension A"](r)||tt["CJK Unified Ideographs"](r)||tt["Enclosed CJK Letters and Months"](r)||tt["Hangul Compatibility Jamo"](r)||tt["Hangul Jamo Extended-A"](r)||tt["Hangul Jamo Extended-B"](r)||tt["Hangul Jamo"](r)||tt["Hangul Syllables"](r)||tt.Hiragana(r)||tt["Ideographic Description Characters"](r)||tt.Kanbun(r)||tt["Kangxi Radicals"](r)||tt["Katakana Phonetic Extensions"](r)||tt.Katakana(r)&&r!==12540||!(!tt["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!tt["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||tt["Unified Canadian Aboriginal Syllabics"](r)||tt["Unified Canadian Aboriginal Syllabics Extended"](r)||tt["Vertical Forms"](r)||tt["Yijing Hexagram Symbols"](r)||tt["Yi Syllables"](r)||tt["Yi Radicals"](r))))}function Yh(r){return!(xc(r)||function(e){return!!(tt["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||tt["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||tt["Letterlike Symbols"](e)||tt["Number Forms"](e)||tt["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||tt["Control Pictures"](e)&&e!==9251||tt["Optical Character Recognition"](e)||tt["Enclosed Alphanumerics"](e)||tt["Geometric Shapes"](e)||tt["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||tt["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||tt["CJK Symbols and Punctuation"](e)||tt.Katakana(e)||tt["Private Use Area"](e)||tt["CJK Compatibility Forms"](e)||tt["Small Form Variants"](e)||tt["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(r))}function Kh(r){return r>=1424&&r<=2303||tt["Arabic Presentation Forms-A"](r)||tt["Arabic Presentation Forms-B"](r)}function yf(r,e){return!(!e&&Kh(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||tt.Khmer(r))}function Jh(r){for(const e of r)if(Kh(e.charCodeAt(0)))return!0;return!1}const bc="deferred",wc="loading",Sc="loaded";let Ec=null,Pi="unavailable",Ba=null;const Qh=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(Pi="error"),Ec&&Ec(r)};function Gs(){Tc.fire(new Ki("pluginStateChange",{pluginStatus:Pi,pluginURL:Ba}))}const Tc=new Ji,Vl=function(){return Pi},ed=function(){if(Pi!==bc||!Ba)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Pi=wc,Gs(),Ba&&ka({url:Ba},r=>{r?Qh(r):(Pi=Sc,Gs())})},oo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Pi===Sc||oo.applyArabicShaping!=null,isLoading:()=>Pi===wc,setState(r){if(!Xe())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Pi=r.pluginStatus,Ba=r.pluginURL},isParsed(){if(!Xe())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return oo.applyArabicShaping!=null&&oo.processBidirectionalText!=null&&oo.processStyledBidirectionalText!=null},getPluginURL(){if(!Xe())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Ba}};class Gn{constructor(e,o){this.zoom=e,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Fa,this.transition={})}isSupportedScript(e){return function(o,l){for(const d of o)if(!yf(d.charCodeAt(0),l))return!1;return!0}(e,oo.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,o=e-Math.floor(e),l=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*o}}}class $l{constructor(e,o){this.property=e,this.value=o,this.expression=function(l,d){if(vn(l))return new Vs(l,d);if(ts(l)){const m=Ol(l,d);if(m.result==="error")throw new Error(m.value.map(_=>`${_.key}: ${_.message}`).join(", "));return m.value}{let m=l;return d.type==="color"&&typeof l=="string"?m=j.parse(l):d.type!=="padding"||typeof l!="number"&&!Array.isArray(l)||(m=ee.parse(l)),{kind:"constant",evaluate:()=>m}}}(o===void 0?e.specification.default:o,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,o,l){return this.property.possiblyEvaluate(this,e,o,l)}}class Eu{constructor(e){this.property=e,this.value=new $l(e,void 0)}transitioned(e,o){return new nd(this.property,this.value,o,Me({},e.transition,this.transition),e.now)}untransitioned(){return new nd(this.property,this.value,null,{},0)}}class td{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return se(this._values[e].value.value)}setValue(e,o){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Eu(this._values[e].property)),this._values[e].value=new $l(this._values[e].property,o===null?void 0:se(o))}getTransition(e){return se(this._values[e].transition)}setTransition(e,o){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Eu(this._values[e].property)),this._values[e].transition=se(o)||void 0}serialize(){const e={};for(const o of Object.keys(this._values)){const l=this.getValue(o);l!==void 0&&(e[o]=l);const d=this.getTransition(o);d!==void 0&&(e[`${o}-transition`]=d)}return e}transitioned(e,o){const l=new rd(this._properties);for(const d of Object.keys(this._values))l._values[d]=this._values[d].transitioned(e,o._values[d]);return l}untransitioned(){const e=new rd(this._properties);for(const o of Object.keys(this._values))e._values[o]=this._values[o].untransitioned();return e}}class nd{constructor(e,o,l,d,m){this.property=e,this.value=o,this.begin=m+d.delay||0,this.end=this.begin+d.duration||0,e.specification.transition&&(d.delay||d.duration)&&(this.prior=l)}possiblyEvaluate(e,o,l){const d=e.now||0,m=this.value.possiblyEvaluate(e,o,l),_=this.prior;if(_){if(d>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(d<this.begin)return _.possiblyEvaluate(e,o,l);{const w=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(e,o,l),m,function(S){if(S<=0)return 0;if(S>=1)return 1;const I=S*S,M=I*S;return 4*(S<.5?M:3*(S-I)+M-.75)}(w))}}return m}}class rd{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,o,l){const d=new jl(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(e,o,l);return d}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class _f{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return se(this._values[e].value)}setValue(e,o){this._values[e]=new $l(this._values[e].property,o===null?void 0:se(o))}serialize(){const e={};for(const o of Object.keys(this._values)){const l=this.getValue(o);l!==void 0&&(e[o]=l)}return e}possiblyEvaluate(e,o,l){const d=new jl(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(e,o,l);return d}}class Wo{constructor(e,o,l){this.property=e,this.value=o,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,o,l,d){return this.property.evaluate(this.value,this.parameters,e,o,l,d)}}class jl{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class bt{constructor(e){this.specification=e}possiblyEvaluate(e,o){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(o)}interpolate(e,o,l){const d=xe[this.specification.type];return d?d(e,o,l):e}}class Lt{constructor(e,o){this.specification=e,this.overrides=o}possiblyEvaluate(e,o,l,d){return new Wo(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(o,null,{},l,d)}:e.expression,o)}interpolate(e,o,l){if(e.value.kind!=="constant"||o.value.kind!=="constant")return e;if(e.value.value===void 0||o.value.value===void 0)return new Wo(this,{kind:"constant",value:void 0},e.parameters);const d=xe[this.specification.type];return d?new Wo(this,{kind:"constant",value:d(e.value.value,o.value.value,l)},e.parameters):e}evaluate(e,o,l,d,m,_){return e.kind==="constant"?e.value:e.evaluate(o,l,d,m,_)}}class qs extends Lt{possiblyEvaluate(e,o,l,d){if(e.value===void 0)return new Wo(this,{kind:"constant",value:void 0},o);if(e.expression.kind==="constant"){const m=e.expression.evaluate(o,null,{},l,d),_=e.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,w=this._calculate(_,_,_,o);return new Wo(this,{kind:"constant",value:w},o)}if(e.expression.kind==="camera"){const m=this._calculate(e.expression.evaluate({zoom:o.zoom-1}),e.expression.evaluate({zoom:o.zoom}),e.expression.evaluate({zoom:o.zoom+1}),o);return new Wo(this,{kind:"constant",value:m},o)}return new Wo(this,e.expression,o)}evaluate(e,o,l,d,m,_){if(e.kind==="source"){const w=e.evaluate(o,l,d,m,_);return this._calculate(w,w,w,o)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(o.zoom)-1},l,d),e.evaluate({zoom:Math.floor(o.zoom)},l,d),e.evaluate({zoom:Math.floor(o.zoom)+1},l,d),o):e.value}_calculate(e,o,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:o}:{from:l,to:o}}interpolate(e){return e}}class kc{constructor(e){this.specification=e}possiblyEvaluate(e,o,l,d){if(e.value!==void 0){if(e.expression.kind==="constant"){const m=e.expression.evaluate(o,null,{},l,d);return this._calculate(m,m,m,o)}return this._calculate(e.expression.evaluate(new Gn(Math.floor(o.zoom-1),o)),e.expression.evaluate(new Gn(Math.floor(o.zoom),o)),e.expression.evaluate(new Gn(Math.floor(o.zoom+1),o)),o)}}_calculate(e,o,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:o}:{from:l,to:o}}interpolate(e){return e}}class Na{constructor(e){this.specification=e}possiblyEvaluate(e,o,l,d){return!!e.expression.evaluate(o,null,{},l,d)}interpolate(){return!1}}class qr{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in e){const l=e[o];l.specification.overridable&&this.overridableProperties.push(o);const d=this.defaultPropertyValues[o]=new $l(l,void 0),m=this.defaultTransitionablePropertyValues[o]=new Eu(l);this.defaultTransitioningPropertyValues[o]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=d.possiblyEvaluate({})}}}lt("DataDrivenProperty",Lt),lt("DataConstantProperty",bt),lt("CrossFadedDataDrivenProperty",qs),lt("CrossFadedProperty",kc),lt("ColorRampProperty",Na);const Ua="-transition";class Ho extends Ji{constructor(e,o){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),o.layout&&(this._unevaluatedLayout=new _f(o.layout)),o.paint)){this._transitionablePaint=new td(o.paint);for(const l in e.paint)this.setPaintProperty(l,e.paint[l],{validate:!1});for(const l in e.layout)this.setLayoutProperty(l,e.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new jl(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,o,l={}){o!=null&&this._validate(Go,`layers.${this.id}.layout.${e}`,e,o,l)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,o):this.visibility=o)}getPaintProperty(e){return e.endsWith(Ua)?this._transitionablePaint.getTransition(e.slice(0,-Ua.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,o,l={}){if(o!=null&&this._validate(ko,`layers.${this.id}.paint.${e}`,e,o,l))return!1;if(e.endsWith(Ua))return this._transitionablePaint.setTransition(e.slice(0,-Ua.length),o||void 0),!1;{const d=this._transitionablePaint._values[e],m=d.property.specification["property-type"]==="cross-faded-data-driven",_=d.value.isDataDriven(),w=d.value;this._transitionablePaint.setValue(e,o),this._handleSpecialPaintPropertyUpdate(e);const S=this._transitionablePaint._values[e].value;return S.isDataDriven()||_||m||this._handleOverridablePaintPropertyUpdate(e,w,S)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,o,l){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,o){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,o)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),J(e,(o,l)=>!(o===void 0||l==="layout"&&!Object.keys(o).length||l==="paint"&&!Object.keys(o).length))}_validate(e,o,l,d,m={}){return(!m||m.validate!==!1)&&qo(this,e.call(ha,{key:o,layerType:this.type,objectKey:l,value:d,styleSpec:Le,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const o=this.paint.get(e);if(o instanceof Wo&&wn(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const id={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Va{constructor(e,o){this._structArray=e,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class or{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,o){return e._trim(),o&&(e.isTransferred=!0,o.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const o=Object.create(this.prototype);return o.arrayBuffer=e.arrayBuffer,o.length=e.length,o.capacity=e.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function gr(r,e=1){let o=0,l=0;return{members:r.map(d=>{const m=id[d.type].BYTES_PER_ELEMENT,_=o=Cc(o,Math.max(e,m)),w=d.components||1;return l=Math.max(l,m),o+=m*w,{name:d.name,type:d.type,components:w,offset:_}}),size:Cc(o,Math.max(l,e)),alignment:e}}function Cc(r,e){return Math.ceil(r/e)*e}class ss extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,o)}emplace(e,o,l){const d=2*e;return this.int16[d+0]=o,this.int16[d+1]=l,e}}ss.prototype.bytesPerElement=4,lt("StructArrayLayout2i4",ss);class h extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,o,l,d)}emplace(e,o,l,d,m){const _=4*e;return this.int16[_+0]=o,this.int16[_+1]=l,this.int16[_+2]=d,this.int16[_+3]=m,e}}h.prototype.bytesPerElement=8,lt("StructArrayLayout4i8",h);class n extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,d,m,_){const w=this.length;return this.resize(w+1),this.emplace(w,e,o,l,d,m,_)}emplace(e,o,l,d,m,_,w){const S=6*e;return this.int16[S+0]=o,this.int16[S+1]=l,this.int16[S+2]=d,this.int16[S+3]=m,this.int16[S+4]=_,this.int16[S+5]=w,e}}n.prototype.bytesPerElement=12,lt("StructArrayLayout2i4i12",n);class a extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,d,m,_){const w=this.length;return this.resize(w+1),this.emplace(w,e,o,l,d,m,_)}emplace(e,o,l,d,m,_,w){const S=4*e,I=8*e;return this.int16[S+0]=o,this.int16[S+1]=l,this.uint8[I+4]=d,this.uint8[I+5]=m,this.uint8[I+6]=_,this.uint8[I+7]=w,e}}a.prototype.bytesPerElement=8,lt("StructArrayLayout2i4ub8",a);class c extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,o)}emplace(e,o,l){const d=2*e;return this.float32[d+0]=o,this.float32[d+1]=l,e}}c.prototype.bytesPerElement=8,lt("StructArrayLayout2f8",c);class p extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,d,m,_,w,S,I,M){const L=this.length;return this.resize(L+1),this.emplace(L,e,o,l,d,m,_,w,S,I,M)}emplace(e,o,l,d,m,_,w,S,I,M,L){const O=10*e;return this.uint16[O+0]=o,this.uint16[O+1]=l,this.uint16[O+2]=d,this.uint16[O+3]=m,this.uint16[O+4]=_,this.uint16[O+5]=w,this.uint16[O+6]=S,this.uint16[O+7]=I,this.uint16[O+8]=M,this.uint16[O+9]=L,e}}p.prototype.bytesPerElement=20,lt("StructArrayLayout10ui20",p);class g extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,d,m,_,w,S,I,M,L,O){const U=this.length;return this.resize(U+1),this.emplace(U,e,o,l,d,m,_,w,S,I,M,L,O)}emplace(e,o,l,d,m,_,w,S,I,M,L,O,U){const V=12*e;return this.int16[V+0]=o,this.int16[V+1]=l,this.int16[V+2]=d,this.int16[V+3]=m,this.uint16[V+4]=_,this.uint16[V+5]=w,this.uint16[V+6]=S,this.uint16[V+7]=I,this.int16[V+8]=M,this.int16[V+9]=L,this.int16[V+10]=O,this.int16[V+11]=U,e}}g.prototype.bytesPerElement=24,lt("StructArrayLayout4i4ui4i24",g);class b extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,o,l)}emplace(e,o,l,d){const m=3*e;return this.float32[m+0]=o,this.float32[m+1]=l,this.float32[m+2]=d,e}}b.prototype.bytesPerElement=12,lt("StructArrayLayout3f12",b);class E extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint32[1*e+0]=o,e}}E.prototype.bytesPerElement=4,lt("StructArrayLayout1ul4",E);class k extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,d,m,_,w,S,I){const M=this.length;return this.resize(M+1),this.emplace(M,e,o,l,d,m,_,w,S,I)}emplace(e,o,l,d,m,_,w,S,I,M){const L=10*e,O=5*e;return this.int16[L+0]=o,this.int16[L+1]=l,this.int16[L+2]=d,this.int16[L+3]=m,this.int16[L+4]=_,this.int16[L+5]=w,this.uint32[O+3]=S,this.uint16[L+8]=I,this.uint16[L+9]=M,e}}k.prototype.bytesPerElement=20,lt("StructArrayLayout6i1ul2ui20",k);class P extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,d,m,_){const w=this.length;return this.resize(w+1),this.emplace(w,e,o,l,d,m,_)}emplace(e,o,l,d,m,_,w){const S=6*e;return this.int16[S+0]=o,this.int16[S+1]=l,this.int16[S+2]=d,this.int16[S+3]=m,this.int16[S+4]=_,this.int16[S+5]=w,e}}P.prototype.bytesPerElement=12,lt("StructArrayLayout2i2i2i12",P);class z extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,d,m){const _=this.length;return this.resize(_+1),this.emplace(_,e,o,l,d,m)}emplace(e,o,l,d,m,_){const w=4*e,S=8*e;return this.float32[w+0]=o,this.float32[w+1]=l,this.float32[w+2]=d,this.int16[S+6]=m,this.int16[S+7]=_,e}}z.prototype.bytesPerElement=16,lt("StructArrayLayout2f1f2i16",z);class R extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,o,l,d)}emplace(e,o,l,d,m){const _=12*e,w=3*e;return this.uint8[_+0]=o,this.uint8[_+1]=l,this.float32[w+1]=d,this.float32[w+2]=m,e}}R.prototype.bytesPerElement=12,lt("StructArrayLayout2ub2f12",R);class N extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,o,l)}emplace(e,o,l,d){const m=3*e;return this.uint16[m+0]=o,this.uint16[m+1]=l,this.uint16[m+2]=d,e}}N.prototype.bytesPerElement=6,lt("StructArrayLayout3ui6",N);class X extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,d,m,_,w,S,I,M,L,O,U,V,te,K,me){const Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,e,o,l,d,m,_,w,S,I,M,L,O,U,V,te,K,me)}emplace(e,o,l,d,m,_,w,S,I,M,L,O,U,V,te,K,me,Ee){const pe=24*e,be=12*e,Be=48*e;return this.int16[pe+0]=o,this.int16[pe+1]=l,this.uint16[pe+2]=d,this.uint16[pe+3]=m,this.uint32[be+2]=_,this.uint32[be+3]=w,this.uint32[be+4]=S,this.uint16[pe+10]=I,this.uint16[pe+11]=M,this.uint16[pe+12]=L,this.float32[be+7]=O,this.float32[be+8]=U,this.uint8[Be+36]=V,this.uint8[Be+37]=te,this.uint8[Be+38]=K,this.uint32[be+10]=me,this.int16[pe+22]=Ee,e}}X.prototype.bytesPerElement=48,lt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",X);class Z extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,d,m,_,w,S,I,M,L,O,U,V,te,K,me,Ee,pe,be,Be,Oe,ft,vt,ut,rt,Ke,ct){const st=this.length;return this.resize(st+1),this.emplace(st,e,o,l,d,m,_,w,S,I,M,L,O,U,V,te,K,me,Ee,pe,be,Be,Oe,ft,vt,ut,rt,Ke,ct)}emplace(e,o,l,d,m,_,w,S,I,M,L,O,U,V,te,K,me,Ee,pe,be,Be,Oe,ft,vt,ut,rt,Ke,ct,st){const qe=34*e,It=17*e;return this.int16[qe+0]=o,this.int16[qe+1]=l,this.int16[qe+2]=d,this.int16[qe+3]=m,this.int16[qe+4]=_,this.int16[qe+5]=w,this.int16[qe+6]=S,this.int16[qe+7]=I,this.uint16[qe+8]=M,this.uint16[qe+9]=L,this.uint16[qe+10]=O,this.uint16[qe+11]=U,this.uint16[qe+12]=V,this.uint16[qe+13]=te,this.uint16[qe+14]=K,this.uint16[qe+15]=me,this.uint16[qe+16]=Ee,this.uint16[qe+17]=pe,this.uint16[qe+18]=be,this.uint16[qe+19]=Be,this.uint16[qe+20]=Oe,this.uint16[qe+21]=ft,this.uint16[qe+22]=vt,this.uint32[It+12]=ut,this.float32[It+13]=rt,this.float32[It+14]=Ke,this.float32[It+15]=ct,this.float32[It+16]=st,e}}Z.prototype.bytesPerElement=68,lt("StructArrayLayout8i15ui1ul4f68",Z);class H extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.float32[1*e+0]=o,e}}H.prototype.bytesPerElement=4,lt("StructArrayLayout1f4",H);class le extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,o,l)}emplace(e,o,l,d){const m=3*e;return this.int16[m+0]=o,this.int16[m+1]=l,this.int16[m+2]=d,e}}le.prototype.bytesPerElement=6,lt("StructArrayLayout3i6",le);class de extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,o,l)}emplace(e,o,l,d){const m=4*e;return this.uint32[2*e+0]=o,this.uint16[m+2]=l,this.uint16[m+3]=d,e}}de.prototype.bytesPerElement=8,lt("StructArrayLayout1ul2ui8",de);class ye extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,o)}emplace(e,o,l){const d=2*e;return this.uint16[d+0]=o,this.uint16[d+1]=l,e}}ye.prototype.bytesPerElement=4,lt("StructArrayLayout2ui4",ye);class Y extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint16[1*e+0]=o,e}}Y.prototype.bytesPerElement=2,lt("StructArrayLayout1ui2",Y);class Se extends or{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,o,l,d)}emplace(e,o,l,d,m){const _=4*e;return this.float32[_+0]=o,this.float32[_+1]=l,this.float32[_+2]=d,this.float32[_+3]=m,e}}Se.prototype.bytesPerElement=16,lt("StructArrayLayout4f16",Se);class ve extends Va{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new mt(this.anchorPointX,this.anchorPointY)}}ve.prototype.size=20;class De extends k{get(e){return new ve(this,e)}}lt("CollisionBoxArray",De);class Re extends Va{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Re.prototype.size=48;class $e extends X{get(e){return new Re(this,e)}}lt("PlacedSymbolArray",$e);class Pe extends Va{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Pe.prototype.size=68;class ht extends Z{get(e){return new Pe(this,e)}}lt("SymbolInstanceArray",ht);class nt extends H{getoffsetX(e){return this.float32[1*e+0]}}lt("GlyphOffsetArray",nt);class pt extends le{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}lt("SymbolLineVertexArray",pt);class Vt extends Va{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Vt.prototype.size=8;class Wt extends de{get(e){return new Vt(this,e)}}lt("FeatureIndexArray",Wt);class Ct extends ss{}class En extends ss{}class Tn extends ss{}class un extends n{}class cn extends a{}class Cn extends c{}class Lr extends p{}class Xo extends g{}class Co extends b{}class Yo extends E{}class $a extends P{}class ao extends R{}class Ai extends N{}class da extends ye{}const Tu=gr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Sr}=Tu;class Kt{constructor(e=[]){this.segments=e}prepareSegment(e,o,l,d){let m=this.segments[this.segments.length-1];return e>Kt.MAX_VERTEX_ARRAY_LENGTH&&ze(`Max vertices per segment is ${Kt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!m||m.vertexLength+e>Kt.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==d)&&(m={vertexOffset:o.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},d!==void 0&&(m.sortKey=d),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const e of this.segments)for(const o in e.vaos)e.vaos[o].destroy()}static simpleSegment(e,o,l,d){return new Kt([{vertexOffset:e,primitiveOffset:o,vertexLength:l,primitiveLength:d,vaos:{},sortKey:0}])}}function bn(r,e){return 256*(r=G(Math.floor(r),0,255))+G(Math.floor(e),0,255)}Kt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,lt("SegmentVector",Kt);const Dr=gr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Rr={exports:{}},qn={exports:{}};qn.exports=function(r,e){var o,l,d,m,_,w,S,I;for(l=r.length-(o=3&r.length),d=e,_=3432918353,w=461845907,I=0;I<l;)S=255&r.charCodeAt(I)|(255&r.charCodeAt(++I))<<8|(255&r.charCodeAt(++I))<<16|(255&r.charCodeAt(++I))<<24,++I,d=27492+(65535&(m=5*(65535&(d=(d^=S=(65535&(S=(S=(65535&S)*_+(((S>>>16)*_&65535)<<16)&4294967295)<<15|S>>>17))*w+(((S>>>16)*w&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(S=0,o){case 3:S^=(255&r.charCodeAt(I+2))<<16;case 2:S^=(255&r.charCodeAt(I+1))<<8;case 1:d^=S=(65535&(S=(S=(65535&(S^=255&r.charCodeAt(I)))*_+(((S>>>16)*_&65535)<<16)&4294967295)<<15|S>>>17))*w+(((S>>>16)*w&65535)<<16)&4294967295}return d^=r.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0};var so={exports:{}};so.exports=function(r,e){for(var o,l=r.length,d=e^l,m=0;l>=4;)o=1540483477*(65535&(o=255&r.charCodeAt(m)|(255&r.charCodeAt(++m))<<8|(255&r.charCodeAt(++m))<<16|(255&r.charCodeAt(++m))<<24))+((1540483477*(o>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),l-=4,++m;switch(l){case 3:d^=(255&r.charCodeAt(m+2))<<16;case 2:d^=(255&r.charCodeAt(m+1))<<8;case 1:d=1540483477*(65535&(d^=255&r.charCodeAt(m)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};var ls=qn.exports,Ic=so.exports;Rr.exports=ls,Rr.exports.murmur3=ls,Rr.exports.murmur2=Ic;class Zs{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,o,l,d){this.ids.push(od(e)),this.positions.push(o,l,d)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=od(e);let l=0,d=this.ids.length-1;for(;l<d;){const _=l+d>>1;this.ids[_]>=o?d=_:l=_+1}const m=[];for(;this.ids[l]===o;)m.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return m}static serialize(e,o){const l=new Float64Array(e.ids),d=new Uint32Array(e.positions);return Pc(l,d,0,l.length-1),o&&o.push(l.buffer,d.buffer),{ids:l,positions:d}}static deserialize(e){const o=new Zs;return o.ids=e.ids,o.positions=e.positions,o.indexed=!0,o}}function od(r){const e=+r;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Rr.exports(String(r))}function Pc(r,e,o,l){for(;o<l;){const d=r[o+l>>1];let m=o-1,_=l+1;for(;;){do m++;while(r[m]<d);do _--;while(r[_]>d);if(m>=_)break;ja(r,m,_),ja(e,3*m,3*_),ja(e,3*m+1,3*_+1),ja(e,3*m+2,3*_+2)}_-o<l-_?(Pc(r,e,o,_),o=_+1):(Pc(r,e,_+1,l),l=_)}}function ja(r,e,o){const l=r[e];r[e]=r[o],r[o]=l}lt("FeaturePositionMap",Zs);class us{constructor(e,o){this.gl=e.gl,this.location=o}}class cs extends us{constructor(e,o){super(e,o),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class ku extends us{constructor(e,o){super(e,o),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Jy extends us{constructor(e,o){super(e,o),this.current=j.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Qb=new Float32Array(16);function vf(r){return[bn(255*r.r,255*r.g),bn(255*r.b,255*r.a)]}class Ac{constructor(e,o,l){this.value=e,this.uniformNames=o.map(d=>`u_${d}`),this.type=l}setUniform(e,o,l){e.set(l.constantOr(this.value))}getBinding(e,o,l){return this.type==="color"?new Jy(e,o):new cs(e,o)}}class Cu{constructor(e,o){this.uniformNames=o.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=e.tlbr}setUniform(e,o,l,d){const m=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&e.set(m)}getBinding(e,o,l){return l.substr(0,9)==="u_pattern"?new ku(e,o):new cs(e,o)}}class hs{constructor(e,o,l,d){this.expression=e,this.type=l,this.maxValue=0,this.paintVertexAttributes=o.map(m=>({name:`a_${m}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(e,o,l,d,m){const _=this.paintVertexArray.length,w=this.expression.evaluate(new Gn(0),o,{},d,[],m);this.paintVertexArray.resize(e),this._setPaintValue(_,e,w)}updatePaintArray(e,o,l,d){const m=this.expression.evaluate({zoom:0},l,d);this._setPaintValue(e,o,m)}_setPaintValue(e,o,l){if(this.type==="color"){const d=vf(l);for(let m=e;m<o;m++)this.paintVertexArray.emplace(m,d[0],d[1])}else{for(let d=e;d<o;d++)this.paintVertexArray.emplace(d,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class pa{constructor(e,o,l,d,m,_){this.expression=e,this.uniformNames=o.map(w=>`u_${w}_t`),this.type=l,this.useIntegerZoom=d,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=o.map(w=>({name:`a_${w}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(e,o,l,d,m){const _=this.expression.evaluate(new Gn(this.zoom),o,{},d,[],m),w=this.expression.evaluate(new Gn(this.zoom+1),o,{},d,[],m),S=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(S,e,_,w)}updatePaintArray(e,o,l,d){const m=this.expression.evaluate({zoom:this.zoom},l,d),_=this.expression.evaluate({zoom:this.zoom+1},l,d);this._setPaintValue(e,o,m,_)}_setPaintValue(e,o,l,d){if(this.type==="color"){const m=vf(l),_=vf(d);for(let w=e;w<o;w++)this.paintVertexArray.emplace(w,m[0],m[1],_[0],_[1])}else{for(let m=e;m<o;m++)this.paintVertexArray.emplace(m,l,d);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(d))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,o){const l=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,d=G(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);e.set(d)}getBinding(e,o,l){return new cs(e,o)}}class Ws{constructor(e,o,l,d,m,_){this.expression=e,this.type=o,this.useIntegerZoom=l,this.zoom=d,this.layerId=_,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(e,o,l){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(d,e,o.patterns&&o.patterns[this.layerId],l)}updatePaintArray(e,o,l,d,m){this._setPaintValues(e,o,l.patterns&&l.patterns[this.layerId],m)}_setPaintValues(e,o,l,d){if(!d||!l)return;const{min:m,mid:_,max:w}=l,S=d[m],I=d[_],M=d[w];if(S&&I&&M)for(let L=e;L<o;L++)this.zoomInPaintVertexArray.emplace(L,I.tl[0],I.tl[1],I.br[0],I.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],I.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(L,I.tl[0],I.tl[1],I.br[0],I.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],I.pixelRatio,M.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Dr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Dr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Qy{constructor(e,o,l){this.binders={},this._buffers=[];const d=[];for(const m in e.paint._values){if(!l(m))continue;const _=e.paint.get(m);if(!(_ instanceof Wo&&wn(_.property.specification)))continue;const w=ew(m,e.type),S=_.value,I=_.property.specification.type,M=_.property.useIntegerZoom,L=_.property.specification["property-type"],O=L==="cross-faded"||L==="cross-faded-data-driven";if(S.kind==="constant")this.binders[m]=O?new Cu(S.value,w):new Ac(S.value,w,I),d.push(`/u_${m}`);else if(S.kind==="source"||O){const U=e_(m,I,"source");this.binders[m]=O?new Ws(S,I,M,o,U,e.id):new hs(S,w,I,U),d.push(`/a_${m}`)}else{const U=e_(m,I,"composite");this.binders[m]=new pa(S,w,I,M,o,U),d.push(`/z_${m}`)}}this.cacheKey=d.sort().join("")}getMaxValue(e){const o=this.binders[e];return o instanceof hs||o instanceof pa?o.maxValue:0}populatePaintArrays(e,o,l,d,m){for(const _ in this.binders){const w=this.binders[_];(w instanceof hs||w instanceof pa||w instanceof Ws)&&w.populatePaintArray(e,o,l,d,m)}}setConstantPatternPositions(e,o){for(const l in this.binders){const d=this.binders[l];d instanceof Cu&&d.setConstantPatternPositions(e,o)}}updatePaintArrays(e,o,l,d,m){let _=!1;for(const w in e){const S=o.getPositions(w);for(const I of S){const M=l.feature(I.index);for(const L in this.binders){const O=this.binders[L];if((O instanceof hs||O instanceof pa||O instanceof Ws)&&O.expression.isStateDependent===!0){const U=d.paint.get(L);O.expression=U.value,O.updatePaintArray(I.start,I.end,M,e[w],m),_=!0}}}}return _}defines(){const e=[];for(const o in this.binders){const l=this.binders[o];(l instanceof Ac||l instanceof Cu)&&e.push(...l.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return e}getBinderAttributes(){const e=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof hs||l instanceof pa)for(let d=0;d<l.paintVertexAttributes.length;d++)e.push(l.paintVertexAttributes[d].name);else if(l instanceof Ws)for(let d=0;d<Dr.members.length;d++)e.push(Dr.members[d].name)}return e}getBinderUniforms(){const e=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof Ac||l instanceof Cu||l instanceof pa)for(const d of l.uniformNames)e.push(d)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,o){const l=[];for(const d in this.binders){const m=this.binders[d];if(m instanceof Ac||m instanceof Cu||m instanceof pa){for(const _ of m.uniformNames)if(o[_]){const w=m.getBinding(e,o[_],_);l.push({name:_,property:d,binding:w})}}}return l}setUniforms(e,o,l,d){for(const{name:m,property:_,binding:w}of o)this.binders[_].setUniform(w,d,l.get(_),m)}updatePaintBuffers(e){this._buffers=[];for(const o in this.binders){const l=this.binders[o];if(e&&l instanceof Ws){const d=e.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(l instanceof hs||l instanceof pa)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(e){for(const o in this.binders){const l=this.binders[o];(l instanceof hs||l instanceof pa||l instanceof Ws)&&l.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const o=this.binders[e];(o instanceof hs||o instanceof pa||o instanceof Ws)&&o.destroy()}}}class Gl{constructor(e,o,l=()=>!0){this.programConfigurations={};for(const d of e)this.programConfigurations[d.id]=new Qy(d,o,l);this.needsUpload=!1,this._featureMap=new Zs,this._bufferOffset=0}populatePaintArrays(e,o,l,d,m,_){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(e,o,d,m,_);o.id!==void 0&&this._featureMap.add(o.id,l,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,o,l,d){for(const m of l)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,o,m,d)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function ew(r,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${e}-`,"").replace(/-/g,"_")]}function e_(r,e,o){const l={color:{source:c,composite:Se},number:{source:H,composite:c}},d=function(m){return{"line-pattern":{source:Lr,composite:Lr},"fill-pattern":{source:Lr,composite:Lr},"fill-extrusion-pattern":{source:Lr,composite:Lr}}[m]}(r);return d&&d[o]||l[e][o]}lt("ConstantBinder",Ac),lt("CrossFadedConstantBinder",Cu),lt("SourceExpressionBinder",hs),lt("CrossFadedCompositeBinder",Ws),lt("CompositeExpressionBinder",pa),lt("ProgramConfiguration",Qy,{omit:["_buffers"]}),lt("ProgramConfigurationSet",Gl);var Er=8192;const xf=Math.pow(2,14)-1,t_=-xf-1;function ql(r){const e=Er/r.extent,o=r.loadGeometry();for(let l=0;l<o.length;l++){const d=o[l];for(let m=0;m<d.length;m++){const _=d[m],w=Math.round(_.x*e),S=Math.round(_.y*e);_.x=G(w,t_,xf),_.y=G(S,t_,xf),(w<_.x||w>_.x+1||S<_.y||S>_.y+1)&&ze("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function Zl(r,e){return{type:r.type,id:r.id,properties:r.properties,geometry:e?ql(r):[]}}function ad(r,e,o,l,d){r.emplaceBack(2*e+(l+1)/2,2*o+(d+1)/2)}class bf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new En,this.indexArray=new Ai,this.segments=new Kt,this.programConfigurations=new Gl(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,l){const d=this.layers[0],m=[];let _=null,w=!1;d.type==="circle"&&(_=d.layout.get("circle-sort-key"),w=!_.isConstant());for(const{feature:S,id:I,index:M,sourceLayerIndex:L}of e){const O=this.layers[0]._featureFilter.needGeometry,U=Zl(S,O);if(!this.layers[0]._featureFilter.filter(new Gn(this.zoom),U,l))continue;const V=w?_.evaluate(U,{},l):void 0,te={id:I,properties:S.properties,type:S.type,sourceLayerIndex:L,index:M,geometry:O?U.geometry:ql(S),patterns:{},sortKey:V};m.push(te)}w&&m.sort((S,I)=>S.sortKey-I.sortKey);for(const S of m){const{geometry:I,index:M,sourceLayerIndex:L}=S,O=e[M].feature;this.addFeature(S,I,M,l),o.featureIndex.insert(O,I,M,L,this.index)}}update(e,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Sr),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,o,l,d){for(const m of o)for(const _ of m){const w=_.x,S=_.y;if(w<0||w>=Er||S<0||S>=Er)continue;const I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),M=I.vertexLength;ad(this.layoutVertexArray,w,S,-1,-1),ad(this.layoutVertexArray,w,S,1,-1),ad(this.layoutVertexArray,w,S,1,1),ad(this.layoutVertexArray,w,S,-1,1),this.indexArray.emplaceBack(M,M+1,M+2),this.indexArray.emplaceBack(M,M+3,M+2),I.vertexLength+=4,I.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,{},d)}}function n_(r,e){for(let o=0;o<r.length;o++)if(Iu(e,r[o]))return!0;for(let o=0;o<e.length;o++)if(Iu(r,e[o]))return!0;return!!wf(r,e)}function tw(r,e,o){return!!Iu(r,e)||!!Sf(e,r,o)}function r_(r,e){if(r.length===1)return o_(e,r[0]);for(let o=0;o<e.length;o++){const l=e[o];for(let d=0;d<l.length;d++)if(Iu(r,l[d]))return!0}for(let o=0;o<r.length;o++)if(o_(e,r[o]))return!0;for(let o=0;o<e.length;o++)if(wf(r,e[o]))return!0;return!1}function nw(r,e,o){if(r.length>1){if(wf(r,e))return!0;for(let l=0;l<e.length;l++)if(Sf(e[l],r,o))return!0}for(let l=0;l<r.length;l++)if(Sf(r[l],e,o))return!0;return!1}function wf(r,e){if(r.length===0||e.length===0)return!1;for(let o=0;o<r.length-1;o++){const l=r[o],d=r[o+1];for(let m=0;m<e.length-1;m++)if(rw(l,d,e[m],e[m+1]))return!0}return!1}function rw(r,e,o,l){return He(r,o,l)!==He(e,o,l)&&He(r,e,o)!==He(r,e,l)}function Sf(r,e,o){const l=o*o;if(e.length===1)return r.distSqr(e[0])<l;for(let d=1;d<e.length;d++)if(i_(r,e[d-1],e[d])<l)return!0;return!1}function i_(r,e,o){const l=e.distSqr(o);if(l===0)return r.distSqr(e);const d=((r.x-e.x)*(o.x-e.x)+(r.y-e.y)*(o.y-e.y))/l;return r.distSqr(d<0?e:d>1?o:o.sub(e)._mult(d)._add(e))}function o_(r,e){let o,l,d,m=!1;for(let _=0;_<r.length;_++){o=r[_];for(let w=0,S=o.length-1;w<o.length;S=w++)l=o[w],d=o[S],l.y>e.y!=d.y>e.y&&e.x<(d.x-l.x)*(e.y-l.y)/(d.y-l.y)+l.x&&(m=!m)}return m}function Iu(r,e){let o=!1;for(let l=0,d=r.length-1;l<r.length;d=l++){const m=r[l],_=r[d];m.y>e.y!=_.y>e.y&&e.x<(_.x-m.x)*(e.y-m.y)/(_.y-m.y)+m.x&&(o=!o)}return o}function iw(r,e,o){const l=o[0],d=o[2];if(r.x<l.x&&e.x<l.x||r.x>d.x&&e.x>d.x||r.y<l.y&&e.y<l.y||r.y>d.y&&e.y>d.y)return!1;const m=He(r,e,o[0]);return m!==He(r,e,o[1])||m!==He(r,e,o[2])||m!==He(r,e,o[3])}function Mc(r,e,o){const l=e.paint.get(r).value;return l.kind==="constant"?l.value:o.programConfigurations.get(e.id).getMaxValue(r)}function sd(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function ld(r,e,o,l,d){if(!e[0]&&!e[1])return r;const m=mt.convert(e)._mult(d);o==="viewport"&&m._rotate(-l);const _=[];for(let w=0;w<r.length;w++)_.push(r[w].sub(m));return _}lt("CircleBucket",bf,{omit:["layers"]});const ow=new qr({"circle-sort-key":new Lt(Le.layout_circle["circle-sort-key"])});var aw={paint:new qr({"circle-radius":new Lt(Le.paint_circle["circle-radius"]),"circle-color":new Lt(Le.paint_circle["circle-color"]),"circle-blur":new Lt(Le.paint_circle["circle-blur"]),"circle-opacity":new Lt(Le.paint_circle["circle-opacity"]),"circle-translate":new bt(Le.paint_circle["circle-translate"]),"circle-translate-anchor":new bt(Le.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new bt(Le.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new bt(Le.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Lt(Le.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Lt(Le.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Lt(Le.paint_circle["circle-stroke-opacity"])}),layout:ow},Mi=1e-6,zi=typeof Float32Array<"u"?Float32Array:Array;function a_(){var r=new zi(9);return zi!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function Ef(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function s_(r,e,o){var l=e[0],d=e[1],m=e[2],_=e[3],w=e[4],S=e[5],I=e[6],M=e[7],L=e[8],O=e[9],U=e[10],V=e[11],te=e[12],K=e[13],me=e[14],Ee=e[15],pe=o[0],be=o[1],Be=o[2],Oe=o[3];return r[0]=pe*l+be*w+Be*L+Oe*te,r[1]=pe*d+be*S+Be*O+Oe*K,r[2]=pe*m+be*I+Be*U+Oe*me,r[3]=pe*_+be*M+Be*V+Oe*Ee,r[4]=(pe=o[4])*l+(be=o[5])*w+(Be=o[6])*L+(Oe=o[7])*te,r[5]=pe*d+be*S+Be*O+Oe*K,r[6]=pe*m+be*I+Be*U+Oe*me,r[7]=pe*_+be*M+Be*V+Oe*Ee,r[8]=(pe=o[8])*l+(be=o[9])*w+(Be=o[10])*L+(Oe=o[11])*te,r[9]=pe*d+be*S+Be*O+Oe*K,r[10]=pe*m+be*I+Be*U+Oe*me,r[11]=pe*_+be*M+Be*V+Oe*Ee,r[12]=(pe=o[12])*l+(be=o[13])*w+(Be=o[14])*L+(Oe=o[15])*te,r[13]=pe*d+be*S+Be*O+Oe*K,r[14]=pe*m+be*I+Be*U+Oe*me,r[15]=pe*_+be*M+Be*V+Oe*Ee,r}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var zc,sw=s_;function l_(){var r=new zi(3);return zi!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function u_(r,e,o){var l=new zi(3);return l[0]=r,l[1]=e,l[2]=o,l}function ud(r,e,o){var l=e[0],d=e[1],m=e[2],_=e[3];return r[0]=o[0]*l+o[4]*d+o[8]*m+o[12]*_,r[1]=o[1]*l+o[5]*d+o[9]*m+o[13]*_,r[2]=o[2]*l+o[6]*d+o[10]*m+o[14]*_,r[3]=o[3]*l+o[7]*d+o[11]*m+o[15]*_,r}function c_(){var r=new zi(4);return zi!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function h_(r,e){const o=ud([],[r.x,r.y,0,1],e);return new mt(o[0]/o[3],o[1]/o[3])}l_(),zc=new zi(4),zi!=Float32Array&&(zc[0]=0,zc[1]=0,zc[2]=0,zc[3]=0),l_(),u_(1,0,0),u_(0,1,0),c_(),c_(),a_(),function(){var r;r=new zi(2),zi!=Float32Array&&(r[0]=0,r[1]=0)}();class d_ extends bf{}lt("HeatmapBucket",d_,{omit:["layers"]});var lw={paint:new qr({"heatmap-radius":new Lt(Le.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Lt(Le.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new bt(Le.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Na(Le.paint_heatmap["heatmap-color"]),"heatmap-opacity":new bt(Le.paint_heatmap["heatmap-opacity"])})};function Tf(r,{width:e,height:o},l,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==e*o*l)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${e*o*l}`)}else d=new Uint8Array(e*o*l);return r.width=e,r.height=o,r.data=d,r}function p_(r,{width:e,height:o},l){if(e===r.width&&o===r.height)return;const d=Tf({},{width:e,height:o},l);kf(r,d,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,e),height:Math.min(r.height,o)},l),r.width=e,r.height=o,r.data=d.data}function kf(r,e,o,l,d,m){if(d.width===0||d.height===0)return e;if(d.width>r.width||d.height>r.height||o.x>r.width-d.width||o.y>r.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>e.width||d.height>e.height||l.x>e.width-d.width||l.y>e.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const _=r.data,w=e.data;if(_===w)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<d.height;S++){const I=((o.y+S)*r.width+o.x)*m,M=((l.y+S)*e.width+l.x)*m;for(let L=0;L<d.width*m;L++)w[M+L]=_[I+L]}return e}class Lc{constructor(e,o){Tf(this,e,1,o)}resize(e){p_(this,e,1)}clone(){return new Lc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,l,d,m){kf(e,o,l,d,m,1)}}class Io{constructor(e,o){Tf(this,e,4,o)}resize(e){p_(this,e,4)}replace(e,o){o?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Io({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,l,d,m){kf(e,o,l,d,m,4)}}function f_(r){const e={},o=r.resolution||256,l=r.clips?r.clips.length:1,d=r.image||new Io({width:o,height:l});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const m=(_,w,S)=>{e[r.evaluationKey]=S;const I=r.expression.evaluate(e);d.data[_+w+0]=Math.floor(255*I.r/I.a),d.data[_+w+1]=Math.floor(255*I.g/I.a),d.data[_+w+2]=Math.floor(255*I.b/I.a),d.data[_+w+3]=Math.floor(255*I.a)};if(r.clips)for(let _=0,w=0;_<l;++_,w+=4*o)for(let S=0,I=0;S<o;S++,I+=4){const M=S/(o-1),{start:L,end:O}=r.clips[_];m(w,I,L*(1-M)+O*M)}else for(let _=0,w=0;_<o;_++,w+=4)m(0,w,_/(o-1));return d}lt("AlphaImage",Lc),lt("RGBAImage",Io);var uw={paint:new qr({"hillshade-illumination-direction":new bt(Le.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new bt(Le.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new bt(Le.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new bt(Le.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new bt(Le.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new bt(Le.paint_hillshade["hillshade-accent-color"])})};const cw=gr([{name:"a_pos",components:2,type:"Int16"}],4),{members:hw}=cw;var cd={exports:{}};function hd(r,e,o){o=o||2;var l,d,m,_,w,S,I,M=e&&e.length,L=M?e[0]*o:r.length,O=m_(r,0,L,o,!0),U=[];if(!O||O.next===O.prev)return U;if(M&&(O=function(te,K,me,Ee){var pe,be,Be,Oe=[];for(pe=0,be=K.length;pe<be;pe++)(Be=m_(te,K[pe]*Ee,pe<be-1?K[pe+1]*Ee:te.length,Ee,!1))===Be.next&&(Be.steiner=!0),Oe.push(vw(Be));for(Oe.sort(gw),pe=0;pe<Oe.length;pe++)me=yw(Oe[pe],me);return me}(r,e,O,o)),r.length>80*o){l=m=r[0],d=_=r[1];for(var V=o;V<L;V+=o)(w=r[V])<l&&(l=w),(S=r[V+1])<d&&(d=S),w>m&&(m=w),S>_&&(_=S);I=(I=Math.max(m-l,_-d))!==0?32767/I:0}return Dc(O,U,o,l,d,I,0),U}function m_(r,e,o,l,d){var m,_;if(d===Pf(r,e,o,l)>0)for(m=e;m<o;m+=l)_=__(m,r[m],r[m+1],_);else for(m=o-l;m>=e;m-=l)_=__(m,r[m],r[m+1],_);return _&&dd(_,_.next)&&(Fc(_),_=_.next),_}function Wl(r,e){if(!r)return r;e||(e=r);var o,l=r;do if(o=!1,l.steiner||!dd(l,l.next)&&hr(l.prev,l,l.next)!==0)l=l.next;else{if(Fc(l),(l=e=l.prev)===l.next)break;o=!0}while(o||l!==e);return e}function Dc(r,e,o,l,d,m,_){if(r){!_&&m&&function(M,L,O,U){var V=M;do V.z===0&&(V.z=Cf(V.x,V.y,L,O,U)),V.prevZ=V.prev,V.nextZ=V.next,V=V.next;while(V!==M);V.prevZ.nextZ=null,V.prevZ=null,function(te){var K,me,Ee,pe,be,Be,Oe,ft,vt=1;do{for(me=te,te=null,be=null,Be=0;me;){for(Be++,Ee=me,Oe=0,K=0;K<vt&&(Oe++,Ee=Ee.nextZ);K++);for(ft=vt;Oe>0||ft>0&&Ee;)Oe!==0&&(ft===0||!Ee||me.z<=Ee.z)?(pe=me,me=me.nextZ,Oe--):(pe=Ee,Ee=Ee.nextZ,ft--),be?be.nextZ=pe:te=pe,pe.prevZ=be,be=pe;me=Ee}be.nextZ=null,vt*=2}while(Be>1)}(V)}(r,l,d,m);for(var w,S,I=r;r.prev!==r.next;)if(w=r.prev,S=r.next,m?pw(r,l,d,m):dw(r))e.push(w.i/o|0),e.push(r.i/o|0),e.push(S.i/o|0),Fc(r),r=S.next,I=S.next;else if((r=S)===I){_?_===1?Dc(r=fw(Wl(r),e,o),e,o,l,d,m,2):_===2&&mw(r,e,o,l,d,m):Dc(Wl(r),e,o,l,d,m,1);break}}}function dw(r){var e=r.prev,o=r,l=r.next;if(hr(e,o,l)>=0)return!1;for(var d=e.x,m=o.x,_=l.x,w=e.y,S=o.y,I=l.y,M=d<m?d<_?d:_:m<_?m:_,L=w<S?w<I?w:I:S<I?S:I,O=d>m?d>_?d:_:m>_?m:_,U=w>S?w>I?w:I:S>I?S:I,V=l.next;V!==e;){if(V.x>=M&&V.x<=O&&V.y>=L&&V.y<=U&&Pu(d,w,m,S,_,I,V.x,V.y)&&hr(V.prev,V,V.next)>=0)return!1;V=V.next}return!0}function pw(r,e,o,l){var d=r.prev,m=r,_=r.next;if(hr(d,m,_)>=0)return!1;for(var w=d.x,S=m.x,I=_.x,M=d.y,L=m.y,O=_.y,U=w<S?w<I?w:I:S<I?S:I,V=M<L?M<O?M:O:L<O?L:O,te=w>S?w>I?w:I:S>I?S:I,K=M>L?M>O?M:O:L>O?L:O,me=Cf(U,V,e,o,l),Ee=Cf(te,K,e,o,l),pe=r.prevZ,be=r.nextZ;pe&&pe.z>=me&&be&&be.z<=Ee;){if(pe.x>=U&&pe.x<=te&&pe.y>=V&&pe.y<=K&&pe!==d&&pe!==_&&Pu(w,M,S,L,I,O,pe.x,pe.y)&&hr(pe.prev,pe,pe.next)>=0||(pe=pe.prevZ,be.x>=U&&be.x<=te&&be.y>=V&&be.y<=K&&be!==d&&be!==_&&Pu(w,M,S,L,I,O,be.x,be.y)&&hr(be.prev,be,be.next)>=0))return!1;be=be.nextZ}for(;pe&&pe.z>=me;){if(pe.x>=U&&pe.x<=te&&pe.y>=V&&pe.y<=K&&pe!==d&&pe!==_&&Pu(w,M,S,L,I,O,pe.x,pe.y)&&hr(pe.prev,pe,pe.next)>=0)return!1;pe=pe.prevZ}for(;be&&be.z<=Ee;){if(be.x>=U&&be.x<=te&&be.y>=V&&be.y<=K&&be!==d&&be!==_&&Pu(w,M,S,L,I,O,be.x,be.y)&&hr(be.prev,be,be.next)>=0)return!1;be=be.nextZ}return!0}function fw(r,e,o){var l=r;do{var d=l.prev,m=l.next.next;!dd(d,m)&&g_(d,l,l.next,m)&&Rc(d,m)&&Rc(m,d)&&(e.push(d.i/o|0),e.push(l.i/o|0),e.push(m.i/o|0),Fc(l),Fc(l.next),l=r=m),l=l.next}while(l!==r);return Wl(l)}function mw(r,e,o,l,d,m){var _=r;do{for(var w=_.next.next;w!==_.prev;){if(_.i!==w.i&&xw(_,w)){var S=y_(_,w);return _=Wl(_,_.next),S=Wl(S,S.next),Dc(_,e,o,l,d,m,0),void Dc(S,e,o,l,d,m,0)}w=w.next}_=_.next}while(_!==r)}function gw(r,e){return r.x-e.x}function yw(r,e){var o=function(d,m){var _,w=m,S=d.x,I=d.y,M=-1/0;do{if(I<=w.y&&I>=w.next.y&&w.next.y!==w.y){var L=w.x+(I-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(L<=S&&L>M&&(M=L,_=w.x<w.next.x?w:w.next,L===S))return _}w=w.next}while(w!==m);if(!_)return null;var O,U=_,V=_.x,te=_.y,K=1/0;w=_;do S>=w.x&&w.x>=V&&S!==w.x&&Pu(I<te?S:M,I,V,te,I<te?M:S,I,w.x,w.y)&&(O=Math.abs(I-w.y)/(S-w.x),Rc(w,d)&&(O<K||O===K&&(w.x>_.x||w.x===_.x&&_w(_,w)))&&(_=w,K=O)),w=w.next;while(w!==U);return _}(r,e);if(!o)return e;var l=y_(o,r);return Wl(l,l.next),Wl(o,o.next)}function _w(r,e){return hr(r.prev,r,e.prev)<0&&hr(e.next,r,r.next)<0}function Cf(r,e,o,l,d){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-o)*d|0)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-l)*d|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function vw(r){var e=r,o=r;do(e.x<o.x||e.x===o.x&&e.y<o.y)&&(o=e),e=e.next;while(e!==r);return o}function Pu(r,e,o,l,d,m,_,w){return(d-_)*(e-w)>=(r-_)*(m-w)&&(r-_)*(l-w)>=(o-_)*(e-w)&&(o-_)*(m-w)>=(d-_)*(l-w)}function xw(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!function(o,l){var d=o;do{if(d.i!==o.i&&d.next.i!==o.i&&d.i!==l.i&&d.next.i!==l.i&&g_(d,d.next,o,l))return!0;d=d.next}while(d!==o);return!1}(r,e)&&(Rc(r,e)&&Rc(e,r)&&function(o,l){var d=o,m=!1,_=(o.x+l.x)/2,w=(o.y+l.y)/2;do d.y>w!=d.next.y>w&&d.next.y!==d.y&&_<(d.next.x-d.x)*(w-d.y)/(d.next.y-d.y)+d.x&&(m=!m),d=d.next;while(d!==o);return m}(r,e)&&(hr(r.prev,r,e.prev)||hr(r,e.prev,e))||dd(r,e)&&hr(r.prev,r,r.next)>0&&hr(e.prev,e,e.next)>0)}function hr(r,e,o){return(e.y-r.y)*(o.x-e.x)-(e.x-r.x)*(o.y-e.y)}function dd(r,e){return r.x===e.x&&r.y===e.y}function g_(r,e,o,l){var d=fd(hr(r,e,o)),m=fd(hr(r,e,l)),_=fd(hr(o,l,r)),w=fd(hr(o,l,e));return d!==m&&_!==w||!(d!==0||!pd(r,o,e))||!(m!==0||!pd(r,l,e))||!(_!==0||!pd(o,r,l))||!(w!==0||!pd(o,e,l))}function pd(r,e,o){return e.x<=Math.max(r.x,o.x)&&e.x>=Math.min(r.x,o.x)&&e.y<=Math.max(r.y,o.y)&&e.y>=Math.min(r.y,o.y)}function fd(r){return r>0?1:r<0?-1:0}function Rc(r,e){return hr(r.prev,r,r.next)<0?hr(r,e,r.next)>=0&&hr(r,r.prev,e)>=0:hr(r,e,r.prev)<0||hr(r,r.next,e)<0}function y_(r,e){var o=new If(r.i,r.x,r.y),l=new If(e.i,e.x,e.y),d=r.next,m=e.prev;return r.next=e,e.prev=r,o.next=d,d.prev=o,l.next=o,o.prev=l,m.next=l,l.prev=m,l}function __(r,e,o,l){var d=new If(r,e,o);return l?(d.next=l.next,d.prev=l,l.next.prev=d,l.next=d):(d.prev=d,d.next=d),d}function Fc(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function If(r,e,o){this.i=r,this.x=e,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Pf(r,e,o,l){for(var d=0,m=e,_=o-l;m<o;m+=l)d+=(r[_]-r[m])*(r[m+1]+r[_+1]),_=m;return d}function bw(r,e,o,l,d){v_(r,e,o||0,l||r.length-1,d||ww)}function v_(r,e,o,l,d){for(;l>o;){if(l-o>600){var m=l-o+1,_=e-o+1,w=Math.log(m),S=.5*Math.exp(2*w/3),I=.5*Math.sqrt(w*S*(m-S)/m)*(_-m/2<0?-1:1);v_(r,e,Math.max(o,Math.floor(e-_*S/m+I)),Math.min(l,Math.floor(e+(m-_)*S/m+I)),d)}var M=r[e],L=o,O=l;for(Oc(r,o,e),d(r[l],M)>0&&Oc(r,o,l);L<O;){for(Oc(r,L,O),L++,O--;d(r[L],M)<0;)L++;for(;d(r[O],M)>0;)O--}d(r[o],M)===0?Oc(r,o,O):Oc(r,++O,l),O<=e&&(o=O+1),e<=O&&(l=O-1)}}function Oc(r,e,o){var l=r[e];r[e]=r[o],r[o]=l}function ww(r,e){return r<e?-1:r>e?1:0}function Af(r,e){const o=r.length;if(o<=1)return[r];const l=[];let d,m;for(let _=0;_<o;_++){const w=it(r[_]);w!==0&&(r[_].area=Math.abs(w),m===void 0&&(m=w<0),m===w<0?(d&&l.push(d),d=[r[_]]):d.push(r[_]))}if(d&&l.push(d),e>1)for(let _=0;_<l.length;_++)l[_].length<=e||(bw(l[_],e,1,l[_].length-1,Sw),l[_]=l[_].slice(0,e));return l}function Sw(r,e){return e.area-r.area}function Mf(r,e,o){const l=o.patternDependencies;let d=!1;for(const m of e){const _=m.paint.get(`${r}-pattern`);_.isConstant()||(d=!0);const w=_.constantOr(null);w&&(d=!0,l[w.to]=!0,l[w.from]=!0)}return d}function zf(r,e,o,l,d){const m=d.patternDependencies;for(const _ of e){const w=_.paint.get(`${r}-pattern`).value;if(w.kind!=="constant"){let S=w.evaluate({zoom:l-1},o,{},d.availableImages),I=w.evaluate({zoom:l},o,{},d.availableImages),M=w.evaluate({zoom:l+1},o,{},d.availableImages);S=S&&S.name?S.name:S,I=I&&I.name?I.name:I,M=M&&M.name?M.name:M,m[S]=!0,m[I]=!0,m[M]=!0,o.patterns[_.id]={min:S,mid:I,max:M}}}return o}cd.exports=hd,cd.exports.default=hd,hd.deviation=function(r,e,o,l){var d=e&&e.length,m=Math.abs(Pf(r,0,d?e[0]*o:r.length,o));if(d)for(var _=0,w=e.length;_<w;_++)m-=Math.abs(Pf(r,e[_]*o,_<w-1?e[_+1]*o:r.length,o));var S=0;for(_=0;_<l.length;_+=3){var I=l[_]*o,M=l[_+1]*o,L=l[_+2]*o;S+=Math.abs((r[I]-r[L])*(r[M+1]-r[I+1])-(r[I]-r[M])*(r[L+1]-r[I+1]))}return m===0&&S===0?0:Math.abs((S-m)/m)},hd.flatten=function(r){for(var e=r[0][0].length,o={vertices:[],holes:[],dimensions:e},l=0,d=0;d<r.length;d++){for(var m=0;m<r[d].length;m++)for(var _=0;_<e;_++)o.vertices.push(r[d][m][_]);d>0&&o.holes.push(l+=r[d-1].length)}return o};class Lf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Tn,this.indexArray=new Ai,this.indexArray2=new da,this.programConfigurations=new Gl(e.layers,e.zoom),this.segments=new Kt,this.segments2=new Kt,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,l){this.hasPattern=Mf("fill",this.layers,o);const d=this.layers[0].layout.get("fill-sort-key"),m=!d.isConstant(),_=[];for(const{feature:w,id:S,index:I,sourceLayerIndex:M}of e){const L=this.layers[0]._featureFilter.needGeometry,O=Zl(w,L);if(!this.layers[0]._featureFilter.filter(new Gn(this.zoom),O,l))continue;const U=m?d.evaluate(O,{},l,o.availableImages):void 0,V={id:S,properties:w.properties,type:w.type,sourceLayerIndex:M,index:I,geometry:L?O.geometry:ql(w),patterns:{},sortKey:U};_.push(V)}m&&_.sort((w,S)=>w.sortKey-S.sortKey);for(const w of _){const{geometry:S,index:I,sourceLayerIndex:M}=w;if(this.hasPattern){const L=zf("fill",this.layers,w,this.zoom,o);this.patternFeatures.push(L)}else this.addFeature(w,S,I,l,{});o.featureIndex.insert(e[I].feature,S,I,M,this.index)}}update(e,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l)}addFeatures(e,o,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,o,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,hw),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,o,l,d,m){for(const _ of Af(o,500)){let w=0;for(const U of _)w+=U.length;const S=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),I=S.vertexLength,M=[],L=[];for(const U of _){if(U.length===0)continue;U!==_[0]&&L.push(M.length/2);const V=this.segments2.prepareSegment(U.length,this.layoutVertexArray,this.indexArray2),te=V.vertexLength;this.layoutVertexArray.emplaceBack(U[0].x,U[0].y),this.indexArray2.emplaceBack(te+U.length-1,te),M.push(U[0].x),M.push(U[0].y);for(let K=1;K<U.length;K++)this.layoutVertexArray.emplaceBack(U[K].x,U[K].y),this.indexArray2.emplaceBack(te+K-1,te+K),M.push(U[K].x),M.push(U[K].y);V.vertexLength+=U.length,V.primitiveLength+=U.length}const O=cd.exports(M,L);for(let U=0;U<O.length;U+=3)this.indexArray.emplaceBack(I+O[U],I+O[U+1],I+O[U+2]);S.vertexLength+=w,S.primitiveLength+=O.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,m,d)}}lt("FillBucket",Lf,{omit:["layers","patternFeatures"]});const Ew=new qr({"fill-sort-key":new Lt(Le.layout_fill["fill-sort-key"])});var Tw={paint:new qr({"fill-antialias":new bt(Le.paint_fill["fill-antialias"]),"fill-opacity":new Lt(Le.paint_fill["fill-opacity"]),"fill-color":new Lt(Le.paint_fill["fill-color"]),"fill-outline-color":new Lt(Le.paint_fill["fill-outline-color"]),"fill-translate":new bt(Le.paint_fill["fill-translate"]),"fill-translate-anchor":new bt(Le.paint_fill["fill-translate-anchor"]),"fill-pattern":new qs(Le.paint_fill["fill-pattern"])}),layout:Ew};const kw=gr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Cw=gr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Iw}=kw;var Hs={},Pw=mt,x_=Au;function Au(r,e,o,l,d){this.properties={},this.extent=o,this.type=0,this._pbf=r,this._geometry=-1,this._keys=l,this._values=d,r.readFields(Aw,this,e)}function Aw(r,e,o){r==1?e.id=o.readVarint():r==2?function(l,d){for(var m=l.readVarint()+l.pos;l.pos<m;){var _=d._keys[l.readVarint()],w=d._values[l.readVarint()];d.properties[_]=w}}(o,e):r==3?e.type=o.readVarint():r==4&&(e._geometry=o.pos)}function Mw(r){for(var e,o,l=0,d=0,m=r.length,_=m-1;d<m;_=d++)l+=((o=r[_]).x-(e=r[d]).x)*(e.y+o.y);return l}Au.types=["Unknown","Point","LineString","Polygon"],Au.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var e,o=r.readVarint()+r.pos,l=1,d=0,m=0,_=0,w=[];r.pos<o;){if(d<=0){var S=r.readVarint();l=7&S,d=S>>3}if(d--,l===1||l===2)m+=r.readSVarint(),_+=r.readSVarint(),l===1&&(e&&w.push(e),e=[]),e.push(new Pw(m,_));else{if(l!==7)throw new Error("unknown command "+l);e&&e.push(e[0].clone())}}return e&&w.push(e),w},Au.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var e=r.readVarint()+r.pos,o=1,l=0,d=0,m=0,_=1/0,w=-1/0,S=1/0,I=-1/0;r.pos<e;){if(l<=0){var M=r.readVarint();o=7&M,l=M>>3}if(l--,o===1||o===2)(d+=r.readSVarint())<_&&(_=d),d>w&&(w=d),(m+=r.readSVarint())<S&&(S=m),m>I&&(I=m);else if(o!==7)throw new Error("unknown command "+o)}return[_,S,w,I]},Au.prototype.toGeoJSON=function(r,e,o){var l,d,m=this.extent*Math.pow(2,o),_=this.extent*r,w=this.extent*e,S=this.loadGeometry(),I=Au.types[this.type];function M(U){for(var V=0;V<U.length;V++){var te=U[V];U[V]=[360*(te.x+_)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(te.y+w)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var L=[];for(l=0;l<S.length;l++)L[l]=S[l][0];M(S=L);break;case 2:for(l=0;l<S.length;l++)M(S[l]);break;case 3:for(S=function(U){var V=U.length;if(V<=1)return[U];for(var te,K,me=[],Ee=0;Ee<V;Ee++){var pe=Mw(U[Ee]);pe!==0&&(K===void 0&&(K=pe<0),K===pe<0?(te&&me.push(te),te=[U[Ee]]):te.push(U[Ee]))}return te&&me.push(te),me}(S),l=0;l<S.length;l++)for(d=0;d<S[l].length;d++)M(S[l][d])}S.length===1?S=S[0]:I="Multi"+I;var O={type:"Feature",geometry:{type:I,coordinates:S},properties:this.properties};return"id"in this&&(O.id=this.id),O};var zw=x_,b_=w_;function w_(r,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(Lw,this,e),this.length=this._features.length}function Lw(r,e,o){r===15?e.version=o.readVarint():r===1?e.name=o.readString():r===5?e.extent=o.readVarint():r===2?e._features.push(o.pos):r===3?e._keys.push(o.readString()):r===4&&e._values.push(function(l){for(var d=null,m=l.readVarint()+l.pos;l.pos<m;){var _=l.readVarint()>>3;d=_===1?l.readString():_===2?l.readFloat():_===3?l.readDouble():_===4?l.readVarint64():_===5?l.readVarint():_===6?l.readSVarint():_===7?l.readBoolean():null}return d}(o))}w_.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var e=this._pbf.readVarint()+this._pbf.pos;return new zw(this._pbf,e,this.extent,this._keys,this._values)};var Dw=b_;function Rw(r,e,o){if(r===3){var l=new Dw(o,o.readVarint()+o.pos);l.length&&(e[l.name]=l)}}Hs.VectorTile=function(r,e){this.layers=r.readFields(Rw,{},e)},Hs.VectorTileFeature=x_,Hs.VectorTileLayer=b_;const Fw=Hs.VectorTileFeature.types,Df=Math.pow(2,13);function Bc(r,e,o,l,d,m,_,w){r.emplaceBack(e,o,2*Math.floor(l*Df)+_,d*Df*2,m*Df*2,Math.round(w))}class Rf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new un,this.centroidVertexArray=new Ct,this.indexArray=new Ai,this.programConfigurations=new Gl(e.layers,e.zoom),this.segments=new Kt,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,l){this.features=[],this.hasPattern=Mf("fill-extrusion",this.layers,o);for(const{feature:d,id:m,index:_,sourceLayerIndex:w}of e){const S=this.layers[0]._featureFilter.needGeometry,I=Zl(d,S);if(!this.layers[0]._featureFilter.filter(new Gn(this.zoom),I,l))continue;const M={id:m,sourceLayerIndex:w,index:_,geometry:S?I.geometry:ql(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(zf("fill-extrusion",this.layers,M,this.zoom,o)):this.addFeature(M,M.geometry,_,l,{}),o.featureIndex.insert(d,M.geometry,_,w,this.index,!0)}}addFeatures(e,o,l){for(const d of this.features){const{geometry:m}=d;this.addFeature(d,m,d.index,o,l)}}update(e,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Iw),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Cw.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,o,l,d,m){const _={x:0,y:0,vertexCount:0};for(const w of Af(o,500)){let S=0;for(const V of w)S+=V.length;let I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const V of w){if(V.length===0||Bw(V))continue;let te=0;for(let K=0;K<V.length;K++){const me=V[K];if(K>=1){const Ee=V[K-1];if(!Ow(me,Ee)){I.vertexLength+4>Kt.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const pe=me.sub(Ee)._perp()._unit(),be=Ee.dist(me);te+be>32768&&(te=0),Bc(this.layoutVertexArray,me.x,me.y,pe.x,pe.y,0,0,te),Bc(this.layoutVertexArray,me.x,me.y,pe.x,pe.y,0,1,te),_.x+=2*me.x,_.y+=2*me.y,_.vertexCount+=2,te+=be,Bc(this.layoutVertexArray,Ee.x,Ee.y,pe.x,pe.y,0,0,te),Bc(this.layoutVertexArray,Ee.x,Ee.y,pe.x,pe.y,0,1,te),_.x+=2*Ee.x,_.y+=2*Ee.y,_.vertexCount+=2;const Be=I.vertexLength;this.indexArray.emplaceBack(Be,Be+2,Be+1),this.indexArray.emplaceBack(Be+1,Be+2,Be+3),I.vertexLength+=4,I.primitiveLength+=2}}}}if(I.vertexLength+S>Kt.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),Fw[e.type]!=="Polygon")continue;const M=[],L=[],O=I.vertexLength;for(const V of w)if(V.length!==0){V!==w[0]&&L.push(M.length/2);for(let te=0;te<V.length;te++){const K=V[te];Bc(this.layoutVertexArray,K.x,K.y,0,0,1,1,0),_.x+=K.x,_.y+=K.y,_.vertexCount+=1,M.push(K.x),M.push(K.y)}}const U=cd.exports(M,L);for(let V=0;V<U.length;V+=3)this.indexArray.emplaceBack(O+U[V],O+U[V+2],O+U[V+1]);I.primitiveLength+=U.length/3,I.vertexLength+=S}for(let w=0;w<_.vertexCount;w++)this.centroidVertexArray.emplaceBack(Math.floor(_.x/_.vertexCount),Math.floor(_.y/_.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,m,d)}}function Ow(r,e){return r.x===e.x&&(r.x<0||r.x>Er)||r.y===e.y&&(r.y<0||r.y>Er)}function Bw(r){return r.every(e=>e.x<0)||r.every(e=>e.x>Er)||r.every(e=>e.y<0)||r.every(e=>e.y>Er)}lt("FillExtrusionBucket",Rf,{omit:["layers","features"]});var Nw={paint:new qr({"fill-extrusion-opacity":new bt(Le["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Lt(Le["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new bt(Le["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new bt(Le["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new qs(Le["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Lt(Le["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Lt(Le["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new bt(Le["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Nc(r,e){return r.x*e.x+r.y*e.y}function S_(r,e){if(r.length===1){let o=0;const l=e[o++];let d;for(;!d||l.equals(d);)if(d=e[o++],!d)return 1/0;for(;o<e.length;o++){const m=e[o],_=r[0],w=d.sub(l),S=m.sub(l),I=_.sub(l),M=Nc(w,w),L=Nc(w,S),O=Nc(S,S),U=Nc(I,w),V=Nc(I,S),te=M*O-L*L,K=(O*U-L*V)/te,me=(M*V-L*U)/te,Ee=l.z*(1-K-me)+d.z*K+m.z*me;if(isFinite(Ee))return Ee}return 1/0}{let o=1/0;for(const l of e)o=Math.min(o,l.z);return o}}const Uw=gr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Vw}=Uw,$w=gr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:jw}=$w,Gw=Hs.VectorTileFeature.types,qw=Math.cos(Math.PI/180*37.5),E_=Math.pow(2,14)/.5;class Ff{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new cn,this.layoutVertexArray2=new Cn,this.indexArray=new Ai,this.programConfigurations=new Gl(e.layers,e.zoom),this.segments=new Kt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,l){this.hasPattern=Mf("line",this.layers,o);const d=this.layers[0].layout.get("line-sort-key"),m=!d.isConstant(),_=[];for(const{feature:w,id:S,index:I,sourceLayerIndex:M}of e){const L=this.layers[0]._featureFilter.needGeometry,O=Zl(w,L);if(!this.layers[0]._featureFilter.filter(new Gn(this.zoom),O,l))continue;const U=m?d.evaluate(O,{},l):void 0,V={id:S,properties:w.properties,type:w.type,sourceLayerIndex:M,index:I,geometry:L?O.geometry:ql(w),patterns:{},sortKey:U};_.push(V)}m&&_.sort((w,S)=>w.sortKey-S.sortKey);for(const w of _){const{geometry:S,index:I,sourceLayerIndex:M}=w;if(this.hasPattern){const L=zf("line",this.layers,w,this.zoom,o);this.patternFeatures.push(L)}else this.addFeature(w,S,I,l,{});o.featureIndex.insert(e[I].feature,S,I,M,this.index)}}update(e,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l)}addFeatures(e,o,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,o,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,jw)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Vw),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,o,l,d,m){const _=this.layers[0].layout,w=_.get("line-join").evaluate(e,{}),S=_.get("line-cap"),I=_.get("line-miter-limit"),M=_.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const L of o)this.addLine(L,e,w,S,I,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,m,d)}addLine(e,o,l,d,m,_){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let me=0;me<e.length-1;me++)this.totalDistance+=e[me].dist(e[me+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w=Gw[o.type]==="Polygon";let S=e.length;for(;S>=2&&e[S-1].equals(e[S-2]);)S--;let I=0;for(;I<S-1&&e[I].equals(e[I+1]);)I++;if(S<(w?3:2))return;l==="bevel"&&(m=1.05);const M=this.overscaling<=16?122880/(512*this.overscaling):0,L=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let O,U,V,te,K;this.e1=this.e2=-1,w&&(O=e[S-2],K=e[I].sub(O)._unit()._perp());for(let me=I;me<S;me++){if(V=me===S-1?w?e[I+1]:void 0:e[me+1],V&&e[me].equals(V))continue;K&&(te=K),O&&(U=O),O=e[me],K=V?V.sub(O)._unit()._perp():te,te=te||K;let Ee=te.add(K);Ee.x===0&&Ee.y===0||Ee._unit();const pe=te.x*K.x+te.y*K.y,be=Ee.x*K.x+Ee.y*K.y,Be=be!==0?1/be:1/0,Oe=2*Math.sqrt(2-2*be),ft=be<qw&&U&&V,vt=te.x*K.y-te.y*K.x>0;if(ft&&me>I){const Ke=O.dist(U);if(Ke>2*M){const ct=O.sub(O.sub(U)._mult(M/Ke)._round());this.updateDistance(U,ct),this.addCurrentVertex(ct,te,0,0,L),U=ct}}const ut=U&&V;let rt=ut?l:w?"butt":d;if(ut&&rt==="round"&&(Be<_?rt="miter":Be<=2&&(rt="fakeround")),rt==="miter"&&Be>m&&(rt="bevel"),rt==="bevel"&&(Be>2&&(rt="flipbevel"),Be<m&&(rt="miter")),U&&this.updateDistance(U,O),rt==="miter")Ee._mult(Be),this.addCurrentVertex(O,Ee,0,0,L);else if(rt==="flipbevel"){if(Be>100)Ee=K.mult(-1);else{const Ke=Be*te.add(K).mag()/te.sub(K).mag();Ee._perp()._mult(Ke*(vt?-1:1))}this.addCurrentVertex(O,Ee,0,0,L),this.addCurrentVertex(O,Ee.mult(-1),0,0,L)}else if(rt==="bevel"||rt==="fakeround"){const Ke=-Math.sqrt(Be*Be-1),ct=vt?Ke:0,st=vt?0:Ke;if(U&&this.addCurrentVertex(O,te,ct,st,L),rt==="fakeround"){const qe=Math.round(180*Oe/Math.PI/20);for(let It=1;It<qe;It++){let wt=It/qe;if(wt!==.5){const Nn=wt-.5;wt+=wt*Nn*(wt-1)*((1.0904+pe*(pe*(3.55645-1.43519*pe)-3.2452))*Nn*Nn+(.848013+pe*(.215638*pe-1.06021)))}const Ht=K.sub(te)._mult(wt)._add(te)._unit()._mult(vt?-1:1);this.addHalfVertex(O,Ht.x,Ht.y,!1,vt,0,L)}}V&&this.addCurrentVertex(O,K,-ct,-st,L)}else if(rt==="butt")this.addCurrentVertex(O,Ee,0,0,L);else if(rt==="square"){const Ke=U?1:-1;this.addCurrentVertex(O,Ee,Ke,Ke,L)}else rt==="round"&&(U&&(this.addCurrentVertex(O,te,0,0,L),this.addCurrentVertex(O,te,1,1,L,!0)),V&&(this.addCurrentVertex(O,K,-1,-1,L,!0),this.addCurrentVertex(O,K,0,0,L)));if(ft&&me<S-1){const Ke=O.dist(V);if(Ke>2*M){const ct=O.add(V.sub(O)._mult(M/Ke)._round());this.updateDistance(O,ct),this.addCurrentVertex(ct,K,0,0,L),O=ct}}}}addCurrentVertex(e,o,l,d,m,_=!1){const w=o.y*d-o.x,S=-o.y-o.x*d;this.addHalfVertex(e,o.x+o.y*l,o.y-o.x*l,_,!1,l,m),this.addHalfVertex(e,w,S,_,!0,-d,m),this.distance>E_/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,o,l,d,m,_))}addHalfVertex({x:e,y:o},l,d,m,_,w,S){const I=.5*(this.lineClips?this.scaledDistance*(E_-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(m?1:0),(o<<1)+(_?1:0),Math.round(63*l)+128,Math.round(63*d)+128,1+(w===0?0:w<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const M=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),S.primitiveLength++),_?this.e2=M:this.e1=M}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,o){this.distance+=e.dist(o),this.updateScaledDistance()}}lt("LineBucket",Ff,{omit:["layers","patternFeatures"]});const Zw=new qr({"line-cap":new bt(Le.layout_line["line-cap"]),"line-join":new Lt(Le.layout_line["line-join"]),"line-miter-limit":new bt(Le.layout_line["line-miter-limit"]),"line-round-limit":new bt(Le.layout_line["line-round-limit"]),"line-sort-key":new Lt(Le.layout_line["line-sort-key"])});var T_={paint:new qr({"line-opacity":new Lt(Le.paint_line["line-opacity"]),"line-color":new Lt(Le.paint_line["line-color"]),"line-translate":new bt(Le.paint_line["line-translate"]),"line-translate-anchor":new bt(Le.paint_line["line-translate-anchor"]),"line-width":new Lt(Le.paint_line["line-width"]),"line-gap-width":new Lt(Le.paint_line["line-gap-width"]),"line-offset":new Lt(Le.paint_line["line-offset"]),"line-blur":new Lt(Le.paint_line["line-blur"]),"line-dasharray":new kc(Le.paint_line["line-dasharray"]),"line-pattern":new qs(Le.paint_line["line-pattern"]),"line-gradient":new Na(Le.paint_line["line-gradient"])}),layout:Zw};const k_=new class extends Lt{possiblyEvaluate(r,e){return e=new Gn(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(r,e)}evaluate(r,e,o,l){return e=Me({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(r,e,o,l)}}(T_.paint.properties["line-width"].specification);function C_(r,e){return e>0?e+2*r:r}k_.useIntegerZoom=!0;const Ww=gr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Hw=gr([{name:"a_projected_pos",components:3,type:"Float32"}],4);gr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Xw=gr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);gr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const I_=gr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Yw=gr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Kw(r,e,o){return r.sections.forEach(l=>{l.text=function(d,m,_){const w=m.layout.get("text-transform").evaluate(_,{});return w==="uppercase"?d=d.toLocaleUpperCase():w==="lowercase"&&(d=d.toLocaleLowerCase()),oo.applyArabicShaping&&(d=oo.applyArabicShaping(d)),d}(l.text,e,o)}),r}gr([{name:"triangle",components:3,type:"Uint16"}]),gr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),gr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),gr([{type:"Float32",name:"offsetX"}]),gr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const Uc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var Zr=24,Of=Pn,P_=function(r,e,o,l,d){var m,_,w=8*d-l-1,S=(1<<w)-1,I=S>>1,M=-7,L=o?d-1:0,O=o?-1:1,U=r[e+L];for(L+=O,m=U&(1<<-M)-1,U>>=-M,M+=w;M>0;m=256*m+r[e+L],L+=O,M-=8);for(_=m&(1<<-M)-1,m>>=-M,M+=l;M>0;_=256*_+r[e+L],L+=O,M-=8);if(m===0)m=1-I;else{if(m===S)return _?NaN:1/0*(U?-1:1);_+=Math.pow(2,l),m-=I}return(U?-1:1)*_*Math.pow(2,m-l)},A_=function(r,e,o,l,d,m){var _,w,S,I=8*m-d-1,M=(1<<I)-1,L=M>>1,O=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,U=l?0:m-1,V=l?1:-1,te=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(w=isNaN(e)?1:0,_=M):(_=Math.floor(Math.log(e)/Math.LN2),e*(S=Math.pow(2,-_))<1&&(_--,S*=2),(e+=_+L>=1?O/S:O*Math.pow(2,1-L))*S>=2&&(_++,S/=2),_+L>=M?(w=0,_=M):_+L>=1?(w=(e*S-1)*Math.pow(2,d),_+=L):(w=e*Math.pow(2,L-1)*Math.pow(2,d),_=0));d>=8;r[o+U]=255&w,U+=V,w/=256,d-=8);for(_=_<<d|w,I+=d;I>0;r[o+U]=255&_,U+=V,_/=256,I-=8);r[o+U-V]|=128*te};function Pn(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Pn.Varint=0,Pn.Fixed64=1,Pn.Bytes=2,Pn.Fixed32=5;var Xs,Bf=4294967296,M_=1/Bf,z_=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ds(r){return r.type===Pn.Bytes?r.readVarint()+r.pos:r.pos+1}function Mu(r,e,o){return o?4294967296*e+(r>>>0):4294967296*(e>>>0)+(r>>>0)}function L_(r,e,o){var l=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));o.realloc(l);for(var d=o.pos-1;d>=r;d--)o.buf[d+l]=o.buf[d]}function Jw(r,e){for(var o=0;o<r.length;o++)e.writeVarint(r[o])}function Qw(r,e){for(var o=0;o<r.length;o++)e.writeSVarint(r[o])}function e2(r,e){for(var o=0;o<r.length;o++)e.writeFloat(r[o])}function t2(r,e){for(var o=0;o<r.length;o++)e.writeDouble(r[o])}function n2(r,e){for(var o=0;o<r.length;o++)e.writeBoolean(r[o])}function r2(r,e){for(var o=0;o<r.length;o++)e.writeFixed32(r[o])}function i2(r,e){for(var o=0;o<r.length;o++)e.writeSFixed32(r[o])}function o2(r,e){for(var o=0;o<r.length;o++)e.writeFixed64(r[o])}function a2(r,e){for(var o=0;o<r.length;o++)e.writeSFixed64(r[o])}function md(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+16777216*r[e+3]}function zu(r,e,o){r[o]=e,r[o+1]=e>>>8,r[o+2]=e>>>16,r[o+3]=e>>>24}function D_(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+(r[e+3]<<24)}function s2(r,e,o){r===1&&o.readMessage(l2,e)}function l2(r,e,o){if(r===3){const{id:l,bitmap:d,width:m,height:_,left:w,top:S,advance:I}=o.readMessage(u2,{});e.push({id:l,bitmap:new Lc({width:m+6,height:_+6},d),metrics:{width:m,height:_,left:w,top:S,advance:I}})}}function u2(r,e,o){r===1?e.id=o.readVarint():r===2?e.bitmap=o.readBytes():r===3?e.width=o.readVarint():r===4?e.height=o.readVarint():r===5?e.left=o.readSVarint():r===6?e.top=o.readSVarint():r===7&&(e.advance=o.readVarint())}function R_(r){let e=0,o=0;for(const _ of r)e+=_.w*_.h,o=Math.max(o,_.w);r.sort((_,w)=>w.h-_.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),o),h:1/0}];let d=0,m=0;for(const _ of r)for(let w=l.length-1;w>=0;w--){const S=l[w];if(!(_.w>S.w||_.h>S.h)){if(_.x=S.x,_.y=S.y,m=Math.max(m,_.y+_.h),d=Math.max(d,_.x+_.w),_.w===S.w&&_.h===S.h){const I=l.pop();w<l.length&&(l[w]=I)}else _.h===S.h?(S.x+=_.w,S.w-=_.w):_.w===S.w?(S.y+=_.h,S.h-=_.h):(l.push({x:S.x+_.w,y:S.y,w:S.w-_.w,h:_.h}),S.y+=_.h,S.h-=_.h);break}}return{w:d,h:m,fill:e/(d*m)||0}}Pn.prototype={destroy:function(){this.buf=null},readFields:function(r,e,o){for(o=o||this.length;this.pos<o;){var l=this.readVarint(),d=l>>3,m=this.pos;this.type=7&l,r(d,e,this),this.pos===m&&this.skip(l)}return e},readMessage:function(r,e){return this.readFields(r,e,this.readVarint()+this.pos)},readFixed32:function(){var r=md(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=D_(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=md(this.buf,this.pos)+md(this.buf,this.pos+4)*Bf;return this.pos+=8,r},readSFixed64:function(){var r=md(this.buf,this.pos)+D_(this.buf,this.pos+4)*Bf;return this.pos+=8,r},readFloat:function(){var r=P_(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=P_(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var e,o,l=this.buf;return e=127&(o=l[this.pos++]),o<128?e:(e|=(127&(o=l[this.pos++]))<<7,o<128?e:(e|=(127&(o=l[this.pos++]))<<14,o<128?e:(e|=(127&(o=l[this.pos++]))<<21,o<128?e:function(d,m,_){var w,S,I=_.buf;if(w=(112&(S=I[_.pos++]))>>4,S<128||(w|=(127&(S=I[_.pos++]))<<3,S<128)||(w|=(127&(S=I[_.pos++]))<<10,S<128)||(w|=(127&(S=I[_.pos++]))<<17,S<128)||(w|=(127&(S=I[_.pos++]))<<24,S<128)||(w|=(1&(S=I[_.pos++]))<<31,S<128))return Mu(d,w,m);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(o=l[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var r=this.readVarint()+this.pos,e=this.pos;return this.pos=r,r-e>=12&&z_?function(o,l,d){return z_.decode(o.subarray(l,d))}(this.buf,e,r):function(o,l,d){for(var m="",_=l;_<d;){var w,S,I,M=o[_],L=null,O=M>239?4:M>223?3:M>191?2:1;if(_+O>d)break;O===1?M<128&&(L=M):O===2?(192&(w=o[_+1]))==128&&(L=(31&M)<<6|63&w)<=127&&(L=null):O===3?(S=o[_+2],(192&(w=o[_+1]))==128&&(192&S)==128&&((L=(15&M)<<12|(63&w)<<6|63&S)<=2047||L>=55296&&L<=57343)&&(L=null)):O===4&&(S=o[_+2],I=o[_+3],(192&(w=o[_+1]))==128&&(192&S)==128&&(192&I)==128&&((L=(15&M)<<18|(63&w)<<12|(63&S)<<6|63&I)<=65535||L>=1114112)&&(L=null)),L===null?(L=65533,O=1):L>65535&&(L-=65536,m+=String.fromCharCode(L>>>10&1023|55296),L=56320|1023&L),m+=String.fromCharCode(L),_+=O}return m}(this.buf,e,r)},readBytes:function(){var r=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,r);return this.pos=r,e},readPackedVarint:function(r,e){if(this.type!==Pn.Bytes)return r.push(this.readVarint(e));var o=ds(this);for(r=r||[];this.pos<o;)r.push(this.readVarint(e));return r},readPackedSVarint:function(r){if(this.type!==Pn.Bytes)return r.push(this.readSVarint());var e=ds(this);for(r=r||[];this.pos<e;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Pn.Bytes)return r.push(this.readBoolean());var e=ds(this);for(r=r||[];this.pos<e;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Pn.Bytes)return r.push(this.readFloat());var e=ds(this);for(r=r||[];this.pos<e;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Pn.Bytes)return r.push(this.readDouble());var e=ds(this);for(r=r||[];this.pos<e;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Pn.Bytes)return r.push(this.readFixed32());var e=ds(this);for(r=r||[];this.pos<e;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Pn.Bytes)return r.push(this.readSFixed32());var e=ds(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Pn.Bytes)return r.push(this.readFixed64());var e=ds(this);for(r=r||[];this.pos<e;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Pn.Bytes)return r.push(this.readSFixed64());var e=ds(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed64());return r},skip:function(r){var e=7&r;if(e===Pn.Varint)for(;this.buf[this.pos++]>127;);else if(e===Pn.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Pn.Fixed32)this.pos+=4;else{if(e!==Pn.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(r,e){this.writeVarint(r<<3|e)},realloc:function(r){for(var e=this.length||16;e<this.pos+r;)e*=2;if(e!==this.length){var o=new Uint8Array(e);o.set(this.buf),this.buf=o,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),zu(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),zu(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),zu(this.buf,-1&r,this.pos),zu(this.buf,Math.floor(r*M_),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),zu(this.buf,-1&r,this.pos),zu(this.buf,Math.floor(r*M_),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(e,o){var l,d;if(e>=0?(l=e%4294967296|0,d=e/4294967296|0):(d=~(-e/4294967296),4294967295^(l=~(-e%4294967296))?l=l+1|0:(l=0,d=d+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(m,_,w){w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,w.buf[w.pos]=127&(m>>>=7)}(l,0,o),function(m,_){var w=(7&m)<<4;_.buf[_.pos++]|=w|((m>>>=3)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m)))))}(d,o)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(Boolean(r))},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var e=this.pos;this.pos=function(l,d,m){for(var _,w,S=0;S<d.length;S++){if((_=d.charCodeAt(S))>55295&&_<57344){if(!w){_>56319||S+1===d.length?(l[m++]=239,l[m++]=191,l[m++]=189):w=_;continue}if(_<56320){l[m++]=239,l[m++]=191,l[m++]=189,w=_;continue}_=w-55296<<10|_-56320|65536,w=null}else w&&(l[m++]=239,l[m++]=191,l[m++]=189,w=null);_<128?l[m++]=_:(_<2048?l[m++]=_>>6|192:(_<65536?l[m++]=_>>12|224:(l[m++]=_>>18|240,l[m++]=_>>12&63|128),l[m++]=_>>6&63|128),l[m++]=63&_|128)}return m}(this.buf,r,this.pos);var o=this.pos-e;o>=128&&L_(e,o,this),this.pos=e-1,this.writeVarint(o),this.pos+=o},writeFloat:function(r){this.realloc(4),A_(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),A_(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var e=r.length;this.writeVarint(e),this.realloc(e);for(var o=0;o<e;o++)this.buf[this.pos++]=r[o]},writeRawMessage:function(r,e){this.pos++;var o=this.pos;r(e,this);var l=this.pos-o;l>=128&&L_(o,l,this),this.pos=o-1,this.writeVarint(l),this.pos+=l},writeMessage:function(r,e,o){this.writeTag(r,Pn.Bytes),this.writeRawMessage(e,o)},writePackedVarint:function(r,e){e.length&&this.writeMessage(r,Jw,e)},writePackedSVarint:function(r,e){e.length&&this.writeMessage(r,Qw,e)},writePackedBoolean:function(r,e){e.length&&this.writeMessage(r,n2,e)},writePackedFloat:function(r,e){e.length&&this.writeMessage(r,e2,e)},writePackedDouble:function(r,e){e.length&&this.writeMessage(r,t2,e)},writePackedFixed32:function(r,e){e.length&&this.writeMessage(r,r2,e)},writePackedSFixed32:function(r,e){e.length&&this.writeMessage(r,i2,e)},writePackedFixed64:function(r,e){e.length&&this.writeMessage(r,o2,e)},writePackedSFixed64:function(r,e){e.length&&this.writeMessage(r,a2,e)},writeBytesField:function(r,e){this.writeTag(r,Pn.Bytes),this.writeBytes(e)},writeFixed32Field:function(r,e){this.writeTag(r,Pn.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(r,e){this.writeTag(r,Pn.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(r,e){this.writeTag(r,Pn.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(r,e){this.writeTag(r,Pn.Fixed64),this.writeSFixed64(e)},writeVarintField:function(r,e){this.writeTag(r,Pn.Varint),this.writeVarint(e)},writeSVarintField:function(r,e){this.writeTag(r,Pn.Varint),this.writeSVarint(e)},writeStringField:function(r,e){this.writeTag(r,Pn.Bytes),this.writeString(e)},writeFloatField:function(r,e){this.writeTag(r,Pn.Fixed32),this.writeFloat(e)},writeDoubleField:function(r,e){this.writeTag(r,Pn.Fixed64),this.writeDouble(e)},writeBooleanField:function(r,e){this.writeVarintField(r,Boolean(e))}};class Nf{constructor(e,{pixelRatio:o,version:l,stretchX:d,stretchY:m,content:_}){this.paddedRect=e,this.pixelRatio=o,this.stretchX=d,this.stretchY=m,this.content=_,this.version=l}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class F_{constructor(e,o){const l={},d={};this.haveRenderCallbacks=[];const m=[];this.addImages(e,l,m),this.addImages(o,d,m);const{w:_,h:w}=R_(m),S=new Io({width:_||1,height:w||1});for(const I in e){const M=e[I],L=l[I].paddedRect;Io.copy(M.data,S,{x:0,y:0},{x:L.x+1,y:L.y+1},M.data)}for(const I in o){const M=o[I],L=d[I].paddedRect,O=L.x+1,U=L.y+1,V=M.data.width,te=M.data.height;Io.copy(M.data,S,{x:0,y:0},{x:O,y:U},M.data),Io.copy(M.data,S,{x:0,y:te-1},{x:O,y:U-1},{width:V,height:1}),Io.copy(M.data,S,{x:0,y:0},{x:O,y:U+te},{width:V,height:1}),Io.copy(M.data,S,{x:V-1,y:0},{x:O-1,y:U},{width:1,height:te}),Io.copy(M.data,S,{x:0,y:0},{x:O+V,y:U},{width:1,height:te})}this.image=S,this.iconPositions=l,this.patternPositions=d}addImages(e,o,l){for(const d in e){const m=e[d],_={x:0,y:0,w:m.data.width+2,h:m.data.height+2};l.push(_),o[d]=new Nf(_,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(e,o){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in e.updatedImages)this.patchUpdatedImage(this.iconPositions[l],e.getImage(l),o),this.patchUpdatedImage(this.patternPositions[l],e.getImage(l),o)}patchUpdatedImage(e,o,l){if(!e||!o||e.version===o.version)return;e.version=o.version;const[d,m]=e.tl;l.update(o.data,void 0,{x:d,y:m})}}lt("ImagePosition",Nf),lt("ImageAtlas",F_),u.WritingMode=void 0,(Xs=u.WritingMode||(u.WritingMode={}))[Xs.none=0]="none",Xs[Xs.horizontal=1]="horizontal",Xs[Xs.vertical=2]="vertical",Xs[Xs.horizontalOnly=3]="horizontalOnly";const gd=-17;class Vc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,o){const l=new Vc;return l.scale=e||1,l.fontStack=o,l}static forImage(e){const o=new Vc;return o.imageName=e,o}}class Lu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,o){const l=new Lu;for(let d=0;d<e.sections.length;d++){const m=e.sections[d];m.image?l.addImageSection(m):l.addTextSection(m,o)}return l}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let o="";for(let l=0;l<e.length;l++){const d=e.charCodeAt(l+1)||null,m=e.charCodeAt(l-1)||null;o+=d&&Yh(d)&&!Uc[e[l+1]]||m&&Yh(m)&&!Uc[e[l-1]]||!Uc[e[l]]?e[l]:Uc[e[l]]}return o}(this.text)}trim(){let e=0;for(let l=0;l<this.text.length&&_d[this.text.charCodeAt(l)];l++)e++;let o=this.text.length;for(let l=this.text.length-1;l>=0&&l>=e&&_d[this.text.charCodeAt(l)];l--)o--;this.text=this.text.substring(e,o),this.sectionIndex=this.sectionIndex.slice(e,o)}substring(e,o){const l=new Lu;return l.text=this.text.substring(e,o),l.sectionIndex=this.sectionIndex.slice(e,o),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,o)=>Math.max(e,this.sections[o].scale),0)}addTextSection(e,o){this.text+=e.text,this.sections.push(Vc.forText(e.scale,e.fontStack||o));const l=this.sections.length-1;for(let d=0;d<e.text.length;++d)this.sectionIndex.push(l)}addImageSection(e){const o=e.image?e.image.name:"";if(o.length===0)return void ze("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Vc.forImage(o)),this.sectionIndex.push(this.sections.length-1)):ze("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function yd(r,e,o,l,d,m,_,w,S,I,M,L,O,U,V,te){const K=Lu.fromFeature(r,d);let me;L===u.WritingMode.vertical&&K.verticalizePunctuation();const{processBidirectionalText:Ee,processStyledBidirectionalText:pe}=oo;if(Ee&&K.sections.length===1){me=[];const Oe=Ee(K.toString(),Uf(K,I,m,e,l,U,V));for(const ft of Oe){const vt=new Lu;vt.text=ft,vt.sections=K.sections;for(let ut=0;ut<ft.length;ut++)vt.sectionIndex.push(0);me.push(vt)}}else if(pe){me=[];const Oe=pe(K.text,K.sectionIndex,Uf(K,I,m,e,l,U,V));for(const ft of Oe){const vt=new Lu;vt.text=ft[0],vt.sectionIndex=ft[1],vt.sections=K.sections,me.push(vt)}}else me=function(Oe,ft){const vt=[],ut=Oe.text;let rt=0;for(const Ke of ft)vt.push(Oe.substring(rt,Ke)),rt=Ke;return rt<ut.length&&vt.push(Oe.substring(rt,ut.length)),vt}(K,Uf(K,I,m,e,l,U,V));const be=[],Be={positionedLines:be,text:K.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:L,iconsInText:!1,verticalizable:!1};return function(Oe,ft,vt,ut,rt,Ke,ct,st,qe,It,wt,Ht){let Nn=0,Zn=gd,Tr=0,Ao=0;const ii=st==="right"?1:st==="left"?0:.5;let yr=0;for(const _r of rt){_r.trim();const ai=_r.getMaxScale(),_i=(ai-1)*Zr,Li={positionedGlyphs:[],lineOffset:0};Oe.positionedLines[yr]=Li;const ji=Li.positionedGlyphs;let Gi=0;if(!_r.length()){Zn+=Ke,++yr;continue}for(let Or=0;Or<_r.length();Or++){const tn=_r.getSection(Or),lo=_r.getSectionIndex(Or),si=_r.getCharCode(Or);let vi=0,Ko=null,fa=null,ma=null,fs=Zr;const Jo=!(qe===u.WritingMode.horizontal||!wt&&!xc(si)||wt&&(_d[si]||(Fr=si,tt.Arabic(Fr)||tt["Arabic Supplement"](Fr)||tt["Arabic Extended-A"](Fr)||tt["Arabic Presentation Forms-A"](Fr)||tt["Arabic Presentation Forms-B"](Fr))));if(tn.imageName){const Mo=ut[tn.imageName];if(!Mo)continue;ma=tn.imageName,Oe.iconsInText=Oe.iconsInText||!0,fa=Mo.paddedRect;const qi=Mo.displaySize;tn.scale=tn.scale*Zr/Ht,Ko={width:qi[0],height:qi[1],left:1,top:-3,advance:Jo?qi[1]:qi[0]},vi=_i+(Zr-qi[1]*tn.scale),fs=Ko.advance;const ms=Jo?qi[0]*tn.scale-Zr*ai:qi[1]*tn.scale-Zr*ai;ms>0&&ms>Gi&&(Gi=ms)}else{const Mo=vt[tn.fontStack],qi=Mo&&Mo[si];if(qi&&qi.rect)fa=qi.rect,Ko=qi.metrics;else{const ms=ft[tn.fontStack],Gc=ms&&ms[si];if(!Gc)continue;Ko=Gc.metrics}vi=(ai-tn.scale)*Zr}Jo?(Oe.verticalizable=!0,ji.push({glyph:si,imageName:ma,x:Nn,y:Zn+vi,vertical:Jo,scale:tn.scale,fontStack:tn.fontStack,sectionIndex:lo,metrics:Ko,rect:fa}),Nn+=fs*tn.scale+It):(ji.push({glyph:si,imageName:ma,x:Nn,y:Zn+vi,vertical:Jo,scale:tn.scale,fontStack:tn.fontStack,sectionIndex:lo,metrics:Ko,rect:fa}),Nn+=Ko.advance*tn.scale+It)}ji.length!==0&&(Tr=Math.max(Nn-It,Tr),d2(ji,0,ji.length-1,ii,Gi)),Nn=0;const Hn=Ke*ai+Gi;Li.lineOffset=Math.max(Gi,_i),Zn+=Hn,Ao=Math.max(Hn,Ao),++yr}var Fr;const oi=Zn-gd,{horizontalAlign:yi,verticalAlign:$i}=Vf(ct);(function(_r,ai,_i,Li,ji,Gi,Hn,Or,tn){const lo=(ai-_i)*ji;let si=0;si=Gi!==Hn?-Or*Li-gd:(-Li*tn+.5)*Hn;for(const vi of _r)for(const Ko of vi.positionedGlyphs)Ko.x+=lo,Ko.y+=si})(Oe.positionedLines,ii,yi,$i,Tr,Ao,Ke,oi,rt.length),Oe.top+=-$i*oi,Oe.bottom=Oe.top+oi,Oe.left+=-yi*Tr,Oe.right=Oe.left+Tr}(Be,e,o,l,me,_,w,S,L,I,O,te),!function(Oe){for(const ft of Oe)if(ft.positionedGlyphs.length!==0)return!1;return!0}(be)&&Be}const _d={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},c2={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function O_(r,e,o,l,d,m){if(e.imageName){const _=l[e.imageName];return _?_.displaySize[0]*e.scale*Zr/m+d:0}{const _=o[e.fontStack],w=_&&_[r];return w?w.metrics.advance*e.scale+d:0}}function B_(r,e,o,l){const d=Math.pow(r-e,2);return l?r<e?d/2:2*d:d+Math.abs(o)*o}function h2(r,e,o){let l=0;return r===10&&(l-=1e4),o&&(l+=150),r!==40&&r!==65288||(l+=50),e!==41&&e!==65289||(l+=50),l}function N_(r,e,o,l,d,m){let _=null,w=B_(e,o,d,m);for(const S of l){const I=B_(e-S.x,o,d,m)+S.badness;I<=w&&(_=S,w=I)}return{index:r,x:e,priorBreak:_,badness:w}}function U_(r){return r?U_(r.priorBreak).concat(r.index):[]}function Uf(r,e,o,l,d,m,_){if(m!=="point")return[];if(!r)return[];const w=[],S=function(O,U,V,te,K,me){let Ee=0;for(let pe=0;pe<O.length();pe++){const be=O.getSection(pe);Ee+=O_(O.getCharCode(pe),be,te,K,U,me)}return Ee/Math.max(1,Math.ceil(Ee/V))}(r,e,o,l,d,_),I=r.text.indexOf("\u200B")>=0;let M=0;for(let O=0;O<r.length();O++){const U=r.getSection(O),V=r.getCharCode(O);if(_d[V]||(M+=O_(V,U,l,d,e,_)),O<r.length()-1){const te=!((L=V)<11904||!(tt["Bopomofo Extended"](L)||tt.Bopomofo(L)||tt["CJK Compatibility Forms"](L)||tt["CJK Compatibility Ideographs"](L)||tt["CJK Compatibility"](L)||tt["CJK Radicals Supplement"](L)||tt["CJK Strokes"](L)||tt["CJK Symbols and Punctuation"](L)||tt["CJK Unified Ideographs Extension A"](L)||tt["CJK Unified Ideographs"](L)||tt["Enclosed CJK Letters and Months"](L)||tt["Halfwidth and Fullwidth Forms"](L)||tt.Hiragana(L)||tt["Ideographic Description Characters"](L)||tt["Kangxi Radicals"](L)||tt["Katakana Phonetic Extensions"](L)||tt.Katakana(L)||tt["Vertical Forms"](L)||tt["Yi Radicals"](L)||tt["Yi Syllables"](L)));(c2[V]||te||U.imageName)&&w.push(N_(O+1,M,S,w,h2(V,r.getCharCode(O+1),te&&I),!1))}}var L;return U_(N_(r.length(),M,S,w,0,!0))}function Vf(r){let e=.5,o=.5;switch(r){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:e,verticalAlign:o}}function d2(r,e,o,l,d){if(!l&&!d)return;const m=r[o],_=(r[o].x+m.metrics.advance*m.scale)*l;for(let w=e;w<=o;w++)r[w].x-=_,r[w].y+=d}function p2(r,e,o){const{horizontalAlign:l,verticalAlign:d}=Vf(o),m=e[0]-r.displaySize[0]*l,_=e[1]-r.displaySize[1]*d;return{image:r,top:_,bottom:_+r.displaySize[1],left:m,right:m+r.displaySize[0]}}function V_(r,e,o,l,d,m){const _=r.image;let w;if(_.content){const K=_.content,me=_.pixelRatio||1;w=[K[0]/me,K[1]/me,_.displaySize[0]-K[2]/me,_.displaySize[1]-K[3]/me]}const S=e.left*m,I=e.right*m;let M,L,O,U;o==="width"||o==="both"?(U=d[0]+S-l[3],L=d[0]+I+l[1]):(U=d[0]+(S+I-_.displaySize[0])/2,L=U+_.displaySize[0]);const V=e.top*m,te=e.bottom*m;return o==="height"||o==="both"?(M=d[1]+V-l[0],O=d[1]+te+l[2]):(M=d[1]+(V+te-_.displaySize[1])/2,O=M+_.displaySize[1]),{image:_,top:M,right:L,bottom:O,left:U,collisionPadding:w}}const ps=128;function $_(r,e){const{expression:o}=e;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new Gn(r+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:d}=o;let m=0;for(;m<l.length&&l[m]<=r;)m++;m=Math.max(0,m-1);let _=m;for(;_<l.length&&l[_]<r+1;)_++;_=Math.min(l.length-1,_);const w=l[m],S=l[_];return o.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:S,interpolationType:d}:{kind:"camera",minZoom:w,maxZoom:S,minSize:o.evaluate(new Gn(w)),maxSize:o.evaluate(new Gn(S)),interpolationType:d}}}class Ys extends mt{constructor(e,o,l,d){super(e,o),this.angle=l,d!==void 0&&(this.segment=d)}clone(){return new Ys(this.x,this.y,this.angle,this.segment)}}function j_(r,e,o,l,d){if(e.segment===void 0)return!0;let m=e,_=e.segment+1,w=0;for(;w>-o/2;){if(_--,_<0)return!1;w-=r[_].dist(m),m=r[_]}w+=r[_].dist(r[_+1]),_++;const S=[];let I=0;for(;w<o/2;){const M=r[_],L=r[_+1];if(!L)return!1;let O=r[_-1].angleTo(M)-M.angleTo(L);for(O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:w,angleDelta:O}),I+=O;w-S[0].distance>l;)I-=S.shift().angleDelta;if(I>d)return!1;_++,w+=M.dist(L)}return!0}function G_(r){let e=0;for(let o=0;o<r.length-1;o++)e+=r[o].dist(r[o+1]);return e}function q_(r,e,o){return r?.6*e*o:0}function Z_(r,e){return Math.max(r?r.right-r.left:0,e?e.right-e.left:0)}function f2(r,e,o,l,d,m){const _=q_(o,d,m),w=Z_(o,l)*m;let S=0;const I=G_(r)/2;for(let M=0;M<r.length-1;M++){const L=r[M],O=r[M+1],U=L.dist(O);if(S+U>I){const V=(I-S)/U,te=Ge(L.x,O.x,V),K=Ge(L.y,O.y,V),me=new Ys(te,K,O.angleTo(L),M);return me._round(),!_||j_(r,me,w,_,e)?me:void 0}S+=U}}function m2(r,e,o,l,d,m,_,w,S){const I=q_(l,m,_),M=Z_(l,d),L=M*_,O=r[0].x===0||r[0].x===S||r[0].y===0||r[0].y===S;return e-L<e/4&&(e=L+e/4),W_(r,O?e/2*w%e:(M/2+2*m)*_*w%e,e,I,o,L,O,!1,S)}function W_(r,e,o,l,d,m,_,w,S){const I=m/2,M=G_(r);let L=0,O=e-o,U=[];for(let V=0;V<r.length-1;V++){const te=r[V],K=r[V+1],me=te.dist(K),Ee=K.angleTo(te);for(;O+o<L+me;){O+=o;const pe=(O-L)/me,be=Ge(te.x,K.x,pe),Be=Ge(te.y,K.y,pe);if(be>=0&&be<S&&Be>=0&&Be<S&&O-I>=0&&O+I<=M){const Oe=new Ys(be,Be,Ee,V);Oe._round(),l&&!j_(r,Oe,m,l,d)||U.push(Oe)}}L+=me}return w||U.length||_||(U=W_(r,L/2,o,l,d,m,_,!0,S)),U}function H_(r,e,o,l,d){const m=[];for(let _=0;_<r.length;_++){const w=r[_];let S;for(let I=0;I<w.length-1;I++){let M=w[I],L=w[I+1];M.x<e&&L.x<e||(M.x<e?M=new mt(e,M.y+(e-M.x)/(L.x-M.x)*(L.y-M.y))._round():L.x<e&&(L=new mt(e,M.y+(e-M.x)/(L.x-M.x)*(L.y-M.y))._round()),M.y<o&&L.y<o||(M.y<o?M=new mt(M.x+(o-M.y)/(L.y-M.y)*(L.x-M.x),o)._round():L.y<o&&(L=new mt(M.x+(o-M.y)/(L.y-M.y)*(L.x-M.x),o)._round()),M.x>=l&&L.x>=l||(M.x>=l?M=new mt(l,M.y+(l-M.x)/(L.x-M.x)*(L.y-M.y))._round():L.x>=l&&(L=new mt(l,M.y+(l-M.x)/(L.x-M.x)*(L.y-M.y))._round()),M.y>=d&&L.y>=d||(M.y>=d?M=new mt(M.x+(d-M.y)/(L.y-M.y)*(L.x-M.x),d)._round():L.y>=d&&(L=new mt(M.x+(d-M.y)/(L.y-M.y)*(L.x-M.x),d)._round()),S&&M.equals(S[S.length-1])||(S=[M],m.push(S)),S.push(L)))))}}return m}function X_(r,e,o,l){const d=[],m=r.image,_=m.pixelRatio,w=m.paddedRect.w-2,S=m.paddedRect.h-2,I=r.right-r.left,M=r.bottom-r.top,L=m.stretchX||[[0,w]],O=m.stretchY||[[0,S]],U=(Ke,ct)=>Ke+ct[1]-ct[0],V=L.reduce(U,0),te=O.reduce(U,0),K=w-V,me=S-te;let Ee=0,pe=V,be=0,Be=te,Oe=0,ft=K,vt=0,ut=me;if(m.content&&l){const Ke=m.content;Ee=vd(L,0,Ke[0]),be=vd(O,0,Ke[1]),pe=vd(L,Ke[0],Ke[2]),Be=vd(O,Ke[1],Ke[3]),Oe=Ke[0]-Ee,vt=Ke[1]-be,ft=Ke[2]-Ke[0]-pe,ut=Ke[3]-Ke[1]-Be}const rt=(Ke,ct,st,qe)=>{const It=xd(Ke.stretch-Ee,pe,I,r.left),wt=bd(Ke.fixed-Oe,ft,Ke.stretch,V),Ht=xd(ct.stretch-be,Be,M,r.top),Nn=bd(ct.fixed-vt,ut,ct.stretch,te),Zn=xd(st.stretch-Ee,pe,I,r.left),Tr=bd(st.fixed-Oe,ft,st.stretch,V),Ao=xd(qe.stretch-be,Be,M,r.top),ii=bd(qe.fixed-vt,ut,qe.stretch,te),yr=new mt(It,Ht),Fr=new mt(Zn,Ht),oi=new mt(Zn,Ao),yi=new mt(It,Ao),$i=new mt(wt/_,Nn/_),_r=new mt(Tr/_,ii/_),ai=e*Math.PI/180;if(ai){const ji=Math.sin(ai),Gi=Math.cos(ai),Hn=[Gi,-ji,ji,Gi];yr._matMult(Hn),Fr._matMult(Hn),yi._matMult(Hn),oi._matMult(Hn)}const _i=Ke.stretch+Ke.fixed,Li=ct.stretch+ct.fixed;return{tl:yr,tr:Fr,bl:yi,br:oi,tex:{x:m.paddedRect.x+1+_i,y:m.paddedRect.y+1+Li,w:st.stretch+st.fixed-_i,h:qe.stretch+qe.fixed-Li},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:$i,pixelOffsetBR:_r,minFontScaleX:ft/_/I,minFontScaleY:ut/_/M,isSDF:o}};if(l&&(m.stretchX||m.stretchY)){const Ke=Y_(L,K,V),ct=Y_(O,me,te);for(let st=0;st<Ke.length-1;st++){const qe=Ke[st],It=Ke[st+1];for(let wt=0;wt<ct.length-1;wt++)d.push(rt(qe,ct[wt],It,ct[wt+1]))}}else d.push(rt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:S+1}));return d}function vd(r,e,o){let l=0;for(const d of r)l+=Math.max(e,Math.min(o,d[1]))-Math.max(e,Math.min(o,d[0]));return l}function Y_(r,e,o){const l=[{fixed:-1,stretch:0}];for(const[d,m]of r){const _=l[l.length-1];l.push({fixed:d-_.stretch,stretch:_.stretch}),l.push({fixed:d-_.stretch,stretch:_.stretch+(m-d)})}return l.push({fixed:e+1,stretch:o}),l}function xd(r,e,o,l){return r/e*o+l}function bd(r,e,o,l){return r-e*o/l}lt("Anchor",Ys);class wd{constructor(e,o,l,d,m,_,w,S,I,M){if(this.boxStartIndex=e.length,I){let L=_.top,O=_.bottom;const U=_.collisionPadding;U&&(L-=U[1],O+=U[3]);let V=O-L;V>0&&(V=Math.max(10,V),this.circleDiameter=V)}else{let L=_.top*w-S[0],O=_.bottom*w+S[2],U=_.left*w-S[3],V=_.right*w+S[1];const te=_.collisionPadding;if(te&&(U-=te[0]*w,L-=te[1]*w,V+=te[2]*w,O+=te[3]*w),M){const K=new mt(U,L),me=new mt(V,L),Ee=new mt(U,O),pe=new mt(V,O),be=M*Math.PI/180;K._rotate(be),me._rotate(be),Ee._rotate(be),pe._rotate(be),U=Math.min(K.x,me.x,Ee.x,pe.x),V=Math.max(K.x,me.x,Ee.x,pe.x),L=Math.min(K.y,me.y,Ee.y,pe.y),O=Math.max(K.y,me.y,Ee.y,pe.y)}e.emplaceBack(o.x,o.y,U,L,V,O,l,d,m)}this.boxEndIndex=e.length}}class g2{constructor(e=[],o=y2){if(this.data=e,this.length=this.data.length,this.compare=o,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:o,compare:l}=this,d=o[e];for(;e>0;){const m=e-1>>1,_=o[m];if(l(d,_)>=0)break;o[e]=_,e=m}o[e]=d}_down(e){const{data:o,compare:l}=this,d=this.length>>1,m=o[e];for(;e<d;){let _=1+(e<<1),w=o[_];const S=_+1;if(S<this.length&&l(o[S],w)<0&&(_=S,w=o[S]),l(w,m)>=0)break;o[e]=w,e=_}o[e]=m}}function y2(r,e){return r<e?-1:r>e?1:0}function _2(r,e=1,o=!1){let l=1/0,d=1/0,m=-1/0,_=-1/0;const w=r[0];for(let U=0;U<w.length;U++){const V=w[U];(!U||V.x<l)&&(l=V.x),(!U||V.y<d)&&(d=V.y),(!U||V.x>m)&&(m=V.x),(!U||V.y>_)&&(_=V.y)}const S=Math.min(m-l,_-d);let I=S/2;const M=new g2([],v2);if(S===0)return new mt(l,d);for(let U=l;U<m;U+=S)for(let V=d;V<_;V+=S)M.push(new Du(U+I,V+I,I,r));let L=function(U){let V=0,te=0,K=0;const me=U[0];for(let Ee=0,pe=me.length,be=pe-1;Ee<pe;be=Ee++){const Be=me[Ee],Oe=me[be],ft=Be.x*Oe.y-Oe.x*Be.y;te+=(Be.x+Oe.x)*ft,K+=(Be.y+Oe.y)*ft,V+=3*ft}return new Du(te/V,K/V,0,U)}(r),O=M.length;for(;M.length;){const U=M.pop();(U.d>L.d||!L.d)&&(L=U,o&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,O)),U.max-L.d<=e||(I=U.h/2,M.push(new Du(U.p.x-I,U.p.y-I,I,r)),M.push(new Du(U.p.x+I,U.p.y-I,I,r)),M.push(new Du(U.p.x-I,U.p.y+I,I,r)),M.push(new Du(U.p.x+I,U.p.y+I,I,r)),O+=4)}return o&&(console.log(`num probes: ${O}`),console.log(`best distance: ${L.d}`)),L.p}function v2(r,e){return e.max-r.max}function Du(r,e,o,l){this.p=new mt(r,e),this.h=o,this.d=function(d,m){let _=!1,w=1/0;for(let S=0;S<m.length;S++){const I=m[S];for(let M=0,L=I.length,O=L-1;M<L;O=M++){const U=I[M],V=I[O];U.y>d.y!=V.y>d.y&&d.x<(V.x-U.x)*(d.y-U.y)/(V.y-U.y)+U.x&&(_=!_),w=Math.min(w,i_(d,U,V))}}return(_?1:-1)*Math.sqrt(w)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}const $f=Number.POSITIVE_INFINITY;function K_(r,e){return e[1]!==$f?function(o,l,d){let m=0,_=0;switch(l=Math.abs(l),d=Math.abs(d),o){case"top-right":case"top-left":case"top":_=d-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-d}switch(o){case"top-right":case"bottom-right":case"right":m=-l;break;case"top-left":case"bottom-left":case"left":m=l}return[m,_]}(r,e[0],e[1]):function(o,l){let d=0,m=0;l<0&&(l=0);const _=l/Math.sqrt(2);switch(o){case"top-right":case"top-left":m=_-7;break;case"bottom-right":case"bottom-left":m=7-_;break;case"bottom":m=7-l;break;case"top":m=l-7}switch(o){case"top-right":case"bottom-right":d=-_;break;case"top-left":case"bottom-left":d=_;break;case"left":d=l;break;case"right":d=-l}return[d,m]}(r,e[0])}function jf(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function x2(r,e,o,l,d,m,_,w,S,I,M){let L=m.textMaxSize.evaluate(e,{});L===void 0&&(L=_);const O=r.layers[0].layout,U=O.get("icon-offset").evaluate(e,{},M),V=Q_(o.horizontal),te=_/24,K=r.tilePixelRatio*te,me=r.tilePixelRatio*L/24,Ee=r.tilePixelRatio*w,pe=r.tilePixelRatio*O.get("symbol-spacing"),be=O.get("text-padding")*r.tilePixelRatio,Be=function(qe,It,wt,Ht=1){const Nn=qe.get("icon-padding").evaluate(It,{},wt),Zn=Nn&&Nn.values;return[Zn[0]*Ht,Zn[1]*Ht,Zn[2]*Ht,Zn[3]*Ht]}(O,e,M,r.tilePixelRatio),Oe=O.get("text-max-angle")/180*Math.PI,ft=O.get("text-rotation-alignment")!=="viewport"&&O.get("symbol-placement")!=="point",vt=O.get("icon-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point",ut=O.get("symbol-placement"),rt=pe/2,Ke=O.get("icon-text-fit");let ct;l&&Ke!=="none"&&(r.allowVerticalPlacement&&o.vertical&&(ct=V_(l,o.vertical,Ke,O.get("icon-text-fit-padding"),U,te)),V&&(l=V_(l,V,Ke,O.get("icon-text-fit-padding"),U,te)));const st=(qe,It)=>{It.x<0||It.x>=Er||It.y<0||It.y>=Er||function(wt,Ht,Nn,Zn,Tr,Ao,ii,yr,Fr,oi,yi,$i,_r,ai,_i,Li,ji,Gi,Hn,Or,tn,lo,si,vi,Ko){const fa=wt.addToLineVertexArray(Ht,Nn);let ma,fs,Jo,Mo,qi=0,ms=0,Gc=0,mv=0,Qf=-1,em=-1;const gs={};let gv=Rr.exports(""),tm=0,nm=0;if(yr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[tm,nm]=yr.layout.get("text-offset").evaluate(tn,{},vi).map(Zi=>Zi*Zr):(tm=yr.layout.get("text-radial-offset").evaluate(tn,{},vi)*Zr,nm=$f),wt.allowVerticalPlacement&&Zn.vertical){const Zi=yr.layout.get("text-rotate").evaluate(tn,{},vi)+90;Jo=new wd(Fr,Ht,oi,yi,$i,Zn.vertical,_r,ai,_i,Zi),ii&&(Mo=new wd(Fr,Ht,oi,yi,$i,ii,ji,Gi,_i,Zi))}if(Tr){const Zi=yr.layout.get("icon-rotate").evaluate(tn,{}),Ga=yr.layout.get("icon-text-fit")!=="none",qc=X_(Tr,Zi,si,Ga),Zc=ii?X_(ii,Zi,si,Ga):void 0;fs=new wd(Fr,Ht,oi,yi,$i,Tr,ji,Gi,!1,Zi),qi=4*qc.length;const vv=wt.iconSizeData;let Xl=null;vv.kind==="source"?(Xl=[ps*yr.layout.get("icon-size").evaluate(tn,{})],Xl[0]>Ks&&ze(`${wt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):vv.kind==="composite"&&(Xl=[ps*lo.compositeIconSizes[0].evaluate(tn,{},vi),ps*lo.compositeIconSizes[1].evaluate(tn,{},vi)],(Xl[0]>Ks||Xl[1]>Ks)&&ze(`${wt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),wt.addSymbols(wt.icon,qc,Xl,Or,Hn,tn,u.WritingMode.none,Ht,fa.lineStartIndex,fa.lineLength,-1,vi),Qf=wt.icon.placedSymbolArray.length-1,Zc&&(ms=4*Zc.length,wt.addSymbols(wt.icon,Zc,Xl,Or,Hn,tn,u.WritingMode.vertical,Ht,fa.lineStartIndex,fa.lineLength,-1,vi),em=wt.icon.placedSymbolArray.length-1)}const yv=Object.keys(Zn.horizontal);for(const Zi of yv){const Ga=Zn.horizontal[Zi];if(!ma){gv=Rr.exports(Ga.text);const Zc=yr.layout.get("text-rotate").evaluate(tn,{},vi);ma=new wd(Fr,Ht,oi,yi,$i,Ga,_r,ai,_i,Zc)}const qc=Ga.positionedLines.length===1;if(Gc+=J_(wt,Ht,Ga,Ao,yr,_i,tn,Li,fa,Zn.vertical?u.WritingMode.horizontal:u.WritingMode.horizontalOnly,qc?yv:[Zi],gs,Qf,lo,vi),qc)break}Zn.vertical&&(mv+=J_(wt,Ht,Zn.vertical,Ao,yr,_i,tn,Li,fa,u.WritingMode.vertical,["vertical"],gs,em,lo,vi));const L2=ma?ma.boxStartIndex:wt.collisionBoxArray.length,D2=ma?ma.boxEndIndex:wt.collisionBoxArray.length,R2=Jo?Jo.boxStartIndex:wt.collisionBoxArray.length,F2=Jo?Jo.boxEndIndex:wt.collisionBoxArray.length,O2=fs?fs.boxStartIndex:wt.collisionBoxArray.length,B2=fs?fs.boxEndIndex:wt.collisionBoxArray.length,N2=Mo?Mo.boxStartIndex:wt.collisionBoxArray.length,U2=Mo?Mo.boxEndIndex:wt.collisionBoxArray.length;let ga=-1;const Cd=(Zi,Ga)=>Zi&&Zi.circleDiameter?Math.max(Zi.circleDiameter,Ga):Ga;ga=Cd(ma,ga),ga=Cd(Jo,ga),ga=Cd(fs,ga),ga=Cd(Mo,ga);const _v=ga>-1?1:0;_v&&(ga*=Ko/Zr),wt.glyphOffsetArray.length>=Ru.MAX_GLYPHS&&ze("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),tn.sortKey!==void 0&&wt.addToSortKeyRanges(wt.symbolInstances.length,tn.sortKey),wt.symbolInstances.emplaceBack(Ht.x,Ht.y,gs.right>=0?gs.right:-1,gs.center>=0?gs.center:-1,gs.left>=0?gs.left:-1,gs.vertical||-1,Qf,em,gv,L2,D2,R2,F2,O2,B2,N2,U2,oi,Gc,mv,qi,ms,_v,0,_r,tm,nm,ga)}(r,It,qe,o,l,d,ct,r.layers[0],r.collisionBoxArray,e.index,e.sourceLayerIndex,r.index,K,[be,be,be,be],ft,S,Ee,Be,vt,U,e,m,I,M,_)};if(ut==="line")for(const qe of H_(e.geometry,0,0,Er,Er)){const It=m2(qe,pe,Oe,o.vertical||V,l,24,me,r.overscaling,Er);for(const wt of It){const Ht=V;Ht&&b2(r,Ht.text,rt,wt)||st(qe,wt)}}else if(ut==="line-center"){for(const qe of e.geometry)if(qe.length>1){const It=f2(qe,Oe,o.vertical||V,l,24,me);It&&st(qe,It)}}else if(e.type==="Polygon")for(const qe of Af(e.geometry,0)){const It=_2(qe,16);st(qe[0],new Ys(It.x,It.y,0))}else if(e.type==="LineString")for(const qe of e.geometry)st(qe,new Ys(qe[0].x,qe[0].y,0));else if(e.type==="Point")for(const qe of e.geometry)for(const It of qe)st([It],new Ys(It.x,It.y,0))}const Ks=32640;function J_(r,e,o,l,d,m,_,w,S,I,M,L,O,U,V){const te=function(Ee,pe,be,Be,Oe,ft,vt,ut){const rt=Be.layout.get("text-rotate").evaluate(ft,{})*Math.PI/180,Ke=[];for(const ct of pe.positionedLines)for(const st of ct.positionedGlyphs){if(!st.rect)continue;const qe=st.rect||{};let It=4,wt=!0,Ht=1,Nn=0;const Zn=(Oe||ut)&&st.vertical,Tr=st.metrics.advance*st.scale/2;if(ut&&pe.verticalizable){const Hn=(st.scale-1)*Zr,Or=(Zr-st.metrics.width*st.scale)/2;Nn=ct.lineOffset/2-(st.imageName?-Or:Hn)}if(st.imageName){const Hn=vt[st.imageName];wt=Hn.sdf,Ht=Hn.pixelRatio,It=1/Ht}const Ao=Oe?[st.x+Tr,st.y]:[0,0];let ii=Oe?[0,0]:[st.x+Tr+be[0],st.y+be[1]-Nn],yr=[0,0];Zn&&(yr=ii,ii=[0,0]);const Fr=(st.metrics.left-It)*st.scale-Tr+ii[0],oi=(-st.metrics.top-It)*st.scale+ii[1],yi=Fr+qe.w*st.scale/Ht,$i=oi+qe.h*st.scale/Ht,_r=new mt(Fr,oi),ai=new mt(yi,oi),_i=new mt(Fr,$i),Li=new mt(yi,$i);if(Zn){const Hn=new mt(-Tr,Tr-gd),Or=-Math.PI/2,tn=12-Tr,lo=new mt(22-tn,-(st.imageName?tn:0)),si=new mt(...yr);_r._rotateAround(Or,Hn)._add(lo)._add(si),ai._rotateAround(Or,Hn)._add(lo)._add(si),_i._rotateAround(Or,Hn)._add(lo)._add(si),Li._rotateAround(Or,Hn)._add(lo)._add(si)}if(rt){const Hn=Math.sin(rt),Or=Math.cos(rt),tn=[Or,-Hn,Hn,Or];_r._matMult(tn),ai._matMult(tn),_i._matMult(tn),Li._matMult(tn)}const ji=new mt(0,0),Gi=new mt(0,0);Ke.push({tl:_r,tr:ai,bl:_i,br:Li,tex:qe,writingMode:pe.writingMode,glyphOffset:Ao,sectionIndex:st.sectionIndex,isSDF:wt,pixelOffsetTL:ji,pixelOffsetBR:Gi,minFontScaleX:0,minFontScaleY:0})}return Ke}(0,o,w,d,m,_,l,r.allowVerticalPlacement),K=r.textSizeData;let me=null;K.kind==="source"?(me=[ps*d.layout.get("text-size").evaluate(_,{})],me[0]>Ks&&ze(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):K.kind==="composite"&&(me=[ps*U.compositeTextSizes[0].evaluate(_,{},V),ps*U.compositeTextSizes[1].evaluate(_,{},V)],(me[0]>Ks||me[1]>Ks)&&ze(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),r.addSymbols(r.text,te,me,w,m,_,I,e,S.lineStartIndex,S.lineLength,O,V);for(const Ee of M)L[Ee]=r.text.placedSymbolArray.length-1;return 4*te.length}function Q_(r){for(const e in r)return r[e];return null}function b2(r,e,o,l){const d=r.compareText;if(e in d){const m=d[e];for(let _=m.length-1;_>=0;_--)if(l.dist(m[_])<o)return!0}else d[e]=[];return d[e].push(l),!1}const w2=Hs.VectorTileFeature.types,S2=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Sd(r,e,o,l,d,m,_,w,S,I,M,L,O){const U=w?Math.min(Ks,Math.round(w[0])):0,V=w?Math.min(Ks,Math.round(w[1])):0;r.emplaceBack(e,o,Math.round(32*l),Math.round(32*d),m,_,(U<<1)+(S?1:0),V,16*I,16*M,256*L,256*O)}function Gf(r,e,o){r.emplaceBack(e.x,e.y,o),r.emplaceBack(e.x,e.y,o),r.emplaceBack(e.x,e.y,o),r.emplaceBack(e.x,e.y,o)}function E2(r){for(const e of r.sections)if(Jh(e.text))return!0;return!1}class qf{constructor(e){this.layoutVertexArray=new Xo,this.indexArray=new Ai,this.programConfigurations=e,this.segments=new Kt,this.dynamicLayoutVertexArray=new Co,this.opacityVertexArray=new Yo,this.placedSymbolArray=new $e}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,o,l,d){this.isEmpty()||(l&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ww.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Hw.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,S2,!0),this.opacityVertexBuffer.itemSize=1),(l||d)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}lt("SymbolBuffers",qf);class Zf{constructor(e,o,l){this.layoutVertexArray=new e,this.layoutAttributes=o,this.indexArray=new l,this.segments=new Kt,this.collisionVertexArray=new ao}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Xw.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}lt("CollisionBuffers",Zf);class Ru{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(_=>_.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ef([]),this.placementViewportMatrix=Ef([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=$_(this.zoom,o["text-size"]),this.iconSizeData=$_(this.zoom,o["icon-size"]);const l=this.layers[0].layout,d=l.get("symbol-sort-key"),m=l.get("symbol-z-order");this.canOverlap=Hf(l,"text-overlap","text-allow-overlap")!=="never"||Hf(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(_=>u.WritingMode[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=e.sourceID}createArrays(){this.text=new qf(new Gl(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new qf(new Gl(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new nt,this.lineVertexArray=new pt,this.symbolInstances=new ht}calculateGlyphDependencies(e,o,l,d,m){for(let _=0;_<e.length;_++)if(o[e.charCodeAt(_)]=!0,(l||d)&&m){const w=Uc[e.charAt(_)];w&&(o[w.charCodeAt(0)]=!0)}}populate(e,o,l){const d=this.layers[0],m=d.layout,_=m.get("text-font"),w=m.get("text-field"),S=m.get("icon-image"),I=(w.value.kind!=="constant"||w.value.value instanceof oe&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),M=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,L=m.get("symbol-sort-key");if(this.features=[],!I&&!M)return;const O=o.iconDependencies,U=o.glyphDependencies,V=o.availableImages,te=new Gn(this.zoom);for(const{feature:K,id:me,index:Ee,sourceLayerIndex:pe}of e){const be=d._featureFilter.needGeometry,Be=Zl(K,be);if(!d._featureFilter.filter(te,Be,l))continue;let Oe,ft;if(be||(Be.geometry=ql(K)),I){const ut=d.getValueAndResolveTokens("text-field",Be,l,V),rt=oe.factory(ut);E2(rt)&&(this.hasRTLText=!0),(!this.hasRTLText||Vl()==="unavailable"||this.hasRTLText&&oo.isParsed())&&(Oe=Kw(rt,d,Be))}if(M){const ut=d.getValueAndResolveTokens("icon-image",Be,l,V);ft=ut instanceof ce?ut:ce.fromString(ut)}if(!Oe&&!ft)continue;const vt=this.sortFeaturesByKey?L.evaluate(Be,{},l):void 0;if(this.features.push({id:me,text:Oe,icon:ft,index:Ee,sourceLayerIndex:pe,geometry:Be.geometry,properties:K.properties,type:w2[K.type],sortKey:vt}),ft&&(O[ft.name]=!0),Oe){const ut=_.evaluate(Be,{},l).join(","),rt=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(u.WritingMode.vertical)>=0;for(const Ke of Oe.sections)if(Ke.image)O[Ke.image.name]=!0;else{const ct=as(Oe.toString()),st=Ke.fontStack||ut,qe=U[st]=U[st]||{};this.calculateGlyphDependencies(Ke.text,qe,rt,this.allowVerticalPlacement,ct)}}}m.get("symbol-placement")==="line"&&(this.features=function(K){const me={},Ee={},pe=[];let be=0;function Be(ut){pe.push(K[ut]),be++}function Oe(ut,rt,Ke){const ct=Ee[ut];return delete Ee[ut],Ee[rt]=ct,pe[ct].geometry[0].pop(),pe[ct].geometry[0]=pe[ct].geometry[0].concat(Ke[0]),ct}function ft(ut,rt,Ke){const ct=me[rt];return delete me[rt],me[ut]=ct,pe[ct].geometry[0].shift(),pe[ct].geometry[0]=Ke[0].concat(pe[ct].geometry[0]),ct}function vt(ut,rt,Ke){const ct=Ke?rt[0][rt[0].length-1]:rt[0][0];return`${ut}:${ct.x}:${ct.y}`}for(let ut=0;ut<K.length;ut++){const rt=K[ut],Ke=rt.geometry,ct=rt.text?rt.text.toString():null;if(!ct){Be(ut);continue}const st=vt(ct,Ke),qe=vt(ct,Ke,!0);if(st in Ee&&qe in me&&Ee[st]!==me[qe]){const It=ft(st,qe,Ke),wt=Oe(st,qe,pe[It].geometry);delete me[st],delete Ee[qe],Ee[vt(ct,pe[wt].geometry,!0)]=wt,pe[It].geometry=null}else st in Ee?Oe(st,qe,Ke):qe in me?ft(st,qe,Ke):(Be(ut),me[st]=be-1,Ee[qe]=be-1)}return pe.filter(ut=>ut.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((K,me)=>K.sortKey-me.sortKey)}update(e,o,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,o,this.layers,l),this.icon.programConfigurations.updatePaintArrays(e,o,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,o){const l=this.lineVertexArray.length;if(e.segment!==void 0){let d=e.dist(o[e.segment+1]),m=e.dist(o[e.segment]);const _={};for(let w=e.segment+1;w<o.length;w++)_[w]={x:o[w].x,y:o[w].y,tileUnitDistanceFromAnchor:d},w<o.length-1&&(d+=o[w+1].dist(o[w]));for(let w=e.segment||0;w>=0;w--)_[w]={x:o[w].x,y:o[w].y,tileUnitDistanceFromAnchor:m},w>0&&(m+=o[w-1].dist(o[w]));for(let w=0;w<o.length;w++){const S=_[w];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(e,o,l,d,m,_,w,S,I,M,L,O){const U=e.indexArray,V=e.layoutVertexArray,te=e.segments.prepareSegment(4*o.length,V,U,this.canOverlap?_.sortKey:void 0),K=this.glyphOffsetArray.length,me=te.vertexLength,Ee=this.allowVerticalPlacement&&w===u.WritingMode.vertical?Math.PI/2:0,pe=_.text&&_.text.sections;for(let be=0;be<o.length;be++){const{tl:Be,tr:Oe,bl:ft,br:vt,tex:ut,pixelOffsetTL:rt,pixelOffsetBR:Ke,minFontScaleX:ct,minFontScaleY:st,glyphOffset:qe,isSDF:It,sectionIndex:wt}=o[be],Ht=te.vertexLength,Nn=qe[1];Sd(V,S.x,S.y,Be.x,Nn+Be.y,ut.x,ut.y,l,It,rt.x,rt.y,ct,st),Sd(V,S.x,S.y,Oe.x,Nn+Oe.y,ut.x+ut.w,ut.y,l,It,Ke.x,rt.y,ct,st),Sd(V,S.x,S.y,ft.x,Nn+ft.y,ut.x,ut.y+ut.h,l,It,rt.x,Ke.y,ct,st),Sd(V,S.x,S.y,vt.x,Nn+vt.y,ut.x+ut.w,ut.y+ut.h,l,It,Ke.x,Ke.y,ct,st),Gf(e.dynamicLayoutVertexArray,S,Ee),U.emplaceBack(Ht,Ht+1,Ht+2),U.emplaceBack(Ht+1,Ht+2,Ht+3),te.vertexLength+=4,te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(qe[0]),be!==o.length-1&&wt===o[be+1].sectionIndex||e.programConfigurations.populatePaintArrays(V.length,_,_.index,{},O,pe&&pe[wt])}e.placedSymbolArray.emplaceBack(S.x,S.y,K,this.glyphOffsetArray.length-K,me,I,M,S.segment,l?l[0]:0,l?l[1]:0,d[0],d[1],w,0,!1,0,L)}_addCollisionDebugVertex(e,o,l,d,m,_){return o.emplaceBack(0,0),e.emplaceBack(l.x,l.y,d,m,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(e,o,l,d,m,_,w){const S=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),I=S.vertexLength,M=m.layoutVertexArray,L=m.collisionVertexArray,O=w.anchorX,U=w.anchorY;this._addCollisionDebugVertex(M,L,_,O,U,new mt(e,o)),this._addCollisionDebugVertex(M,L,_,O,U,new mt(l,o)),this._addCollisionDebugVertex(M,L,_,O,U,new mt(l,d)),this._addCollisionDebugVertex(M,L,_,O,U,new mt(e,d)),S.vertexLength+=4;const V=m.indexArray;V.emplaceBack(I,I+1),V.emplaceBack(I+1,I+2),V.emplaceBack(I+2,I+3),V.emplaceBack(I+3,I),S.primitiveLength+=4}addDebugCollisionBoxes(e,o,l,d){for(let m=e;m<o;m++){const _=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,d?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Zf($a,I_.members,da),this.iconCollisionBox=new Zf($a,I_.members,da);for(let e=0;e<this.symbolInstances.length;e++){const o=this.symbolInstances.get(e);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(e,o,l,d,m,_,w,S,I){const M={};for(let L=o;L<l;L++){const O=e.get(L);M.textBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},M.textFeatureIndex=O.featureIndex;break}for(let L=d;L<m;L++){const O=e.get(L);M.verticalTextBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},M.verticalTextFeatureIndex=O.featureIndex;break}for(let L=_;L<w;L++){const O=e.get(L);M.iconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},M.iconFeatureIndex=O.featureIndex;break}for(let L=S;L<I;L++){const O=e.get(L);M.verticalIconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},M.verticalIconFeatureIndex=O.featureIndex;break}return M}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const l=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,o){const l=e.placedSymbolArray.get(o),d=l.vertexStartIndex+4*l.numGlyphs;for(let m=l.vertexStartIndex;m<d;m+=4)e.indexArray.emplaceBack(m,m+1,m+2),e.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(e),l=Math.cos(e),d=[],m=[],_=[];for(let w=0;w<this.symbolInstances.length;++w){_.push(w);const S=this.symbolInstances.get(w);d.push(0|Math.round(o*S.anchorX+l*S.anchorY)),m.push(S.featureIndex)}return _.sort((w,S)=>d[w]-d[S]||m[S]-m[w]),_}addToSortKeyRanges(e,o){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===o?l.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const l=this.symbolInstances.get(o);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((d,m,_)=>{d>=0&&_.indexOf(d)===m&&this.addIndicesForPlacedSymbol(this.text,d)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}lt("SymbolBucket",Ru,{omit:["layers","collisionBoxArray","features","compareText"]}),Ru.MAX_GLYPHS=65535,Ru.addDynamicAttributes=Gf;const T2=new qr({"symbol-placement":new bt(Le.layout_symbol["symbol-placement"]),"symbol-spacing":new bt(Le.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new bt(Le.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Lt(Le.layout_symbol["symbol-sort-key"]),"symbol-z-order":new bt(Le.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new bt(Le.layout_symbol["icon-allow-overlap"]),"icon-overlap":new bt(Le.layout_symbol["icon-overlap"]),"icon-ignore-placement":new bt(Le.layout_symbol["icon-ignore-placement"]),"icon-optional":new bt(Le.layout_symbol["icon-optional"]),"icon-rotation-alignment":new bt(Le.layout_symbol["icon-rotation-alignment"]),"icon-size":new Lt(Le.layout_symbol["icon-size"]),"icon-text-fit":new bt(Le.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new bt(Le.layout_symbol["icon-text-fit-padding"]),"icon-image":new Lt(Le.layout_symbol["icon-image"]),"icon-rotate":new Lt(Le.layout_symbol["icon-rotate"]),"icon-padding":new Lt(Le.layout_symbol["icon-padding"]),"icon-keep-upright":new bt(Le.layout_symbol["icon-keep-upright"]),"icon-offset":new Lt(Le.layout_symbol["icon-offset"]),"icon-anchor":new Lt(Le.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new bt(Le.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new bt(Le.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new bt(Le.layout_symbol["text-rotation-alignment"]),"text-field":new Lt(Le.layout_symbol["text-field"]),"text-font":new Lt(Le.layout_symbol["text-font"]),"text-size":new Lt(Le.layout_symbol["text-size"]),"text-max-width":new Lt(Le.layout_symbol["text-max-width"]),"text-line-height":new bt(Le.layout_symbol["text-line-height"]),"text-letter-spacing":new Lt(Le.layout_symbol["text-letter-spacing"]),"text-justify":new Lt(Le.layout_symbol["text-justify"]),"text-radial-offset":new Lt(Le.layout_symbol["text-radial-offset"]),"text-variable-anchor":new bt(Le.layout_symbol["text-variable-anchor"]),"text-anchor":new Lt(Le.layout_symbol["text-anchor"]),"text-max-angle":new bt(Le.layout_symbol["text-max-angle"]),"text-writing-mode":new bt(Le.layout_symbol["text-writing-mode"]),"text-rotate":new Lt(Le.layout_symbol["text-rotate"]),"text-padding":new bt(Le.layout_symbol["text-padding"]),"text-keep-upright":new bt(Le.layout_symbol["text-keep-upright"]),"text-transform":new Lt(Le.layout_symbol["text-transform"]),"text-offset":new Lt(Le.layout_symbol["text-offset"]),"text-allow-overlap":new bt(Le.layout_symbol["text-allow-overlap"]),"text-overlap":new bt(Le.layout_symbol["text-overlap"]),"text-ignore-placement":new bt(Le.layout_symbol["text-ignore-placement"]),"text-optional":new bt(Le.layout_symbol["text-optional"])});var Wf={paint:new qr({"icon-opacity":new Lt(Le.paint_symbol["icon-opacity"]),"icon-color":new Lt(Le.paint_symbol["icon-color"]),"icon-halo-color":new Lt(Le.paint_symbol["icon-halo-color"]),"icon-halo-width":new Lt(Le.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Lt(Le.paint_symbol["icon-halo-blur"]),"icon-translate":new bt(Le.paint_symbol["icon-translate"]),"icon-translate-anchor":new bt(Le.paint_symbol["icon-translate-anchor"]),"text-opacity":new Lt(Le.paint_symbol["text-opacity"]),"text-color":new Lt(Le.paint_symbol["text-color"],{runtimeType:wr,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new Lt(Le.paint_symbol["text-halo-color"]),"text-halo-width":new Lt(Le.paint_symbol["text-halo-width"]),"text-halo-blur":new Lt(Le.paint_symbol["text-halo-blur"]),"text-translate":new bt(Le.paint_symbol["text-translate"]),"text-translate-anchor":new bt(Le.paint_symbol["text-translate-anchor"])}),layout:T2};class ev{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Kn,this.defaultValue=e}evaluate(e){if(e.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(e.formattedSection))return o.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}lt("FormatSectionOverride",ev,{omit:["defaultValue"]});class Ed extends Ho{constructor(e){super(e,Wf)}recalculate(e,o){if(super.recalculate(e,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const d=[];for(const m of l)d.indexOf(m)<0&&d.push(m);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,o,l,d){const m=this.layout.get(e).evaluate(o,{},l,d),_=this._unevaluatedLayout._values[e];return _.isDataDriven()||ts(_.value)||!m?m:function(w,S){return S.replace(/{([^{}]+)}/g,(I,M)=>M in w?String(w[M]):"")}(o.properties,m)}createBucket(e){return new Ru(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of Wf.paint.overridableProperties){if(!Ed.hasPaintOverride(this.layout,e))continue;const o=this.paint.get(e),l=new ev(o),d=new So(l,o.property.specification);let m=null;m=o.value.kind==="constant"||o.value.kind==="source"?new ns("source",d):new Eo("composite",d,o.value.zoomStops),this.paint._values[e]=new Wo(o.property,m,o.parameters)}}_handleOverridablePaintPropertyUpdate(e,o,l){return!(!this.layout||o.isDataDriven()||l.isDataDriven())&&Ed.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,o){const l=e.get("text-field"),d=Wf.paint.properties[o];let m=!1;const _=w=>{for(const S of w)if(d.overrides&&d.overrides.hasOverride(S))return void(m=!0)};if(l.value.kind==="constant"&&l.value.value instanceof oe)_(l.value.value.sections);else if(l.value.kind==="source"){const w=I=>{m||(I instanceof _t&&ke(I.value)===ur?_(I.value.sections):I instanceof Ns?_(I.sections):I.eachChild(w))},S=l.value;S._styleExpression&&w(S._styleExpression.expression)}return m}}function Hf(r,e,o){let l="never";const d=r.get(e);return d?l=d:r.get(o)&&(l="always"),l}var k2={paint:new qr({"background-color":new bt(Le.paint_background["background-color"]),"background-pattern":new kc(Le.paint_background["background-pattern"]),"background-opacity":new bt(Le.paint_background["background-opacity"])})},C2={paint:new qr({"raster-opacity":new bt(Le.paint_raster["raster-opacity"]),"raster-hue-rotate":new bt(Le.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new bt(Le.paint_raster["raster-brightness-min"]),"raster-brightness-max":new bt(Le.paint_raster["raster-brightness-max"]),"raster-saturation":new bt(Le.paint_raster["raster-saturation"]),"raster-contrast":new bt(Le.paint_raster["raster-contrast"]),"raster-resampling":new bt(Le.paint_raster["raster-resampling"]),"raster-fade-duration":new bt(Le.paint_raster["raster-fade-duration"])})};class I2 extends Ho{constructor(e){super(e,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const P2={circle:class extends Ho{constructor(r){super(r,aw)}createBucket(r){return new bf(r)}queryRadius(r){const e=r;return Mc("circle-radius",this,e)+Mc("circle-stroke-width",this,e)+sd(this.paint.get("circle-translate"))}queryIntersectsFeature(r,e,o,l,d,m,_,w){const S=ld(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,_),I=this.paint.get("circle-radius").evaluate(e,o)+this.paint.get("circle-stroke-width").evaluate(e,o),M=this.paint.get("circle-pitch-alignment")==="map",L=M?S:function(U,V){return U.map(te=>h_(te,V))}(S,w),O=M?I*_:I;for(const U of l)for(const V of U){const te=M?V:h_(V,w);let K=O;const me=ud([],[V.x,V.y,0,1],w);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?K*=me[3]/m.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(K*=m.cameraToCenterDistance/me[3]),tw(L,te,K))return!0}return!1}},heatmap:class extends Ho{constructor(r){super(r,lw),this._updateColorRamp()}createBucket(r){return new d_(r)}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=f_({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends Ho{constructor(r){super(r,uw)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends Ho{constructor(r){super(r,Tw)}recalculate(r,e){super.recalculate(r,e);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new Lf(r)}queryRadius(){return sd(this.paint.get("fill-translate"))}queryIntersectsFeature(r,e,o,l,d,m,_){return r_(ld(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,_),l)}isTileClipped(){return!0}},"fill-extrusion":class extends Ho{constructor(r){super(r,Nw)}createBucket(r){return new Rf(r)}queryRadius(){return sd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(r,e,o,l,d,m,_,w){const S=ld(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,_),I=this.paint.get("fill-extrusion-height").evaluate(e,o),M=this.paint.get("fill-extrusion-base").evaluate(e,o),L=function(U,V,te,K){const me=[];for(const Ee of U){const pe=[Ee.x,Ee.y,0,1];ud(pe,pe,V),me.push(new mt(pe[0]/pe[3],pe[1]/pe[3]))}return me}(S,w),O=function(U,V,te,K){const me=[],Ee=[],pe=K[8]*V,be=K[9]*V,Be=K[10]*V,Oe=K[11]*V,ft=K[8]*te,vt=K[9]*te,ut=K[10]*te,rt=K[11]*te;for(const Ke of U){const ct=[],st=[];for(const qe of Ke){const It=qe.x,wt=qe.y,Ht=K[0]*It+K[4]*wt+K[12],Nn=K[1]*It+K[5]*wt+K[13],Zn=K[2]*It+K[6]*wt+K[14],Tr=K[3]*It+K[7]*wt+K[15],Ao=Zn+Be,ii=Tr+Oe,yr=Ht+ft,Fr=Nn+vt,oi=Zn+ut,yi=Tr+rt,$i=new mt((Ht+pe)/ii,(Nn+be)/ii);$i.z=Ao/ii,ct.push($i);const _r=new mt(yr/yi,Fr/yi);_r.z=oi/yi,st.push(_r)}me.push(ct),Ee.push(st)}return[me,Ee]}(l,M,I,w);return function(U,V,te){let K=1/0;r_(te,V)&&(K=S_(te,V[0]));for(let me=0;me<V.length;me++){const Ee=V[me],pe=U[me];for(let be=0;be<Ee.length-1;be++){const Be=Ee[be],Oe=[Be,Ee[be+1],pe[be+1],pe[be],Be];n_(te,Oe)&&(K=Math.min(K,S_(te,Oe)))}}return K!==1/0&&K}(O[0],O[1],L)}},line:class extends Ho{constructor(r){super(r,T_),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ve,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,e){super.recalculate(r,e),this.paint._values["line-floorwidth"]=k_.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new Ff(r)}queryRadius(r){const e=r,o=C_(Mc("line-width",this,e),Mc("line-gap-width",this,e)),l=Mc("line-offset",this,e);return o/2+Math.abs(l)+sd(this.paint.get("line-translate"))}queryIntersectsFeature(r,e,o,l,d,m,_){const w=ld(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,_),S=_/2*C_(this.paint.get("line-width").evaluate(e,o),this.paint.get("line-gap-width").evaluate(e,o)),I=this.paint.get("line-offset").evaluate(e,o);return I&&(l=function(M,L){const O=[];for(let U=0;U<M.length;U++){const V=M[U],te=[];for(let K=0;K<V.length;K++){const me=V[K-1],Ee=V[K],pe=V[K+1],be=K===0?new mt(0,0):Ee.sub(me)._unit()._perp(),Be=K===V.length-1?new mt(0,0):pe.sub(Ee)._unit()._perp(),Oe=be._add(Be)._unit(),ft=Oe.x*Be.x+Oe.y*Be.y;ft!==0&&Oe._mult(1/ft),te.push(Oe._mult(L)._add(Ee))}O.push(te)}return O}(l,I*_)),function(M,L,O){for(let U=0;U<L.length;U++){const V=L[U];if(M.length>=3){for(let te=0;te<V.length;te++)if(Iu(M,V[te]))return!0}if(nw(M,V,O))return!0}return!1}(w,l,S)}isTileClipped(){return!0}},symbol:Ed,background:class extends Ho{constructor(r){super(r,k2)}},raster:class extends Ho{constructor(r){super(r,C2)}}};class A2{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const tv=63710088e-1;class ar{constructor(e,o){if(isNaN(e)||isNaN(o))throw new Error(`Invalid LngLat object: (${e}, ${o})`);if(this.lng=+e,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ar(we(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const o=Math.PI/180,l=this.lat*o,d=e.lat*o,m=Math.sin(l)*Math.sin(d)+Math.cos(l)*Math.cos(d)*Math.cos((e.lng-this.lng)*o);return tv*Math.acos(Math.min(m,1))}toBounds(e=0){const o=360*e/40075017,l=o/Math.cos(Math.PI/180*this.lat);return new Hl(new ar(this.lng-l,this.lat-o),new ar(this.lng+l,this.lat+o))}static convert(e){if(e instanceof ar)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new ar(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new ar(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Hl{constructor(e,o){e&&(o?this.setSouthWest(e).setNorthEast(o):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof ar?new ar(e.lng,e.lat):ar.convert(e),this}setSouthWest(e){return this._sw=e instanceof ar?new ar(e.lng,e.lat):ar.convert(e),this}extend(e){const o=this._sw,l=this._ne;let d,m;if(e instanceof ar)d=e,m=e;else{if(!(e instanceof Hl))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Hl.convert(e)):this.extend(ar.convert(e)):this;if(d=e._sw,m=e._ne,!d||!m)return this}return o||l?(o.lng=Math.min(d.lng,o.lng),o.lat=Math.min(d.lat,o.lat),l.lng=Math.max(m.lng,l.lng),l.lat=Math.max(m.lat,l.lat)):(this._sw=new ar(d.lng,d.lat),this._ne=new ar(m.lng,m.lat)),this}getCenter(){return new ar((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ar(this.getWest(),this.getNorth())}getSouthEast(){return new ar(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:o,lat:l}=ar.convert(e);let d=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&d}static convert(e){return e instanceof Hl?e:e&&new Hl(e)}}const nv=2*Math.PI*tv;function rv(r){return nv*Math.cos(r*Math.PI/180)}function iv(r){return(180+r)/360}function ov(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function av(r,e){return r/rv(e)}function Xf(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class Td{constructor(e,o,l=0){this.x=+e,this.y=+o,this.z=+l}static fromLngLat(e,o=0){const l=ar.convert(e);return new Td(iv(l.lng),ov(l.lat),av(o,l.lat))}toLngLat(){return new ar(360*this.x-180,Xf(this.y))}toAltitude(){return this.z*rv(Xf(this.y))}meterInMercatorCoordinateUnits(){return 1/nv*(e=Xf(this.y),1/Math.cos(e*Math.PI/180));var e}}function sv(r,e,o){var l=2*Math.PI*6378137/256/Math.pow(2,o);return[r*l-2*Math.PI*6378137/2,e*l-2*Math.PI*6378137/2]}class Yf{constructor(e,o,l){if(e<0||e>25||l<0||l>=Math.pow(2,e)||o<0||o>=Math.pow(2,e))throw new Error(`x=${o}, y=${l}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=o,this.y=l,this.key=$c(0,e,e,o,l)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,o,l){const d=(_=this.y,w=this.z,S=sv(256*(m=this.x),256*(_=Math.pow(2,w)-_-1),w),I=sv(256*(m+1),256*(_+1),w),S[0]+","+S[1]+","+I[0]+","+I[1]);var m,_,w,S,I;const M=function(L,O,U){let V,te="";for(let K=L;K>0;K--)V=1<<K-1,te+=(O&V?1:0)+(U&V?2:0);return te}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,M).replace(/{bbox-epsg-3857}/g,d)}isChildOf(e){const o=this.z-e.z;return o>0&&e.x===this.x>>o&&e.y===this.y>>o}getTilePoint(e){const o=Math.pow(2,this.z);return new mt((e.x*o-this.x)*Er,(e.y*o-this.y)*Er)}toString(){return`${this.z}/${this.x}/${this.y}`}}class lv{constructor(e,o){this.wrap=e,this.canonical=o,this.key=$c(e,o.z,o.z,o.x,o.y)}}class Po{constructor(e,o,l,d,m){if(e<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${l}`);this.overscaledZ=e,this.wrap=o,this.canonical=new Yf(l,+d,+m),this.key=$c(o,e,l,d,m)}clone(){return new Po(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-e;return e>this.canonical.z?new Po(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Po(e,this.wrap,e,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(e,o){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-e;return e>this.canonical.z?$c(this.wrap*+o,e,this.canonical.z,this.canonical.x,this.canonical.y):$c(this.wrap*+o,e,e,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const o=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>o&&e.canonical.y===this.canonical.y>>o}children(e){if(this.overscaledZ>=e)return[new Po(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,l=2*this.canonical.x,d=2*this.canonical.y;return[new Po(o,this.wrap,o,l,d),new Po(o,this.wrap,o,l+1,d),new Po(o,this.wrap,o,l,d+1),new Po(o,this.wrap,o,l+1,d+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Po(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Po(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new lv(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Td(e.x-this.wrap,e.y))}}function $c(r,e,o,l,d){(r*=2)<0&&(r=-1*r-1);const m=1<<o;return(m*m*r+m*d+l).toString(36)+o.toString(36)+e.toString(36)}lt("CanonicalTileID",Yf),lt("OverscaledTileID",Po,{omit:["posMatrix"]});class uv{constructor(e,o,l){if(this.uid=e,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return void ze(`"${l}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const d=this.dim=o.height-2;this.data=new Uint32Array(o.data.buffer),this.encoding=l||"mapbox";for(let m=0;m<d;m++)this.data[this._idx(-1,m)]=this.data[this._idx(0,m)],this.data[this._idx(d,m)]=this.data[this._idx(d-1,m)],this.data[this._idx(m,-1)]=this.data[this._idx(m,0)],this.data[this._idx(m,d)]=this.data[this._idx(m,d-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(d,-1)]=this.data[this._idx(d-1,0)],this.data[this._idx(-1,d)]=this.data[this._idx(0,d-1)],this.data[this._idx(d,d)]=this.data[this._idx(d-1,d-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let m=0;m<d;m++)for(let _=0;_<d;_++){const w=this.get(m,_);w>this.max&&(this.max=w),w<this.min&&(this.min=w)}}get(e,o){const l=new Uint8Array(this.data.buffer),d=4*this._idx(e,o);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(l[d],l[d+1],l[d+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(e,o){if(e<-1||e>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(e+1)}_unpackMapbox(e,o,l){return(256*e*256+256*o+l)/10-1e4}_unpackTerrarium(e,o,l){return 256*e+o+l/256-32768}getPixels(){return new Io({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,o,l){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let d=o*this.dim,m=o*this.dim+this.dim,_=l*this.dim,w=l*this.dim+this.dim;switch(o){case-1:d=m-1;break;case 1:m=d+1}switch(l){case-1:_=w-1;break;case 1:w=_+1}const S=-o*this.dim,I=-l*this.dim;for(let M=_;M<w;M++)for(let L=d;L<m;L++)this.data[this._idx(L,M)]=e.data[this._idx(L+S,M+I)]}}lt("DEMData",uv);class cv{constructor(e){this._stringToNumber={},this._numberToString=[];for(let o=0;o<e.length;o++){const l=e[o];this._stringToNumber[l]=o,this._numberToString[o]=l}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class hv{constructor(e,o,l,d,m){this.type="Feature",this._vectorTileFeature=e,e._z=o,e._x=l,e._y=d,this.properties=e.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(e[o]=this[o]);return e}}class dv{constructor(e,o){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Zo(Er,16,0),this.grid3D=new Zo(Er,16,0),this.featureIndexArray=new Wt,this.promoteId=o}insert(e,o,l,d,m,_){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,d,m);const S=_?this.grid3D:this.grid;for(let I=0;I<o.length;I++){const M=o[I],L=[1/0,1/0,-1/0,-1/0];for(let O=0;O<M.length;O++){const U=M[O];L[0]=Math.min(L[0],U.x),L[1]=Math.min(L[1],U.y),L[2]=Math.max(L[2],U.x),L[3]=Math.max(L[3],U.y)}L[0]<Er&&L[1]<Er&&L[2]>=0&&L[3]>=0&&S.insert(w,L[0],L[1],L[2],L[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Hs.VectorTile(new Of(this.rawTileData)).layers,this.sourceLayerCoder=new cv(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,o,l,d){this.loadVTLayers();const m=e.params||{},_=Er/e.tileSize/e.scale,w=Ae(m.filter),S=e.queryGeometry,I=e.queryPadding*_,M=fv(S),L=this.grid.query(M.minX-I,M.minY-I,M.maxX+I,M.maxY+I),O=fv(e.cameraQueryGeometry),U=this.grid3D.query(O.minX-I,O.minY-I,O.maxX+I,O.maxY+I,(K,me,Ee,pe)=>function(be,Be,Oe,ft,vt){for(const rt of be)if(Be<=rt.x&&Oe<=rt.y&&ft>=rt.x&&vt>=rt.y)return!0;const ut=[new mt(Be,Oe),new mt(Be,vt),new mt(ft,vt),new mt(ft,Oe)];if(be.length>2){for(const rt of ut)if(Iu(be,rt))return!0}for(let rt=0;rt<be.length-1;rt++)if(iw(be[rt],be[rt+1],ut))return!0;return!1}(e.cameraQueryGeometry,K-I,me-I,Ee+I,pe+I));for(const K of U)L.push(K);L.sort(M2);const V={};let te;for(let K=0;K<L.length;K++){const me=L[K];if(me===te)continue;te=me;const Ee=this.featureIndexArray.get(me);let pe=null;this.loadMatchingFeature(V,Ee.bucketIndex,Ee.sourceLayerIndex,Ee.featureIndex,w,m.layers,m.availableImages,o,l,d,(be,Be,Oe)=>(pe||(pe=ql(be)),Be.queryIntersectsFeature(S,be,Oe,pe,this.z,e.transform,_,e.pixelPosMatrix)))}return V}loadMatchingFeature(e,o,l,d,m,_,w,S,I,M,L){const O=this.bucketLayerIDs[o];if(_&&!function(K,me){for(let Ee=0;Ee<K.length;Ee++)if(me.indexOf(K[Ee])>=0)return!0;return!1}(_,O))return;const U=this.sourceLayerCoder.decode(l),V=this.vtLayers[U].feature(d);if(m.needGeometry){const K=Zl(V,!0);if(!m.filter(new Gn(this.tileID.overscaledZ),K,this.tileID.canonical))return}else if(!m.filter(new Gn(this.tileID.overscaledZ),V))return;const te=this.getId(V,U);for(let K=0;K<O.length;K++){const me=O[K];if(_&&_.indexOf(me)<0)continue;const Ee=S[me];if(!Ee)continue;let pe={};te&&M&&(pe=M.getState(Ee.sourceLayer||"_geojsonTileLayer",te));const be=Me({},I[me]);be.paint=pv(be.paint,Ee.paint,V,pe,w),be.layout=pv(be.layout,Ee.layout,V,pe,w);const Be=!L||L(V,Ee,pe);if(!Be)continue;const Oe=new hv(V,this.z,this.x,this.y,te);Oe.layer=be;let ft=e[me];ft===void 0&&(ft=e[me]=[]),ft.push({featureIndex:d,feature:Oe,intersectionZ:Be})}}lookupSymbolFeatures(e,o,l,d,m,_,w,S){const I={};this.loadVTLayers();const M=Ae(m);for(const L of e)this.loadMatchingFeature(I,l,d,L,M,_,w,S,o);return I}hasLayer(e){for(const o of this.bucketLayerIDs)for(const l of o)if(e===l)return!0;return!1}getId(e,o){let l=e.id;return this.promoteId&&(l=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof l=="boolean"&&(l=Number(l))),l}}function pv(r,e,o,l,d){return re(r,(m,_)=>{const w=e instanceof jl?e.get(_):null;return w&&w.evaluate?w.evaluate(o,l,d):w})}function fv(r){let e=1/0,o=1/0,l=-1/0,d=-1/0;for(const m of r)e=Math.min(e,m.x),o=Math.min(o,m.y),l=Math.max(l,m.x),d=Math.max(d,m.y);return{minX:e,minY:o,maxX:l,maxY:d}}function M2(r,e){return e-r}var Kf;lt("FeatureIndex",dv,{omit:["rawTileData","sourceLayerCoder"]}),u.PerformanceMarkers=void 0,(Kf=u.PerformanceMarkers||(u.PerformanceMarkers={})).create="create",Kf.load="load",Kf.fullLoad="fullLoad";let kd=null,jc=[];const Jf=1e3/30,z2={mark(r){performance.mark(r)},frame(r){const e=r;kd!=null&&jc.push(e-kd),kd=e},clearMetrics(){kd=null,jc=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const r in u.PerformanceMarkers)performance.clearMarks(u.PerformanceMarkers[r])},getPerformanceMetrics(){performance.measure("loadTime",u.PerformanceMarkers.create,u.PerformanceMarkers.load),performance.measure("fullLoadTime",u.PerformanceMarkers.create,u.PerformanceMarkers.fullLoad);const r=performance.getEntriesByName("loadTime")[0].duration,e=performance.getEntriesByName("fullLoadTime")[0].duration,o=jc.length,l=1/(jc.reduce((m,_)=>m+_,0)/o/1e3),d=jc.filter(m=>m>Jf).reduce((m,_)=>m+(_-Jf)/Jf,0);return{loadTime:r,fullLoadTime:e,fps:l,percentDroppedFrames:d/(o+d)*100}}};u.AJAXError=Ur,u.ARRAY_TYPE=zi,u.Actor=class{constructor(r,e,o){this.target=r,this.parent=e,this.mapId=o,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Ze(["receive","process"],this),this.invoker=new A2(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Xe()?r:window}send(r,e,o,l,d=!1){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(this.callbacks[m]=o);const _=An(this.globalScope)?void 0:[];return this.target.postMessage({id:m,type:r,hasCallback:!!o,targetMapId:l,mustQueue:d,sourceMapId:this.mapId,data:ro(e,_)},_),{cancel:()=>{o&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:l,sourceMapId:this.mapId})}}}receive(r){const e=r.data,o=e.id;if(o&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){delete this.tasks[o];const l=this.cancelCallbacks[o];delete this.cancelCallbacks[o],l&&l()}else Xe()||e.mustQueue?(this.tasks[o]=e,this.taskQueue.push(o),this.invoker.trigger()):this.processTask(o,e)}process(){if(!this.taskQueue.length)return;const r=this.taskQueue.shift(),e=this.tasks[r];delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(r,e)}processTask(r,e){if(e.type==="<response>"){const o=this.callbacks[r];delete this.callbacks[r],o&&(e.error?o(io(e.error)):o(null,io(e.data)))}else{let o=!1;const l=An(this.globalScope)?void 0:[],d=e.hasCallback?(w,S)=>{o=!0,delete this.cancelCallbacks[r],this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:w?ro(w):null,data:ro(S,l)},l)}:w=>{o=!0};let m=null;const _=io(e.data);if(this.parent[e.type])m=this.parent[e.type](e.sourceMapId,_,d);else if(this.parent.getWorkerSource){const w=e.type.split(".");m=this.parent.getWorkerSource(e.sourceMapId,w[0],_.source)[w[1]](_,d)}else d(new Error(`Could not find function ${e.type}`));!o&&m&&m.cancel&&(this.cancelCallbacks[r]=m.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},u.AlphaImage=Lc,u.CanonicalTileID=Yf,u.CollisionBoxArray=De,u.CollisionCircleLayoutArray=class extends z{},u.Color=j,u.DEMData=uv,u.DataConstantProperty=bt,u.DictionaryCoder=cv,u.EXTENT=Er,u.ErrorEvent=aa,u.EvaluationParameters=Gn,u.Event=Ki,u.Evented=Ji,u.FeatureIndex=dv,u.FillBucket=Lf,u.FillExtrusionBucket=Rf,u.GeoJSONFeature=hv,u.ImageAtlas=F_,u.ImagePosition=Nf,u.LineBucket=Ff,u.LineStripIndexArray=class extends Y{},u.LngLat=ar,u.LngLatBounds=Hl,u.MercatorCoordinate=Td,u.ONE_EM=Zr,u.OverscaledTileID=Po,u.PerformanceUtils=z2,u.PosArray=Ct,u.Properties=qr,u.QuadTriangleArray=class extends N{},u.RGBAImage=Io,u.RasterBoundsArray=class extends h{},u.RequestPerformance=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},u.ResourceType=Nr,u.SegmentVector=Kt,u.SymbolBucket=Ru,u.Transitionable=td,u.TriangleIndexArray=Ai,u.Uniform1f=cs,u.Uniform1i=class extends us{constructor(r,e){super(r,e),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},u.Uniform2f=class extends us{constructor(r,e){super(r,e),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},u.Uniform3f=class extends us{constructor(r,e){super(r,e),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},u.Uniform4f=ku,u.UniformColor=Jy,u.UniformMatrix4f=class extends us{constructor(r,e){super(r,e),this.current=Qb}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let e=1;e<16;e++)if(r[e]!==this.current[e]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},u.UnwrappedTileID=lv,u.ValidationError=Je,u.ZoomHistory=Fa,u.add=function(r,e,o){return r[0]=e[0]+o[0],r[1]=e[1]+o[1],r[2]=e[2]+o[2],r},u.addDynamicAttributes=Gf,u.asyncAll=function(r,e,o){if(!r.length)return o(null,[]);let l=r.length;const d=new Array(r.length);let m=null;r.forEach((_,w)=>{e(_,(S,I)=>{S&&(m=S),d[w]=I,--l==0&&o(m,d)})})},u.bezier=ie,u.bindAll=Ze,u.cacheEntryPossiblyAdded=function(r){Kr++,Kr>Ei&&(r.getActor().send("enforceCacheSizeLimit",Ln),Kr=0)},u.clamp=G,u.clearTileCache=function(r){const e=caches.delete(Pt);r&&e.catch(r).then(()=>r())},u.clipLine=H_,u.clone=function(r){var e=new zi(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},u.clone$1=se,u.clone$2=function(r){var e=new zi(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e},u.collisionCircleLayout=Yw,u.config=at,u.copy=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},u.create=function(){var r=new zi(16);return zi!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},u.create$1=a_,u.createExpression=Ii,u.createFilter=Ae,u.createLayout=gr,u.createStyleLayer=function(r){return r.type==="custom"?new I2(r):new P2[r.type](r)},u.cross=function(r,e,o){var l=e[0],d=e[1],m=e[2],_=o[0],w=o[1],S=o[2];return r[0]=d*S-m*w,r[1]=m*_-l*S,r[2]=l*w-d*_,r},u.dot=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]},u.dot$1=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]},u.ease=ne,u.emitValidationErrors=qo,u.enforceCacheSizeLimit=function(r){Yr(),Qe&&Qe.then(e=>{e.keys().then(o=>{for(let l=0;l<o.length-r;l++)e.delete(o[l])})})},u.equals=function(r,e){var o=r[0],l=r[1],d=r[2],m=r[3],_=r[4],w=r[5],S=r[6],I=r[7],M=r[8],L=r[9],O=r[10],U=r[11],V=r[12],te=r[13],K=r[14],me=r[15],Ee=e[0],pe=e[1],be=e[2],Be=e[3],Oe=e[4],ft=e[5],vt=e[6],ut=e[7],rt=e[8],Ke=e[9],ct=e[10],st=e[11],qe=e[12],It=e[13],wt=e[14],Ht=e[15];return Math.abs(o-Ee)<=Mi*Math.max(1,Math.abs(o),Math.abs(Ee))&&Math.abs(l-pe)<=Mi*Math.max(1,Math.abs(l),Math.abs(pe))&&Math.abs(d-be)<=Mi*Math.max(1,Math.abs(d),Math.abs(be))&&Math.abs(m-Be)<=Mi*Math.max(1,Math.abs(m),Math.abs(Be))&&Math.abs(_-Oe)<=Mi*Math.max(1,Math.abs(_),Math.abs(Oe))&&Math.abs(w-ft)<=Mi*Math.max(1,Math.abs(w),Math.abs(ft))&&Math.abs(S-vt)<=Mi*Math.max(1,Math.abs(S),Math.abs(vt))&&Math.abs(I-ut)<=Mi*Math.max(1,Math.abs(I),Math.abs(ut))&&Math.abs(M-rt)<=Mi*Math.max(1,Math.abs(M),Math.abs(rt))&&Math.abs(L-Ke)<=Mi*Math.max(1,Math.abs(L),Math.abs(Ke))&&Math.abs(O-ct)<=Mi*Math.max(1,Math.abs(O),Math.abs(ct))&&Math.abs(U-st)<=Mi*Math.max(1,Math.abs(U),Math.abs(st))&&Math.abs(V-qe)<=Mi*Math.max(1,Math.abs(V),Math.abs(qe))&&Math.abs(te-It)<=Mi*Math.max(1,Math.abs(te),Math.abs(It))&&Math.abs(K-wt)<=Mi*Math.max(1,Math.abs(K),Math.abs(wt))&&Math.abs(me-Ht)<=Mi*Math.max(1,Math.abs(me),Math.abs(Ht))},u.evaluateSizeForFeature=function(r,{uSize:e,uSizeT:o},{lowerSize:l,upperSize:d}){return r.kind==="source"?l/ps:r.kind==="composite"?Ge(l/ps,d/ps,o):e},u.evaluateSizeForZoom=function(r,e){let o=0,l=0;if(r.kind==="constant")l=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:d,minZoom:m,maxZoom:_}=r,w=d?G(Qr.interpolationFactor(d,e,m,_),0,1):0;r.kind==="camera"?l=Ge(r.minSize,r.maxSize,w):o=w}return{uSizeT:o,uSize:l}},u.evaluateVariableOffset=K_,u.evented=Tc,u.exported=zn,u.exported$1=Cr,u.extend=Me,u.filterObject=J,u.fromRotation=function(r,e){var o=Math.sin(e),l=Math.cos(e);return r[0]=l,r[1]=o,r[2]=0,r[3]=-o,r[4]=l,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},u.fromScaling=function(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},u.getAnchorAlignment=Vf,u.getAnchorJustification=jf,u.getArrayBuffer=ka,u.getImage=Ti,u.getJSON=function(r,e){return hi(Me(r,{type:"json"}),e)},u.getOverlapMode=Hf,u.getRTLTextPluginStatus=Vl,u.getReferrer=go,u.getVideo=function(r,e){const o=window.document.createElement("video");o.muted=!0,o.onloadstart=function(){e(null,o)};for(let l=0;l<r.length;l++){const d=window.document.createElement("source");Ca(r[l])||(o.crossOrigin="Anonymous"),d.src=r[l],o.appendChild(d)}return{cancel:()=>{}}},u.identity=Ef,u.invert=function(r,e){var o=e[0],l=e[1],d=e[2],m=e[3],_=e[4],w=e[5],S=e[6],I=e[7],M=e[8],L=e[9],O=e[10],U=e[11],V=e[12],te=e[13],K=e[14],me=e[15],Ee=o*w-l*_,pe=o*S-d*_,be=o*I-m*_,Be=l*S-d*w,Oe=l*I-m*w,ft=d*I-m*S,vt=M*te-L*V,ut=M*K-O*V,rt=M*me-U*V,Ke=L*K-O*te,ct=L*me-U*te,st=O*me-U*K,qe=Ee*st-pe*ct+be*Ke+Be*rt-Oe*ut+ft*vt;return qe?(r[0]=(w*st-S*ct+I*Ke)*(qe=1/qe),r[1]=(d*ct-l*st-m*Ke)*qe,r[2]=(te*ft-K*Oe+me*Be)*qe,r[3]=(O*Oe-L*ft-U*Be)*qe,r[4]=(S*rt-_*st-I*ut)*qe,r[5]=(o*st-d*rt+m*ut)*qe,r[6]=(K*be-V*ft-me*pe)*qe,r[7]=(M*ft-O*be+U*pe)*qe,r[8]=(_*ct-w*rt+I*vt)*qe,r[9]=(l*rt-o*ct-m*vt)*qe,r[10]=(V*Oe-te*be+me*Ee)*qe,r[11]=(L*be-M*Oe-U*Ee)*qe,r[12]=(w*ut-_*Ke-S*vt)*qe,r[13]=(o*Ke-l*ut+d*vt)*qe,r[14]=(te*pe-V*Be-K*Ee)*qe,r[15]=(M*Be-L*pe+O*Ee)*qe,r):null},u.isImageBitmap=sn,u.isSafari=An,u.isWorker=Xe,u.keysDifference=function(r,e){const o=[];for(const l in r)l in e||o.push(l);return o},u.lazyLoadRTLTextPlugin=function(){oo.isLoading()||oo.isLoaded()||Vl()!=="deferred"||ed()},u.makeRequest=hi,u.mapObject=re,u.mercatorXfromLng=iv,u.mercatorYfromLat=ov,u.mercatorZfromAltitude=av,u.mul=sw,u.mul$1=function(r,e,o){return r[0]=e[0]*o[0],r[1]=e[1]*o[1],r[2]=e[2]*o[2],r[3]=e[3]*o[3],r},u.multiply=s_,u.nextPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},u.normalize=function(r,e){var o=e[0],l=e[1],d=e[2],m=o*o+l*l+d*d;return m>0&&(m=1/Math.sqrt(m)),r[0]=e[0]*m,r[1]=e[1]*m,r[2]=e[2]*m,r},u.number=Ge,u.ortho=function(r,e,o,l,d,m,_){var w=1/(e-o),S=1/(l-d),I=1/(m-_);return r[0]=-2*w,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*S,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*I,r[11]=0,r[12]=(e+o)*w,r[13]=(d+l)*S,r[14]=(_+m)*I,r[15]=1,r},u.parseCacheControl=Ut,u.parseGlyphPbf=function(r){return new Of(r).readFields(s2,[])},u.pbf=Of,u.performSymbolLayout=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=Er/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const e=r.bucket.layers[0].layout,o=r.bucket.layers[0]._unevaluatedLayout._values,l={layoutIconSize:o["icon-size"].possiblyEvaluate(new Gn(r.bucket.zoom+1),r.canonical),layoutTextSize:o["text-size"].possiblyEvaluate(new Gn(r.bucket.zoom+1),r.canonical),textMaxSize:o["text-size"].possiblyEvaluate(new Gn(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:S,maxZoom:I}=r.bucket.textSizeData;l.compositeTextSizes=[o["text-size"].possiblyEvaluate(new Gn(S),r.canonical),o["text-size"].possiblyEvaluate(new Gn(I),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:S,maxZoom:I}=r.bucket.iconSizeData;l.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new Gn(S),r.canonical),o["icon-size"].possiblyEvaluate(new Gn(I),r.canonical)]}const d=e.get("text-line-height")*Zr,m=e.get("text-rotation-alignment")!=="viewport"&&e.get("symbol-placement")!=="point",_=e.get("text-keep-upright"),w=e.get("text-size");for(const S of r.bucket.features){const I=e.get("text-font").evaluate(S,{},r.canonical).join(","),M=w.evaluate(S,{},r.canonical),L=l.layoutTextSize.evaluate(S,{},r.canonical),O=l.layoutIconSize.evaluate(S,{},r.canonical),U={horizontal:{},vertical:void 0},V=S.text;let te,K=[0,0];if(V){const pe=V.toString(),be=e.get("text-letter-spacing").evaluate(S,{},r.canonical)*Zr,Be=js(pe)?be:0,Oe=e.get("text-anchor").evaluate(S,{},r.canonical),ft=e.get("text-variable-anchor");if(!ft){const ct=e.get("text-radial-offset").evaluate(S,{},r.canonical);K=ct?K_(Oe,[ct*Zr,$f]):e.get("text-offset").evaluate(S,{},r.canonical).map(st=>st*Zr)}let vt=m?"center":e.get("text-justify").evaluate(S,{},r.canonical);const ut=e.get("symbol-placement"),rt=ut==="point"?e.get("text-max-width").evaluate(S,{},r.canonical)*Zr:0,Ke=()=>{r.bucket.allowVerticalPlacement&&as(pe)&&(U.vertical=yd(V,r.glyphMap,r.glyphPositions,r.imagePositions,I,rt,d,Oe,"left",Be,K,u.WritingMode.vertical,!0,ut,L,M))};if(!m&&ft){const ct=vt==="auto"?ft.map(qe=>jf(qe)):[vt];let st=!1;for(let qe=0;qe<ct.length;qe++){const It=ct[qe];if(!U.horizontal[It])if(st)U.horizontal[It]=U.horizontal[0];else{const wt=yd(V,r.glyphMap,r.glyphPositions,r.imagePositions,I,rt,d,"center",It,Be,K,u.WritingMode.horizontal,!1,ut,L,M);wt&&(U.horizontal[It]=wt,st=wt.positionedLines.length===1)}}Ke()}else{vt==="auto"&&(vt=jf(Oe));const ct=yd(V,r.glyphMap,r.glyphPositions,r.imagePositions,I,rt,d,Oe,vt,Be,K,u.WritingMode.horizontal,!1,ut,L,M);ct&&(U.horizontal[vt]=ct),Ke(),as(pe)&&m&&_&&(U.vertical=yd(V,r.glyphMap,r.glyphPositions,r.imagePositions,I,rt,d,Oe,vt,Be,K,u.WritingMode.vertical,!1,ut,L,M))}}let me=!1;if(S.icon&&S.icon.name){const pe=r.imageMap[S.icon.name];pe&&(te=p2(r.imagePositions[S.icon.name],e.get("icon-offset").evaluate(S,{},r.canonical),e.get("icon-anchor").evaluate(S,{},r.canonical)),me=!!pe.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=me:r.bucket.sdfIcons!==me&&ze("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(pe.pixelRatio!==r.bucket.pixelRatio||e.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const Ee=Q_(U.horizontal)||U.vertical;r.bucket.iconsInText=!!Ee&&Ee.iconsInText,(Ee||te)&&x2(r.bucket,S,U,te,r.imageMap,l,L,O,K,me,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},u.perspective=function(r,e,o,l,d){var m,_=1/Math.tan(e/2);return r[0]=_/o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=_,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,d!=null&&d!==1/0?(r[10]=(d+l)*(m=1/(l-d)),r[14]=2*d*l*m):(r[10]=-1,r[14]=-2*l),r},u.pick=function(r,e){const o={};for(let l=0;l<e.length;l++){const d=e[l];d in r&&(o[d]=r[d])}return o},u.plugin=oo,u.pointGeometry=mt,u.polygonIntersectsPolygon=n_,u.potpack=R_,u.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],u.register=lt,u.registerForPluginStateChange=function(r){return r({pluginStatus:Pi,pluginURL:Ba}),Tc.on("pluginStateChange",r),r},u.renderColorRamp=f_,u.rotateX=function(r,e,o){var l=Math.sin(o),d=Math.cos(o),m=e[4],_=e[5],w=e[6],S=e[7],I=e[8],M=e[9],L=e[10],O=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=m*d+I*l,r[5]=_*d+M*l,r[6]=w*d+L*l,r[7]=S*d+O*l,r[8]=I*d-m*l,r[9]=M*d-_*l,r[10]=L*d-w*l,r[11]=O*d-S*l,r},u.rotateZ=function(r,e,o){var l=Math.sin(o),d=Math.cos(o),m=e[0],_=e[1],w=e[2],S=e[3],I=e[4],M=e[5],L=e[6],O=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=m*d+I*l,r[1]=_*d+M*l,r[2]=w*d+L*l,r[3]=S*d+O*l,r[4]=I*d-m*l,r[5]=M*d-_*l,r[6]=L*d-w*l,r[7]=O*d-S*l,r},u.scale=function(r,e,o){var l=o[0],d=o[1],m=o[2];return r[0]=e[0]*l,r[1]=e[1]*l,r[2]=e[2]*l,r[3]=e[3]*l,r[4]=e[4]*d,r[5]=e[5]*d,r[6]=e[6]*d,r[7]=e[7]*d,r[8]=e[8]*m,r[9]=e[9]*m,r[10]=e[10]*m,r[11]=e[11]*m,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},u.scale$1=function(r,e,o){return r[0]=e[0]*o,r[1]=e[1]*o,r[2]=e[2]*o,r},u.setCacheLimits=function(r,e){Ln=r,Ei=e},u.setRTLTextPlugin=function(r,e,o=!1){if(Pi===bc||Pi===wc||Pi===Sc)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ba=zn.resolveURL(r),Pi=bc,Ec=e,Gs(),o||ed()},u.spec=Le,u.sphericalToCartesian=function([r,e,o]){return e+=90,e*=Math.PI/180,o*=Math.PI/180,{x:r*Math.cos(e)*Math.sin(o),y:r*Math.sin(e)*Math.sin(o),z:r*Math.cos(o)}},u.sqrLen=function(r){var e=r[0],o=r[1];return e*e+o*o},u.sub=function(r,e,o){return r[0]=e[0]-o[0],r[1]=e[1]-o[1],r[2]=e[2]-o[2],r},u.toEvaluationFeature=Zl,u.transformMat3=function(r,e,o){var l=e[0],d=e[1],m=e[2];return r[0]=l*o[0]+d*o[3]+m*o[6],r[1]=l*o[1]+d*o[4]+m*o[7],r[2]=l*o[2]+d*o[5]+m*o[8],r},u.transformMat4=ud,u.transformMat4$1=function(r,e,o){var l=e[0],d=e[1];return r[0]=o[0]*l+o[4]*d+o[12],r[1]=o[1]*l+o[5]*d+o[13],r},u.translate=function(r,e,o){var l,d,m,_,w,S,I,M,L,O,U,V,te=o[0],K=o[1],me=o[2];return e===r?(r[12]=e[0]*te+e[4]*K+e[8]*me+e[12],r[13]=e[1]*te+e[5]*K+e[9]*me+e[13],r[14]=e[2]*te+e[6]*K+e[10]*me+e[14],r[15]=e[3]*te+e[7]*K+e[11]*me+e[15]):(d=e[1],m=e[2],_=e[3],w=e[4],S=e[5],I=e[6],M=e[7],L=e[8],O=e[9],U=e[10],V=e[11],r[0]=l=e[0],r[1]=d,r[2]=m,r[3]=_,r[4]=w,r[5]=S,r[6]=I,r[7]=M,r[8]=L,r[9]=O,r[10]=U,r[11]=V,r[12]=l*te+w*K+L*me+e[12],r[13]=d*te+S*K+O*me+e[13],r[14]=m*te+I*K+U*me+e[14],r[15]=_*te+M*K+V*me+e[15]),r},u.triggerPluginCompletionEvent=Qh,u.unicodeBlockLookup=tt,u.uniqueId=function(){return Ce++},u.validateCustomStyleLayer=function(r){const e=[],o=r.id;return o===void 0&&e.push({message:`layers.${o}: missing required property "id"`}),r.render===void 0&&e.push({message:`layers.${o}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&e.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),e},u.validateLight=ni,u.validateStyle=ha,u.vectorTile=Hs,u.warnOnce=ze,u.wrap=we}),v(["./shared"],function(u){function F(q){const A=typeof q;if(A==="number"||A==="boolean"||A==="string"||q==null)return JSON.stringify(q);if(Array.isArray(q)){let j="[";for(const Q of q)j+=`${F(Q)},`;return`${j}]`}const D=Object.keys(q).sort();let $="{";for(let j=0;j<D.length;j++)$+=`${JSON.stringify(D[j])}:${F(q[D[j]])},`;return`${$}}`}function W(q){let A="";for(const D of u.refProperties)A+=`/${F(q[D])}`;return A}class ie{constructor(A){this.keyCache={},A&&this.replace(A)}replace(A){this._layerConfigs={},this._layers={},this.update(A,[])}update(A,D){for(const j of A){this._layerConfigs[j.id]=j;const Q=this._layers[j.id]=u.createStyleLayer(j);Q._featureFilter=u.createFilter(Q.filter),this.keyCache[j.id]&&delete this.keyCache[j.id]}for(const j of D)delete this.keyCache[j],delete this._layerConfigs[j],delete this._layers[j];this.familiesBySource={};const $=function(j,Q){const ue={};for(let ee=0;ee<j.length;ee++){const ce=Q&&Q[j[ee].id]||W(j[ee]);Q&&(Q[j[ee].id]=ce);let Ie=ue[ce];Ie||(Ie=ue[ce]=[]),Ie.push(j[ee])}const oe=[];for(const ee in ue)oe.push(ue[ee]);return oe}(Object.values(this._layerConfigs),this.keyCache);for(const j of $){const Q=j.map(Ue=>this._layers[Ue.id]),ue=Q[0];if(ue.visibility==="none")continue;const oe=ue.source||"";let ee=this.familiesBySource[oe];ee||(ee=this.familiesBySource[oe]={});const ce=ue.sourceLayer||"_geojsonTileLayer";let Ie=ee[ce];Ie||(Ie=ee[ce]=[]),Ie.push(Q)}}}class ne{constructor(A){const D={},$=[];for(const oe in A){const ee=A[oe],ce=D[oe]={};for(const Ie in ee){const Ue=ee[+Ie];if(!Ue||Ue.bitmap.width===0||Ue.bitmap.height===0)continue;const ke={x:0,y:0,w:Ue.bitmap.width+2,h:Ue.bitmap.height+2};$.push(ke),ce[Ie]={rect:ke,metrics:Ue.metrics}}}const{w:j,h:Q}=u.potpack($),ue=new u.AlphaImage({width:j||1,height:Q||1});for(const oe in A){const ee=A[oe];for(const ce in ee){const Ie=ee[+ce];if(!Ie||Ie.bitmap.width===0||Ie.bitmap.height===0)continue;const Ue=D[oe][ce].rect;u.AlphaImage.copy(Ie.bitmap,ue,{x:0,y:0},{x:Ue.x+1,y:Ue.y+1},Ie.bitmap)}}this.image=ue,this.positions=D}}u.register("GlyphAtlas",ne);class G{constructor(A){this.tileID=new u.OverscaledTileID(A.tileID.overscaledZ,A.tileID.wrap,A.tileID.canonical.z,A.tileID.canonical.x,A.tileID.canonical.y),this.uid=A.uid,this.zoom=A.zoom,this.pixelRatio=A.pixelRatio,this.tileSize=A.tileSize,this.source=A.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=A.showCollisionBoxes,this.collectResourceTiming=!!A.collectResourceTiming,this.returnDependencies=!!A.returnDependencies,this.promoteId=A.promoteId}parse(A,D,$,j,Q){this.status="parsing",this.data=A,this.collisionBoxArray=new u.CollisionBoxArray;const ue=new u.DictionaryCoder(Object.keys(A.layers).sort()),oe=new u.FeatureIndex(this.tileID,this.promoteId);oe.bucketLayerIDs=[];const ee={},ce={featureIndex:oe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:$},Ie=D.familiesBySource[this.source];for(const Ft in Ie){const qt=A.layers[Ft];if(!qt)continue;qt.version===1&&u.warnOnce(`Vector tile source "${this.source}" layer "${Ft}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const nn=ue.encode(Ft),Nt=[];for(let cr=0;cr<qt.length;cr++){const Dn=qt.feature(cr),$n=oe.getId(Dn,Ft);Nt.push({feature:Dn,id:$n,index:cr,sourceLayerIndex:nn})}for(const cr of Ie[Ft]){const Dn=cr[0];Dn.source!==this.source&&u.warnOnce(`layer.source = ${Dn.source} does not equal this.source = ${this.source}`),Dn.minzoom&&this.zoom<Math.floor(Dn.minzoom)||Dn.maxzoom&&this.zoom>=Dn.maxzoom||Dn.visibility!=="none"&&(we(cr,this.zoom,$),(ee[Dn.id]=Dn.createBucket({index:oe.bucketLayerIDs.length,layers:cr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:nn,sourceID:this.source})).populate(Nt,ce,this.tileID.canonical),oe.bucketLayerIDs.push(cr.map($n=>$n.id)))}}let Ue,ke,gt,_t;const We=u.mapObject(ce.glyphDependencies,Ft=>Object.keys(Ft).map(Number));Object.keys(We).length?j.send("getGlyphs",{uid:this.uid,stacks:We},(Ft,qt)=>{Ue||(Ue=Ft,ke=qt,Qt.call(this))}):ke={};const At=Object.keys(ce.iconDependencies);At.length?j.send("getImages",{icons:At,source:this.source,tileID:this.tileID,type:"icons"},(Ft,qt)=>{Ue||(Ue=Ft,gt=qt,Qt.call(this))}):gt={};const Dt=Object.keys(ce.patternDependencies);function Qt(){if(Ue)return Q(Ue);if(ke&&gt&&_t){const Ft=new ne(ke),qt=new u.ImageAtlas(gt,_t);for(const nn in ee){const Nt=ee[nn];Nt instanceof u.SymbolBucket?(we(Nt.layers,this.zoom,$),u.performSymbolLayout({bucket:Nt,glyphMap:ke,glyphPositions:Ft.positions,imageMap:gt,imagePositions:qt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Nt.hasPattern&&(Nt instanceof u.LineBucket||Nt instanceof u.FillBucket||Nt instanceof u.FillExtrusionBucket)&&(we(Nt.layers,this.zoom,$),Nt.addFeatures(ce,this.tileID.canonical,qt.patternPositions))}this.status="done",Q(null,{buckets:Object.values(ee).filter(nn=>!nn.isEmpty()),featureIndex:oe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ft.image,imageAtlas:qt,glyphMap:this.returnDependencies?ke:null,iconMap:this.returnDependencies?gt:null,glyphPositions:this.returnDependencies?Ft.positions:null})}}Dt.length?j.send("getImages",{icons:Dt,source:this.source,tileID:this.tileID,type:"patterns"},(Ft,qt)=>{Ue||(Ue=Ft,_t=qt,Qt.call(this))}):_t={},Qt.call(this)}}function we(q,A,D){const $=new u.EvaluationParameters(A);for(const j of q)j.recalculate($,D)}function Me(q,A){const D=u.getArrayBuffer(q.request,($,j,Q,ue)=>{$?A($):j&&A(null,{vectorTile:new u.vectorTile.VectorTile(new u.pbf(j)),rawData:j,cacheControl:Q,expires:ue})});return()=>{D.cancel(),A()}}class Ce{constructor(A,D,$,j){this.actor=A,this.layerIndex=D,this.availableImages=$,this.loadVectorData=j||Me,this.loading={},this.loaded={}}loadTile(A,D){const $=A.uid;this.loading||(this.loading={});const j=!!(A&&A.request&&A.request.collectResourceTiming)&&new u.RequestPerformance(A.request),Q=this.loading[$]=new G(A);Q.abort=this.loadVectorData(A,(ue,oe)=>{if(delete this.loading[$],ue||!oe)return Q.status="done",this.loaded[$]=Q,D(ue);const ee=oe.rawData,ce={};oe.expires&&(ce.expires=oe.expires),oe.cacheControl&&(ce.cacheControl=oe.cacheControl);const Ie={};if(j){const Ue=j.finish();Ue&&(Ie.resourceTiming=JSON.parse(JSON.stringify(Ue)))}Q.vectorTile=oe.vectorTile,Q.parse(oe.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ue,ke)=>{if(Ue||!ke)return D(Ue);D(null,u.extend({rawTileData:ee.slice(0)},ke,ce,Ie))}),this.loaded=this.loaded||{},this.loaded[$]=Q})}reloadTile(A,D){const $=this.loaded,j=A.uid,Q=this;if($&&$[j]){const ue=$[j];ue.showCollisionBoxes=A.showCollisionBoxes;const oe=(ee,ce)=>{const Ie=ue.reloadCallback;Ie&&(delete ue.reloadCallback,ue.parse(ue.vectorTile,Q.layerIndex,this.availableImages,Q.actor,Ie)),D(ee,ce)};ue.status==="parsing"?ue.reloadCallback=oe:ue.status==="done"&&(ue.vectorTile?ue.parse(ue.vectorTile,this.layerIndex,this.availableImages,this.actor,oe):oe())}}abortTile(A,D){const $=this.loading,j=A.uid;$&&$[j]&&$[j].abort&&($[j].abort(),delete $[j]),D()}removeTile(A,D){const $=this.loaded,j=A.uid;$&&$[j]&&delete $[j],D()}}class Ze{constructor(){this.loaded={}}loadTile(A,D){const{uid:$,encoding:j,rawImageData:Q}=A,ue=u.isImageBitmap(Q)?this.getImageData(Q):Q,oe=new u.DEMData($,ue,j);this.loaded=this.loaded||{},this.loaded[$]=oe,D(null,oe)}getImageData(A){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(A.width,A.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=A.width,this.offscreenCanvas.height=A.height,this.offscreenCanvasContext.drawImage(A,0,0,A.width,A.height);const D=this.offscreenCanvasContext.getImageData(-1,-1,A.width+2,A.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new u.RGBAImage({width:D.width,height:D.height},D.data)}removeTile(A){const D=this.loaded,$=A.uid;D&&D[$]&&delete D[$]}}var re=function q(A,D){var $,j=A&&A.type;if(j==="FeatureCollection")for($=0;$<A.features.length;$++)q(A.features[$],D);else if(j==="GeometryCollection")for($=0;$<A.geometries.length;$++)q(A.geometries[$],D);else if(j==="Feature")q(A.geometry,D);else if(j==="Polygon")J(A.coordinates,D);else if(j==="MultiPolygon")for($=0;$<A.coordinates.length;$++)J(A.coordinates[$],D);return A};function J(q,A){if(q.length!==0){se(q[0],A);for(var D=1;D<q.length;D++)se(q[D],!A)}}function se(q,A){for(var D=0,$=0,j=0,Q=q.length,ue=Q-1;j<Q;ue=j++){var oe=(q[j][0]-q[ue][0])*(q[ue][1]+q[j][1]),ee=D+oe;$+=Math.abs(D)>=Math.abs(oe)?D-ee+oe:oe-ee+D,D=ee}D+$>=0!=!!A&&q.reverse()}const Te=u.vectorTile.VectorTileFeature.prototype.toGeoJSON;class ze{constructor(A){this._feature=A,this.extent=u.EXTENT,this.type=A.type,this.properties=A.tags,"id"in A&&!isNaN(A.id)&&(this.id=parseInt(A.id,10))}loadGeometry(){if(this._feature.type===1){const A=[];for(const D of this._feature.geometry)A.push([new u.pointGeometry(D[0],D[1])]);return A}{const A=[];for(const D of this._feature.geometry){const $=[];for(const j of D)$.push(new u.pointGeometry(j[0],j[1]));A.push($)}return A}}toGeoJSON(A,D,$){return Te.call(this,A,D,$)}}class He{constructor(A){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=u.EXTENT,this.length=A.length,this._features=A}feature(A){return new ze(this._features[A])}}var it={exports:{}},Xe=u.pointGeometry,Ut=u.vectorTile.VectorTileFeature,xt=Zt;function Zt(q,A){this.options=A||{},this.features=q,this.length=q.length}function dn(q,A){this.id=typeof q.id=="number"?q.id:void 0,this.type=q.type,this.rawGeometry=q.type===1?[q.geometry]:q.geometry,this.properties=q.tags,this.extent=A||4096}Zt.prototype.feature=function(q){return new dn(this.features[q],this.options.extent)},dn.prototype.loadGeometry=function(){var q=this.rawGeometry;this.geometry=[];for(var A=0;A<q.length;A++){for(var D=q[A],$=[],j=0;j<D.length;j++)$.push(new Xe(D[j][0],D[j][1]));this.geometry.push($)}return this.geometry},dn.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var q=this.geometry,A=1/0,D=-1/0,$=1/0,j=-1/0,Q=0;Q<q.length;Q++)for(var ue=q[Q],oe=0;oe<ue.length;oe++){var ee=ue[oe];A=Math.min(A,ee.x),D=Math.max(D,ee.x),$=Math.min($,ee.y),j=Math.max(j,ee.y)}return[A,$,D,j]},dn.prototype.toGeoJSON=Ut.prototype.toGeoJSON;var An=u.pbf,sn=xt;function zn(q){var A=new An;return function(D,$){for(var j in D.layers)$.writeMessage(3,mt,D.layers[j])}(q,A),A.finish()}function mt(q,A){var D;A.writeVarintField(15,q.version||1),A.writeStringField(1,q.name||""),A.writeVarintField(5,q.extent||4096);var $={keys:[],values:[],keycache:{},valuecache:{}};for(D=0;D<q.length;D++)$.feature=q.feature(D),A.writeMessage(2,Un,$);var j=$.keys;for(D=0;D<j.length;D++)A.writeStringField(3,j[D]);var Q=$.values;for(D=0;D<Q.length;D++)A.writeMessage(4,Ln,Q[D])}function Un(q,A){var D=q.feature;D.id!==void 0&&A.writeVarintField(1,D.id),A.writeMessage(2,at,q),A.writeVarintField(3,D.type),A.writeMessage(4,yn,D)}function at(q,A){var D=q.feature,$=q.keys,j=q.values,Q=q.keycache,ue=q.valuecache;for(var oe in D.properties){var ee=D.properties[oe],ce=Q[oe];if(ee!==null){ce===void 0&&($.push(oe),Q[oe]=ce=$.length-1),A.writeVarint(ce);var Ie=typeof ee;Ie!=="string"&&Ie!=="boolean"&&Ie!=="number"&&(ee=JSON.stringify(ee));var Ue=Ie+":"+ee,ke=ue[Ue];ke===void 0&&(j.push(ee),ue[Ue]=ke=j.length-1),A.writeVarint(ke)}}}function Pt(q,A){return(A<<3)+(7&q)}function Qe(q){return q<<1^q>>31}function yn(q,A){for(var D=q.loadGeometry(),$=q.type,j=0,Q=0,ue=D.length,oe=0;oe<ue;oe++){var ee=D[oe],ce=1;$===1&&(ce=ee.length),A.writeVarint(Pt(1,ce));for(var Ie=$===3?ee.length-1:ee.length,Ue=0;Ue<Ie;Ue++){Ue===1&&$!==1&&A.writeVarint(Pt(2,Ie-1));var ke=ee[Ue].x-j,gt=ee[Ue].y-Q;A.writeVarint(Qe(ke)),A.writeVarint(Qe(gt)),j+=ke,Q+=gt}$===3&&A.writeVarint(Pt(7,1))}}function Ln(q,A){var D=typeof q;D==="string"?A.writeStringField(1,q):D==="boolean"?A.writeBooleanField(7,q):D==="number"&&(q%1!=0?A.writeDoubleField(3,q):q<0?A.writeSVarintField(6,q):A.writeVarintField(5,q))}function Ei(q,A,D,$,j,Q){if(j-$<=D)return;const ue=$+j>>1;Yr(q,A,ue,$,j,Q%2),Ei(q,A,D,$,ue-1,Q+1),Ei(q,A,D,ue+1,j,Q+1)}function Yr(q,A,D,$,j,Q){for(;j>$;){if(j-$>600){const ce=j-$+1,Ie=D-$+1,Ue=Math.log(ce),ke=.5*Math.exp(2*Ue/3),gt=.5*Math.sqrt(Ue*ke*(ce-ke)/ce)*(Ie-ce/2<0?-1:1);Yr(q,A,D,Math.max($,Math.floor(D-Ie*ke/ce+gt)),Math.min(j,Math.floor(D+(ce-Ie)*ke/ce+gt)),Q)}const ue=A[2*D+Q];let oe=$,ee=j;for(Kr(q,A,$,D),A[2*j+Q]>ue&&Kr(q,A,$,j);oe<ee;){for(Kr(q,A,oe,ee),oe++,ee--;A[2*oe+Q]<ue;)oe++;for(;A[2*ee+Q]>ue;)ee--}A[2*$+Q]===ue?Kr(q,A,$,ee):(ee++,Kr(q,A,ee,j)),ee<=D&&($=ee+1),D<=ee&&(j=ee-1)}}function Kr(q,A,D,$){Cr(q,D,$),Cr(A,2*D,2*$),Cr(A,2*D+1,2*$+1)}function Cr(q,A,D){const $=q[A];q[A]=q[D],q[D]=$}function ci(q,A,D,$){const j=q-D,Q=A-$;return j*j+Q*Q}it.exports=zn,it.exports.fromVectorTileJs=zn,it.exports.fromGeojsonVt=function(q,A){A=A||{};var D={};for(var $ in q)D[$]=new sn(q[$].features,A),D[$].name=$,D[$].version=A.version,D[$].extent=A.extent;return zn({layers:D})},it.exports.GeoJSONWrapper=sn;const No=q=>q[0],Jr=q=>q[1];class Ta{constructor(A,D=No,$=Jr,j=64,Q=Float64Array){this.nodeSize=j,this.points=A;const ue=A.length<65536?Uint16Array:Uint32Array,oe=this.ids=new ue(A.length),ee=this.coords=new Q(2*A.length);for(let ce=0;ce<A.length;ce++)oe[ce]=ce,ee[2*ce]=D(A[ce]),ee[2*ce+1]=$(A[ce]);Ei(oe,ee,j,0,oe.length-1,0)}range(A,D,$,j){return function(Q,ue,oe,ee,ce,Ie,Ue){const ke=[0,Q.length-1,0],gt=[];let _t,We;for(;ke.length;){const At=ke.pop(),Dt=ke.pop(),Qt=ke.pop();if(Dt-Qt<=Ue){for(let nn=Qt;nn<=Dt;nn++)_t=ue[2*nn],We=ue[2*nn+1],_t>=oe&&_t<=ce&&We>=ee&&We<=Ie&&gt.push(Q[nn]);continue}const Ft=Math.floor((Qt+Dt)/2);_t=ue[2*Ft],We=ue[2*Ft+1],_t>=oe&&_t<=ce&&We>=ee&&We<=Ie&&gt.push(Q[Ft]);const qt=(At+1)%2;(At===0?oe<=_t:ee<=We)&&(ke.push(Qt),ke.push(Ft-1),ke.push(qt)),(At===0?ce>=_t:Ie>=We)&&(ke.push(Ft+1),ke.push(Dt),ke.push(qt))}return gt}(this.ids,this.coords,A,D,$,j,this.nodeSize)}within(A,D,$){return function(j,Q,ue,oe,ee,ce){const Ie=[0,j.length-1,0],Ue=[],ke=ee*ee;for(;Ie.length;){const gt=Ie.pop(),_t=Ie.pop(),We=Ie.pop();if(_t-We<=ce){for(let qt=We;qt<=_t;qt++)ci(Q[2*qt],Q[2*qt+1],ue,oe)<=ke&&Ue.push(j[qt]);continue}const At=Math.floor((We+_t)/2),Dt=Q[2*At],Qt=Q[2*At+1];ci(Dt,Qt,ue,oe)<=ke&&Ue.push(j[At]);const Ft=(gt+1)%2;(gt===0?ue-ee<=Dt:oe-ee<=Qt)&&(Ie.push(We),Ie.push(At-1),Ie.push(Ft)),(gt===0?ue+ee>=Dt:oe+ee>=Qt)&&(Ie.push(At+1),Ie.push(_t),Ie.push(Ft))}return Ue}(this.ids,this.coords,A,D,$,this.nodeSize)}}const Ka={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:q=>q},Nr=Math.fround||(Ur=new Float32Array(1),q=>(Ur[0]=+q,Ur[0]));var Ur;class go{constructor(A){this.options=Ti(Object.create(Ka),A),this.trees=new Array(this.options.maxZoom+1)}load(A){const{log:D,minZoom:$,maxZoom:j,nodeSize:Q}=this.options;D&&console.time("total time");const ue=`prepare ${A.length} points`;D&&console.time(ue),this.points=A;let oe=[];for(let ee=0;ee<A.length;ee++)A[ee].geometry&&oe.push(hi(A[ee],ee));this.trees[j+1]=new Ta(oe,Ia,Bi,Q,Float32Array),D&&console.timeEnd(ue);for(let ee=j;ee>=$;ee--){const ce=+Date.now();oe=this._cluster(oe,ee),this.trees[ee]=new Ta(oe,Ia,Bi,Q,Float32Array),D&&console.log("z%d: %d clusters in %dms",ee,oe.length,+Date.now()-ce)}return D&&console.timeEnd("total time"),this}getClusters(A,D){let $=((A[0]+180)%360+360)%360-180;const j=Math.max(-90,Math.min(90,A[1]));let Q=A[2]===180?180:((A[2]+180)%360+360)%360-180;const ue=Math.max(-90,Math.min(90,A[3]));if(A[2]-A[0]>=360)$=-180,Q=180;else if($>Q){const Ie=this.getClusters([$,j,180,ue],D),Ue=this.getClusters([-180,j,Q,ue],D);return Ie.concat(Ue)}const oe=this.trees[this._limitZoom(D)],ee=oe.range(rn($),nr(ue),rn(Q),nr(j)),ce=[];for(const Ie of ee){const Ue=oe.points[Ie];ce.push(Ue.numPoints?ka(Ue):this.points[Ue.index])}return ce}getChildren(A){const D=this._getOriginId(A),$=this._getOriginZoom(A),j="No cluster with the specified id.",Q=this.trees[$];if(!Q)throw new Error(j);const ue=Q.points[D];if(!ue)throw new Error(j);const oe=this.options.radius/(this.options.extent*Math.pow(2,$-1)),ee=Q.within(ue.x,ue.y,oe),ce=[];for(const Ie of ee){const Ue=Q.points[Ie];Ue.parentId===A&&ce.push(Ue.numPoints?ka(Ue):this.points[Ue.index])}if(ce.length===0)throw new Error(j);return ce}getLeaves(A,D,$){const j=[];return this._appendLeaves(j,A,D=D||10,$=$||0,0),j}getTile(A,D,$){const j=this.trees[this._limitZoom(A)],Q=Math.pow(2,A),{extent:ue,radius:oe}=this.options,ee=oe/ue,ce=($-ee)/Q,Ie=($+1+ee)/Q,Ue={features:[]};return this._addTileFeatures(j.range((D-ee)/Q,ce,(D+1+ee)/Q,Ie),j.points,D,$,Q,Ue),D===0&&this._addTileFeatures(j.range(1-ee/Q,ce,1,Ie),j.points,Q,$,Q,Ue),D===Q-1&&this._addTileFeatures(j.range(0,ce,ee/Q,Ie),j.points,-1,$,Q,Ue),Ue.features.length?Ue:null}getClusterExpansionZoom(A){let D=this._getOriginZoom(A)-1;for(;D<=this.options.maxZoom;){const $=this.getChildren(A);if(D++,$.length!==1)break;A=$[0].properties.cluster_id}return D}_appendLeaves(A,D,$,j,Q){const ue=this.getChildren(D);for(const oe of ue){const ee=oe.properties;if(ee&&ee.cluster?Q+ee.point_count<=j?Q+=ee.point_count:Q=this._appendLeaves(A,ee.cluster_id,$,j,Q):Q<j?Q++:A.push(oe),A.length===$)break}return Q}_addTileFeatures(A,D,$,j,Q,ue){for(const oe of A){const ee=D[oe],ce=ee.numPoints;let Ie,Ue,ke;if(ce)Ie=Ca(ee),Ue=ee.x,ke=ee.y;else{const We=this.points[ee.index];Ie=We.properties,Ue=rn(We.geometry.coordinates[0]),ke=nr(We.geometry.coordinates[1])}const gt={type:1,geometry:[[Math.round(this.options.extent*(Ue*Q-$)),Math.round(this.options.extent*(ke*Q-j))]],tags:Ie};let _t;ce?_t=ee.id:this.options.generateId?_t=ee.index:this.points[ee.index].id&&(_t=this.points[ee.index].id),_t!==void 0&&(gt.id=_t),ue.features.push(gt)}}_limitZoom(A){return Math.max(this.options.minZoom,Math.min(Math.floor(+A),this.options.maxZoom+1))}_cluster(A,D){const $=[],{radius:j,extent:Q,reduce:ue,minPoints:oe}=this.options,ee=j/(Q*Math.pow(2,D));for(let ce=0;ce<A.length;ce++){const Ie=A[ce];if(Ie.zoom<=D)continue;Ie.zoom=D;const Ue=this.trees[D+1],ke=Ue.within(Ie.x,Ie.y,ee),gt=Ie.numPoints||1;let _t=gt;for(const We of ke){const At=Ue.points[We];At.zoom>D&&(_t+=At.numPoints||1)}if(_t>gt&&_t>=oe){let We=Ie.x*gt,At=Ie.y*gt,Dt=ue&&gt>1?this._map(Ie,!0):null;const Qt=(ce<<5)+(D+1)+this.points.length;for(const Ft of ke){const qt=Ue.points[Ft];if(qt.zoom<=D)continue;qt.zoom=D;const nn=qt.numPoints||1;We+=qt.x*nn,At+=qt.y*nn,qt.parentId=Qt,ue&&(Dt||(Dt=this._map(Ie,!0)),ue(Dt,this._map(qt)))}Ie.parentId=Qt,$.push(Ir(We/_t,At/_t,Qt,_t,Dt))}else if($.push(Ie),_t>1)for(const We of ke){const At=Ue.points[We];At.zoom<=D||(At.zoom=D,$.push(At))}}return $}_getOriginId(A){return A-this.points.length>>5}_getOriginZoom(A){return(A-this.points.length)%32}_map(A,D){if(A.numPoints)return D?Ti({},A.properties):A.properties;const $=this.points[A.index].properties,j=this.options.map($);return D&&j===$?Ti({},j):j}}function Ir(q,A,D,$,j){return{x:Nr(q),y:Nr(A),zoom:1/0,id:D,parentId:-1,numPoints:$,properties:j}}function hi(q,A){const[D,$]=q.geometry.coordinates;return{x:Nr(rn(D)),y:Nr(nr($)),zoom:1/0,index:A,parentId:-1}}function ka(q){return{type:"Feature",id:q.id,properties:Ca(q),geometry:{type:"Point",coordinates:[(A=q.x,360*(A-.5)),Uo(q.y)]}};var A}function Ca(q){const A=q.numPoints,D=A>=1e4?`${Math.round(A/1e3)}k`:A>=1e3?Math.round(A/100)/10+"k":A;return Ti(Ti({},q.properties),{cluster:!0,cluster_id:q.id,point_count:A,point_count_abbreviated:D})}function rn(q){return q/360+.5}function nr(q){const A=Math.sin(q*Math.PI/180),D=.5-.25*Math.log((1+A)/(1-A))/Math.PI;return D<0?0:D>1?1:D}function Uo(q){const A=(180-360*q)*Math.PI/180;return 360*Math.atan(Math.exp(A))/Math.PI-90}function Ti(q,A){for(const D in A)q[D]=A[D];return q}function Ia(q){return q.x}function Bi(q){return q.y}function Ki(q,A,D,$){for(var j,Q=$,ue=D-A>>1,oe=D-A,ee=q[A],ce=q[A+1],Ie=q[D],Ue=q[D+1],ke=A+3;ke<D;ke+=3){var gt=aa(q[ke],q[ke+1],ee,ce,Ie,Ue);if(gt>Q)j=ke,Q=gt;else if(gt===Q){var _t=Math.abs(ke-ue);_t<oe&&(j=ke,oe=_t)}}Q>$&&(j-A>3&&Ki(q,A,j,$),q[j+2]=Q,D-j>3&&Ki(q,j,D,$))}function aa(q,A,D,$,j,Q){var ue=j-D,oe=Q-$;if(ue!==0||oe!==0){var ee=((q-D)*ue+(A-$)*oe)/(ue*ue+oe*oe);ee>1?(D=j,$=Q):ee>0&&(D+=ue*ee,$+=oe*ee)}return(ue=q-D)*ue+(oe=A-$)*oe}function Ji(q,A,D,$){var j={id:q===void 0?null:q,type:A,geometry:D,tags:$,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Q){var ue=Q.geometry,oe=Q.type;if(oe==="Point"||oe==="MultiPoint"||oe==="LineString")Le(Q,ue);else if(oe==="Polygon"||oe==="MultiLineString")for(var ee=0;ee<ue.length;ee++)Le(Q,ue[ee]);else if(oe==="MultiPolygon")for(ee=0;ee<ue.length;ee++)for(var ce=0;ce<ue[ee].length;ce++)Le(Q,ue[ee][ce])}(j),j}function Le(q,A){for(var D=0;D<A.length;D+=3)q.minX=Math.min(q.minX,A[D]),q.minY=Math.min(q.minY,A[D+1]),q.maxX=Math.max(q.maxX,A[D]),q.maxY=Math.max(q.maxY,A[D+1])}function Je(q,A,D,$){if(A.geometry){var j=A.geometry.coordinates,Q=A.geometry.type,ue=Math.pow(D.tolerance/((1<<D.maxZoom)*D.extent),2),oe=[],ee=A.id;if(D.promoteId?ee=A.properties[D.promoteId]:D.generateId&&(ee=$||0),Q==="Point")Yn(j,oe);else if(Q==="MultiPoint")for(var ce=0;ce<j.length;ce++)Yn(j[ce],oe);else if(Q==="LineString")br(j,oe,ue,!1);else if(Q==="MultiLineString"){if(D.lineMetrics){for(ce=0;ce<j.length;ce++)br(j[ce],oe=[],ue,!1),q.push(Ji(ee,"LineString",oe,A.properties));return}jt(j,oe,ue,!1)}else if(Q==="Polygon")jt(j,oe,ue,!0);else{if(Q!=="MultiPolygon"){if(Q==="GeometryCollection"){for(ce=0;ce<A.geometry.geometries.length;ce++)Je(q,{id:ee,geometry:A.geometry.geometries[ce],properties:A.properties},D,$);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ce=0;ce<j.length;ce++){var Ie=[];jt(j[ce],Ie,ue,!0),oe.push(Ie)}}q.push(Ji(ee,Q,oe,A.properties))}}function Yn(q,A){A.push(Vn(q[0])),A.push(di(q[1])),A.push(0)}function br(q,A,D,$){for(var j,Q,ue=0,oe=0;oe<q.length;oe++){var ee=Vn(q[oe][0]),ce=di(q[oe][1]);A.push(ee),A.push(ce),A.push(0),oe>0&&(ue+=$?(j*ce-ee*Q)/2:Math.sqrt(Math.pow(ee-j,2)+Math.pow(ce-Q,2))),j=ee,Q=ce}var Ie=A.length-3;A[2]=1,Ki(A,0,Ie,D),A[Ie+2]=1,A.size=Math.abs(ue),A.start=0,A.end=A.size}function jt(q,A,D,$){for(var j=0;j<q.length;j++){var Q=[];br(q[j],Q,D,$),A.push(Q)}}function Vn(q){return q/360+.5}function di(q){var A=Math.sin(q*Math.PI/180),D=.5-.25*Math.log((1+A)/(1-A))/Math.PI;return D<0?0:D>1?1:D}function Pr(q,A,D,$,j,Q,ue,oe){if($/=A,Q>=(D/=A)&&ue<$)return q;if(ue<D||Q>=$)return null;for(var ee=[],ce=0;ce<q.length;ce++){var Ie=q[ce],Ue=Ie.geometry,ke=Ie.type,gt=j===0?Ie.minX:Ie.minY,_t=j===0?Ie.maxX:Ie.maxY;if(gt>=D&&_t<$)ee.push(Ie);else if(!(_t<D||gt>=$)){var We=[];if(ke==="Point"||ke==="MultiPoint")Kn(Ue,We,D,$,j);else if(ke==="LineString")Fe(Ue,We,D,$,j,!1,oe.lineMetrics);else if(ke==="MultiLineString")Bt(Ue,We,D,$,j,!1);else if(ke==="Polygon")Bt(Ue,We,D,$,j,!0);else if(ke==="MultiPolygon")for(var At=0;At<Ue.length;At++){var Dt=[];Bt(Ue[At],Dt,D,$,j,!0),Dt.length&&We.push(Dt)}if(We.length){if(oe.lineMetrics&&ke==="LineString"){for(At=0;At<We.length;At++)ee.push(Ji(Ie.id,ke,We[At],Ie.tags));continue}ke!=="LineString"&&ke!=="MultiLineString"||(We.length===1?(ke="LineString",We=We[0]):ke="MultiLineString"),ke!=="Point"&&ke!=="MultiPoint"||(ke=We.length===3?"Point":"MultiPoint"),ee.push(Ji(Ie.id,ke,We,Ie.tags))}}}return ee.length?ee:null}function Kn(q,A,D,$,j){for(var Q=0;Q<q.length;Q+=3){var ue=q[Q+j];ue>=D&&ue<=$&&(A.push(q[Q]),A.push(q[Q+1]),A.push(q[Q+2]))}}function Fe(q,A,D,$,j,Q,ue){for(var oe,ee,ce=Gt(q),Ie=j===0?Ni:Ot,Ue=q.start,ke=0;ke<q.length-3;ke+=3){var gt=q[ke],_t=q[ke+1],We=q[ke+2],At=q[ke+3],Dt=q[ke+4],Qt=j===0?gt:_t,Ft=j===0?At:Dt,qt=!1;ue&&(oe=Math.sqrt(Math.pow(gt-At,2)+Math.pow(_t-Dt,2))),Qt<D?Ft>D&&(ee=Ie(ce,gt,_t,At,Dt,D),ue&&(ce.start=Ue+oe*ee)):Qt>$?Ft<$&&(ee=Ie(ce,gt,_t,At,Dt,$),ue&&(ce.start=Ue+oe*ee)):wr(ce,gt,_t,We),Ft<D&&Qt>=D&&(ee=Ie(ce,gt,_t,At,Dt,D),qt=!0),Ft>$&&Qt<=$&&(ee=Ie(ce,gt,_t,At,Dt,$),qt=!0),!Q&&qt&&(ue&&(ce.end=Ue+oe*ee),A.push(ce),ce=Gt(q)),ue&&(Ue+=oe)}var nn=q.length-3;gt=q[nn],_t=q[nn+1],We=q[nn+2],(Qt=j===0?gt:_t)>=D&&Qt<=$&&wr(ce,gt,_t,We),nn=ce.length-3,Q&&nn>=3&&(ce[nn]!==ce[0]||ce[nn+1]!==ce[1])&&wr(ce,ce[0],ce[1],ce[2]),ce.length&&A.push(ce)}function Gt(q){var A=[];return A.size=q.size,A.start=q.start,A.end=q.end,A}function Bt(q,A,D,$,j,Q){for(var ue=0;ue<q.length;ue++)Fe(q[ue],A,D,$,j,Q,!1)}function wr(q,A,D,$){q.push(A),q.push(D),q.push($)}function Ni(q,A,D,$,j,Q){var ue=(Q-A)/($-A);return q.push(Q),q.push(D+(j-D)*ue),q.push(1),ue}function Ot(q,A,D,$,j,Q){var ue=(Q-D)/(j-D);return q.push(A+($-A)*ue),q.push(Q),q.push(1),ue}function pn(q,A){for(var D=[],$=0;$<q.length;$++){var j,Q=q[$],ue=Q.type;if(ue==="Point"||ue==="MultiPoint"||ue==="LineString")j=ur(Q.geometry,A);else if(ue==="MultiLineString"||ue==="Polygon"){j=[];for(var oe=0;oe<Q.geometry.length;oe++)j.push(ur(Q.geometry[oe],A))}else if(ue==="MultiPolygon")for(j=[],oe=0;oe<Q.geometry.length;oe++){for(var ee=[],ce=0;ce<Q.geometry[oe].length;ce++)ee.push(ur(Q.geometry[oe][ce],A));j.push(ee)}D.push(Ji(Q.id,ue,j,Q.tags))}return D}function ur(q,A){var D=[];D.size=q.size,q.start!==void 0&&(D.start=q.start,D.end=q.end);for(var $=0;$<q.length;$+=3)D.push(q[$]+A,q[$+1],q[$+2]);return D}function pi(q,A){if(q.transformed)return q;var D,$,j,Q=1<<q.z,ue=q.x,oe=q.y;for(D=0;D<q.features.length;D++){var ee=q.features[D],ce=ee.geometry,Ie=ee.type;if(ee.geometry=[],Ie===1)for($=0;$<ce.length;$+=2)ee.geometry.push(rr(ce[$],ce[$+1],A,Q,ue,oe));else for($=0;$<ce.length;$++){var Ue=[];for(j=0;j<ce[$].length;j+=2)Ue.push(rr(ce[$][j],ce[$][j+1],A,Q,ue,oe));ee.geometry.push(Ue)}}return q.transformed=!0,q}function rr(q,A,D,$,j,Q){return[Math.round(D*(q*$-j)),Math.round(D*(A*$-Q))]}function Vr(q,A,D,$,j){for(var Q=A===j.maxZoom?0:j.tolerance/((1<<A)*j.extent),ue={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:D,y:$,z:A,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},oe=0;oe<q.length;oe++){ue.numFeatures++,xn(ue,q[oe],Q,j);var ee=q[oe].minX,ce=q[oe].minY,Ie=q[oe].maxX,Ue=q[oe].maxY;ee<ue.minX&&(ue.minX=ee),ce<ue.minY&&(ue.minY=ce),Ie>ue.maxX&&(ue.maxX=Ie),Ue>ue.maxY&&(ue.maxY=Ue)}return ue}function xn(q,A,D,$){var j=A.geometry,Q=A.type,ue=[];if(Q==="Point"||Q==="MultiPoint")for(var oe=0;oe<j.length;oe+=3)ue.push(j[oe]),ue.push(j[oe+1]),q.numPoints++,q.numSimplified++;else if(Q==="LineString")Vo(ue,j,q,D,!1,!1);else if(Q==="MultiLineString"||Q==="Polygon")for(oe=0;oe<j.length;oe++)Vo(ue,j[oe],q,D,Q==="Polygon",oe===0);else if(Q==="MultiPolygon")for(var ee=0;ee<j.length;ee++){var ce=j[ee];for(oe=0;oe<ce.length;oe++)Vo(ue,ce[oe],q,D,!0,oe===0)}if(ue.length){var Ie=A.tags||null;if(Q==="LineString"&&$.lineMetrics){for(var Ue in Ie={},A.tags)Ie[Ue]=A.tags[Ue];Ie.mapbox_clip_start=j.start/j.size,Ie.mapbox_clip_end=j.end/j.size}var ke={geometry:ue,type:Q==="Polygon"||Q==="MultiPolygon"?3:Q==="LineString"||Q==="MultiLineString"?2:1,tags:Ie};A.id!==null&&(ke.id=A.id),q.features.push(ke)}}function Vo(q,A,D,$,j,Q){var ue=$*$;if($>0&&A.size<(j?ue:$))D.numPoints+=A.length/3;else{for(var oe=[],ee=0;ee<A.length;ee+=3)($===0||A[ee+2]>ue)&&(D.numSimplified++,oe.push(A[ee]),oe.push(A[ee+1])),D.numPoints++;j&&function(ce,Ie){for(var Ue=0,ke=0,gt=ce.length,_t=gt-2;ke<gt;_t=ke,ke+=2)Ue+=(ce[ke]-ce[_t])*(ce[ke+1]+ce[_t+1]);if(Ue>0===Ie)for(ke=0,gt=ce.length;ke<gt/2;ke+=2){var We=ce[ke],At=ce[ke+1];ce[ke]=ce[gt-2-ke],ce[ke+1]=ce[gt-1-ke],ce[gt-2-ke]=We,ce[gt-1-ke]=At}}(oe,Q),q.push(oe)}}function $r(q,A){var D=(A=this.options=function(j,Q){for(var ue in Q)j[ue]=Q[ue];return j}(Object.create(this.options),A)).debug;if(D&&console.time("preprocess data"),A.maxZoom<0||A.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(A.promoteId&&A.generateId)throw new Error("promoteId and generateId cannot be used together.");var $=function(j,Q){var ue=[];if(j.type==="FeatureCollection")for(var oe=0;oe<j.features.length;oe++)Je(ue,j.features[oe],Q,oe);else Je(ue,j.type==="Feature"?j:{geometry:j},Q);return ue}(q,A);this.tiles={},this.tileCoords=[],D&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",A.indexMaxZoom,A.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),$=function(j,Q){var ue=Q.buffer/Q.extent,oe=j,ee=Pr(j,1,-1-ue,ue,0,-1,2,Q),ce=Pr(j,1,1-ue,2+ue,0,-1,2,Q);return(ee||ce)&&(oe=Pr(j,1,-ue,1+ue,0,-1,2,Q)||[],ee&&(oe=pn(ee,1).concat(oe)),ce&&(oe=oe.concat(pn(ce,-1)))),oe}($,A),$.length&&this.splitTile($,0,0,0),D&&($.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function $o(q,A,D){return 32*((1<<q)*D+A)+q}function yo(q,A){const D=q.tileID.canonical;if(!this._geoJSONIndex)return A(null,null);const $=this._geoJSONIndex.getTile(D.z,D.x,D.y);if(!$)return A(null,null);const j=new He($.features);let Q=it.exports(j);Q.byteOffset===0&&Q.byteLength===Q.buffer.byteLength||(Q=new Uint8Array(Q)),A(null,{vectorTile:j,rawData:Q.buffer})}$r.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},$r.prototype.splitTile=function(q,A,D,$,j,Q,ue){for(var oe=[q,A,D,$],ee=this.options,ce=ee.debug;oe.length;){$=oe.pop(),D=oe.pop(),A=oe.pop(),q=oe.pop();var Ie=1<<A,Ue=$o(A,D,$),ke=this.tiles[Ue];if(!ke&&(ce>1&&console.time("creation"),ke=this.tiles[Ue]=Vr(q,A,D,$,ee),this.tileCoords.push({z:A,x:D,y:$}),ce)){ce>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",A,D,$,ke.numFeatures,ke.numPoints,ke.numSimplified),console.timeEnd("creation"));var gt="z"+A;this.stats[gt]=(this.stats[gt]||0)+1,this.total++}if(ke.source=q,j){if(A===ee.maxZoom||A===j)continue;var _t=1<<j-A;if(D!==Math.floor(Q/_t)||$!==Math.floor(ue/_t))continue}else if(A===ee.indexMaxZoom||ke.numPoints<=ee.indexMaxPoints)continue;if(ke.source=null,q.length!==0){ce>1&&console.time("clipping");var We,At,Dt,Qt,Ft,qt,nn=.5*ee.buffer/ee.extent,Nt=.5-nn,cr=.5+nn,Dn=1+nn;We=At=Dt=Qt=null,Ft=Pr(q,Ie,D-nn,D+cr,0,ke.minX,ke.maxX,ee),qt=Pr(q,Ie,D+Nt,D+Dn,0,ke.minX,ke.maxX,ee),q=null,Ft&&(We=Pr(Ft,Ie,$-nn,$+cr,1,ke.minY,ke.maxY,ee),At=Pr(Ft,Ie,$+Nt,$+Dn,1,ke.minY,ke.maxY,ee),Ft=null),qt&&(Dt=Pr(qt,Ie,$-nn,$+cr,1,ke.minY,ke.maxY,ee),Qt=Pr(qt,Ie,$+Nt,$+Dn,1,ke.minY,ke.maxY,ee),qt=null),ce>1&&console.timeEnd("clipping"),oe.push(We||[],A+1,2*D,2*$),oe.push(At||[],A+1,2*D,2*$+1),oe.push(Dt||[],A+1,2*D+1,2*$),oe.push(Qt||[],A+1,2*D+1,2*$+1)}}},$r.prototype.getTile=function(q,A,D){var $=this.options,j=$.extent,Q=$.debug;if(q<0||q>24)return null;var ue=1<<q,oe=$o(q,A=(A%ue+ue)%ue,D);if(this.tiles[oe])return pi(this.tiles[oe],j);Q>1&&console.log("drilling down to z%d-%d-%d",q,A,D);for(var ee,ce=q,Ie=A,Ue=D;!ee&&ce>0;)ce--,Ie=Math.floor(Ie/2),Ue=Math.floor(Ue/2),ee=this.tiles[$o(ce,Ie,Ue)];return ee&&ee.source?(Q>1&&console.log("found parent tile z%d-%d-%d",ce,Ie,Ue),Q>1&&console.time("drilling down"),this.splitTile(ee.source,ce,Ie,Ue,q,A,D),Q>1&&console.timeEnd("drilling down"),this.tiles[oe]?pi(this.tiles[oe],j):null):null};class _o extends Ce{constructor(A,D,$,j){super(A,D,$,yo),j&&(this.loadGeoJSON=j)}loadData(A,D){var $;($=this._pendingRequest)===null||$===void 0||$.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const j=!!(A&&A.request&&A.request.collectResourceTiming)&&new u.RequestPerformance(A.request);this._pendingCallback=D,this._pendingRequest=this.loadGeoJSON(A,(Q,ue)=>{if(delete this._pendingCallback,delete this._pendingRequest,Q||!ue)return D(Q);if(typeof ue!="object")return D(new Error(`Input data given to '${A.source}' is not a valid GeoJSON object.`));{re(ue,!0);try{if(A.filter){const ee=u.createExpression(A.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ee.result==="error")throw new Error(ee.value.map(Ie=>`${Ie.key}: ${Ie.message}`).join(", "));ue={type:"FeatureCollection",features:ue.features.filter(Ie=>ee.value.evaluate({zoom:0},Ie))}}this._geoJSONIndex=A.cluster?new go(function({superclusterOptions:ee,clusterProperties:ce}){if(!ce||!ee)return ee;const Ie={},Ue={},ke={accumulated:null,zoom:0},gt={properties:null},_t=Object.keys(ce);for(const We of _t){const[At,Dt]=ce[We],Qt=u.createExpression(Dt),Ft=u.createExpression(typeof At=="string"?[At,["accumulated"],["get",We]]:At);Ie[We]=Qt.value,Ue[We]=Ft.value}return ee.map=We=>{gt.properties=We;const At={};for(const Dt of _t)At[Dt]=Ie[Dt].evaluate(ke,gt);return At},ee.reduce=(We,At)=>{gt.properties=At;for(const Dt of _t)ke.accumulated=We[Dt],We[Dt]=Ue[Dt].evaluate(ke,gt)},ee}(A)).load(ue.features):function(ee,ce){return new $r(ee,ce)}(ue,A.geojsonVtOptions)}catch(ee){return D(ee)}this.loaded={};const oe={};if(j){const ee=j.finish();ee&&(oe.resourceTiming={},oe.resourceTiming[A.source]=JSON.parse(JSON.stringify(ee)))}D(null,oe)}})}reloadTile(A,D){const $=this.loaded;return $&&$[A.uid]?super.reloadTile(A,D):this.loadTile(A,D)}loadGeoJSON(A,D){if(A.request)return u.getJSON(A.request,D);if(typeof A.data=="string")try{D(null,JSON.parse(A.data))}catch{D(new Error(`Input data given to '${A.source}' is not a valid GeoJSON object.`))}else D(new Error(`Input data given to '${A.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(A,D){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),D()}getClusterExpansionZoom(A,D){try{D(null,this._geoJSONIndex.getClusterExpansionZoom(A.clusterId))}catch($){D($)}}getClusterChildren(A,D){try{D(null,this._geoJSONIndex.getChildren(A.clusterId))}catch($){D($)}}getClusterLeaves(A,D){try{D(null,this._geoJSONIndex.getLeaves(A.clusterId,A.limit,A.offset))}catch($){D($)}}}class vo{constructor(A){this.self=A,this.actor=new u.Actor(A,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Ce,geojson:_o},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(D,$)=>{if(this.workerSourceTypes[D])throw new Error(`Worker source with name "${D}" already registered.`);this.workerSourceTypes[D]=$},this.self.registerRTLTextPlugin=D=>{if(u.plugin.isParsed())throw new Error("RTL text plugin already registered.");u.plugin.applyArabicShaping=D.applyArabicShaping,u.plugin.processBidirectionalText=D.processBidirectionalText,u.plugin.processStyledBidirectionalText=D.processStyledBidirectionalText}}setReferrer(A,D){this.referrer=D}setImages(A,D,$){this.availableImages[A]=D;for(const j in this.workerSources[A]){const Q=this.workerSources[A][j];for(const ue in Q)Q[ue].availableImages=D}$()}setLayers(A,D,$){this.getLayerIndex(A).replace(D),$()}updateLayers(A,D,$){this.getLayerIndex(A).update(D.layers,D.removedIds),$()}loadTile(A,D,$){this.getWorkerSource(A,D.type,D.source).loadTile(D,$)}loadDEMTile(A,D,$){this.getDEMWorkerSource(A,D.source).loadTile(D,$)}reloadTile(A,D,$){this.getWorkerSource(A,D.type,D.source).reloadTile(D,$)}abortTile(A,D,$){this.getWorkerSource(A,D.type,D.source).abortTile(D,$)}removeTile(A,D,$){this.getWorkerSource(A,D.type,D.source).removeTile(D,$)}removeDEMTile(A,D){this.getDEMWorkerSource(A,D.source).removeTile(D)}removeSource(A,D,$){if(!this.workerSources[A]||!this.workerSources[A][D.type]||!this.workerSources[A][D.type][D.source])return;const j=this.workerSources[A][D.type][D.source];delete this.workerSources[A][D.type][D.source],j.removeSource!==void 0?j.removeSource(D,$):$()}loadWorkerSource(A,D,$){try{this.self.importScripts(D.url),$()}catch(j){$(j.toString())}}syncRTLPluginState(A,D,$){try{u.plugin.setState(D);const j=u.plugin.getPluginURL();if(u.plugin.isLoaded()&&!u.plugin.isParsed()&&j!=null){this.self.importScripts(j);const Q=u.plugin.isParsed();$(Q?void 0:new Error(`RTL Text Plugin failed to import scripts from ${j}`),Q)}}catch(j){$(j.toString())}}getAvailableImages(A){let D=this.availableImages[A];return D||(D=[]),D}getLayerIndex(A){let D=this.layerIndexes[A];return D||(D=this.layerIndexes[A]=new ie),D}getWorkerSource(A,D,$){if(this.workerSources[A]||(this.workerSources[A]={}),this.workerSources[A][D]||(this.workerSources[A][D]={}),!this.workerSources[A][D][$]){const j={send:(Q,ue,oe)=>{this.actor.send(Q,ue,oe,A)}};this.workerSources[A][D][$]=new this.workerSourceTypes[D](j,this.getLayerIndex(A),this.getAvailableImages(A))}return this.workerSources[A][D][$]}getDEMWorkerSource(A,D){return this.demWorkerSources[A]||(this.demWorkerSources[A]={}),this.demWorkerSources[A][D]||(this.demWorkerSources[A][D]=new Ze),this.demWorkerSources[A][D]}enforceCacheSizeLimit(A,D){u.enforceCacheSizeLimit(D)}}return u.isWorker()&&(self.worker=new vo(self)),vo}),v(["./shared"],function(u){var F=W;function W(h){return!function(n){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var c,p,g=new Blob([""],{type:"text/javascript"}),b=URL.createObjectURL(g);try{p=new Worker(b),c=!0}catch{c=!1}return p&&p.terminate(),URL.revokeObjectURL(b),c}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var c=document.createElement("canvas");c.width=c.height=1;var p=c.getContext("2d");if(!p)return!1;var g=p.getImageData(0,0,1,1);return g&&g.width===c.width}()?(ie[a=n&&n.failIfMajorPerformanceCaveat]===void 0&&(ie[a]=function(c){var p,g=function(b){var E=document.createElement("canvas"),k=Object.create(W.webGLContextAttributes);return k.failIfMajorPerformanceCaveat=b,E.getContext("webgl",k)||E.getContext("experimental-webgl",k)}(c);if(!g)return!1;try{p=g.createShader(g.VERTEX_SHADER)}catch{return!1}return!(!p||g.isContextLost())&&(g.shaderSource(p,"void main() {}"),g.compileShader(p),g.getShaderParameter(p,g.COMPILE_STATUS)===!0)}(a)),ie[a]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var a}(h)}var ie={};function ne(h,n){if(Array.isArray(h)){if(!Array.isArray(n)||h.length!==n.length)return!1;for(let a=0;a<h.length;a++)if(!ne(h[a],n[a]))return!1;return!0}if(typeof h=="object"&&h!==null&&n!==null){if(typeof n!="object"||Object.keys(h).length!==Object.keys(n).length)return!1;for(const a in h)if(!ne(h[a],n[a]))return!1;return!0}return h===n}W.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class G{static testProp(n){if(!G.docStyle)return n[0];for(let a=0;a<n.length;a++)if(n[a]in G.docStyle)return n[a];return n[0]}static create(n,a,c){const p=window.document.createElement(n);return a!==void 0&&(p.className=a),c&&c.appendChild(p),p}static createNS(n,a){return window.document.createElementNS(n,a)}static disableDrag(){G.docStyle&&G.selectProp&&(G.userSelect=G.docStyle[G.selectProp],G.docStyle[G.selectProp]="none")}static enableDrag(){G.docStyle&&G.selectProp&&(G.docStyle[G.selectProp]=G.userSelect)}static setTransform(n,a){n.style[G.transformProp]=a}static addEventListener(n,a,c,p={}){n.addEventListener(a,c,"passive"in p?p:p.capture)}static removeEventListener(n,a,c,p={}){n.removeEventListener(a,c,"passive"in p?p:p.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",G.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",G.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",G.suppressClickInternal,!0)},0)}static mousePos(n,a){const c=n.getBoundingClientRect();return new u.pointGeometry(a.clientX-c.left-n.clientLeft,a.clientY-c.top-n.clientTop)}static touchPos(n,a){const c=n.getBoundingClientRect(),p=[];for(let g=0;g<a.length;g++)p.push(new u.pointGeometry(a[g].clientX-c.left-n.clientLeft,a[g].clientY-c.top-n.clientTop));return p}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}}G.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,G.selectProp=G.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),G.transformProp=G.testProp(["transform","WebkitTransform"]);class we{constructor(n){this._transformRequestFn=n}transformRequest(n,a){return this._transformRequestFn&&this._transformRequestFn(n,a)||{url:n}}normalizeSpriteURL(n,a,c){const p=function(g){const b=g.match(Me);if(!b)throw new Error(`Unable to parse URL "${g}"`);return{protocol:b[1],authority:b[2],path:b[3]||"/",params:b[4]?b[4].split("&"):[]}}(n);return p.path+=`${a}${c}`,function(g){const b=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${b}`}(p)}setTransformRequest(n){this._transformRequestFn=n}}const Me=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class Ce{constructor(n,a,c,p){this.context=n,this.format=c,this.texture=n.gl.createTexture(),this.update(a,p)}update(n,a,c){const{width:p,height:g}=n,b=!(this.size&&this.size[0]===p&&this.size[1]===g||c),{context:E}=this,{gl:k}=E;if(this.useMipmap=Boolean(a&&a.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!a||a.premultiply!==!1)),b)this.size=[p,g],n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||u.isImageBitmap(n)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,n):k.texImage2D(k.TEXTURE_2D,0,this.format,p,g,0,this.format,k.UNSIGNED_BYTE,n.data);else{const{x:P,y:z}=c||{x:0,y:0};n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||u.isImageBitmap(n)?k.texSubImage2D(k.TEXTURE_2D,0,P,z,k.RGBA,k.UNSIGNED_BYTE,n):k.texSubImage2D(k.TEXTURE_2D,0,P,z,p,g,k.RGBA,k.UNSIGNED_BYTE,n.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)}bind(n,a,c){const{context:p}=this,{gl:g}=p;g.bindTexture(g.TEXTURE_2D,this.texture),c!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=g.LINEAR),n!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,n),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,c||n),this.filter=n),a!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,a),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}function Ze(h){const{userImage:n}=h;return!!(n&&n.render&&n.render())&&(h.data.replace(new Uint8Array(n.data.buffer)),!0)}class re extends u.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:a,callback:c}of this.requestors)this._notify(a,c);this.requestors=[]}}getImage(n){return this.images[n]}addImage(n,a){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,a)&&(this.images[n]=a)}_validate(n,a){let c=!0;return this._validateStretch(a.stretchX,a.data&&a.data.width)||(this.fire(new u.ErrorEvent(new Error(`Image "${n}" has invalid "stretchX" value`))),c=!1),this._validateStretch(a.stretchY,a.data&&a.data.height)||(this.fire(new u.ErrorEvent(new Error(`Image "${n}" has invalid "stretchY" value`))),c=!1),this._validateContent(a.content,a)||(this.fire(new u.ErrorEvent(new Error(`Image "${n}" has invalid "content" value`))),c=!1),c}_validateStretch(n,a){if(!n)return!0;let c=0;for(const p of n){if(p[0]<c||p[1]<p[0]||a<p[1])return!1;c=p[1]}return!0}_validateContent(n,a){return!(n&&(n.length!==4||n[0]<0||a.data.width<n[0]||n[1]<0||a.data.height<n[1]||n[2]<0||a.data.width<n[2]||n[3]<0||a.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))}updateImage(n,a){const c=this.images[n];if(c.data.width!==a.data.width||c.data.height!==a.data.height)throw new Error(`size mismatch between old image (${c.data.width}x${c.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=c.version+1,this.images[n]=a,this.updatedImages[n]=!0}removeImage(n){const a=this.images[n];delete this.images[n],delete this.patterns[n],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n,a){let c=!0;if(!this.isLoaded())for(const p of n)this.images[p]||(c=!1);this.isLoaded()||c?this._notify(n,a):this.requestors.push({ids:n,callback:a})}_notify(n,a){const c={};for(const p of n){this.images[p]||this.fire(new u.Event("styleimagemissing",{id:p}));const g=this.images[p];g?c[p]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,hasRenderCallback:Boolean(g.userImage&&g.userImage.render)}:u.warnOnce(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}a(null,c)}getPixelSize(){const{width:n,height:a}=this.atlasImage;return{width:n,height:a}}getPattern(n){const a=this.patterns[n],c=this.getImage(n);if(!c)return null;if(a&&a.position.version===c.version)return a.position;if(a)a.position.version=c.version;else{const p={w:c.data.width+2,h:c.data.height+2,x:0,y:0},g=new u.ImagePosition(p,c);this.patterns[n]={bin:p,position:g}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const a=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ce(n,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const g in this.patterns)n.push(this.patterns[g].bin);const{w:a,h:c}=u.potpack(n),p=this.atlasImage;p.resize({width:a||1,height:c||1});for(const g in this.patterns){const{bin:b}=this.patterns[g],E=b.x+1,k=b.y+1,P=this.images[g].data,z=P.width,R=P.height;u.RGBAImage.copy(P,p,{x:0,y:0},{x:E,y:k},{width:z,height:R}),u.RGBAImage.copy(P,p,{x:0,y:R-1},{x:E,y:k-1},{width:z,height:1}),u.RGBAImage.copy(P,p,{x:0,y:0},{x:E,y:k+R},{width:z,height:1}),u.RGBAImage.copy(P,p,{x:z-1,y:0},{x:E-1,y:k},{width:1,height:R}),u.RGBAImage.copy(P,p,{x:0,y:0},{x:E+z,y:k},{width:1,height:R})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const a of n){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const c=this.images[a];c||u.warnOnce(`Image with ID: "${a}" was not found`),Ze(c)&&this.updateImage(a,c)}}}const J=1e20;function se(h,n,a,c,p,g,b,E,k){for(let P=n;P<n+c;P++)Te(h,a*g+P,g,p,b,E,k);for(let P=a;P<a+p;P++)Te(h,P*g+n,1,c,b,E,k)}function Te(h,n,a,c,p,g,b){g[0]=0,b[0]=-J,b[1]=J,p[0]=h[n];for(let E=1,k=0,P=0;E<c;E++){p[E]=h[n+E*a];const z=E*E;do{const R=g[k];P=(p[E]-p[R]+z-R*R)/(E-R)/2}while(P<=b[k]&&--k>-1);k++,g[k]=E,b[k]=P,b[k+1]=J}for(let E=0,k=0;E<c;E++){for(;b[k+1]<E;)k++;const P=g[k],z=E-P;h[n+E*a]=p[P]+z*z}}class ze{constructor(n,a){this.requestManager=n,this.localIdeographFontFamily=a,this.entries={}}setURL(n){this.url=n}getGlyphs(n,a){const c=[];for(const p in n)for(const g of n[p])c.push({stack:p,id:g});u.asyncAll(c,({stack:p,id:g},b)=>{let E=this.entries[p];E||(E=this.entries[p]={glyphs:{},requests:{},ranges:{}});let k=E.glyphs[g];if(k!==void 0)return void b(null,{stack:p,id:g,glyph:k});if(k=this._tinySDF(E,p,g),k)return E.glyphs[g]=k,void b(null,{stack:p,id:g,glyph:k});const P=Math.floor(g/256);if(256*P>65535)return void b(new Error("glyphs > 65535 not supported"));if(E.ranges[P])return void b(null,{stack:p,id:g,glyph:k});let z=E.requests[P];z||(z=E.requests[P]=[],ze.loadGlyphRange(p,P,this.url,this.requestManager,(R,N)=>{if(N){for(const X in N)this._doesCharSupportLocalGlyph(+X)||(E.glyphs[+X]=N[+X]);E.ranges[P]=!0}for(const X of z)X(R,N);delete E.requests[P]})),z.push((R,N)=>{R?b(R):N&&b(null,{stack:p,id:g,glyph:N[g]||null})})},(p,g)=>{if(p)a(p);else if(g){const b={};for(const{stack:E,id:k,glyph:P}of g)(b[E]||(b[E]={}))[k]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics};a(null,b)}})}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&(u.unicodeBlockLookup["CJK Unified Ideographs"](n)||u.unicodeBlockLookup["Hangul Syllables"](n)||u.unicodeBlockLookup.Hiragana(n)||u.unicodeBlockLookup.Katakana(n))}_tinySDF(n,a,c){const p=this.localIdeographFontFamily;if(!p||!this._doesCharSupportLocalGlyph(c))return;let g=n.tinySDF;if(!g){let E="400";/bold/i.test(a)?E="900":/medium/i.test(a)?E="500":/light/i.test(a)&&(E="200"),g=n.tinySDF=new ze.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:p,fontWeight:E})}const b=g.draw(String.fromCharCode(c));return{id:c,bitmap:new u.AlphaImage({width:b.width||30,height:b.height||30},b.data),metrics:{width:b.glyphWidth||24,height:b.glyphHeight||24,left:b.glyphLeft||0,top:b.glyphTop-27||-8,advance:b.glyphAdvance||24}}}}ze.loadGlyphRange=function(h,n,a,c,p){const g=256*n,b=g+255,E=c.transformRequest(a.replace("{fontstack}",h).replace("{range}",`${g}-${b}`),u.ResourceType.Glyphs);u.getArrayBuffer(E,(k,P)=>{if(k)p(k);else if(P){const z={};for(const R of u.parseGlyphPbf(P))z[R.id]=R;p(null,z)}})},ze.TinySDF=class{constructor({fontSize:h=24,buffer:n=3,radius:a=8,cutoff:c=.25,fontFamily:p="sans-serif",fontWeight:g="normal",fontStyle:b="normal"}={}){this.buffer=n,this.cutoff=c,this.radius=a;const E=this.size=h+4*n,k=this._createCanvas(E),P=this.ctx=k.getContext("2d",{willReadFrequently:!0});P.font=`${b} ${g} ${h}px ${p}`,P.textBaseline="alphabetic",P.textAlign="left",P.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(h){const n=document.createElement("canvas");return n.width=n.height=h,n}draw(h){const{width:n,actualBoundingBoxAscent:a,actualBoundingBoxDescent:c,actualBoundingBoxLeft:p,actualBoundingBoxRight:g}=this.ctx.measureText(h),b=Math.ceil(a),E=Math.min(this.size-this.buffer,Math.ceil(g-p)),k=Math.min(this.size-this.buffer,b+Math.ceil(c)),P=E+2*this.buffer,z=k+2*this.buffer,R=Math.max(P*z,0),N=new Uint8ClampedArray(R),X={data:N,width:P,height:z,glyphWidth:E,glyphHeight:k,glyphTop:b,glyphLeft:0,glyphAdvance:n};if(E===0||k===0)return X;const{ctx:Z,buffer:H,gridInner:le,gridOuter:de}=this;Z.clearRect(H,H,E,k),Z.fillText(h,H,H+b);const ye=Z.getImageData(H,H,E,k);de.fill(J,0,R),le.fill(0,0,R);for(let Y=0;Y<k;Y++)for(let Se=0;Se<E;Se++){const ve=ye.data[4*(Y*E+Se)+3]/255;if(ve===0)continue;const De=(Y+H)*P+Se+H;if(ve===1)de[De]=0,le[De]=J;else{const Re=.5-ve;de[De]=Re>0?Re*Re:0,le[De]=Re<0?Re*Re:0}}se(de,0,0,P,z,P,this.f,this.v,this.z),se(le,H,H,E,k,P,this.f,this.v,this.z);for(let Y=0;Y<R;Y++){const Se=Math.sqrt(de[Y])-Math.sqrt(le[Y]);N[Y]=Math.round(255-255*(Se/this.radius+this.cutoff))}return X}};const He=new u.Properties({anchor:new u.DataConstantProperty(u.spec.light.anchor),position:new class{constructor(){this.specification=u.spec.light.position}possiblyEvaluate(h,n){return u.sphericalToCartesian(h.expression.evaluate(n))}interpolate(h,n,a){return{x:u.number(h.x,n.x,a),y:u.number(h.y,n.y,a),z:u.number(h.z,n.z,a)}}},color:new u.DataConstantProperty(u.spec.light.color),intensity:new u.DataConstantProperty(u.spec.light.intensity)}),it="-transition";class Xe extends u.Evented{constructor(n){super(),this._transitionable=new u.Transitionable(He),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,a={}){if(!this._validate(u.validateLight,n,a))for(const c in n){const p=n[c];c.endsWith(it)?this._transitionable.setTransition(c.slice(0,-it.length),p):this._transitionable.setValue(c,p)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,a,c){return(!c||c.validate!==!1)&&u.emitValidationErrors(this,n.call(u.validateStyle,u.extend({value:a,style:{glyphs:!0,sprite:!0},styleSpec:u.spec})))}}class Ut{constructor(n,a){this.width=n,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,a){const c=n.join(",")+String(a);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(n,a)),this.dashEntry[c]}getDashRanges(n,a,c){const p=[];let g=n.length%2==1?-n[n.length-1]*c:0,b=n[0]*c,E=!0;p.push({left:g,right:b,isDash:E,zeroLength:n[0]===0});let k=n[0];for(let P=1;P<n.length;P++){E=!E;const z=n[P];g=k*c,k+=z,b=k*c,p.push({left:g,right:b,isDash:E,zeroLength:z===0})}return p}addRoundDash(n,a,c){const p=a/2;for(let g=-c;g<=c;g++){const b=this.width*(this.nextRow+c+g);let E=0,k=n[E];for(let P=0;P<this.width;P++){P/k.right>1&&(k=n[++E]);const z=Math.abs(P-k.left),R=Math.abs(P-k.right),N=Math.min(z,R);let X;const Z=g/c*(p+1);if(k.isDash){const H=p-Math.abs(Z);X=Math.sqrt(N*N+H*H)}else X=p-Math.sqrt(N*N+Z*Z);this.data[b+P]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(n){for(let E=n.length-1;E>=0;--E){const k=n[E],P=n[E+1];k.zeroLength?n.splice(E,1):P&&P.isDash===k.isDash&&(P.left=k.left,n.splice(E,1))}const a=n[0],c=n[n.length-1];a.isDash===c.isDash&&(a.left=c.left-this.width,c.right=a.right+this.width);const p=this.width*this.nextRow;let g=0,b=n[g];for(let E=0;E<this.width;E++){E/b.right>1&&(b=n[++g]);const k=Math.abs(E-b.left),P=Math.abs(E-b.right),z=Math.min(k,P);this.data[p+E]=Math.max(0,Math.min(255,(b.isDash?z:-z)+128))}}addDash(n,a){const c=a?7:0,p=2*c+1;if(this.nextRow+p>this.height)return u.warnOnce("LineAtlas out of space"),null;let g=0;for(let E=0;E<n.length;E++)g+=n[E];if(g!==0){const E=this.width/g,k=this.getDashRanges(n,this.width,E);a?this.addRoundDash(k,E,c):this.addRegularDash(k)}const b={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:g};return this.nextRow+=p,this.dirty=!0,b}bind(n){const a=n.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}class xt{constructor(n,a){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=u.uniqueId();const c=this.workerPool.acquire(this.id);for(let p=0;p<c.length;p++){const g=new xt.Actor(c[p],a,this.id);g.name=`Worker ${p}`,this.actors.push(g)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,a,c){u.asyncAll(this.actors,(p,g)=>{p.send(n,a,g)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Zt(h,n,a){const c=function(p,g){if(p)return a(p);if(g){const b=u.pick(u.extend(g,h),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);g.vector_layers&&(b.vectorLayers=g.vector_layers,b.vectorLayerIds=b.vectorLayers.map(E=>E.id)),a(null,b)}};return h.url?u.getJSON(n.transformRequest(h.url,u.ResourceType.Source),c):u.exported.frame(()=>c(null,h))}xt.Actor=u.Actor;class dn{constructor(n,a,c){this.bounds=u.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=a||0,this.maxzoom=c||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const a=Math.pow(2,n.z),c=Math.floor(u.mercatorXfromLng(this.bounds.getWest())*a),p=Math.floor(u.mercatorYfromLat(this.bounds.getNorth())*a),g=Math.ceil(u.mercatorXfromLng(this.bounds.getEast())*a),b=Math.ceil(u.mercatorYfromLat(this.bounds.getSouth())*a);return n.x>=c&&n.x<g&&n.y>=p&&n.y<b}}class An extends u.Evented{constructor(n,a,c,p){if(super(),this.id=n,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.extend(this,u.pick(a,["url","scheme","tileSize","promoteId"])),this._options=u.extend({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p)}load(){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Zt(this._options,this.map._requestManager,(n,a)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n?this.fire(new u.ErrorEvent(n)):a&&(u.extend(this,a),a.bounds&&(this.tileBounds=new dn(a.bounds,this.minzoom,this.maxzoom)),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return u.extend({},this._options)}loadTile(n,a){const c=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(c,u.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function g(b,E){return delete n.request,n.aborted?a(null):b&&b.status!==404?a(b):(E&&E.resourceTiming&&(n.resourceTiming=E.resourceTiming),this.map._refreshExpiredTiles&&E&&n.setExpiryData(E),n.loadVectorData(E,this.map.painter),u.cacheEntryPossiblyAdded(this.dispatcher),a(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}p.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=a:n.request=n.actor.send("reloadTile",p,g.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",p,g.bind(this)))}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)}unloadTile(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class sn extends u.Evented{constructor(n,a,c,p){super(),this.id=n,this.dispatcher=c,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.extend({type:"raster"},a),u.extend(this,u.pick(a,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Zt(this._options,this.map._requestManager,(n,a)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new u.ErrorEvent(n)):a&&(u.extend(this,a),a.bounds&&(this.tileBounds=new dn(a.bounds,this.minzoom,this.maxzoom)),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return u.extend({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,a){const c=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.request=u.getImage(this.map._requestManager.transformRequest(c,u.ResourceType.Tile),(p,g,b)=>{if(delete n.request,n.aborted)n.state="unloaded",a(null);else if(p)n.state="errored",a(p);else if(g){this.map._refreshExpiredTiles&&n.setExpiryData(b);const E=this.map.painter.context,k=E.gl;n.texture=this.map.painter.getTileTexture(g.width),n.texture?n.texture.update(g,{useMipmap:!0}):(n.texture=new Ce(E,g,k.RGBA,{useMipmap:!0}),n.texture.bind(k.LINEAR,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),E.extTextureFilterAnisotropic&&k.texParameterf(k.TEXTURE_2D,E.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,E.extTextureFilterAnisotropicMax)),n.state="loaded",u.cacheEntryPossiblyAdded(this.dispatcher),a(null)}})}abortTile(n,a){n.request&&(n.request.cancel(),delete n.request),a()}unloadTile(n,a){n.texture&&this.map.painter.saveTileTexture(n.texture),a()}hasTransition(){return!1}}let zn;class mt extends sn{constructor(n,a,c,p){super(n,a,c,p),this.type="raster-dem",this.maxzoom=22,this._options=u.extend({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(n,a){const c=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function p(g,b){g&&(n.state="errored",a(g)),b&&(n.dem=b,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded",a(null))}n.request=u.getImage(this.map._requestManager.transformRequest(c,u.ResourceType.Tile),function(g,b){if(delete n.request,n.aborted)n.state="unloaded",a(null);else if(g)n.state="errored",a(g);else if(b){this.map._refreshExpiredTiles&&n.setExpiryData(b),delete b.cacheControl,delete b.expires;const E=u.isImageBitmap(b)&&(zn==null&&(zn=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),zn)?b:u.exported.getImageData(b,1),k={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:E,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",k,p.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)}_getNeighboringTiles(n){const a=n.canonical,c=Math.pow(2,a.z),p=(a.x-1+c)%c,g=a.x===0?n.wrap-1:n.wrap,b=(a.x+1+c)%c,E=a.x+1===c?n.wrap+1:n.wrap,k={};return k[new u.OverscaledTileID(n.overscaledZ,g,a.z,p,a.y).key]={backfilled:!1},k[new u.OverscaledTileID(n.overscaledZ,E,a.z,b,a.y).key]={backfilled:!1},a.y>0&&(k[new u.OverscaledTileID(n.overscaledZ,g,a.z,p,a.y-1).key]={backfilled:!1},k[new u.OverscaledTileID(n.overscaledZ,n.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},k[new u.OverscaledTileID(n.overscaledZ,E,a.z,b,a.y-1).key]={backfilled:!1}),a.y+1<c&&(k[new u.OverscaledTileID(n.overscaledZ,g,a.z,p,a.y+1).key]={backfilled:!1},k[new u.OverscaledTileID(n.overscaledZ,n.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},k[new u.OverscaledTileID(n.overscaledZ,E,a.z,b,a.y+1).key]={backfilled:!1}),k}unloadTile(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})}}class Un extends u.Evented{constructor(n,a,c,p){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(p),this._data=a.data,this._options=u.extend({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const g=u.EXTENT/this.tileSize;this.workerOptions=u.extend({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*g,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*g,extent:u.EXTENT,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:u.EXTENT,radius:(a.clusterRadius||50)*g,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._updateWorkerData("content"),this}getClusterExpansionZoom(n,a){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},a),this}getClusterChildren(n,a){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},a),this}getClusterLeaves(n,a,c,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:a,offset:c},p),this}_updateWorkerData(n){const a=u.extend({},this.workerOptions),c=this._data;typeof c=="string"?(a.request=this.map._requestManager.transformRequest(u.exported.resolveURL(c),u.ResourceType.Source),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(c),this._pendingLoads++,this.fire(new u.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,a,(p,g)=>{if(this._pendingLoads--,this._removed||g&&g.abandoned)return void this.fire(new u.Event("dataabort",{dataType:"source",sourceDataType:n}));let b=null;if(g&&g.resourceTiming&&g.resourceTiming[this.id]&&(b=g.resourceTiming[this.id].slice(0)),p)return void this.fire(new u.ErrorEvent(p));const E={dataType:"source",sourceDataType:n};this._collectResourceTiming&&b&&b.length>0&&u.extend(E,{resourceTiming:b}),this.fire(new u.Event("data",E))})}loaded(){return this._pendingLoads===0}loadTile(n,a){const c=n.actor?"reloadTile":"loadTile";n.actor=this.actor;const p={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.request=this.actor.send(c,p,(g,b)=>(delete n.request,n.unloadVectorData(),n.aborted?a(null):g?a(g):(n.loadVectorData(b,this.map.painter,c==="reloadTile"),a(null))))}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0}unloadTile(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return u.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var at=u.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Pt extends u.Evented{constructor(n,a,c,p){super(),this.id=n,this.dispatcher=c,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=a}load(n,a){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this.url=this.options.url,u.getImage(this.map._requestManager.transformRequest(this.url,u.ResourceType.Image),(c,p)=>{this._loaded=!0,c?this.fire(new u.ErrorEvent(c)):p&&(this.image=p,n&&(this.coordinates=n),a&&a(),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}setCoordinates(n){this.coordinates=n;const a=n.map(u.MercatorCoordinate.fromLngLat);this.tileID=function(p){let g=1/0,b=1/0,E=-1/0,k=-1/0;for(const N of p)g=Math.min(g,N.x),b=Math.min(b,N.y),E=Math.max(E,N.x),k=Math.max(k,N.y);const P=Math.max(E-g,k-b),z=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),R=Math.pow(2,z);return new u.CanonicalTileID(z,Math.floor((g+E)/2*R),Math.floor((b+k)/2*R))}(a),this.minzoom=this.maxzoom=this.tileID.z;const c=a.map(p=>this.tileID.getTilePoint(p)._round());return this._boundsArray=new u.RasterBoundsArray,this._boundsArray.emplaceBack(c[0].x,c[0].y,0,0),this._boundsArray.emplaceBack(c[1].x,c[1].y,u.EXTENT,0),this._boundsArray.emplaceBack(c[3].x,c[3].y,0,u.EXTENT),this._boundsArray.emplaceBack(c[2].x,c[2].y,u.EXTENT,u.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,a=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,at.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Ce(n,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));for(const c in this.tiles){const p=this.tiles[c];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}}loadTile(n,a){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},a(null)):(n.state="errored",a(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Qe extends Pt{constructor(n,a,c,p){super(n,a,c,p),this.roundZoom=!0,this.type="video",this.options=a}load(){this._loaded=!1;const n=this.options;this.urls=[];for(const a of n.urls)this.urls.push(this.map._requestManager.transformRequest(a,u.ResourceType.Source).url);u.getVideo(this.urls,(a,c)=>{this._loaded=!0,a?this.fire(new u.ErrorEvent(a)):c&&(this.video=c,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const a=this.video.seekable;n<a.start(0)||n>a.end(0)?this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,a=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,at.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new Ce(n,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));for(const c in this.tiles){const p=this.tiles[c];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class yn extends Pt{constructor(n,a,c,p){super(n,a,c,p),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(b=>typeof b!="number"))||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${n}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${n}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,c=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,at.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ce(a,this.canvas,c.RGBA,{premultiply:!0});for(const p in this.tiles){const g=this.tiles[p];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const Ln={vector:An,raster:sn,"raster-dem":mt,geojson:Un,video:Qe,image:Pt,canvas:yn};function Ei(h,n){const a=u.create();return u.translate(a,a,[1,1,0]),u.scale(a,a,[.5*h.width,.5*h.height,1]),u.multiply(a,a,h.calculatePosMatrix(n.toUnwrapped()))}function Yr(h,n,a,c,p,g){const b=function(R,N,X){if(R)for(const Z of R){const H=N[Z];if(H&&H.source===X&&H.type==="fill-extrusion")return!0}else for(const Z in N){const H=N[Z];if(H.source===X&&H.type==="fill-extrusion")return!0}return!1}(p&&p.layers,n,h.id),E=g.maxPitchScaleFactor(),k=h.tilesIn(c,E,b);k.sort(Kr);const P=[];for(const R of k)P.push({wrappedTileID:R.tileID.wrapped().key,queryResults:R.tile.queryRenderedFeatures(n,a,h._state,R.queryGeometry,R.cameraQueryGeometry,R.scale,p,g,E,Ei(h.transform,R.tileID))});const z=function(R){const N={},X={};for(const Z of R){const H=Z.queryResults,le=Z.wrappedTileID,de=X[le]=X[le]||{};for(const ye in H){const Y=H[ye],Se=de[ye]=de[ye]||{},ve=N[ye]=N[ye]||[];for(const De of Y)Se[De.featureIndex]||(Se[De.featureIndex]=!0,ve.push(De))}}return N}(P);for(const R in z)z[R].forEach(N=>{const X=N.feature,Z=h.getFeatureState(X.layer["source-layer"],X.id);X.source=X.layer.source,X.layer["source-layer"]&&(X.sourceLayer=X.layer["source-layer"]),X.state=Z});return z}function Kr(h,n){const a=h.tileID,c=n.tileID;return a.overscaledZ-c.overscaledZ||a.canonical.y-c.canonical.y||a.wrap-c.wrap||a.canonical.x-c.canonical.x}class Cr{constructor(n,a){this.tileID=n,this.uid=u.uniqueId(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const a=n+this.timeAdded;a<u.exported.now()||this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.textures.forEach(a=>n.saveTileTexture(a)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(n,a,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(p,g){const b={};if(!g)return b;for(const E of p){const k=E.layerIds.map(P=>g.getLayer(P)).filter(Boolean);if(k.length!==0){E.layers=k,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map(P=>k.filter(z=>z.id===P)[0]));for(const P of k)b[P.id]=E}}return b}(n.buckets,a.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const g=this.buckets[p];if(g instanceof u.SymbolBucket){if(this.hasSymbolBuckets=!0,!c)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const g=this.buckets[p];if(g instanceof u.SymbolBucket&&g.hasRTLText){this.hasRTLText=!0,u.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const p in this.buckets){const g=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(p).queryRadius(g))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new u.CollisionBoxArray}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const c in this.buckets){const p=this.buckets[c];p.uploadPending()&&p.upload(n)}const a=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ce(n,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ce(n,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,a,c,p,g,b,E,k,P,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:g,scale:b,tileSize:this.tileSize,pixelPosMatrix:z,transform:k,params:E,queryPadding:this.queryPadding*P},n,a,c):{}}querySourceFeatures(n,a){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const p=c.loadVTLayers(),g=a?a.sourceLayer:"",b=p._geojsonTileLayer||p[g];if(!b)return;const E=u.createFilter(a&&a.filter),{z:k,x:P,y:z}=this.tileID.canonical,R={z:k,x:P,y:z};for(let N=0;N<b.length;N++){const X=b.feature(N);if(E.needGeometry){const le=u.toEvaluationFeature(X,!0);if(!E.filter(new u.EvaluationParameters(this.tileID.overscaledZ),le,this.tileID.canonical))continue}else if(!E.filter(new u.EvaluationParameters(this.tileID.overscaledZ),X))continue;const Z=c.getId(X,g),H=new u.GeoJSONFeature(X,k,P,z,Z);H.tile=R,n.push(H)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const a=this.expirationTime;if(n.cacheControl){const c=u.parseCacheControl(n.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const c=Date.now();let p=!1;if(this.expirationTime>c)p=!1;else if(a)if(this.expirationTime<a)p=!0;else{const g=this.expirationTime-a;g?this.expirationTime=c+Math.max(g,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const p in this.buckets){if(!a.style.hasLayer(p))continue;const g=this.buckets[p],b=g.layers[0].sourceLayer||"_geojsonTileLayer",E=c[b],k=n[b];if(!E||!k||Object.keys(k).length===0)continue;g.update(k,E,this.imageAtlas&&this.imageAtlas.patternPositions||{});const P=a&&a.style&&a.style.getLayer(p);P&&(this.queryPadding=Math.max(this.queryPadding,P.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<u.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=u.exported.now()+n}setDependencies(n,a){const c={};for(const p of a)c[p]=!0;this.dependencies[n]=c}hasDependency(n,a){for(const c of n){const p=this.dependencies[c];if(p){for(const g of a)if(p[g])return!0}}return!1}}class ci{constructor(n,a){this.max=n,this.onRemove=a,this.reset()}reset(){for(const n in this.data)for(const a of this.data[n])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(n,a,c){const p=n.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const g={value:a,timeout:void 0};if(c!==void 0&&(g.timeout=setTimeout(()=>{this.remove(n,g)},c)),this.data[p].push(g),this.order.push(p),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const a=this.data[n].shift();return a.timeout&&clearTimeout(a.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),a.value}getByKey(n){const a=this.data[n];return a?a[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,a){if(!this.has(n))return this;const c=n.wrapped().key,p=a===void 0?0:this.data[c].indexOf(a),g=this.data[c][p];return this.data[c].splice(p,1),g.timeout&&clearTimeout(g.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(g.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(n){const a=[];for(const c in this.data)for(const p of this.data[c])n(p.value)||a.push(p);for(const c of a)this.remove(c.value.tileID,c)}}class No{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,a,c){const p=String(a);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][p]=this.stateChanges[n][p]||{},u.extend(this.stateChanges[n][p],c),this.deletedStates[n]===null){this.deletedStates[n]={};for(const g in this.state[n])g!==p&&(this.deletedStates[n][g]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][p]===null){this.deletedStates[n][p]={};for(const g in this.state[n][p])c[g]||(this.deletedStates[n][p][g]=null)}else for(const g in c)this.deletedStates[n]&&this.deletedStates[n][p]&&this.deletedStates[n][p][g]===null&&delete this.deletedStates[n][p][g]}removeFeatureState(n,a,c){if(this.deletedStates[n]===null)return;const p=String(a);if(this.deletedStates[n]=this.deletedStates[n]||{},c&&a!==void 0)this.deletedStates[n][p]!==null&&(this.deletedStates[n][p]=this.deletedStates[n][p]||{},this.deletedStates[n][p][c]=null);else if(a!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][p])for(c in this.deletedStates[n][p]={},this.stateChanges[n][p])this.deletedStates[n][p][c]=null;else this.deletedStates[n][p]=null;else this.deletedStates[n]=null}getState(n,a){const c=String(a),p=u.extend({},(this.state[n]||{})[c],(this.stateChanges[n]||{})[c]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const g=this.deletedStates[n][a];if(g===null)return{};for(const b in g)delete p[b]}return p}initializeTileState(n,a){n.setFeatureState(this.state,a)}coalesceChanges(n,a){const c={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const g={};for(const b in this.stateChanges[p])this.state[p][b]||(this.state[p][b]={}),u.extend(this.state[p][b],this.stateChanges[p][b]),g[b]=this.state[p][b];c[p]=g}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const g={};if(this.deletedStates[p]===null)for(const b in this.state[p])g[b]={},this.state[p][b]={};else for(const b in this.deletedStates[p]){if(this.deletedStates[p][b]===null)this.state[p][b]={};else for(const E of Object.keys(this.deletedStates[p][b]))delete this.state[p][b][E];g[b]=this.state[p][b]}c[p]=c[p]||{},u.extend(c[p],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const p in n)n[p].setFeatureState(c,a)}}class Jr extends u.Evented{constructor(n,a,c){super(),this.id=n,this.dispatcher=c,this.on("data",p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(p,g,b,E){const k=new Ln[g.type](p,g,b,E);if(k.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${k.id}`);return u.bindAll(["load","abort","unload","serialize","prepare"],k),k}(n,a,c,this),this._tiles={},this._cache=new ci(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new No}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles){const a=this._tiles[n];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,a){return this._source.loadTile(n,a)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n,()=>{})}_abortTile(n){this._source.abortTile&&this._source.abortTile(n,()=>{}),this._source.fire(new u.Event("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const c=this._tiles[a];c.upload(n),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(Ta).map(n=>n.key)}getRenderableIds(n){const a=[];for(const c in this._tiles)this._isIdRenderable(c,n)&&a.push(this._tiles[c]);return n?a.sort((c,p)=>{const g=c.tileID,b=p.tileID,E=new u.pointGeometry(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),k=new u.pointGeometry(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-b.overscaledZ||k.y-E.y||k.x-E.x}).map(c=>c.tileID.key):a.map(c=>c.tileID).sort(Ta).map(c=>c.key)}hasRenderableParent(n){const a=this.findLoadedParent(n,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(n,a){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(a||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")}}_reloadTile(n,a){const c=this._tiles[n];c&&(c.state!=="loading"&&(c.state=a),this._loadTile(c,this._tileLoaded.bind(this,c,n,a)))}_tileLoaded(n,a,c,p){if(p)return n.state="errored",void(p.status!==404?this._source.fire(new u.ErrorEvent(p,{tile:n})):this.update(this.transform,this.terrain));n.timeAdded=u.exported.now(),c==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(a,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new u.Event("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const a=this.getRenderableIds();for(let p=0;p<a.length;p++){const g=a[p];if(n.neighboringTiles&&n.neighboringTiles[g]){const b=this.getTileByID(g);c(n,b),c(b,n)}}function c(p,g){p.needsHillshadePrepare=!0,p.needsTerrainPrepare=!0;let b=g.tileID.canonical.x-p.tileID.canonical.x;const E=g.tileID.canonical.y-p.tileID.canonical.y,k=Math.pow(2,p.tileID.canonical.z),P=g.tileID.key;b===0&&E===0||Math.abs(E)>1||(Math.abs(b)>1&&(Math.abs(b+k)===1?b+=k:Math.abs(b-k)===1&&(b-=k)),g.dem&&p.dem&&(p.dem.backfillBorder(g.dem,b,E),p.neighboringTiles&&p.neighboringTiles[P]&&(p.neighboringTiles[P].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,a,c,p){for(const g in this._tiles){let b=this._tiles[g];if(p[g]||!b.hasData()||b.tileID.overscaledZ<=a||b.tileID.overscaledZ>c)continue;let E=b.tileID;for(;b&&b.tileID.overscaledZ>a+1;){const P=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[P.key],b&&b.hasData()&&(E=P)}let k=E;for(;k.overscaledZ>a;)if(k=k.scaledTo(k.overscaledZ-1),n[k.key]){p[E.key]=E;break}}}findLoadedParent(n,a){if(n.key in this._loadedParentTiles){const c=this._loadedParentTiles[n.key];return c&&c.tileID.overscaledZ>=a?c:null}for(let c=n.overscaledZ-1;c>=a;c--){const p=n.scaledTo(c),g=this._getLoadedTile(p);if(g)return g}}_getLoadedTile(n){const a=this._tiles[n.key];return a&&a.hasData()?a:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const a=Math.ceil(n.width/this._source.tileSize)+1,c=Math.ceil(n.height/this._source.tileSize)+1,p=Math.floor(a*c*5),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(g)}handleWrapJump(n){const a=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,a){const c={};for(const p in this._tiles){const g=this._tiles[p];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+a),c[g.tileID.key]=g}this._tiles=c;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(p,this._tiles[p])}}update(n,a){if(this.transform=n,this.terrain=a,!this._sourceLoaded||this._paused)return;let c;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(P=>new u.OverscaledTileID(P.canonical.z,P.wrap,P.canonical.z,P.canonical.x,P.canonical.y)):(c=n.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a}),this._source.hasTile&&(c=c.filter(P=>this._source.hasTile(P)))):c=[];const p=n.coveringZoomLevel(this._source),g=Math.max(p-Jr.maxOverzooming,this._source.minzoom),b=Math.max(p+Jr.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const P={};for(const z of c)if(z.canonical.z>this._source.minzoom){const R=z.scaledTo(z.canonical.z-1);P[R.key]=R;const N=z.scaledTo(Math.max(this._source.minzoom,Math.min(z.canonical.z,5)));P[N.key]=N}c=c.concat(Object.values(P))}const E=this._updateRetainedTiles(c,p);if(Ka(this._source.type)){const P={},z={},R=Object.keys(E);for(const N of R){const X=E[N],Z=this._tiles[N];if(!Z||Z.fadeEndTime&&Z.fadeEndTime<=u.exported.now())continue;const H=this.findLoadedParent(X,g);H&&(this._addTile(H.tileID),P[H.tileID.key]=H.tileID),z[N]=X}this._retainLoadedChildren(z,p,b,E);for(const N in P)E[N]||(this._coveredTiles[N]=!0,E[N]=P[N]);if(a){const N={},X={};for(const Z of c)this._tiles[Z.key].hasData()?N[Z.key]=Z:X[Z.key]=Z;for(const Z in X){const H=X[Z].children(this._source.maxzoom);this._tiles[H[0].key]&&this._tiles[H[1].key]&&this._tiles[H[2].key]&&this._tiles[H[3].key]&&(N[H[0].key]=E[H[0].key]=H[0],N[H[1].key]=E[H[1].key]=H[1],N[H[2].key]=E[H[2].key]=H[2],N[H[3].key]=E[H[3].key]=H[3],delete X[Z])}for(const Z in X){const H=this.findLoadedParent(X[Z],this._source.minzoom);if(H){N[H.tileID.key]=E[H.tileID.key]=H.tileID;for(const le in N)N[le].isChildOf(H.tileID)&&delete N[le]}}for(const Z in this._tiles)N[Z]||(this._coveredTiles[Z]=!0)}}for(const P in E)this._tiles[P].clearFadeHold();const k=u.keysDifference(this._tiles,E);for(const P of k){const z=this._tiles[P];z.hasSymbolBuckets&&!z.holdingForFade()?z.setHoldDuration(this.map._fadeDuration):z.hasSymbolBuckets&&!z.symbolFadeFinished()||this._removeTile(P)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,a){const c={},p={},g=Math.max(a-Jr.maxOverzooming,this._source.minzoom),b=Math.max(a+Jr.maxUnderzooming,this._source.minzoom),E={};for(const k of n){const P=this._addTile(k);c[k.key]=k,P.hasData()||a<this._source.maxzoom&&(E[k.key]=k)}this._retainLoadedChildren(E,a,b,c);for(const k of n){let P=this._tiles[k.key];if(P.hasData())continue;if(a+1>this._source.maxzoom){const R=k.children(this._source.maxzoom)[0],N=this.getTile(R);if(N&&N.hasData()){c[R.key]=R;continue}}else{const R=k.children(this._source.maxzoom);if(c[R[0].key]&&c[R[1].key]&&c[R[2].key]&&c[R[3].key])continue}let z=P.wasRequested();for(let R=k.overscaledZ-1;R>=g;--R){const N=k.scaledTo(R);if(p[N.key]||(p[N.key]=!0,P=this.getTile(N),!P&&z&&(P=this._addTile(N)),P&&(c[N.key]=N,z=P.wasRequested(),P.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const a=[];let c,p=this._tiles[n].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){c=this._loadedParentTiles[p.key];break}a.push(p.key);const g=p.scaledTo(p.overscaledZ-1);if(c=this._getLoadedTile(g),c)break;p=g}for(const g of a)this._loadedParentTiles[g]=c}}_addTile(n){let a=this._tiles[n.key];if(a)return a;a=this._cache.getAndRemove(n),a&&(this._setTileReloadTimer(n.key,a),a.tileID=n,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,a)));const c=a;return a||(a=new Cr(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(a,this._tileLoaded.bind(this,a,n.key,a.state))),a.uses++,this._tiles[n.key]=a,c||this._source.fire(new u.Event("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(n,a){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const c=a.getExpiryTimeout();c&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},c))}_removeTile(n){const a=this._tiles[n];a&&(a.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,a,c){const p=[],g=this.transform;if(!g)return p;const b=c?g.getCameraQueryGeometry(n):n,E=n.map(Z=>g.pointCoordinate(Z,this.terrain)),k=b.map(Z=>g.pointCoordinate(Z,this.terrain)),P=this.getIds();let z=1/0,R=1/0,N=-1/0,X=-1/0;for(const Z of k)z=Math.min(z,Z.x),R=Math.min(R,Z.y),N=Math.max(N,Z.x),X=Math.max(X,Z.y);for(let Z=0;Z<P.length;Z++){const H=this._tiles[P[Z]];if(H.holdingForFade())continue;const le=H.tileID,de=Math.pow(2,g.zoom-H.tileID.overscaledZ),ye=a*H.queryPadding*u.EXTENT/H.tileSize/de,Y=[le.getTilePoint(new u.MercatorCoordinate(z,R)),le.getTilePoint(new u.MercatorCoordinate(N,X))];if(Y[0].x-ye<u.EXTENT&&Y[0].y-ye<u.EXTENT&&Y[1].x+ye>=0&&Y[1].y+ye>=0){const Se=E.map(De=>le.getTilePoint(De)),ve=k.map(De=>le.getTilePoint(De));p.push({tile:H,tileID:le,queryGeometry:Se,cameraQueryGeometry:ve,scale:de})}}return p}getVisibleCoordinates(n){const a=this.getRenderableIds(n).map(c=>this._tiles[c].tileID);for(const c of a)c.posMatrix=this.transform.calculatePosMatrix(c.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(Ka(this._source.type))for(const n in this._tiles){const a=this._tiles[n];if(a.fadeEndTime!==void 0&&a.fadeEndTime>=u.exported.now())return!0}return!1}setFeatureState(n,a,c){this._state.updateState(n=n||"_geojsonTileLayer",a,c)}removeFeatureState(n,a,c){this._state.removeFeatureState(n=n||"_geojsonTileLayer",a,c)}getFeatureState(n,a){return this._state.getState(n=n||"_geojsonTileLayer",a)}setDependencies(n,a,c){const p=this._tiles[n];p&&p.setDependencies(a,c)}reloadTilesForDependencies(n,a){for(const c in this._tiles)this._tiles[c].hasDependency(n,a)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(n,a))}}function Ta(h,n){const a=Math.abs(2*h.wrap)-+(h.wrap<0),c=Math.abs(2*n.wrap)-+(n.wrap<0);return h.overscaledZ-n.overscaledZ||c-a||n.canonical.y-h.canonical.y||n.canonical.x-h.canonical.x}function Ka(h){return h==="raster"||h==="image"||h==="video"}Jr.maxOverzooming=10,Jr.maxUnderzooming=3;const Nr="mapboxgl_preloaded_worker_pool";class Ur{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<Ur.workerCount;)this.workers.push(new Worker(ss.workerUrl));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Nr]}numActive(){return Object.keys(this.active).length}}const go=Math.floor(u.exported.hardwareConcurrency/2);let Ir;function hi(){return Ir||(Ir=new Ur),Ir}function ka(h,n){const a={};for(const c in h)c!=="ref"&&(a[c]=h[c]);return u.refProperties.forEach(c=>{c in n&&(a[c]=n[c])}),a}function Ca(h){h=h.slice();const n=Object.create(null);for(let a=0;a<h.length;a++)n[h[a].id]=h[a];for(let a=0;a<h.length;a++)"ref"in h[a]&&(h[a]=ka(h[a],n[h[a].ref]));return h}Ur.workerCount=Math.max(Math.min(go,6),1);const rn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function nr(h,n,a){a.push({command:rn.addSource,args:[h,n[h]]})}function Uo(h,n,a){n.push({command:rn.removeSource,args:[h]}),a[h]=!0}function Ti(h,n,a,c){Uo(h,a,c),nr(h,n,a)}function Ia(h,n,a){let c;for(c in h[a])if(Object.prototype.hasOwnProperty.call(h[a],c)&&c!=="data"&&!ne(h[a][c],n[a][c]))return!1;for(c in n[a])if(Object.prototype.hasOwnProperty.call(n[a],c)&&c!=="data"&&!ne(h[a][c],n[a][c]))return!1;return!0}function Bi(h,n,a,c,p,g){let b;for(b in n=n||{},h=h||{})Object.prototype.hasOwnProperty.call(h,b)&&(ne(h[b],n[b])||a.push({command:g,args:[c,b,n[b],p]}));for(b in n)Object.prototype.hasOwnProperty.call(n,b)&&!Object.prototype.hasOwnProperty.call(h,b)&&(ne(h[b],n[b])||a.push({command:g,args:[c,b,n[b],p]}))}function Ki(h){return h.id}function aa(h,n){return h[n.id]=n,h}class Ji{constructor(n,a){this.reset(n,a)}reset(n,a){this.points=n||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=u.clamp(n,0,1);let a=1,c=this._distances[a];const p=n*this.paddedLength+this.padding;for(;c<p&&a<this._distances.length;)c=this._distances[++a];const g=a-1,b=this._distances[g],E=c-b,k=E>0?(p-b)/E:0;return this.points[g].mult(1-k).add(this.points[a].mult(k))}}function Le(h,n){let a=!0;return h==="always"||h!=="never"&&n!=="never"||(a=!1),a}class Je{constructor(n,a,c){const p=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(n/c),this.yCellCount=Math.ceil(a/c);for(let b=0;b<this.xCellCount*this.yCellCount;b++)p.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=a,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,a,c,p,g){this._forEachCell(a,c,p,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(a),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(g)}insertCircle(n,a,c,p){this._forEachCell(a-p,c-p,a+p,c+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(a),this.circles.push(c),this.circles.push(p)}_insertBoxCell(n,a,c,p,g,b){this.boxCells[g].push(b)}_insertCircleCell(n,a,c,p,g,b){this.circleCells[g].push(b)}_query(n,a,c,p,g,b,E){if(c<0||n>this.width||p<0||a>this.height)return[];const k=[];if(n<=0&&a<=0&&this.width<=c&&this.height<=p){if(g)return[{key:null,x1:n,y1:a,x2:c,y2:p}];for(let P=0;P<this.boxKeys.length;P++)k.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){const z=this.circles[3*P],R=this.circles[3*P+1],N=this.circles[3*P+2];k.push({key:this.circleKeys[P],x1:z-N,y1:R-N,x2:z+N,y2:R+N})}}else this._forEachCell(n,a,c,p,this._queryCell,k,{hitTest:g,overlapMode:b,seenUids:{box:{},circle:{}}},E);return k}query(n,a,c,p){return this._query(n,a,c,p,!1,null)}hitTest(n,a,c,p,g,b){return this._query(n,a,c,p,!0,g,b).length>0}hitTestCircle(n,a,c,p,g){const b=n-c,E=n+c,k=a-c,P=a+c;if(E<0||b>this.width||P<0||k>this.height)return!1;const z=[];return this._forEachCell(b,k,E,P,this._queryCellCircle,z,{hitTest:!0,overlapMode:p,circle:{x:n,y:a,radius:c},seenUids:{box:{},circle:{}}},g),z.length>0}_queryCell(n,a,c,p,g,b,E,k){const{seenUids:P,hitTest:z,overlapMode:R}=E,N=this.boxCells[g];if(N!==null){const Z=this.bboxes;for(const H of N)if(!P.box[H]){P.box[H]=!0;const le=4*H,de=this.boxKeys[H];if(n<=Z[le+2]&&a<=Z[le+3]&&c>=Z[le+0]&&p>=Z[le+1]&&(!k||k(de))&&(!z||!Le(R,de.overlapMode))&&(b.push({key:de,x1:Z[le],y1:Z[le+1],x2:Z[le+2],y2:Z[le+3]}),z))return!0}}const X=this.circleCells[g];if(X!==null){const Z=this.circles;for(const H of X)if(!P.circle[H]){P.circle[H]=!0;const le=3*H,de=this.circleKeys[H];if(this._circleAndRectCollide(Z[le],Z[le+1],Z[le+2],n,a,c,p)&&(!k||k(de))&&(!z||!Le(R,de.overlapMode))){const ye=Z[le],Y=Z[le+1],Se=Z[le+2];if(b.push({key:de,x1:ye-Se,y1:Y-Se,x2:ye+Se,y2:Y+Se}),z)return!0}}}return!1}_queryCellCircle(n,a,c,p,g,b,E,k){const{circle:P,seenUids:z,overlapMode:R}=E,N=this.boxCells[g];if(N!==null){const Z=this.bboxes;for(const H of N)if(!z.box[H]){z.box[H]=!0;const le=4*H,de=this.boxKeys[H];if(this._circleAndRectCollide(P.x,P.y,P.radius,Z[le+0],Z[le+1],Z[le+2],Z[le+3])&&(!k||k(de))&&!Le(R,de.overlapMode))return b.push(!0),!0}}const X=this.circleCells[g];if(X!==null){const Z=this.circles;for(const H of X)if(!z.circle[H]){z.circle[H]=!0;const le=3*H,de=this.circleKeys[H];if(this._circlesCollide(Z[le],Z[le+1],Z[le+2],P.x,P.y,P.radius)&&(!k||k(de))&&!Le(R,de.overlapMode))return b.push(!0),!0}}}_forEachCell(n,a,c,p,g,b,E,k){const P=this._convertToXCellCoord(n),z=this._convertToYCellCoord(a),R=this._convertToXCellCoord(c),N=this._convertToYCellCoord(p);for(let X=P;X<=R;X++)for(let Z=z;Z<=N;Z++)if(g.call(this,n,a,c,p,this.xCellCount*Z+X,b,E,k))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,a,c,p,g,b){const E=p-n,k=g-a,P=c+b;return P*P>E*E+k*k}_circleAndRectCollide(n,a,c,p,g,b,E){const k=(b-p)/2,P=Math.abs(n-(p+k));if(P>k+c)return!1;const z=(E-g)/2,R=Math.abs(a-(g+z));if(R>z+c)return!1;if(P<=k||R<=z)return!0;const N=P-k,X=R-z;return N*N+X*X<=c*c}}function Yn(h,n,a,c,p){const g=u.create();return n?(u.scale(g,g,[1/p,1/p,1]),a||u.rotateZ(g,g,c.angle)):u.multiply(g,c.labelPlaneMatrix,h),g}function br(h,n,a,c,p){if(n){const g=u.clone(h);return u.scale(g,g,[p,p,1]),a||u.rotateZ(g,g,-c.angle),g}return c.glCoordMatrix}function jt(h,n,a){let c;a?(c=[h.x,h.y,a(h.x,h.y),1],u.transformMat4(c,c,n)):(c=[h.x,h.y,0,1],pn(c,c,n));const p=c[3];return{point:new u.pointGeometry(c[0]/p,c[1]/p),signedDistanceFromCamera:p}}function Vn(h,n){return .5+h/n*.5}function di(h,n){const a=h[0]/h[3],c=h[1]/h[3];return a>=-n[0]&&a<=n[0]&&c>=-n[1]&&c<=n[1]}function Pr(h,n,a,c,p,g,b,E,k,P){const z=c?h.textSizeData:h.iconSizeData,R=u.evaluateSizeForZoom(z,a.transform.zoom),N=[256/a.width*2+1,256/a.height*2+1],X=c?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;X.clear();const Z=h.lineVertexArray,H=c?h.text.placedSymbolArray:h.icon.placedSymbolArray,le=a.transform.width/a.transform.height;let de=!1;for(let ye=0;ye<H.length;ye++){const Y=H.get(ye);if(Y.hidden||Y.writingMode===u.WritingMode.vertical&&!de){Ot(Y.numGlyphs,X);continue}let Se;if(de=!1,P?(Se=[Y.anchorX,Y.anchorY,P(Y.anchorX,Y.anchorY),1],u.transformMat4(Se,Se,n)):(Se=[Y.anchorX,Y.anchorY,0,1],pn(Se,Se,n)),!di(Se,N)){Ot(Y.numGlyphs,X);continue}const ve=Vn(a.transform.cameraToCenterDistance,Se[3]),De=u.evaluateSizeForFeature(z,R,Y),Re=b?De/ve:De*ve,$e=new u.pointGeometry(Y.anchorX,Y.anchorY),Pe=jt($e,p,P).point,ht={},nt=Gt(Y,Re,!1,E,n,p,g,h.glyphOffsetArray,Z,X,Pe,$e,ht,le,k,P);de=nt.useVertical,(nt.notEnoughRoom||de||nt.needsFlipping&&Gt(Y,Re,!0,E,n,p,g,h.glyphOffsetArray,Z,X,Pe,$e,ht,le,k,P).notEnoughRoom)&&Ot(Y.numGlyphs,X)}c?h.text.dynamicLayoutVertexBuffer.updateData(X):h.icon.dynamicLayoutVertexBuffer.updateData(X)}function Kn(h,n,a,c,p,g,b,E,k,P,z,R,N){const X=E.glyphStartIndex+E.numGlyphs,Z=E.lineStartIndex,H=E.lineStartIndex+E.lineLength,le=n.getoffsetX(E.glyphStartIndex),de=n.getoffsetX(X-1),ye=wr(h*le,a,c,p,g,b,E.segment,Z,H,k,P,z,R,N);if(!ye)return null;const Y=wr(h*de,a,c,p,g,b,E.segment,Z,H,k,P,z,R,N);return Y?{first:ye,last:Y}:null}function Fe(h,n,a,c){return h===u.WritingMode.horizontal&&Math.abs(a.y-n.y)>Math.abs(a.x-n.x)*c?{useVertical:!0}:(h===u.WritingMode.vertical?n.y<a.y:n.x>a.x)?{needsFlipping:!0}:null}function Gt(h,n,a,c,p,g,b,E,k,P,z,R,N,X,Z,H){const le=n/24,de=h.lineOffsetX*le,ye=h.lineOffsetY*le;let Y;if(h.numGlyphs>1){const Se=h.glyphStartIndex+h.numGlyphs,ve=h.lineStartIndex,De=h.lineStartIndex+h.lineLength,Re=Kn(le,E,de,ye,a,z,R,h,k,g,N,Z,H);if(!Re)return{notEnoughRoom:!0};const $e=jt(Re.first.point,b,H).point,Pe=jt(Re.last.point,b,H).point;if(c&&!a){const ht=Fe(h.writingMode,$e,Pe,X);if(ht)return ht}Y=[Re.first];for(let ht=h.glyphStartIndex+1;ht<Se-1;ht++)Y.push(wr(le*E.getoffsetX(ht),de,ye,a,z,R,h.segment,ve,De,k,g,N,Z,H));Y.push(Re.last)}else{if(c&&!a){const ve=jt(R,p,H).point,De=h.lineStartIndex+h.segment+1,Re=new u.pointGeometry(k.getx(De),k.gety(De)),$e=jt(Re,p,H),Pe=$e.signedDistanceFromCamera>0?$e.point:Bt(R,Re,ve,1,p,H),ht=Fe(h.writingMode,ve,Pe,X);if(ht)return ht}const Se=wr(le*E.getoffsetX(h.glyphStartIndex),de,ye,a,z,R,h.segment,h.lineStartIndex,h.lineStartIndex+h.lineLength,k,g,N,Z,H);if(!Se)return{notEnoughRoom:!0};Y=[Se]}for(const Se of Y)u.addDynamicAttributes(P,Se.point,Se.angle);return{}}function Bt(h,n,a,c,p,g){const b=jt(h.add(h.sub(n)._unit()),p,g).point,E=a.sub(b);return a.add(E._mult(c/E.mag()))}function wr(h,n,a,c,p,g,b,E,k,P,z,R,N,X){const Z=c?h-n:h+n;let H=Z>0?1:-1,le=0;c&&(H*=-1,le=Math.PI),H<0&&(le+=Math.PI);let de=H>0?E+b:E+b+1,ye=p,Y=p,Se=0,ve=0;const De=Math.abs(Z),Re=[];for(;Se+ve<=De;){if(de+=H,de<E||de>=k)return null;if(Y=ye,Re.push(ye),ye=R[de],ye===void 0){const pt=new u.pointGeometry(P.getx(de),P.gety(de)),Vt=jt(pt,z,X);if(Vt.signedDistanceFromCamera>0)ye=R[de]=Vt.point;else{const Wt=de-H;ye=Bt(Se===0?g:new u.pointGeometry(P.getx(Wt),P.gety(Wt)),pt,Y,De-Se+1,z,X)}}Se+=ve,ve=Y.dist(ye)}const $e=(De-Se)/ve,Pe=ye.sub(Y),ht=Pe.mult($e)._add(Y);ht._add(Pe._unit()._perp()._mult(a*H));const nt=le+Math.atan2(ye.y-Y.y,ye.x-Y.x);return Re.push(ht),{point:ht,angle:N?nt:0,path:Re}}const Ni=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ot(h,n){for(let a=0;a<h;a++){const c=n.length;n.resize(c+4),n.float32.set(Ni,3*c)}}function pn(h,n,a){const c=n[0],p=n[1];return h[0]=a[0]*c+a[4]*p+a[12],h[1]=a[1]*c+a[5]*p+a[13],h[3]=a[3]*c+a[7]*p+a[15],h}const ur=100;class pi{constructor(n,a=new Je(n.width+200,n.height+200,25),c=new Je(n.width+200,n.height+200,25)){this.transform=n,this.grid=a,this.ignoredGrid=c,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+ur,this.screenBottomBoundary=n.height+ur,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,a,c,p,g,b){const E=this.projectAndGetPerspectiveRatio(p,n.anchorPointX,n.anchorPointY,b),k=c*E.perspectiveRatio,P=n.x1*k+E.point.x,z=n.y1*k+E.point.y,R=n.x2*k+E.point.x,N=n.y2*k+E.point.y;return!this.isInsideGrid(P,z,R,N)||a!=="always"&&this.grid.hitTest(P,z,R,N,a,g)||E.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[P,z,R,N],offscreen:this.isOffscreen(P,z,R,N)}}placeCollisionCircles(n,a,c,p,g,b,E,k,P,z,R,N,X,Z){const H=[],le=new u.pointGeometry(a.anchorX,a.anchorY),de=jt(le,b,Z),ye=Vn(this.transform.cameraToCenterDistance,de.signedDistanceFromCamera),Y=(z?g/ye:g*ye)/u.ONE_EM,Se=jt(le,E,Z).point,ve=Kn(Y,p,a.lineOffsetX*Y,a.lineOffsetY*Y,!1,Se,le,a,c,E,{},!1,Z);let De=!1,Re=!1,$e=!0;if(ve){const Pe=.5*N*ye+X,ht=new u.pointGeometry(-100,-100),nt=new u.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),pt=new Ji,Vt=ve.first,Wt=ve.last;let Ct=[];for(let un=Vt.path.length-1;un>=1;un--)Ct.push(Vt.path[un]);for(let un=1;un<Wt.path.length;un++)Ct.push(Wt.path[un]);const En=2.5*Pe;if(k){const un=Ct.map(cn=>jt(cn,k,Z));Ct=un.some(cn=>cn.signedDistanceFromCamera<=0)?[]:un.map(cn=>cn.point)}let Tn=[];if(Ct.length>0){const un=Ct[0].clone(),cn=Ct[0].clone();for(let Cn=1;Cn<Ct.length;Cn++)un.x=Math.min(un.x,Ct[Cn].x),un.y=Math.min(un.y,Ct[Cn].y),cn.x=Math.max(cn.x,Ct[Cn].x),cn.y=Math.max(cn.y,Ct[Cn].y);Tn=un.x>=ht.x&&cn.x<=nt.x&&un.y>=ht.y&&cn.y<=nt.y?[Ct]:cn.x<ht.x||un.x>nt.x||cn.y<ht.y||un.y>nt.y?[]:u.clipLine([Ct],ht.x,ht.y,nt.x,nt.y)}for(const un of Tn){pt.reset(un,.25*Pe);let cn=0;cn=pt.length<=.5*Pe?1:Math.ceil(pt.paddedLength/En)+1;for(let Cn=0;Cn<cn;Cn++){const Lr=Cn/Math.max(cn-1,1),Xo=pt.lerp(Lr),Co=Xo.x+ur,Yo=Xo.y+ur;H.push(Co,Yo,Pe,0);const $a=Co-Pe,ao=Yo-Pe,Ai=Co+Pe,da=Yo+Pe;if($e=$e&&this.isOffscreen($a,ao,Ai,da),Re=Re||this.isInsideGrid($a,ao,Ai,da),n!=="always"&&this.grid.hitTestCircle(Co,Yo,Pe,n,R)&&(De=!0,!P))return{circles:[],offscreen:!1,collisionDetected:De}}}}return{circles:!P&&De||!Re||ye<this.perspectiveRatioCutoff?[]:H,offscreen:$e,collisionDetected:De}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let c=1/0,p=1/0,g=-1/0,b=-1/0;for(const z of n){const R=new u.pointGeometry(z.x+ur,z.y+ur);c=Math.min(c,R.x),p=Math.min(p,R.y),g=Math.max(g,R.x),b=Math.max(b,R.y),a.push(R)}const E=this.grid.query(c,p,g,b).concat(this.ignoredGrid.query(c,p,g,b)),k={},P={};for(const z of E){const R=z.key;if(k[R.bucketInstanceId]===void 0&&(k[R.bucketInstanceId]={}),k[R.bucketInstanceId][R.featureIndex])continue;const N=[new u.pointGeometry(z.x1,z.y1),new u.pointGeometry(z.x2,z.y1),new u.pointGeometry(z.x2,z.y2),new u.pointGeometry(z.x1,z.y2)];u.polygonIntersectsPolygon(a,N)&&(k[R.bucketInstanceId][R.featureIndex]=!0,P[R.bucketInstanceId]===void 0&&(P[R.bucketInstanceId]=[]),P[R.bucketInstanceId].push(R.featureIndex))}return P}insertCollisionBox(n,a,c,p,g,b){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:g,collisionGroupID:b,overlapMode:a},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,a,c,p,g,b){const E=c?this.ignoredGrid:this.grid,k={bucketInstanceId:p,featureIndex:g,collisionGroupID:b,overlapMode:a};for(let P=0;P<n.length;P+=4)E.insertCircle(k,n[P],n[P+1],n[P+2])}projectAndGetPerspectiveRatio(n,a,c,p){let g;return p?(g=[a,c,p(a,c),1],u.transformMat4(g,g,n)):(g=[a,c,0,1],pn(g,g,n)),{point:new u.pointGeometry((g[0]/g[3]+1)/2*this.transform.width+ur,(-g[1]/g[3]+1)/2*this.transform.height+ur),perspectiveRatio:.5+this.transform.cameraToCenterDistance/g[3]*.5}}isOffscreen(n,a,c,p){return c<ur||n>=this.screenRightBoundary||p<ur||a>this.screenBottomBoundary}isInsideGrid(n,a,c,p){return c>=0&&n<this.gridRightBoundary&&p>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const n=u.identity([]);return u.translate(n,n,[-100,-100,0]),n}}function rr(h,n,a){return n*(u.EXTENT/(h.tileSize*Math.pow(2,a-h.tileID.overscaledZ)))}class Vr{constructor(n,a,c,p){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?a:-a))):p&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class xn{constructor(n,a,c,p,g){this.text=new Vr(n?n.text:null,a,c,g),this.icon=new Vr(n?n.icon:null,a,p,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Vo{constructor(n,a,c){this.text=n,this.icon=a,this.skipFade=c}}class $r{constructor(){this.invProjMatrix=u.create(),this.viewportMatrix=u.create(),this.circles=[]}}class $o{constructor(n,a,c,p,g){this.bucketInstanceId=n,this.featureIndex=a,this.sourceLayerIndex=c,this.bucketIndex=p,this.tileID=g}}class yo{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const a=++this.maxGroupID;this.collisionGroups[n]={ID:a,predicate:c=>c.collisionGroupID===a}}return this.collisionGroups[n]}}function _o(h,n,a,c,p){const{horizontalAlign:g,verticalAlign:b}=u.getAnchorAlignment(h),E=-(g-.5)*n,k=-(b-.5)*a,P=u.evaluateVariableOffset(h,c);return new u.pointGeometry(E+P[0]*p,k+P[1]*p)}function vo(h,n,a,c,p,g){const{x1:b,x2:E,y1:k,y2:P,anchorPointX:z,anchorPointY:R}=h,N=new u.pointGeometry(n,a);return c&&N._rotate(p?g:-g),{x1:b+N.x,y1:k+N.y,x2:E+N.x,y2:P+N.y,anchorPointX:z,anchorPointY:R}}class q{constructor(n,a,c,p,g){this.transform=n.clone(),this.terrain=a,this.collisionIndex=new pi(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new yo(p),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,a,c,p){const g=c.getBucket(a),b=c.latestFeatureIndex;if(!g||!b||a.id!==g.layerIds[0])return;const E=c.collisionBoxArray,k=g.layers[0].layout,P=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),z=c.tileSize/u.EXTENT,R=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),N=k.get("text-pitch-alignment")==="map",X=k.get("text-rotation-alignment")==="map",Z=rr(c,1,this.transform.zoom),H=Yn(R,N,X,this.transform,Z);let le=null;if(N){const ye=br(R,N,X,this.transform,Z);le=u.multiply([],this.transform.labelPlaneMatrix,ye)}this.retainedQueryData[g.bucketInstanceId]=new $o(g.bucketInstanceId,b,g.sourceLayerIndex,g.index,c.tileID);const de={bucket:g,layout:k,posMatrix:R,textLabelPlaneMatrix:H,labelToScreenMatrix:le,scale:P,textPixelRatio:z,holdingForFade:c.holdingForFade(),collisionBoxArray:E,partiallyEvaluatedTextSize:u.evaluateSizeForZoom(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(p)for(const ye of g.sortKeyRanges){const{sortKey:Y,symbolInstanceStart:Se,symbolInstanceEnd:ve}=ye;n.push({sortKey:Y,symbolInstanceStart:Se,symbolInstanceEnd:ve,parameters:de})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:de})}attemptAnchorPlacement(n,a,c,p,g,b,E,k,P,z,R,N,X,Z,H,le){const de=[N.textOffset0,N.textOffset1],ye=_o(n,c,p,de,g),Y=this.collisionIndex.placeCollisionBox(vo(a,ye.x,ye.y,b,E,this.transform.angle),R,k,P,z.predicate,le);if((!H||this.collisionIndex.placeCollisionBox(vo(H,ye.x,ye.y,b,E,this.transform.angle),R,k,P,z.predicate,le).box.length!==0)&&Y.box.length>0){let Se;if(this.prevPlacement&&this.prevPlacement.variableOffsets[N.crossTileID]&&this.prevPlacement.placements[N.crossTileID]&&this.prevPlacement.placements[N.crossTileID].text&&(Se=this.prevPlacement.variableOffsets[N.crossTileID].anchor),N.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[N.crossTileID]={textOffset:de,width:c,height:p,anchor:n,textBoxScale:g,prevAnchor:Se},this.markUsedJustification(X,n,N,Z),X.allowVerticalPlacement&&(this.markUsedOrientation(X,Z,N),this.placedOrientations[N.crossTileID]=Z),{shift:ye,placedGlyphBoxes:Y}}}placeLayerBucketPart(n,a,c){const{bucket:p,layout:g,posMatrix:b,textLabelPlaneMatrix:E,labelToScreenMatrix:k,textPixelRatio:P,holdingForFade:z,collisionBoxArray:R,partiallyEvaluatedTextSize:N,collisionGroup:X}=n.parameters,Z=g.get("text-optional"),H=g.get("icon-optional"),le=u.getOverlapMode(g,"text-overlap","text-allow-overlap"),de=le==="always",ye=u.getOverlapMode(g,"icon-overlap","icon-allow-overlap"),Y=ye==="always",Se=g.get("text-rotation-alignment")==="map",ve=g.get("text-pitch-alignment")==="map",De=g.get("icon-text-fit")!=="none",Re=g.get("symbol-z-order")==="viewport-y",$e=de&&(Y||!p.hasIconData()||H),Pe=Y&&(de||!p.hasTextData()||Z);!p.collisionArrays&&R&&p.deserializeCollisionBoxes(R);const ht=(nt,pt)=>{if(a[nt.crossTileID])return;if(z)return void(this.placements[nt.crossTileID]=new Vo(!1,!1,!1));let Vt=!1,Wt=!1,Ct=!0,En=null,Tn={box:null,offscreen:null},un={box:null,offscreen:null},cn=null,Cn=null,Lr=null,Xo=0,Co=0,Yo=0;pt.textFeatureIndex?Xo=pt.textFeatureIndex:nt.useRuntimeCollisionCircles&&(Xo=nt.featureIndex),pt.verticalTextFeatureIndex&&(Co=pt.verticalTextFeatureIndex);const $a=this.retainedQueryData[p.bucketInstanceId].tileID,ao=this.terrain?(Sr,Kt)=>this.terrain.getElevation($a,Sr,Kt):null;for(const Sr of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const Kt=pt[Sr];Kt&&(Kt.elevation=ao?ao(Kt.anchorPointX,Kt.anchorPointY):0)}const Ai=pt.textBox;if(Ai){const Sr=bn=>{let Dr=u.WritingMode.horizontal;if(p.allowVerticalPlacement&&!bn&&this.prevPlacement){const Rr=this.prevPlacement.placedOrientations[nt.crossTileID];Rr&&(this.placedOrientations[nt.crossTileID]=Rr,Dr=Rr,this.markUsedOrientation(p,Dr,nt))}return Dr},Kt=(bn,Dr)=>{if(p.allowVerticalPlacement&&nt.numVerticalGlyphVertices>0&&pt.verticalTextBox){for(const Rr of p.writingModes)if(Rr===u.WritingMode.vertical?(Tn=Dr(),un=Tn):Tn=bn(),Tn&&Tn.box&&Tn.box.length)break}else Tn=bn()};if(g.get("text-variable-anchor")){let bn=g.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[nt.crossTileID]){const qn=this.prevPlacement.variableOffsets[nt.crossTileID];bn.indexOf(qn.anchor)>0&&(bn=bn.filter(so=>so!==qn.anchor),bn.unshift(qn.anchor))}const Dr=(qn,so,ls)=>{const Ic=qn.x2-qn.x1,Zs=qn.y2-qn.y1,od=nt.textBoxScale,Pc=De&&ye==="never"?so:null;let ja={box:[],offscreen:!1};const us=le!=="never"?2*bn.length:bn.length;for(let cs=0;cs<us;++cs){const ku=this.attemptAnchorPlacement(bn[cs%bn.length],qn,Ic,Zs,od,Se,ve,P,b,X,cs>=bn.length?le:"never",nt,p,ls,Pc,ao);if(ku&&(ja=ku.placedGlyphBoxes,ja&&ja.box&&ja.box.length)){Vt=!0,En=ku.shift;break}}return ja};Kt(()=>Dr(Ai,pt.iconBox,u.WritingMode.horizontal),()=>{const qn=pt.verticalTextBox;return p.allowVerticalPlacement&&!(Tn&&Tn.box&&Tn.box.length)&&nt.numVerticalGlyphVertices>0&&qn?Dr(qn,pt.verticalIconBox,u.WritingMode.vertical):{box:null,offscreen:null}}),Tn&&(Vt=Tn.box,Ct=Tn.offscreen);const Rr=Sr(Tn&&Tn.box);if(!Vt&&this.prevPlacement){const qn=this.prevPlacement.variableOffsets[nt.crossTileID];qn&&(this.variableOffsets[nt.crossTileID]=qn,this.markUsedJustification(p,qn.anchor,nt,Rr))}}else{const bn=(Dr,Rr)=>{const qn=this.collisionIndex.placeCollisionBox(Dr,le,P,b,X.predicate,ao);return qn&&qn.box&&qn.box.length&&(this.markUsedOrientation(p,Rr,nt),this.placedOrientations[nt.crossTileID]=Rr),qn};Kt(()=>bn(Ai,u.WritingMode.horizontal),()=>{const Dr=pt.verticalTextBox;return p.allowVerticalPlacement&&nt.numVerticalGlyphVertices>0&&Dr?bn(Dr,u.WritingMode.vertical):{box:null,offscreen:null}}),Sr(Tn&&Tn.box&&Tn.box.length)}}if(cn=Tn,Vt=cn&&cn.box&&cn.box.length>0,Ct=cn&&cn.offscreen,nt.useRuntimeCollisionCircles){const Sr=p.text.placedSymbolArray.get(nt.centerJustifiedTextSymbolIndex),Kt=u.evaluateSizeForFeature(p.textSizeData,N,Sr),bn=g.get("text-padding");Cn=this.collisionIndex.placeCollisionCircles(le,Sr,p.lineVertexArray,p.glyphOffsetArray,Kt,b,E,k,c,ve,X.predicate,nt.collisionCircleDiameter,bn,ao),Cn.circles.length&&Cn.collisionDetected&&!c&&u.warnOnce("Collisions detected, but collision boxes are not shown"),Vt=de||Cn.circles.length>0&&!Cn.collisionDetected,Ct=Ct&&Cn.offscreen}if(pt.iconFeatureIndex&&(Yo=pt.iconFeatureIndex),pt.iconBox){const Sr=Kt=>{const bn=De&&En?vo(Kt,En.x,En.y,Se,ve,this.transform.angle):Kt;return this.collisionIndex.placeCollisionBox(bn,ye,P,b,X.predicate,ao)};un&&un.box&&un.box.length&&pt.verticalIconBox?(Lr=Sr(pt.verticalIconBox),Wt=Lr.box.length>0):(Lr=Sr(pt.iconBox),Wt=Lr.box.length>0),Ct=Ct&&Lr.offscreen}const da=Z||nt.numHorizontalGlyphVertices===0&&nt.numVerticalGlyphVertices===0,Tu=H||nt.numIconVertices===0;if(da||Tu?Tu?da||(Wt=Wt&&Vt):Vt=Wt&&Vt:Wt=Vt=Wt&&Vt,Vt&&cn&&cn.box&&this.collisionIndex.insertCollisionBox(cn.box,le,g.get("text-ignore-placement"),p.bucketInstanceId,un&&un.box&&Co?Co:Xo,X.ID),Wt&&Lr&&this.collisionIndex.insertCollisionBox(Lr.box,ye,g.get("icon-ignore-placement"),p.bucketInstanceId,Yo,X.ID),Cn&&(Vt&&this.collisionIndex.insertCollisionCircles(Cn.circles,le,g.get("text-ignore-placement"),p.bucketInstanceId,Xo,X.ID),c)){const Sr=p.bucketInstanceId;let Kt=this.collisionCircleArrays[Sr];Kt===void 0&&(Kt=this.collisionCircleArrays[Sr]=new $r);for(let bn=0;bn<Cn.circles.length;bn+=4)Kt.circles.push(Cn.circles[bn+0]),Kt.circles.push(Cn.circles[bn+1]),Kt.circles.push(Cn.circles[bn+2]),Kt.circles.push(Cn.collisionDetected?1:0)}if(nt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(p.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[nt.crossTileID]=new Vo(Vt||$e,Wt||Pe,Ct||p.justReloaded),a[nt.crossTileID]=!0};if(Re){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const nt=p.getSortedSymbolIndexes(this.transform.angle);for(let pt=nt.length-1;pt>=0;--pt){const Vt=nt[pt];ht(p.symbolInstances.get(Vt),p.collisionArrays[Vt])}}else for(let nt=n.symbolInstanceStart;nt<n.symbolInstanceEnd;nt++)ht(p.symbolInstances.get(nt),p.collisionArrays[nt]);if(c&&p.bucketInstanceId in this.collisionCircleArrays){const nt=this.collisionCircleArrays[p.bucketInstanceId];u.invert(nt.invProjMatrix,b),nt.viewportMatrix=this.collisionIndex.getViewportMatrix()}p.justReloaded=!1}markUsedJustification(n,a,c,p){let g;g=p===u.WritingMode.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[u.getAnchorJustification(a)];const b=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const E of b)E>=0&&(n.text.placedSymbolArray.get(E).crossTileID=g>=0&&E!==g?0:c.crossTileID)}markUsedOrientation(n,a,c){const p=a===u.WritingMode.horizontal||a===u.WritingMode.horizontalOnly?a:0,g=a===u.WritingMode.vertical?a:0,b=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const E of b)n.text.placedSymbolArray.get(E).placedOrientation=p;c.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let c=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const p=a?a.symbolFadeChange(n):1,g=a?a.opacities:{},b=a?a.variableOffsets:{},E=a?a.placedOrientations:{};for(const k in this.placements){const P=this.placements[k],z=g[k];z?(this.opacities[k]=new xn(z,p,P.text,P.icon),c=c||P.text!==z.text.placed||P.icon!==z.icon.placed):(this.opacities[k]=new xn(null,p,P.text,P.icon,P.skipFade),c=c||P.text||P.icon)}for(const k in g){const P=g[k];if(!this.opacities[k]){const z=new xn(P,p,!1,!1);z.isHidden()||(this.opacities[k]=z,c=c||P.text.placed||P.icon.placed)}}for(const k in b)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=b[k]);for(const k in E)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=E[k]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:n)}updateLayerOpacities(n,a){const c={};for(const p of a){const g=p.getBucket(n);g&&p.latestFeatureIndex&&n.id===g.layerIds[0]&&this.updateBucketOpacities(g,c,p.collisionBoxArray)}}updateBucketOpacities(n,a,c){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const p=n.layers[0].layout,g=new xn(null,0,!1,!1,!0),b=p.get("text-allow-overlap"),E=p.get("icon-allow-overlap"),k=p.get("text-variable-anchor"),P=p.get("text-rotation-alignment")==="map",z=p.get("text-pitch-alignment")==="map",R=p.get("icon-text-fit")!=="none",N=new xn(null,0,b&&(E||!n.hasIconData()||p.get("icon-optional")),E&&(b||!n.hasTextData()||p.get("text-optional")),!0);!n.collisionArrays&&c&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(c);const X=(Z,H,le)=>{for(let de=0;de<H/4;de++)Z.opacityVertexArray.emplaceBack(le)};for(let Z=0;Z<n.symbolInstances.length;Z++){const H=n.symbolInstances.get(Z),{numHorizontalGlyphVertices:le,numVerticalGlyphVertices:de,crossTileID:ye}=H;let Y=this.opacities[ye];a[ye]?Y=g:Y||(Y=N,this.opacities[ye]=Y),a[ye]=!0;const Se=H.numIconVertices>0,ve=this.placedOrientations[H.crossTileID],De=ve===u.WritingMode.vertical,Re=ve===u.WritingMode.horizontal||ve===u.WritingMode.horizontalOnly;if(le>0||de>0){const $e=ce(Y.text);X(n.text,le,De?Ie:$e),X(n.text,de,Re?Ie:$e);const Pe=Y.text.isHidden();[H.rightJustifiedTextSymbolIndex,H.centerJustifiedTextSymbolIndex,H.leftJustifiedTextSymbolIndex].forEach(pt=>{pt>=0&&(n.text.placedSymbolArray.get(pt).hidden=Pe||De?1:0)}),H.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(H.verticalPlacedTextSymbolIndex).hidden=Pe||Re?1:0);const ht=this.variableOffsets[H.crossTileID];ht&&this.markUsedJustification(n,ht.anchor,H,ve);const nt=this.placedOrientations[H.crossTileID];nt&&(this.markUsedJustification(n,"left",H,nt),this.markUsedOrientation(n,nt,H))}if(Se){const $e=ce(Y.icon),Pe=!(R&&H.verticalPlacedIconSymbolIndex&&De);H.placedIconSymbolIndex>=0&&(X(n.icon,H.numIconVertices,Pe?$e:Ie),n.icon.placedSymbolArray.get(H.placedIconSymbolIndex).hidden=Y.icon.isHidden()),H.verticalPlacedIconSymbolIndex>=0&&(X(n.icon,H.numVerticalIconVertices,Pe?Ie:$e),n.icon.placedSymbolArray.get(H.verticalPlacedIconSymbolIndex).hidden=Y.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const $e=n.collisionArrays[Z];if($e){let Pe=new u.pointGeometry(0,0);if($e.textBox||$e.verticalTextBox){let nt=!0;if(k){const pt=this.variableOffsets[ye];pt?(Pe=_o(pt.anchor,pt.width,pt.height,pt.textOffset,pt.textBoxScale),P&&Pe._rotate(z?this.transform.angle:-this.transform.angle)):nt=!1}$e.textBox&&A(n.textCollisionBox.collisionVertexArray,Y.text.placed,!nt||De,Pe.x,Pe.y),$e.verticalTextBox&&A(n.textCollisionBox.collisionVertexArray,Y.text.placed,!nt||Re,Pe.x,Pe.y)}const ht=Boolean(!Re&&$e.verticalIconBox);$e.iconBox&&A(n.iconCollisionBox.collisionVertexArray,Y.icon.placed,ht,R?Pe.x:0,R?Pe.y:0),$e.verticalIconBox&&A(n.iconCollisionBox.collisionVertexArray,Y.icon.placed,!ht,R?Pe.x:0,R?Pe.y:0)}}}if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);if(n.bucketInstanceId in this.collisionCircleArrays){const Z=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Z.invProjMatrix,n.placementViewportMatrix=Z.viewportMatrix,n.collisionCircleArray=Z.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,a){const c=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*c>n}setStale(){this.stale=!0}}function A(h,n,a,c,p){h.emplaceBack(n?1:0,a?1:0,c||0,p||0),h.emplaceBack(n?1:0,a?1:0,c||0,p||0),h.emplaceBack(n?1:0,a?1:0,c||0,p||0),h.emplaceBack(n?1:0,a?1:0,c||0,p||0)}const D=Math.pow(2,25),$=Math.pow(2,24),j=Math.pow(2,17),Q=Math.pow(2,16),ue=Math.pow(2,9),oe=Math.pow(2,8),ee=Math.pow(2,1);function ce(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;const n=h.placed?1:0,a=Math.floor(127*h.opacity);return a*D+n*$+a*j+n*Q+a*ue+n*oe+a*ee+n}const Ie=0;class Ue{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,a,c,p,g){const b=this._bucketParts;for(;this._currentTileIndex<n.length;)if(a.getBucketParts(b,p,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,b.sort((E,k)=>E.sortKey-k.sortKey));this._currentPartIndex<b.length;)if(a.placeLayerBucketPart(b[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,g())return!0;return!1}}class ke{constructor(n,a,c,p,g,b,E,k){this.placement=new q(n,a,b,E,k),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(n,a,c){const p=u.exported.now(),g=()=>{const b=u.exported.now()-p;return!this._forceFullPlacement&&b>2};for(;this._currentPlacementIndex>=0;){const b=a[n[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(b.type==="symbol"&&(!b.minzoom||b.minzoom<=E)&&(!b.maxzoom||b.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new Ue(b)),this._inProgressLayer.continuePlacement(c[b.source],this.placement,this._showCollisionBoxes,b,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const gt=512/u.EXTENT/2;class _t{constructor(n,a,c){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=c;for(let p=0;p<a.length;p++){const g=a.get(p),b=g.key;this.indexedSymbolInstances[b]||(this.indexedSymbolInstances[b]=[]),this.indexedSymbolInstances[b].push({crossTileID:g.crossTileID,coord:this.getScaledCoordinates(g,n)})}}getScaledCoordinates(n,a){const c=gt/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*u.EXTENT+n.anchorX)*c),y:Math.floor((a.canonical.y*u.EXTENT+n.anchorY)*c)}}findMatches(n,a,c){const p=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let g=0;g<n.length;g++){const b=n.get(g);if(b.crossTileID)continue;const E=this.indexedSymbolInstances[b.key];if(!E)continue;const k=this.getScaledCoordinates(b,a);for(const P of E)if(Math.abs(P.coord.x-k.x)<=p&&Math.abs(P.coord.y-k.y)<=p&&!c[P.crossTileID]){c[P.crossTileID]=!0,b.crossTileID=P.crossTileID;break}}}}class We{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class At{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const a=Math.round((n-this.lng)/360);if(a!==0)for(const c in this.indexes){const p=this.indexes[c],g={};for(const b in p){const E=p[b];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+a),g[E.tileID.key]=E}this.indexes[c]=g}this.lng=n}addBucket(n,a,c){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let g=0;g<a.symbolInstances.length;g++)a.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const p=this.usedCrossTileIDs[n.overscaledZ];for(const g in this.indexes){const b=this.indexes[g];if(Number(g)>n.overscaledZ)for(const E in b){const k=b[E];k.tileID.isChildOf(n)&&k.findMatches(a.symbolInstances,n,p)}else{const E=b[n.scaledTo(Number(g)).key];E&&E.findMatches(a.symbolInstances,n,p)}}for(let g=0;g<a.symbolInstances.length;g++){const b=a.symbolInstances.get(g);b.crossTileID||(b.crossTileID=c.generate(),p[b.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new _t(n,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(n,a){for(const c in a.indexedSymbolInstances)for(const p of a.indexedSymbolInstances[c])delete this.usedCrossTileIDs[n][p.crossTileID]}removeStaleBuckets(n){let a=!1;for(const c in this.indexes){const p=this.indexes[c];for(const g in p)n[p[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,p[g]),delete p[g],a=!0)}return a}}class Dt{constructor(){this.layerIndexes={},this.crossTileIDs=new We,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,a,c){let p=this.layerIndexes[n.id];p===void 0&&(p=this.layerIndexes[n.id]=new At);let g=!1;const b={};p.handleWrapJump(c);for(const E of a){const k=E.getBucket(n);k&&n.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(E.tileID,k,this.crossTileIDs)&&(g=!0),b[k.bucketInstanceId]=!0)}return p.removeStaleBuckets(b)&&(g=!0),g}pruneUnusedLayers(n){const a={};n.forEach(c=>{a[c]=!0});for(const c in this.layerIndexes)a[c]||delete this.layerIndexes[c]}}var Qt=u.createLayout([{name:"a_pos",type:"Int16",components:2}]);class Ft extends u.Evented{constructor(n){super(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=n._cache.max,n.usedForTerrain=!0,n.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const n in this._tiles){const a=this._tiles[n];a.textures.forEach(c=>c.destroy()),a.textures=[]}}update(n,a){this.sourceCache.update(n,a),this._renderableTilesKeys=[];for(const c of n.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a}))this._renderableTilesKeys.push(c.key),this._tiles[c.key]||(c.posMatrix=new Float64Array(16),u.ortho(c.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),this._tiles[c.key]=new Cr(c,this.tileSize))}removeOutdated(n){const a={};this.renderHistory=this.renderHistory.filter((c,p)=>this.renderHistory.indexOf(c)===p).slice(0,this.renderHistorySize);for(const c of this._renderableTilesKeys)a[c]=!0;for(const c of this.renderHistory)a[c]=!0;for(const c in this._tiles)a[c]||(this._tiles[c].clearTextures(n),delete this._tiles[c])}getRenderableTiles(){return this._renderableTilesKeys.map(n=>this.getTileByID(n))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n){const a={};for(const c of this._renderableTilesKeys){const p=this._tiles[c].tileID;if(p.canonical.equals(n.canonical)){const g=n.clone();g.posMatrix=new Float64Array(16),u.ortho(g.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),a[c]=g}else if(p.canonical.isChildOf(n.canonical)){const g=n.clone();g.posMatrix=new Float64Array(16);const b=p.canonical.z-n.canonical.z,E=p.canonical.x-(p.canonical.x>>b<<b),k=p.canonical.y-(p.canonical.y>>b<<b),P=u.EXTENT>>b;u.ortho(g.posMatrix,0,P,0,P,0,1),u.translate(g.posMatrix,g.posMatrix,[-E*P,-k*P,0]),a[c]=g}else if(n.canonical.isChildOf(p.canonical)){const g=n.clone();g.posMatrix=new Float64Array(16);const b=n.canonical.z-p.canonical.z,E=n.canonical.x-(n.canonical.x>>b<<b),k=n.canonical.y-(n.canonical.y>>b<<b),P=u.EXTENT>>b;u.ortho(g.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),u.translate(g.posMatrix,g.posMatrix,[E*P,k*P,0]),u.scale(g.posMatrix,g.posMatrix,[1/2**b,1/2**b,0]),a[c]=g}}return a}getSourceTile(n,a){const c=this.sourceCache._source;let p=n.overscaledZ-this.deltaZoom;if(p>c.maxzoom&&(p=c.maxzoom),p<c.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(p).key);let g=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!g||!g.dem)&&a)for(;p>=c.minzoom&&(!g||!g.dem);)g=this.sourceCache.getTileByID(n.scaledTo(p--).key);return g}tilesAfterTime(n=Date.now()){return Object.values(this._tiles).filter(a=>a.timeLoaded>=n)}}class qt{constructor(n,a,c){this.style=n,this.sourceCache=new Ft(a),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.elevationOffset=typeof c.elevationOffset=="number"?c.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(n,a,c,p=u.EXTENT){if(!(a>=0&&a<p&&c>=0&&c<p))return this.elevationOffset;let g=0;const b=this.getTerrainData(n);if(b.tile&&b.tile.dem){const E=u.transformMat4$1([],[a/p*u.EXTENT,c/p*u.EXTENT],b.u_terrain_matrix),k=[E[0]*b.tile.dem.dim,E[1]*b.tile.dem.dim],P=[Math.floor(k[0]),Math.floor(k[1])],z=b.tile.dem.get(P[0],P[1]),R=b.tile.dem.get(P[0],P[1]+1),N=b.tile.dem.get(P[0]+1,P[1]),X=b.tile.dem.get(P[0]+1,P[1]+1);g=u.number(u.number(z,R,k[0]-P[0]),u.number(N,X,k[0]-P[0]),k[1]-P[1])}return g}rememberForRerender(n,a){for(const c in this.sourceCache._tiles){const p=this.sourceCache._tiles[c];(p.tileID.equals(a)||p.tileID.isChildOf(a))&&(n===this.sourceCache.sourceCache.id&&(p.timeLoaded=Date.now()),this._rerender[n]=this._rerender[n]||{},this._rerender[n][p.tileID.key]=!0)}}needsRerender(n,a){return this._rerender[n]&&this._rerender[n][a.key]}clearRerenderCache(){this._rerender={}}getElevation(n,a,c,p=u.EXTENT){return(this.getDEMElevation(n,a,c,p)+this.elevationOffset)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const p=this.style.map.painter.context,g=new u.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Ce(p,g,p.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Ce(p,new u.RGBAImage({width:1,height:1}),p.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.identity([])}const a=this.sourceCache.getSourceTile(n,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const p=this.style.map.painter.context;a.demTexture=this.style.map.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new Ce(p,a.dem.getPixels(),p.gl.RGBA,{premultiply:!1}),a.demTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const c=a&&a+a.tileID.key+n.key;if(c&&!this._demMatrixCache[c]){const p=this.sourceCache.sourceCache._source.maxzoom;let g=n.canonical.z-a.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=p?g=n.canonical.z-p:u.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const b=n.canonical.x-(n.canonical.x>>g<<g),E=n.canonical.y-(n.canonical.y>>g<<g),k=u.fromScaling(new Float64Array(16),[1/(u.EXTENT<<g),1/(u.EXTENT<<g),0]);u.translate(k,k,[b*u.EXTENT,E*u.EXTENT,0]),this._demMatrixCache[n.key]={matrix:k,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getRTTFramebuffer(){const n=this.style.map.painter;if(!this._rttFramebuffer){const a=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=n.context.createFramebuffer(a,a,!0),this._rttFramebuffer.depthAttachment.set(n.context.createRenderbuffer(n.context.gl.DEPTH_COMPONENT16,a,a))}return this._rttFramebuffer}getFramebuffer(n){const a=this.style.map.painter,c=a.width/devicePixelRatio,p=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===p||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Ce(a.context,{width:c,height:p,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Ce(a.context,{width:c,height:p,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(c,p,!0),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,c,p))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,b=0;g<this._coordsTextureSize;g++)for(let E=0;E<this._coordsTextureSize;E++,b+=4)a[b+0]=255&E,a[b+1]=255&g,a[b+2]=E>>8<<4|g>>8,a[b+3]=0;const c=new u.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),p=new Ce(n,c,n.gl.RGBA,{premultiply:!1});return p.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=p,p}pointCoordinate(n){const a=new Uint8Array(4),c=this.style.map.painter,p=c.context,g=p.gl;p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(n.x,c.height/devicePixelRatio-n.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,a),p.bindFramebuffer.set(null);const b=a[0]+(a[2]>>4<<8),E=a[1]+((15&a[2])<<8),k=this.coordsIndex[255-a[3]],P=k&&this.sourceCache.getTileByID(k);if(!P)return null;const z=this._coordsTextureSize,R=(1<<P.tileID.canonical.z)*z;return new u.MercatorCoordinate((P.tileID.canonical.x*z+b)/R,(P.tileID.canonical.y*z+E)/R,this.getElevation(P.tileID,b,E,z))}getTerrainMesh(){if(this._mesh)return this._mesh;const n=this.style.map.painter.context,a=new u.PosArray,c=new u.TriangleIndexArray,p=this.meshSize,g=u.EXTENT/p,b=p*p;for(let E=0;E<=p;E++)for(let k=0;k<=p;k++)a.emplaceBack(k*g,E*g);for(let E=0;E<b;E+=p+1)for(let k=0;k<p;k++)c.emplaceBack(k+E,p+k+E+1,p+k+E+2),c.emplaceBack(k+E,p+k+E+2,k+E+1);return this._mesh={indexBuffer:n.createIndexBuffer(c),vertexBuffer:n.createVertexBuffer(a,Qt.members),segments:u.SegmentVector.simpleSegment(0,0,a.length,c.length)},this._mesh}getMinMaxElevation(n){const a=this.getTerrainData(n).tile,c={minElevation:null,maxElevation:null};return a&&a.dem&&(c.minElevation=(a.dem.min+this.elevationOffset)*this.exaggeration,c.maxElevation=(a.dem.max+this.elevationOffset)*this.exaggeration),c}}const nn=(h,n)=>u.emitValidationErrors(h,n&&n.filter(a=>a.identifier!=="source.canvas")),Nt=u.pick(rn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),cr=u.pick(rn,["setCenter","setZoom","setBearing","setPitch"]),Dn=function(){const h={},n=u.spec.$version;for(const a in u.spec.$root){const c=u.spec.$root[a];if(c.required){let p=null;p=a==="version"?n:c.type==="array"?[]:{},p!=null&&(h[a]=p)}}return h}();class $n extends u.Evented{constructor(n,a={}){super(),this.map=n,this.dispatcher=new xt(hi(),this),this.imageManager=new re,this.imageManager.setEventedParent(this),this.glyphManager=new ze(n._requestManager,a.localIdeographFontFamily),this.lineAtlas=new Ut(256,512),this.crossTileSymbolIndex=new Dt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",u.getReferrer());const c=this;this._rtlTextPluginCallback=$n.registerForPluginStateChange(p=>{c.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:p.pluginStatus,pluginURL:p.pluginURL},(g,b)=>{if(u.triggerPluginCompletionEvent(g),b&&b.every(E=>E))for(const E in c.sourceCaches)c.sourceCaches[E].reload()})}),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const g=this.sourceCaches[p.sourceId];if(!g)return;const b=g.getSource();if(b&&b.vectorLayerIds)for(const E in this._layers){const k=this._layers[E];k.source===b.id&&this._validateLayer(k)}})}loadURL(n,a={}){this.fire(new u.Event("dataloading",{dataType:"style"}));const c=typeof a.validate!="boolean"||a.validate,p=this.map._requestManager.transformRequest(n,u.ResourceType.Style);this._request=u.getJSON(p,(g,b)=>{this._request=null,g?this.fire(new u.ErrorEvent(g)):b&&this._load(b,c)})}loadJSON(n,a={}){this.fire(new u.Event("dataloading",{dataType:"style"})),this._request=u.exported.frame(()=>{this._request=null,this._load(n,a.validate!==!1)})}loadEmpty(){this.fire(new u.Event("dataloading",{dataType:"style"})),this._load(Dn,!1)}_load(n,a){if(a&&nn(this,u.validateStyle(n)))return;this._loaded=!0,this.stylesheet=n;for(const p in n.sources)this.addSource(p,n.sources[p],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);const c=Ca(this.stylesheet.layers);this._order=c.map(p=>p.id),this._layers={},this._serializedLayers={};for(let p of c)p=u.createStyleLayer(p),p.setEventedParent(this,{layer:{id:p.id}}),this._layers[p.id]=p,this._serializedLayers[p.id]=p.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Xe(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new u.Event("data",{dataType:"style"})),this.fire(new u.Event("style.load"))}_loadSprite(n){this._spriteRequest=function(a,c,p,g){let b,E,k;const P=p>1?"@2x":"";let z=u.getJSON(c.transformRequest(c.normalizeSpriteURL(a,P,".json"),u.ResourceType.SpriteJSON),(X,Z)=>{z=null,k||(k=X,b=Z,N())}),R=u.getImage(c.transformRequest(c.normalizeSpriteURL(a,P,".png"),u.ResourceType.SpriteImage),(X,Z)=>{R=null,k||(k=X,E=Z,N())});function N(){if(k)g(k);else if(b&&E){const X=u.exported.getImageData(E),Z={};for(const H in b){const{width:le,height:de,x:ye,y:Y,sdf:Se,pixelRatio:ve,stretchX:De,stretchY:Re,content:$e}=b[H],Pe=new u.RGBAImage({width:le,height:de});u.RGBAImage.copy(X,Pe,{x:ye,y:Y},{x:0,y:0},{width:le,height:de}),Z[H]={data:Pe,pixelRatio:ve,sdf:Se,stretchX:De,stretchY:Re,content:$e}}g(null,Z)}}return{cancel(){z&&(z.cancel(),z=null),R&&(R.cancel(),R=null)}}}(n,this.map._requestManager,this.map.getPixelRatio(),(a,c)=>{if(this._spriteRequest=null,a)this.fire(new u.ErrorEvent(a));else if(c)for(const p in c)this.imageManager.addImage(p,c[p]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))})}_validateLayer(n){const a=this.sourceCaches[n.source];if(!a)return;const c=n.sourceLayer;if(!c)return;const p=a.getSource();(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(c)===-1)&&this.fire(new u.ErrorEvent(new Error(`Source layer "${c}" does not exist on source "${p.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(n){const a=[];for(const c of n){const p=this._layers[c];p.type!=="custom"&&a.push(p.serialize())}return a}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const a=this._changed;if(this._changed){const p=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(p.length||g.length)&&this._updateWorkerLayers(p,g);for(const b in this._updatedSources){const E=this._updatedSources[b];if(E==="reload")this._reloadSource(b);else{if(E!=="clear")throw new Error(`Invalid action ${E}`);this._clearSource(b)}}this._updateTilesForChangedImages();for(const b in this._updatedPaintProps)this._layers[b].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}const c={};for(const p in this.sourceCaches){const g=this.sourceCaches[p];c[p]=g.used,g.used=!1}for(const p of this._order){const g=this._layers[p];g.recalculate(n,this._availableImages),!g.isHidden(n.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}for(const p in c){const g=this.sourceCaches[p];c[p]!==g.used&&g.fire(new u.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:p}))}this.light.recalculate(n),this.z=n.zoom,a&&this.fire(new u.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateWorkerLayers(n,a){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(n){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),n){const a=this.sourceCaches[n.source];if(!a)throw new Error(`cannot load terrain, because there exists no source with ID: ${n.source}`);this.terrain=new qt(this,a,n),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=c=>{c.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=c=>{c.tile&&(c.sourceId===n.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(c.sourceId,c.tile.tileID)):c.source.type==="geojson"&&this.terrain.rememberForRerender(c.sourceId,c.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new u.Event("terrain",{terrain:n}))}setState(n){if(this._checkLoaded(),nn(this,u.validateStyle(n)))return!1;(n=u.clone$1(n)).layers=Ca(n.layers);const a=function(p,g){if(!p)return[{command:rn.setStyle,args:[g]}];let b=[];try{if(!ne(p.version,g.version))return[{command:rn.setStyle,args:[g]}];ne(p.center,g.center)||b.push({command:rn.setCenter,args:[g.center]}),ne(p.zoom,g.zoom)||b.push({command:rn.setZoom,args:[g.zoom]}),ne(p.bearing,g.bearing)||b.push({command:rn.setBearing,args:[g.bearing]}),ne(p.pitch,g.pitch)||b.push({command:rn.setPitch,args:[g.pitch]}),ne(p.sprite,g.sprite)||b.push({command:rn.setSprite,args:[g.sprite]}),ne(p.glyphs,g.glyphs)||b.push({command:rn.setGlyphs,args:[g.glyphs]}),ne(p.transition,g.transition)||b.push({command:rn.setTransition,args:[g.transition]}),ne(p.light,g.light)||b.push({command:rn.setLight,args:[g.light]});const E={},k=[];(function(z,R,N,X){let Z;for(Z in R=R||{},z=z||{})Object.prototype.hasOwnProperty.call(z,Z)&&(Object.prototype.hasOwnProperty.call(R,Z)||Uo(Z,N,X));for(Z in R)Object.prototype.hasOwnProperty.call(R,Z)&&(Object.prototype.hasOwnProperty.call(z,Z)?ne(z[Z],R[Z])||(z[Z].type==="geojson"&&R[Z].type==="geojson"&&Ia(z,R,Z)?N.push({command:rn.setGeoJSONSourceData,args:[Z,R[Z].data]}):Ti(Z,R,N,X)):nr(Z,R,N))})(p.sources,g.sources,k,E);const P=[];p.layers&&p.layers.forEach(z=>{E[z.source]?b.push({command:rn.removeLayer,args:[z.id]}):P.push(z)}),b=b.concat(k),function(z,R,N){R=R||[];const X=(z=z||[]).map(Ki),Z=R.map(Ki),H=z.reduce(aa,{}),le=R.reduce(aa,{}),de=X.slice(),ye=Object.create(null);let Y,Se,ve,De,Re,$e,Pe;for(Y=0,Se=0;Y<X.length;Y++)ve=X[Y],Object.prototype.hasOwnProperty.call(le,ve)?Se++:(N.push({command:rn.removeLayer,args:[ve]}),de.splice(de.indexOf(ve,Se),1));for(Y=0,Se=0;Y<Z.length;Y++)ve=Z[Z.length-1-Y],de[de.length-1-Y]!==ve&&(Object.prototype.hasOwnProperty.call(H,ve)?(N.push({command:rn.removeLayer,args:[ve]}),de.splice(de.lastIndexOf(ve,de.length-Se),1)):Se++,$e=de[de.length-Y],N.push({command:rn.addLayer,args:[le[ve],$e]}),de.splice(de.length-Y,0,ve),ye[ve]=!0);for(Y=0;Y<Z.length;Y++)if(ve=Z[Y],De=H[ve],Re=le[ve],!ye[ve]&&!ne(De,Re))if(ne(De.source,Re.source)&&ne(De["source-layer"],Re["source-layer"])&&ne(De.type,Re.type)){for(Pe in Bi(De.layout,Re.layout,N,ve,null,rn.setLayoutProperty),Bi(De.paint,Re.paint,N,ve,null,rn.setPaintProperty),ne(De.filter,Re.filter)||N.push({command:rn.setFilter,args:[ve,Re.filter]}),ne(De.minzoom,Re.minzoom)&&ne(De.maxzoom,Re.maxzoom)||N.push({command:rn.setLayerZoomRange,args:[ve,Re.minzoom,Re.maxzoom]}),De)Object.prototype.hasOwnProperty.call(De,Pe)&&Pe!=="layout"&&Pe!=="paint"&&Pe!=="filter"&&Pe!=="metadata"&&Pe!=="minzoom"&&Pe!=="maxzoom"&&(Pe.indexOf("paint.")===0?Bi(De[Pe],Re[Pe],N,ve,Pe.slice(6),rn.setPaintProperty):ne(De[Pe],Re[Pe])||N.push({command:rn.setLayerProperty,args:[ve,Pe,Re[Pe]]}));for(Pe in Re)Object.prototype.hasOwnProperty.call(Re,Pe)&&!Object.prototype.hasOwnProperty.call(De,Pe)&&Pe!=="layout"&&Pe!=="paint"&&Pe!=="filter"&&Pe!=="metadata"&&Pe!=="minzoom"&&Pe!=="maxzoom"&&(Pe.indexOf("paint.")===0?Bi(De[Pe],Re[Pe],N,ve,Pe.slice(6),rn.setPaintProperty):ne(De[Pe],Re[Pe])||N.push({command:rn.setLayerProperty,args:[ve,Pe,Re[Pe]]}))}else N.push({command:rn.removeLayer,args:[ve]}),$e=de[de.lastIndexOf(ve)+1],N.push({command:rn.addLayer,args:[Re,$e]})}(P,g.layers,b)}catch(E){console.warn("Unable to compute style diff:",E),b=[{command:rn.setStyle,args:[g]}]}return b}(this.serialize(),n).filter(p=>!(p.command in cr));if(a.length===0)return!1;const c=a.filter(p=>!(p.command in Nt));if(c.length>0)throw new Error(`Unimplemented: ${c.map(p=>p.command).join(", ")}.`);return a.forEach(p=>{p.command!=="setTransition"&&this[p.command].apply(this,p.args)}),this.stylesheet=n,!0}addImage(n,a){if(this.getImage(n))return this.fire(new u.ErrorEvent(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,a),this._afterImageUpdated(n)}updateImage(n,a){this.imageManager.updateImage(n,a)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new u.ErrorEvent(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,a,c={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(u.validateStyle.source,`sources.${n}`,a,null,c))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const p=this.sourceCaches[n]=new Jr(n,a,this.dispatcher);p.style=this,p.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:p.serialize(),sourceId:n})),p.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===n)return this.fire(new u.ErrorEvent(new Error(`Source "${n}" cannot be removed while layer "${c}" is using it.`)));const a=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],a.fire(new u.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,a){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const c=this.sourceCaches[n].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(a),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,a,c={}){this._checkLoaded();const p=n.id;if(this.getLayer(p))return void this.fire(new u.ErrorEvent(new Error(`Layer "${p}" already exists on this map.`)));let g;if(n.type==="custom"){if(nn(this,u.validateCustomStyleLayer(n)))return;g=u.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(p,n.source),n=u.clone$1(n),n=u.extend(n,{source:p})),this._validate(u.validateStyle.layer,`layers.${p}`,n,{arrayIndex:-1},c))return;g=u.createStyleLayer(n),this._validateLayer(g),g.setEventedParent(this,{layer:{id:p}}),this._serializedLayers[g.id]=g.serialize()}const b=a?this._order.indexOf(a):this._order.length;if(a&&b===-1)this.fire(new u.ErrorEvent(new Error(`Cannot add layer "${p}" before non-existing layer "${a}".`)));else{if(this._order.splice(b,0,p),this._layerOrderChanged=!0,this._layers[p]=g,this._removedLayers[p]&&g.source&&g.type!=="custom"){const E=this._removedLayers[p];delete this._removedLayers[p],E.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(n,a){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new u.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===a)return;const c=this._order.indexOf(n);this._order.splice(c,1);const p=a?this._order.indexOf(a):this._order.length;a&&p===-1?this.fire(new u.ErrorEvent(new Error(`Cannot move layer "${n}" before non-existing layer "${a}".`))):(this._order.splice(p,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const a=this._layers[n];if(!a)return void this.fire(new u.ErrorEvent(new Error(`Cannot remove non-existing layer "${n}".`)));a.setEventedParent(null);const c=this._order.indexOf(n);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=a,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],a.onRemove&&a.onRemove(this.map)}getLayer(n){return this._layers[n]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,a,c){this._checkLoaded();const p=this.getLayer(n);p?p.minzoom===a&&p.maxzoom===c||(a!=null&&(p.minzoom=a),c!=null&&(p.maxzoom=c),this._updateLayer(p)):this.fire(new u.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,a,c={}){this._checkLoaded();const p=this.getLayer(n);if(p){if(!ne(p.filter,a))return a==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(u.validateStyle.filter,`layers.${p.id}.filter`,a,null,c)||(p.filter=u.clone$1(a),this._updateLayer(p)))}else this.fire(new u.ErrorEvent(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return u.clone$1(this.getLayer(n).filter)}setLayoutProperty(n,a,c,p={}){this._checkLoaded();const g=this.getLayer(n);g?ne(g.getLayoutProperty(a),c)||(g.setLayoutProperty(a,c,p),this._updateLayer(g)):this.fire(new u.ErrorEvent(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,a){const c=this.getLayer(n);if(c)return c.getLayoutProperty(a);this.fire(new u.ErrorEvent(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,a,c,p={}){this._checkLoaded();const g=this.getLayer(n);g?ne(g.getPaintProperty(a),c)||(g.setPaintProperty(a,c,p)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new u.ErrorEvent(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,a){return this.getLayer(n).getPaintProperty(a)}setFeatureState(n,a){this._checkLoaded();const c=n.source,p=n.sourceLayer,g=this.sourceCaches[c];if(g===void 0)return void this.fire(new u.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)));const b=g.getSource().type;b==="geojson"&&p?this.fire(new u.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):b!=="vector"||p?(n.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),g.setFeatureState(p,n.id,a)):this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,a){this._checkLoaded();const c=n.source,p=this.sourceCaches[c];if(p===void 0)return void this.fire(new u.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)));const g=p.getSource().type,b=g==="vector"?n.sourceLayer:void 0;g!=="vector"||b?a&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new u.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):p.removeFeatureState(b,n.id,a):this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const a=n.source,c=n.sourceLayer,p=this.sourceCaches[a];if(p!==void 0)return p.getSource().type!=="vector"||c?(n.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),p.getFeatureState(c,n.id)):void this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.ErrorEvent(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return u.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return u.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:u.mapObject(this.sourceCaches,n=>n.serialize()),layers:this._serializeLayers(this._order)},n=>n!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(n){const a=b=>this._layers[b].type==="fill-extrusion",c={},p=[];for(let b=this._order.length-1;b>=0;b--){const E=this._order[b];if(a(E)){c[E]=b;for(const k of n){const P=k[E];if(P)for(const z of P)p.push(z)}}}p.sort((b,E)=>E.intersectionZ-b.intersectionZ);const g=[];for(let b=this._order.length-1;b>=0;b--){const E=this._order[b];if(a(E))for(let k=p.length-1;k>=0;k--){const P=p[k].feature;if(c[P.layer.id]<b)break;g.push(P),p.pop()}else for(const k of n){const P=k[E];if(P)for(const z of P)g.push(z.feature)}}return g}queryRenderedFeatures(n,a,c){a&&a.filter&&this._validate(u.validateStyle.filter,"queryRenderedFeatures.filter",a.filter,null,a);const p={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new u.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const b of a.layers){const E=this._layers[b];if(!E)return this.fire(new u.ErrorEvent(new Error(`The layer '${b}' does not exist in the map's style and cannot be queried for features.`))),[];p[E.source]=!0}}const g=[];a.availableImages=this._availableImages;for(const b in this.sourceCaches)a.layers&&!p[b]||g.push(Yr(this.sourceCaches[b],this._layers,this._serializedLayers,n,a,c));return this.placement&&g.push(function(b,E,k,P,z,R,N){const X={},Z=R.queryRenderedSymbols(P),H=[];for(const le of Object.keys(Z).map(Number))H.push(N[le]);H.sort(Kr);for(const le of H){const de=le.featureIndex.lookupSymbolFeatures(Z[le.bucketInstanceId],E,le.bucketIndex,le.sourceLayerIndex,z.filter,z.layers,z.availableImages,b);for(const ye in de){const Y=X[ye]=X[ye]||[],Se=de[ye];Se.sort((ve,De)=>{const Re=le.featureSortOrder;if(Re){const $e=Re.indexOf(ve.featureIndex);return Re.indexOf(De.featureIndex)-$e}return De.featureIndex-ve.featureIndex});for(const ve of Se)Y.push(ve)}}for(const le in X)X[le].forEach(de=>{const ye=de.feature,Y=k[b[le].source].getFeatureState(ye.layer["source-layer"],ye.id);ye.source=ye.layer.source,ye.layer["source-layer"]&&(ye.sourceLayer=ye.layer["source-layer"]),ye.state=Y});return X}(this._layers,this._serializedLayers,this.sourceCaches,n,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(n,a){a&&a.filter&&this._validate(u.validateStyle.filter,"querySourceFeatures.filter",a.filter,null,a);const c=this.sourceCaches[n];return c?function(p,g){const b=p.getRenderableIds().map(P=>p.getTileByID(P)),E=[],k={};for(let P=0;P<b.length;P++){const z=b[P],R=z.tileID.canonical.key;k[R]||(k[R]=!0,z.querySourceFeatures(E,g))}return E}(c,a):[]}addSourceType(n,a,c){return $n.getSourceType(n)?c(new Error(`A source type called "${n}" already exists.`)):($n.setSourceType(n,a),a.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:a.workerSourceURL},c):c(null,null))}getLight(){return this.light.getLight()}setLight(n,a={}){this._checkLoaded();const c=this.light.getLight();let p=!1;for(const b in n)if(!ne(n[b],c[b])){p=!0;break}if(!p)return;const g={now:u.exported.now(),transition:u.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,a),this.light.updateTransitions(g)}_validate(n,a,c,p,g={}){return(!g||g.validate!==!1)&&nn(this,n.call(u.validateStyle,u.extend({key:a,style:this.serialize(),value:c,styleSpec:u.spec},p)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),u.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this.sourceCaches){const a=this.sourceCaches[n];a.setEventedParent(null),a.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const a in this.sourceCaches)this.sourceCaches[a].update(n,this.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,a,c,p,g=!1){let b=!1,E=!1;const k={};for(const P of this._order){const z=this._layers[P];if(z.type!=="symbol")continue;if(!k[z.source]){const N=this.sourceCaches[z.source];k[z.source]=N.getRenderableIds(!0).map(X=>N.getTileByID(X)).sort((X,Z)=>Z.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(Z.tileID)?-1:1))}const R=this.crossTileSymbolIndex.addLayer(z,k[z.source],n.center.lng);b=b||R}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(u.exported.now(),n.zoom))&&(this.pauseablePlacement=new ke(n,this.terrain,this._order,g,a,c,p,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(u.exported.now()),E=!0),b&&this.pauseablePlacement.placement.setStale()),E||b)for(const P of this._order){const z=this._layers[P];z.type==="symbol"&&this.placement.updateLayerOpacities(z,k[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(u.exported.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,a,c){this.imageManager.getImages(a.icons,c),this._updateTilesForChangedImages();const p=this.sourceCaches[a.source];p&&p.setDependencies(a.tileID.key,a.type,a.icons)}getGlyphs(n,a,c){this.glyphManager.getGlyphs(a.stacks,c)}getResource(n,a,c){return u.makeRequest(a,c)}}$n.getSourceType=function(h){return Ln[h]},$n.setSourceType=function(h,n){Ln[h]=n},$n.registerForPluginStateChange=u.registerForPluginStateChange;var jr="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const sa={prelude:ln(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:ln(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:ln(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ln(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ln("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ln(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:ln(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ln("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ln("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ln("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:ln(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:ln(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:ln(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:ln(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ln(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ln(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ln(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ln(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:ln(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ln(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ln(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ln(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:ln(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:ln(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ln(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ln(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ln("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",jr),terrainDepth:ln("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",jr),terrainCoords:ln("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",jr)};function ln(h,n){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=n.match(/attribute ([\w]+) ([\w]+)/g),p=h.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=g?g.concat(p):p,E={};return{fragmentSource:h=h.replace(a,(k,P,z,R,N)=>(E[N]=!0,P==="define"?`
#ifndef HAS_UNIFORM_u_${N}
varying ${z} ${R} ${N};
#else
uniform ${z} ${R} u_${N};
#endif
`:`
#ifdef HAS_UNIFORM_u_${N}
    ${z} ${R} ${N} = u_${N};
#endif
`)),vertexSource:n=n.replace(a,(k,P,z,R,N)=>{const X=R==="float"?"vec2":"vec4",Z=N.match(/color/)?"color":X;return E[N]?P==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
attribute ${z} ${X} a_${N};
varying ${z} ${R} ${N};
#else
uniform ${z} ${R} u_${N};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = a_${N};
#else
    ${z} ${R} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = unpack_mix_${Z}(a_${N}, u_${N}_t);
#else
    ${z} ${R} ${N} = u_${N};
#endif
`:P==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
attribute ${z} ${X} a_${N};
#else
uniform ${z} ${R} u_${N};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${z} ${R} ${N} = a_${N};
#else
    ${z} ${R} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${z} ${R} ${N} = unpack_mix_${Z}(a_${N}, u_${N}_t);
#else
    ${z} ${R} ${N} = u_${N};
#endif
`}),staticAttributes:c,staticUniforms:b}}class xo{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,a,c,p,g,b,E,k,P){this.context=n;let z=this.boundPaintVertexBuffers.length!==p.length;for(let R=0;!z&&R<p.length;R++)this.boundPaintVertexBuffers[R]!==p[R]&&(z=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===c&&!z&&this.boundIndexBuffer===g&&this.boundVertexOffset===b&&this.boundDynamicVertexBuffer===E&&this.boundDynamicVertexBuffer2===k&&this.boundDynamicVertexBuffer3===P?(n.bindVertexArrayOES.set(this.vao),E&&E.bind(),g&&g.dynamicDraw&&g.bind(),k&&k.bind(),P&&P.bind()):this.freshBind(a,c,p,g,b,E,k,P)}freshBind(n,a,c,p,g,b,E,k){let P;const z=n.numAttributes,R=this.context,N=R.gl;if(R.extVertexArrayObject)this.vao&&this.destroy(),this.vao=R.extVertexArrayObject.createVertexArrayOES(),R.bindVertexArrayOES.set(this.vao),P=0,this.boundProgram=n,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=p,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=b,this.boundDynamicVertexBuffer2=E,this.boundDynamicVertexBuffer3=k;else{P=R.currentNumAttributes||0;for(let X=z;X<P;X++)N.disableVertexAttribArray(X)}a.enableAttributes(N,n);for(const X of c)X.enableAttributes(N,n);b&&b.enableAttributes(N,n),E&&E.enableAttributes(N,n),k&&k.enableAttributes(N,n),a.bind(),a.setVertexAttribPointers(N,n,g);for(const X of c)X.bind(),X.setVertexAttribPointers(N,n,g);b&&(b.bind(),b.setVertexAttribPointers(N,n,g)),p&&p.bind(),E&&(E.bind(),E.setVertexAttribPointers(N,n,g)),k&&(k.bind(),k.setVertexAttribPointers(N,n,g)),R.currentNumAttributes=z}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function zs(h){const n=[];for(let a=0;a<h.length;a++){if(h[a]===null)continue;const c=h[a].split(" ");n.push(c.pop())}return n}class yu{constructor(n,a,c,p,g,b,E){const k=n.gl;this.program=k.createProgram();const P=zs(c.staticAttributes),z=p?p.getBinderAttributes():[],R=P.concat(z),N=sa.prelude.staticUniforms?zs(sa.prelude.staticUniforms):[],X=c.staticUniforms?zs(c.staticUniforms):[],Z=p?p.getBinderUniforms():[],H=N.concat(X).concat(Z),le=[];for(const Re of H)le.indexOf(Re)<0&&le.push(Re);const de=p?p.defines():[];b&&de.push("#define OVERDRAW_INSPECTOR;"),E&&de.push("#define TERRAIN3D;");const ye=de.concat(sa.prelude.fragmentSource,c.fragmentSource).join(`
`),Y=de.concat(sa.prelude.vertexSource,c.vertexSource).join(`
`),Se=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(Se,ye),k.compileShader(Se),k.attachShader(this.program,Se);const ve=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(ve,Y),k.compileShader(ve),k.attachShader(this.program,ve),this.attributes={};const De={};this.numAttributes=R.length;for(let Re=0;Re<this.numAttributes;Re++)R[Re]&&(k.bindAttribLocation(this.program,Re,R[Re]),this.attributes[R[Re]]=Re);k.linkProgram(this.program),k.deleteShader(ve),k.deleteShader(Se);for(let Re=0;Re<le.length;Re++){const $e=le[Re];if($e&&!De[$e]){const Pe=k.getUniformLocation(this.program,$e);Pe&&(De[$e]=Pe)}}this.fixedUniforms=g(n,De),this.terrainUniforms=((Re,$e)=>({u_depth:new u.Uniform1i(Re,$e.u_depth),u_terrain:new u.Uniform1i(Re,$e.u_terrain),u_terrain_dim:new u.Uniform1f(Re,$e.u_terrain_dim),u_terrain_matrix:new u.UniformMatrix4f(Re,$e.u_terrain_matrix),u_terrain_unpack:new u.Uniform4f(Re,$e.u_terrain_unpack),u_terrain_offset:new u.Uniform1f(Re,$e.u_terrain_offset),u_terrain_exaggeration:new u.Uniform1f(Re,$e.u_terrain_exaggeration)}))(n,De),this.binderUniforms=p?p.getUniforms(n,De):[]}draw(n,a,c,p,g,b,E,k,P,z,R,N,X,Z,H,le,de,ye){const Y=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(c),n.setStencilMode(p),n.setColorMode(g),n.setCullFace(b),k){n.activeTexture.set(Y.TEXTURE2),Y.bindTexture(Y.TEXTURE_2D,k.depthTexture),n.activeTexture.set(Y.TEXTURE3),Y.bindTexture(Y.TEXTURE_2D,k.texture);for(const ve in this.terrainUniforms)this.terrainUniforms[ve].set(k[ve])}for(const ve in this.fixedUniforms)this.fixedUniforms[ve].set(E[ve]);H&&H.setUniforms(n,this.binderUniforms,X,{zoom:Z});let Se=0;switch(a){case Y.LINES:Se=2;break;case Y.TRIANGLES:Se=3;break;case Y.LINE_STRIP:Se=1}for(const ve of N.get()){const De=ve.vaos||(ve.vaos={});(De[P]||(De[P]=new xo)).bind(n,this,z,H?H.getPaintVertexBuffers():[],R,ve.vertexOffset,le,de,ye),Y.drawElements(a,ve.primitiveLength*Se,Y.UNSIGNED_SHORT,ve.primitiveOffset*Se*2)}}}function _u(h,n,a){const c=1/rr(a,1,n.transform.tileZoom),p=Math.pow(2,a.tileID.overscaledZ),g=a.tileSize*Math.pow(2,n.transform.tileZoom)/p,b=g*(a.tileID.canonical.x+a.tileID.wrap*p),E=g*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[c,h.fromScale,h.toScale],u_fade:h.t,u_pixel_coord_upper:[b>>16,E>>16],u_pixel_coord_lower:[65535&b,65535&E]}}const El=(h,n,a,c)=>{const p=n.style.light,g=p.properties.get("position"),b=[g.x,g.y,g.z],E=u.create$1();p.properties.get("anchor")==="viewport"&&u.fromRotation(E,-n.transform.angle),u.transformMat3(b,b,E);const k=p.properties.get("color");return{u_matrix:h,u_lightpos:b,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+a,u_opacity:c}},vu=(h,n,a,c,p,g,b)=>u.extend(El(h,n,a,c),_u(g,n,b),{u_height_factor:-Math.pow(2,p.overscaledZ)/b.tileSize/8}),Ls=h=>({u_matrix:h}),Tl=(h,n,a,c)=>u.extend(Ls(h),_u(a,n,c)),xu=(h,n)=>({u_matrix:h,u_world:n}),bu=(h,n,a,c,p)=>u.extend(Tl(h,n,a,c),{u_world:p}),kl=(h,n,a,c)=>{const p=h.transform;let g,b;if(c.paint.get("circle-pitch-alignment")==="map"){const E=rr(a,1,p.zoom);g=!0,b=[E,E]}else g=!1,b=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:h.translatePosMatrix(n.posMatrix,a,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+g,u_device_pixel_ratio:h.pixelRatio,u_extrude_scale:b}},x=(h,n,a)=>{const c=rr(a,1,n.zoom),p=Math.pow(2,n.zoom-a.tileID.overscaledZ),g=a.tileID.overscaleFactor();return{u_matrix:h,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[n.pixelsToGLUnits[0]/(c*p),n.pixelsToGLUnits[1]/(c*p)],u_overscale_factor:g}},C=(h,n,a=1)=>({u_matrix:h,u_color:n,u_overlay:0,u_overlay_scale:a}),B=h=>({u_matrix:h}),ae=(h,n,a,c)=>({u_matrix:h,u_extrude_scale:rr(n,1,a),u_intensity:c});function _e(h,n){const a=Math.pow(2,n.canonical.z),c=n.canonical.y;return[new u.MercatorCoordinate(0,c/a).toLngLat().lat,new u.MercatorCoordinate(0,(c+1)/a).toLngLat().lat]}const he=(h,n,a,c)=>{const p=h.transform;return{u_matrix:xe(h,n,a,c),u_ratio:1/rr(n,1,p.zoom),u_device_pixel_ratio:h.pixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},ge=(h,n,a,c,p)=>u.extend(he(h,n,a,p),{u_image:0,u_image_height:c}),je=(h,n,a,c,p)=>{const g=h.transform,b=Ge(n,g);return{u_matrix:xe(h,n,a,p),u_texsize:n.imageAtlasTexture.size,u_ratio:1/rr(n,1,g.zoom),u_device_pixel_ratio:h.pixelRatio,u_image:0,u_scale:[b,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Ve=(h,n,a,c,p,g)=>{const b=h.lineAtlas,E=Ge(n,h.transform),k=a.layout.get("line-cap")==="round",P=b.getDash(c.from,k),z=b.getDash(c.to,k),R=P.width*p.fromScale,N=z.width*p.toScale;return u.extend(he(h,n,a,g),{u_patternscale_a:[E/R,-P.height/2],u_patternscale_b:[E/N,-z.height/2],u_sdfgamma:b.width/(256*Math.min(R,N)*h.pixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:z.y,u_mix:p.t})};function Ge(h,n){return 1/rr(h,1,n.tileZoom)}function xe(h,n,a,c){return h.translatePosMatrix(c?c.posMatrix:n.tileID.posMatrix,n,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const et=(h,n,a,c,p)=>{return{u_matrix:h,u_tl_parent:n,u_scale_parent:a,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(b=p.paint.get("raster-saturation"),b>0?1-1/(1.001-b):-b),u_contrast_factor:(g=p.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:dt(p.paint.get("raster-hue-rotate"))};var g,b};function dt(h){h*=Math.PI/180;const n=Math.sin(h),a=Math.cos(h);return[(2*a+1)/3,(-Math.sqrt(3)*n-a+1)/3,(Math.sqrt(3)*n-a+1)/3]}const Tt=(h,n,a,c,p,g,b,E,k,P)=>{const z=p.transform;return{u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:z.cameraToCenterDistance,u_pitch:z.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:z.width/z.height,u_fade_change:p.options.fadeDuration?p.symbolFadeChange:1,u_matrix:g,u_label_plane_matrix:b,u_coord_matrix:E,u_is_text:+k,u_pitch_with_map:+c,u_texsize:P,u_texture:0}},Rt=(h,n,a,c,p,g,b,E,k,P,z)=>{const R=p.transform;return u.extend(Tt(h,n,a,c,p,g,b,E,k,P),{u_gamma_scale:c?Math.cos(R._pitch)*R.cameraToCenterDistance:1,u_device_pixel_ratio:p.pixelRatio,u_is_halo:+z})},Wn=(h,n,a,c,p,g,b,E,k,P)=>u.extend(Rt(h,n,a,c,p,g,b,E,!0,k,!0),{u_texsize_icon:P,u_texture_icon:1}),Ne=(h,n,a)=>({u_matrix:h,u_opacity:n,u_color:a}),yt=(h,n,a,c,p,g)=>u.extend(function(b,E,k,P){const z=k.imageManager.getPattern(b.from.toString()),R=k.imageManager.getPattern(b.to.toString()),{width:N,height:X}=k.imageManager.getPixelSize(),Z=Math.pow(2,P.tileID.overscaledZ),H=P.tileSize*Math.pow(2,k.transform.tileZoom)/Z,le=H*(P.tileID.canonical.x+P.tileID.wrap*Z),de=H*P.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:R.tl,u_pattern_br_b:R.br,u_texsize:[N,X],u_mix:E.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:R.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/rr(P,1,k.transform.tileZoom),u_pixel_coord_upper:[le>>16,de>>16],u_pixel_coord_lower:[65535&le,65535&de]}}(c,g,a,p),{u_matrix:h,u_opacity:n}),_n={fillExtrusion:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_lightpos:new u.Uniform3f(h,n.u_lightpos),u_lightintensity:new u.Uniform1f(h,n.u_lightintensity),u_lightcolor:new u.Uniform3f(h,n.u_lightcolor),u_vertical_gradient:new u.Uniform1f(h,n.u_vertical_gradient),u_opacity:new u.Uniform1f(h,n.u_opacity)}),fillExtrusionPattern:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_lightpos:new u.Uniform3f(h,n.u_lightpos),u_lightintensity:new u.Uniform1f(h,n.u_lightintensity),u_lightcolor:new u.Uniform3f(h,n.u_lightcolor),u_vertical_gradient:new u.Uniform1f(h,n.u_vertical_gradient),u_height_factor:new u.Uniform1f(h,n.u_height_factor),u_image:new u.Uniform1i(h,n.u_image),u_texsize:new u.Uniform2f(h,n.u_texsize),u_pixel_coord_upper:new u.Uniform2f(h,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,n.u_pixel_coord_lower),u_scale:new u.Uniform3f(h,n.u_scale),u_fade:new u.Uniform1f(h,n.u_fade),u_opacity:new u.Uniform1f(h,n.u_opacity)}),fill:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix)}),fillPattern:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_image:new u.Uniform1i(h,n.u_image),u_texsize:new u.Uniform2f(h,n.u_texsize),u_pixel_coord_upper:new u.Uniform2f(h,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,n.u_pixel_coord_lower),u_scale:new u.Uniform3f(h,n.u_scale),u_fade:new u.Uniform1f(h,n.u_fade)}),fillOutline:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_world:new u.Uniform2f(h,n.u_world)}),fillOutlinePattern:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_world:new u.Uniform2f(h,n.u_world),u_image:new u.Uniform1i(h,n.u_image),u_texsize:new u.Uniform2f(h,n.u_texsize),u_pixel_coord_upper:new u.Uniform2f(h,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,n.u_pixel_coord_lower),u_scale:new u.Uniform3f(h,n.u_scale),u_fade:new u.Uniform1f(h,n.u_fade)}),circle:(h,n)=>({u_camera_to_center_distance:new u.Uniform1f(h,n.u_camera_to_center_distance),u_scale_with_map:new u.Uniform1i(h,n.u_scale_with_map),u_pitch_with_map:new u.Uniform1i(h,n.u_pitch_with_map),u_extrude_scale:new u.Uniform2f(h,n.u_extrude_scale),u_device_pixel_ratio:new u.Uniform1f(h,n.u_device_pixel_ratio),u_matrix:new u.UniformMatrix4f(h,n.u_matrix)}),collisionBox:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_camera_to_center_distance:new u.Uniform1f(h,n.u_camera_to_center_distance),u_pixels_to_tile_units:new u.Uniform1f(h,n.u_pixels_to_tile_units),u_extrude_scale:new u.Uniform2f(h,n.u_extrude_scale),u_overscale_factor:new u.Uniform1f(h,n.u_overscale_factor)}),collisionCircle:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_inv_matrix:new u.UniformMatrix4f(h,n.u_inv_matrix),u_camera_to_center_distance:new u.Uniform1f(h,n.u_camera_to_center_distance),u_viewport_size:new u.Uniform2f(h,n.u_viewport_size)}),debug:(h,n)=>({u_color:new u.UniformColor(h,n.u_color),u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_overlay:new u.Uniform1i(h,n.u_overlay),u_overlay_scale:new u.Uniform1f(h,n.u_overlay_scale)}),clippingMask:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix)}),heatmap:(h,n)=>({u_extrude_scale:new u.Uniform1f(h,n.u_extrude_scale),u_intensity:new u.Uniform1f(h,n.u_intensity),u_matrix:new u.UniformMatrix4f(h,n.u_matrix)}),heatmapTexture:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_world:new u.Uniform2f(h,n.u_world),u_image:new u.Uniform1i(h,n.u_image),u_color_ramp:new u.Uniform1i(h,n.u_color_ramp),u_opacity:new u.Uniform1f(h,n.u_opacity)}),hillshade:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_image:new u.Uniform1i(h,n.u_image),u_latrange:new u.Uniform2f(h,n.u_latrange),u_light:new u.Uniform2f(h,n.u_light),u_shadow:new u.UniformColor(h,n.u_shadow),u_highlight:new u.UniformColor(h,n.u_highlight),u_accent:new u.UniformColor(h,n.u_accent)}),hillshadePrepare:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_image:new u.Uniform1i(h,n.u_image),u_dimension:new u.Uniform2f(h,n.u_dimension),u_zoom:new u.Uniform1f(h,n.u_zoom),u_unpack:new u.Uniform4f(h,n.u_unpack)}),line:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_ratio:new u.Uniform1f(h,n.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,n.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(h,n.u_units_to_pixels)}),lineGradient:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_ratio:new u.Uniform1f(h,n.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,n.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(h,n.u_units_to_pixels),u_image:new u.Uniform1i(h,n.u_image),u_image_height:new u.Uniform1f(h,n.u_image_height)}),linePattern:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_texsize:new u.Uniform2f(h,n.u_texsize),u_ratio:new u.Uniform1f(h,n.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,n.u_device_pixel_ratio),u_image:new u.Uniform1i(h,n.u_image),u_units_to_pixels:new u.Uniform2f(h,n.u_units_to_pixels),u_scale:new u.Uniform3f(h,n.u_scale),u_fade:new u.Uniform1f(h,n.u_fade)}),lineSDF:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_ratio:new u.Uniform1f(h,n.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,n.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(h,n.u_units_to_pixels),u_patternscale_a:new u.Uniform2f(h,n.u_patternscale_a),u_patternscale_b:new u.Uniform2f(h,n.u_patternscale_b),u_sdfgamma:new u.Uniform1f(h,n.u_sdfgamma),u_image:new u.Uniform1i(h,n.u_image),u_tex_y_a:new u.Uniform1f(h,n.u_tex_y_a),u_tex_y_b:new u.Uniform1f(h,n.u_tex_y_b),u_mix:new u.Uniform1f(h,n.u_mix)}),raster:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_tl_parent:new u.Uniform2f(h,n.u_tl_parent),u_scale_parent:new u.Uniform1f(h,n.u_scale_parent),u_buffer_scale:new u.Uniform1f(h,n.u_buffer_scale),u_fade_t:new u.Uniform1f(h,n.u_fade_t),u_opacity:new u.Uniform1f(h,n.u_opacity),u_image0:new u.Uniform1i(h,n.u_image0),u_image1:new u.Uniform1i(h,n.u_image1),u_brightness_low:new u.Uniform1f(h,n.u_brightness_low),u_brightness_high:new u.Uniform1f(h,n.u_brightness_high),u_saturation_factor:new u.Uniform1f(h,n.u_saturation_factor),u_contrast_factor:new u.Uniform1f(h,n.u_contrast_factor),u_spin_weights:new u.Uniform3f(h,n.u_spin_weights)}),symbolIcon:(h,n)=>({u_is_size_zoom_constant:new u.Uniform1i(h,n.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(h,n.u_is_size_feature_constant),u_size_t:new u.Uniform1f(h,n.u_size_t),u_size:new u.Uniform1f(h,n.u_size),u_camera_to_center_distance:new u.Uniform1f(h,n.u_camera_to_center_distance),u_pitch:new u.Uniform1f(h,n.u_pitch),u_rotate_symbol:new u.Uniform1i(h,n.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(h,n.u_aspect_ratio),u_fade_change:new u.Uniform1f(h,n.u_fade_change),u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(h,n.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(h,n.u_coord_matrix),u_is_text:new u.Uniform1i(h,n.u_is_text),u_pitch_with_map:new u.Uniform1i(h,n.u_pitch_with_map),u_texsize:new u.Uniform2f(h,n.u_texsize),u_texture:new u.Uniform1i(h,n.u_texture)}),symbolSDF:(h,n)=>({u_is_size_zoom_constant:new u.Uniform1i(h,n.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(h,n.u_is_size_feature_constant),u_size_t:new u.Uniform1f(h,n.u_size_t),u_size:new u.Uniform1f(h,n.u_size),u_camera_to_center_distance:new u.Uniform1f(h,n.u_camera_to_center_distance),u_pitch:new u.Uniform1f(h,n.u_pitch),u_rotate_symbol:new u.Uniform1i(h,n.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(h,n.u_aspect_ratio),u_fade_change:new u.Uniform1f(h,n.u_fade_change),u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(h,n.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(h,n.u_coord_matrix),u_is_text:new u.Uniform1i(h,n.u_is_text),u_pitch_with_map:new u.Uniform1i(h,n.u_pitch_with_map),u_texsize:new u.Uniform2f(h,n.u_texsize),u_texture:new u.Uniform1i(h,n.u_texture),u_gamma_scale:new u.Uniform1f(h,n.u_gamma_scale),u_device_pixel_ratio:new u.Uniform1f(h,n.u_device_pixel_ratio),u_is_halo:new u.Uniform1i(h,n.u_is_halo)}),symbolTextAndIcon:(h,n)=>({u_is_size_zoom_constant:new u.Uniform1i(h,n.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(h,n.u_is_size_feature_constant),u_size_t:new u.Uniform1f(h,n.u_size_t),u_size:new u.Uniform1f(h,n.u_size),u_camera_to_center_distance:new u.Uniform1f(h,n.u_camera_to_center_distance),u_pitch:new u.Uniform1f(h,n.u_pitch),u_rotate_symbol:new u.Uniform1i(h,n.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(h,n.u_aspect_ratio),u_fade_change:new u.Uniform1f(h,n.u_fade_change),u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(h,n.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(h,n.u_coord_matrix),u_is_text:new u.Uniform1i(h,n.u_is_text),u_pitch_with_map:new u.Uniform1i(h,n.u_pitch_with_map),u_texsize:new u.Uniform2f(h,n.u_texsize),u_texsize_icon:new u.Uniform2f(h,n.u_texsize_icon),u_texture:new u.Uniform1i(h,n.u_texture),u_texture_icon:new u.Uniform1i(h,n.u_texture_icon),u_gamma_scale:new u.Uniform1f(h,n.u_gamma_scale),u_device_pixel_ratio:new u.Uniform1f(h,n.u_device_pixel_ratio),u_is_halo:new u.Uniform1i(h,n.u_is_halo)}),background:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_opacity:new u.Uniform1f(h,n.u_opacity),u_color:new u.UniformColor(h,n.u_color)}),backgroundPattern:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_opacity:new u.Uniform1f(h,n.u_opacity),u_image:new u.Uniform1i(h,n.u_image),u_pattern_tl_a:new u.Uniform2f(h,n.u_pattern_tl_a),u_pattern_br_a:new u.Uniform2f(h,n.u_pattern_br_a),u_pattern_tl_b:new u.Uniform2f(h,n.u_pattern_tl_b),u_pattern_br_b:new u.Uniform2f(h,n.u_pattern_br_b),u_texsize:new u.Uniform2f(h,n.u_texsize),u_mix:new u.Uniform1f(h,n.u_mix),u_pattern_size_a:new u.Uniform2f(h,n.u_pattern_size_a),u_pattern_size_b:new u.Uniform2f(h,n.u_pattern_size_b),u_scale_a:new u.Uniform1f(h,n.u_scale_a),u_scale_b:new u.Uniform1f(h,n.u_scale_b),u_pixel_coord_upper:new u.Uniform2f(h,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,n.u_pixel_coord_lower),u_tile_units_to_pixels:new u.Uniform1f(h,n.u_tile_units_to_pixels)}),terrain:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_texture:new u.Uniform1i(h,n.u_texture)}),terrainDepth:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix)}),terrainCoords:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_texture:new u.Uniform1i(h,n.u_texture),u_terrain_coords_id:new u.Uniform1f(h,n.u_terrain_coords_id)})};class mn{constructor(n,a,c){this.context=n;const p=n.gl;this.buffer=p.createBuffer(),this.dynamicDraw=Boolean(c),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Rn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class kt{constructor(n,a,c,p){this.length=a.length,this.attributes=c,this.itemSize=a.bytesPerElement,this.dynamicDraw=p,this.context=n;const g=n.gl;this.buffer=g.createBuffer(),n.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,a){for(let c=0;c<this.attributes.length;c++){const p=a.attributes[this.attributes[c].name];p!==void 0&&n.enableVertexAttribArray(p)}}setVertexAttribPointers(n,a,c){for(let p=0;p<this.attributes.length;p++){const g=this.attributes[p],b=a.attributes[g.name];b!==void 0&&n.vertexAttribPointer(b,g.components,n[Rn[g.type]],!1,this.itemSize,g.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Xt{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class bo extends Xt{getDefault(){return u.Color.transparent}set(n){const a=this.current;(n.r!==a.r||n.g!==a.g||n.b!==a.b||n.a!==a.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class fn extends Xt{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Gr extends Xt{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class mr extends Xt{getDefault(){return[!0,!0,!0,!0]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2]||n[3]!==a[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Ds extends Xt{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class Qr extends Xt{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class ki extends Xt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const a=this.current;(n.func!==a.func||n.ref!==a.ref||n.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Ja extends Xt{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Qa extends Xt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=n,this.dirty=!1}}class Cl extends Xt{getDefault(){return[0,1]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Rs extends Xt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=n,this.dirty=!1}}class la extends Xt{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Fs extends Xt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.BLEND):a.disable(a.BLEND),this.current=n,this.dirty=!1}}class Os extends Xt{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class Bs extends Xt{getDefault(){return u.Color.transparent}set(n){const a=this.current;(n.r!==a.r||n.g!==a.g||n.b!==a.b||n.a!==a.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class jo extends Xt{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class Il extends Xt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=n,this.dirty=!1}}class Pa extends Xt{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class _c extends Xt{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class Pl extends Xt{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class es extends Xt{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Al extends Xt{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2]||n[3]!==a[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Ml extends Xt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class zl extends Xt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class ua extends Xt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Ns extends Xt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Ll extends Xt{getDefault(){return null}set(n){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Dl extends Xt{constructor(n){super(n),this.vao=n.extVertexArrayObject}getDefault(){return null}set(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)}}class Aa extends Xt{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class wu extends Xt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Rl extends Xt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Ma extends Xt{constructor(n,a){super(n),this.context=n,this.parent=a}getDefault(){return null}}class fi extends Ma{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Qi extends Ma{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Ci{constructor(n,a,c,p){this.context=n,this.width=a,this.height=c;const g=n.gl,b=this.framebuffer=g.createFramebuffer();if(this.colorAttachment=new fi(n,b),p&&(this.depthAttachment=new Qi(n,b)),g.checkFramebufferStatus(g.FRAMEBUFFER)!==g.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const n=this.context.gl,a=this.colorAttachment.get();if(a&&n.deleteTexture(a),this.depthAttachment){const c=this.depthAttachment.get();c&&n.deleteRenderbuffer(c)}n.deleteFramebuffer(this.framebuffer)}}class wn{constructor(n,a,c){this.blendFunction=n,this.blendColor=a,this.mask=c}}wn.Replace=[1,0],wn.disabled=new wn(wn.Replace,u.Color.transparent,[!1,!1,!1,!1]),wn.unblended=new wn(wn.Replace,u.Color.transparent,[!0,!0,!0,!0]),wn.alphaBlended=new wn([1,771],u.Color.transparent,[!0,!0,!0,!0]);class wo{constructor(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new bo(this),this.clearDepth=new fn(this),this.clearStencil=new Gr(this),this.colorMask=new mr(this),this.depthMask=new Ds(this),this.stencilMask=new Qr(this),this.stencilFunc=new ki(this),this.stencilOp=new Ja(this),this.stencilTest=new Qa(this),this.depthRange=new Cl(this),this.depthTest=new Rs(this),this.depthFunc=new la(this),this.blend=new Fs(this),this.blendFunc=new Os(this),this.blendColor=new Bs(this),this.blendEquation=new jo(this),this.cullFace=new Il(this),this.cullFaceSide=new Pa(this),this.frontFace=new _c(this),this.program=new Pl(this),this.activeTexture=new es(this),this.viewport=new Al(this),this.bindFramebuffer=new Ml(this),this.bindRenderbuffer=new zl(this),this.bindTexture=new ua(this),this.bindVertexBuffer=new Ns(this),this.bindElementBuffer=new Ll(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Dl(this),this.pixelStoreUnpack=new Aa(this),this.pixelStoreUnpackPremultiplyAlpha=new wu(this),this.pixelStoreUnpackFlipY=new Rl(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,a){return new mn(this,n,a)}createVertexBuffer(n,a,c){return new kt(this,n,a,c)}createRenderbuffer(n,a,c){const p=this.gl,g=p.createRenderbuffer();return this.bindRenderbuffer.set(g),p.renderbufferStorage(p.RENDERBUFFER,n,a,c),this.bindRenderbuffer.set(null),g}createFramebuffer(n,a,c){return new Ci(this,n,a,c)}clear({color:n,depth:a}){const c=this.gl;let p=0;n&&(p|=c.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(p|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),c.clear(p)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){ne(n.blendFunction,wn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Yt{constructor(n,a,c){this.func=n,this.mask=a,this.range=c}}Yt.ReadOnly=!1,Yt.ReadWrite=!0,Yt.disabled=new Yt(519,Yt.ReadOnly,[0,1]);const on=7680;class vn{constructor(n,a,c,p,g,b){this.test=n,this.ref=a,this.mask=c,this.fail=p,this.depthFail=g,this.pass=b}}vn.disabled=new vn({func:519,mask:0},0,0,on,on,on);class Mn{constructor(n,a,c){this.enable=n,this.mode=a,this.frontFace=c}}let za;function La(h,n,a,c,p,g,b){const E=h.context,k=E.gl,P=h.useProgram("collisionBox"),z=[];let R=0,N=0;for(let Y=0;Y<c.length;Y++){const Se=c[Y],ve=n.getTile(Se),De=ve.getBucket(a);if(!De)continue;let Re=Se.posMatrix;p[0]===0&&p[1]===0||(Re=h.translatePosMatrix(Se.posMatrix,ve,p,g));const $e=b?De.textCollisionBox:De.iconCollisionBox,Pe=De.collisionCircleArray;if(Pe.length>0){const ht=u.create(),nt=Re;u.mul(ht,De.placementInvProjMatrix,h.transform.glCoordMatrix),u.mul(ht,ht,De.placementViewportMatrix),z.push({circleArray:Pe,circleOffset:N,transform:nt,invTransform:ht,coord:Se}),R+=Pe.length/4,N=R}$e&&P.draw(E,k.LINES,Yt.disabled,vn.disabled,h.colorModeForRenderPass(),Mn.disabled,x(Re,h.transform,ve),h.style.terrain&&h.style.terrain.getTerrainData(Se),a.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,null,h.transform.zoom,null,null,$e.collisionVertexBuffer)}if(!b||!z.length)return;const X=h.useProgram("collisionCircle"),Z=new u.CollisionCircleLayoutArray;Z.resize(4*R),Z._trim();let H=0;for(const Y of z)for(let Se=0;Se<Y.circleArray.length/4;Se++){const ve=4*Se,De=Y.circleArray[ve+0],Re=Y.circleArray[ve+1],$e=Y.circleArray[ve+2],Pe=Y.circleArray[ve+3];Z.emplace(H++,De,Re,$e,Pe,0),Z.emplace(H++,De,Re,$e,Pe,1),Z.emplace(H++,De,Re,$e,Pe,2),Z.emplace(H++,De,Re,$e,Pe,3)}(!za||za.length<2*R)&&(za=function(Y){const Se=2*Y,ve=new u.QuadTriangleArray;ve.resize(Se),ve._trim();for(let De=0;De<Se;De++){const Re=6*De;ve.uint16[Re+0]=4*De+0,ve.uint16[Re+1]=4*De+1,ve.uint16[Re+2]=4*De+2,ve.uint16[Re+3]=4*De+2,ve.uint16[Re+4]=4*De+3,ve.uint16[Re+5]=4*De+0}return ve}(R));const le=E.createIndexBuffer(za,!0),de=E.createVertexBuffer(Z,u.collisionCircleLayout.members,!0);for(const Y of z){const Se={u_matrix:Y.transform,u_inv_matrix:Y.invTransform,u_camera_to_center_distance:(ye=h.transform).cameraToCenterDistance,u_viewport_size:[ye.width,ye.height]};X.draw(E,k.TRIANGLES,Yt.disabled,vn.disabled,h.colorModeForRenderPass(),Mn.disabled,Se,h.style.terrain&&h.style.terrain.getTerrainData(Y.coord),a.id,de,le,u.SegmentVector.simpleSegment(0,2*Y.circleOffset,Y.circleArray.length,Y.circleArray.length/2),null,h.transform.zoom,null,null,null)}var ye;de.destroy(),le.destroy()}Mn.disabled=new Mn(!1,1029,2305),Mn.backCCW=new Mn(!0,1029,2305);const vc=u.identity(new Float32Array(16));function Su(h,n,a,c,p,g){const{horizontalAlign:b,verticalAlign:E}=u.getAnchorAlignment(h),k=-(b-.5)*n,P=-(E-.5)*a,z=u.evaluateVariableOffset(h,c);return new u.pointGeometry((k/p+z[0])*g,(P/p+z[1])*g)}function Fl(h,n,a,c,p,g,b,E,k,P,z){const R=h.text.placedSymbolArray,N=h.text.dynamicLayoutVertexArray,X=h.icon.dynamicLayoutVertexArray,Z={};N.clear();for(let H=0;H<R.length;H++){const le=R.get(H),de=h.allowVerticalPlacement&&!le.placedOrientation,ye=le.hidden||!le.crossTileID||de?null:c[le.crossTileID];if(ye){const Y=new u.pointGeometry(le.anchorX,le.anchorY),Se=jt(Y,a?b:g,z),ve=Vn(p.cameraToCenterDistance,Se.signedDistanceFromCamera);let De=u.evaluateSizeForFeature(h.textSizeData,k,le)*ve/u.ONE_EM;a&&(De*=h.tilePixelRatio/E);const{width:Re,height:$e,anchor:Pe,textOffset:ht,textBoxScale:nt}=ye,pt=Su(Pe,Re,$e,ht,nt,De),Vt=a?jt(Y.add(pt),g,z).point:Se.point.add(n?pt.rotate(-p.angle):pt),Wt=h.allowVerticalPlacement&&le.placedOrientation===u.WritingMode.vertical?Math.PI/2:0;for(let Ct=0;Ct<le.numGlyphs;Ct++)u.addDynamicAttributes(N,Vt,Wt);P&&le.associatedIconIndex>=0&&(Z[le.associatedIconIndex]={shiftedAnchor:Vt,angle:Wt})}else Ot(le.numGlyphs,N)}if(P){X.clear();const H=h.icon.placedSymbolArray;for(let le=0;le<H.length;le++){const de=H.get(le);if(de.hidden)Ot(de.numGlyphs,X);else{const ye=Z[le];if(ye)for(let Y=0;Y<de.numGlyphs;Y++)u.addDynamicAttributes(X,ye.shiftedAnchor,ye.angle);else Ot(de.numGlyphs,X)}}h.icon.dynamicLayoutVertexBuffer.updateData(X)}h.text.dynamicLayoutVertexBuffer.updateData(N)}function Us(h,n,a){return a.iconsInText&&n?"symbolTextAndIcon":h?"symbolSDF":"symbolIcon"}function So(h,n,a,c,p,g,b,E,k,P,z,R){const N=h.context,X=N.gl,Z=h.transform,H=E==="map",le=k==="map",de=E!=="viewport"&&a.layout.get("symbol-placement")!=="point",ye=H&&!le&&!de,Y=!a.layout.get("symbol-sort-key").isConstant();let Se=!1;const ve=h.depthModeForSublayer(0,Yt.ReadOnly),De=a.layout.get("text-variable-anchor"),Re=[];for(const $e of c){const Pe=n.getTile($e),ht=Pe.getBucket(a);if(!ht)continue;const nt=p?ht.text:ht.icon;if(!nt||!nt.segments.get().length)continue;const pt=nt.programConfigurations.get(a.id),Vt=p||ht.sdfIcons,Wt=p?ht.textSizeData:ht.iconSizeData,Ct=le||Z.pitch!==0,En=h.useProgram(Us(Vt,p,ht),pt),Tn=u.evaluateSizeForZoom(Wt,Z.zoom),un=h.style.terrain&&h.style.terrain.getTerrainData($e);let cn,Cn,Lr,Xo,Co=[0,0],Yo=null;if(p){if(Cn=Pe.glyphAtlasTexture,Lr=X.LINEAR,cn=Pe.glyphAtlasTexture.size,ht.iconsInText){Co=Pe.imageAtlasTexture.size,Yo=Pe.imageAtlasTexture;const so=Wt.kind==="composite"||Wt.kind==="camera";Xo=Ct||h.options.rotating||h.options.zooming||so?X.LINEAR:X.NEAREST}}else{const so=a.layout.get("icon-size").constantOr(0)!==1||ht.iconsNeedLinear;Cn=Pe.imageAtlasTexture,Lr=Vt||h.options.rotating||h.options.zooming||so||Ct?X.LINEAR:X.NEAREST,cn=Pe.imageAtlasTexture.size}const $a=rr(Pe,1,h.transform.zoom),ao=Yn($e.posMatrix,le,H,h.transform,$a),Ai=br($e.posMatrix,le,H,h.transform,$a),da=De&&ht.hasTextData(),Tu=a.layout.get("icon-text-fit")!=="none"&&da&&ht.hasIconData();if(de){const so=h.style.terrain?(Ic,Zs)=>h.style.terrain.getElevation($e,Ic,Zs):null,ls=a.layout.get("text-rotation-alignment")==="map";Pr(ht,$e.posMatrix,h,p,ao,Ai,le,P,ls,so)}const Sr=h.translatePosMatrix($e.posMatrix,Pe,g,b),Kt=de||p&&De||Tu?vc:ao,bn=h.translatePosMatrix(Ai,Pe,g,b,!0),Dr=Vt&&a.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Rr;Rr=Vt?ht.iconsInText?Wn(Wt.kind,Tn,ye,le,h,Sr,Kt,bn,cn,Co):Rt(Wt.kind,Tn,ye,le,h,Sr,Kt,bn,p,cn,!0):Tt(Wt.kind,Tn,ye,le,h,Sr,Kt,bn,p,cn);const qn={program:En,buffers:nt,uniformValues:Rr,atlasTexture:Cn,atlasTextureIcon:Yo,atlasInterpolation:Lr,atlasInterpolationIcon:Xo,isSDF:Vt,hasHalo:Dr};if(Y&&ht.canOverlap){Se=!0;const so=nt.segments.get();for(const ls of so)Re.push({segments:new u.SegmentVector([ls]),sortKey:ls.sortKey,state:qn,terrainData:un})}else Re.push({segments:nt.segments,sortKey:0,state:qn,terrainData:un})}Se&&Re.sort(($e,Pe)=>$e.sortKey-Pe.sortKey);for(const $e of Re){const Pe=$e.state;if(N.activeTexture.set(X.TEXTURE0),Pe.atlasTexture.bind(Pe.atlasInterpolation,X.CLAMP_TO_EDGE),Pe.atlasTextureIcon&&(N.activeTexture.set(X.TEXTURE1),Pe.atlasTextureIcon&&Pe.atlasTextureIcon.bind(Pe.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),Pe.isSDF){const ht=Pe.uniformValues;Pe.hasHalo&&(ht.u_is_halo=1,ts(Pe.buffers,$e.segments,a,h,Pe.program,ve,z,R,ht,$e.terrainData)),ht.u_is_halo=0}ts(Pe.buffers,$e.segments,a,h,Pe.program,ve,z,R,Pe.uniformValues,$e.terrainData)}}function ts(h,n,a,c,p,g,b,E,k,P){const z=c.context;p.draw(z,z.gl.TRIANGLES,g,b,E,Mn.disabled,k,P,a.id,h.layoutVertexBuffer,h.indexBuffer,n,a.paint,c.transform.zoom,h.programConfigurations.get(a.id),h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer)}function Ii(h,n,a,c,p,g,b){const E=h.context.gl,k=a.paint.get("fill-pattern"),P=k&&k.constantOr(1),z=a.getCrossfadeParameters();let R,N,X,Z,H;b?(N=P&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",R=E.LINES):(N=P?"fillPattern":"fill",R=E.TRIANGLES);for(const le of c){const de=n.getTile(le);if(P&&!de.patternsLoaded())continue;const ye=de.getBucket(a);if(!ye)continue;const Y=ye.programConfigurations.get(a.id),Se=h.useProgram(N,Y),ve=h.style.terrain&&h.style.terrain.getTerrainData(le);P&&(h.context.activeTexture.set(E.TEXTURE0),de.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),Y.updatePaintBuffers(z));const De=k.constantOr(null);if(De&&de.imageAtlas){const Pe=de.imageAtlas,ht=Pe.patternPositions[De.to.toString()],nt=Pe.patternPositions[De.from.toString()];ht&&nt&&Y.setConstantPatternPositions(ht,nt)}const Re=ve?le:null,$e=h.translatePosMatrix(Re?Re.posMatrix:le.posMatrix,de,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(b){Z=ye.indexBuffer2,H=ye.segments2;const Pe=[E.drawingBufferWidth,E.drawingBufferHeight];X=N==="fillOutlinePattern"&&P?bu($e,h,z,de,Pe):xu($e,Pe)}else Z=ye.indexBuffer,H=ye.segments,X=P?Tl($e,h,z,de):Ls($e);Se.draw(h.context,R,p,h.stencilModeForClipping(le),g,Mn.disabled,X,ve,a.id,ye.layoutVertexBuffer,Z,H,a.paint,h.transform.zoom,Y)}}function ns(h,n,a,c,p,g,b){const E=h.context,k=E.gl,P=a.paint.get("fill-extrusion-pattern"),z=P.constantOr(1),R=a.getCrossfadeParameters(),N=a.paint.get("fill-extrusion-opacity");for(const X of c){const Z=n.getTile(X),H=Z.getBucket(a);if(!H)continue;const le=h.style.terrain&&h.style.terrain.getTerrainData(X),de=H.programConfigurations.get(a.id),ye=h.useProgram(z?"fillExtrusionPattern":"fillExtrusion",de);z&&(h.context.activeTexture.set(k.TEXTURE0),Z.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),de.updatePaintBuffers(R));const Y=P.constantOr(null);if(Y&&Z.imageAtlas){const Re=Z.imageAtlas,$e=Re.patternPositions[Y.to.toString()],Pe=Re.patternPositions[Y.from.toString()];$e&&Pe&&de.setConstantPatternPositions($e,Pe)}const Se=h.translatePosMatrix(X.posMatrix,Z,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),ve=a.paint.get("fill-extrusion-vertical-gradient"),De=z?vu(Se,h,ve,N,X,R,Z):El(Se,h,ve,N);ye.draw(E,E.gl.TRIANGLES,p,g,b,Mn.backCCW,De,le,a.id,H.layoutVertexBuffer,H.indexBuffer,H.segments,a.paint,h.transform.zoom,de,h.style.terrain&&H.centroidVertexBuffer)}}function Eo(h,n,a,c,p,g,b){const E=h.context,k=E.gl,P=a.fbo;if(!P)return;const z=h.useProgram("hillshade"),R=h.style.terrain&&h.style.terrain.getTerrainData(n);E.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,P.colorAttachment.get()),z.draw(E,k.TRIANGLES,p,g,b,Mn.disabled,((N,X,Z,H)=>{const le=Z.paint.get("hillshade-shadow-color"),de=Z.paint.get("hillshade-highlight-color"),ye=Z.paint.get("hillshade-accent-color");let Y=Z.paint.get("hillshade-illumination-direction")*(Math.PI/180);Z.paint.get("hillshade-illumination-anchor")==="viewport"&&(Y-=N.transform.angle);const Se=!N.options.moving;return{u_matrix:H?H.posMatrix:N.transform.calculatePosMatrix(X.tileID.toUnwrapped(),Se),u_image:0,u_latrange:_e(0,X.tileID),u_light:[Z.paint.get("hillshade-exaggeration"),Y],u_shadow:le,u_highlight:de,u_accent:ye}})(h,a,c,R?n:null),R,c.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}function Ol(h,n,a,c,p,g){const b=h.context,E=b.gl,k=n.dem;if(k&&k.data){const P=k.dim,z=k.stride,R=k.getPixels();if(b.activeTexture.set(E.TEXTURE1),b.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||h.getTileTexture(z),n.demTexture){const X=n.demTexture;X.update(R,{premultiply:!1}),X.bind(E.NEAREST,E.CLAMP_TO_EDGE)}else n.demTexture=new Ce(b,R,E.RGBA,{premultiply:!1}),n.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE);b.activeTexture.set(E.TEXTURE0);let N=n.fbo;if(!N){const X=new Ce(b,{width:P,height:P,data:null},E.RGBA);X.bind(E.LINEAR,E.CLAMP_TO_EDGE),N=n.fbo=b.createFramebuffer(P,P,!0),N.colorAttachment.set(X.texture)}b.bindFramebuffer.set(N.framebuffer),b.viewport.set([0,0,P,P]),h.useProgram("hillshadePrepare").draw(b,E.TRIANGLES,c,p,g,Mn.disabled,((X,Z)=>{const H=Z.stride,le=u.create();return u.ortho(le,0,u.EXTENT,-u.EXTENT,0,0,1),u.translate(le,le,[0,-u.EXTENT,0]),{u_matrix:le,u_image:1,u_dimension:[H,H],u_zoom:X.overscaledZ,u_unpack:Z.getUnpackVector()}})(n.tileID,k),null,a.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function Vs(h,n,a,c,p,g){const b=c.paint.get("raster-fade-duration");if(!g&&b>0){const E=u.exported.now(),k=(E-h.timeAdded)/b,P=n?(E-n.timeAdded)/b:-1,z=a.getSource(),R=p.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),N=!n||Math.abs(n.tileID.overscaledZ-R)>Math.abs(h.tileID.overscaledZ-R),X=N&&h.refreshedUponExpiration?1:u.clamp(N?k:1-P,0,1);return h.refreshedUponExpiration&&k>=1&&(h.refreshedUponExpiration=!1),n?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}const ca=new u.Color(1,0,0,1),mi=new u.Color(0,1,0,1),Bl=new u.Color(0,0,1,1),$s=new u.Color(1,0,1,1),Nl=new u.Color(0,1,1,1);function Ui(h,n,a,c){Ra(h,0,n+a/2,h.transform.width,a,c)}function Da(h,n,a,c){Ra(h,n-a/2,0,a,h.transform.height,c)}function Ra(h,n,a,c,p,g){const b=h.context,E=b.gl;E.enable(E.SCISSOR_TEST),E.scissor(n*h.pixelRatio,a*h.pixelRatio,c*h.pixelRatio,p*h.pixelRatio),b.clear({color:g}),E.disable(E.SCISSOR_TEST)}function fe(h,n,a){const c=h.context,p=c.gl,g=a.posMatrix,b=h.useProgram("debug"),E=Yt.disabled,k=vn.disabled,P=h.colorModeForRenderPass(),z="$debug",R=h.style.terrain&&h.style.terrain.getTerrainData(a);c.activeTexture.set(p.TEXTURE0),h.emptyTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE);const N=n.getTileByID(a.key).latestRawTileData,X=Math.floor((N&&N.byteLength||0)/1024),Z=n.getTile(a).tileSize,H=512/Math.min(Z,512)*(a.overscaledZ/h.transform.zoom)*.5;let le=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(le+=` => ${a.overscaledZ}`),function(de,ye){de.initDebugOverlayCanvas();const Y=de.debugOverlayCanvas,Se=de.context.gl,ve=de.debugOverlayCanvas.getContext("2d");ve.clearRect(0,0,Y.width,Y.height),ve.shadowColor="white",ve.shadowBlur=2,ve.lineWidth=1.5,ve.strokeStyle="white",ve.textBaseline="top",ve.font="bold 36px Open Sans, sans-serif",ve.fillText(ye,5,5),ve.strokeText(ye,5,5),de.debugOverlayTexture.update(Y),de.debugOverlayTexture.bind(Se.LINEAR,Se.CLAMP_TO_EDGE)}(h,`${le} ${X}kB`),b.draw(c,p.TRIANGLES,E,k,wn.alphaBlended,Mn.disabled,C(g,u.Color.transparent,H),null,z,h.debugBuffer,h.quadTriangleIndexBuffer,h.debugSegments),b.draw(c,p.LINE_STRIP,E,k,P,Mn.disabled,C(g,u.Color.red),R,z,h.debugBuffer,h.tileBorderIndexBuffer,h.debugSegments)}function Ae(h,n,a){const c=h.context,p=c.gl,g=h.colorModeForRenderPass(),b=new Yt(p.LEQUAL,Yt.ReadWrite,h.depthRangeFor3D),E=h.useProgram("terrain"),k=n.getTerrainMesh(),P=n.getTerrainData(a.tileID);c.bindFramebuffer.set(null),c.viewport.set([0,0,h.width,h.height]),c.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,n.getRTTFramebuffer().colorAttachment.get());const z=h.transform.calculatePosMatrix(a.tileID.toUnwrapped());E.draw(c,p.TRIANGLES,b,vn.disabled,g,Mn.backCCW,{u_matrix:z,u_texture:0},P,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}function ot(h,n,a,c){const p=h.context,g=a.tileSize*n.qualityFactor;a.textures[c]||(a.textures[c]=h.getTileTexture(g)||new Ce(p,{width:g,height:g,data:null},p.gl.RGBA),a.textures[c].bind(p.gl.LINEAR,p.gl.CLAMP_TO_EDGE),c===0&&n.sourceCache.renderHistory.unshift(a.tileID.key));const b=n.getRTTFramebuffer();b.colorAttachment.set(a.textures[c].texture),p.bindFramebuffer.set(b.framebuffer),p.viewport.set([0,0,g,g])}class Mt{constructor(n){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=n,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=n.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const n=this.painter.style,a=n.terrain;for(const c in n.sourceCaches){this._coordsDescendingInv[c]={};const p=n.sourceCaches[c].getVisibleCoordinates();for(const g of p){const b=a.sourceCache.getTerrainCoords(g);for(const E in b)this._coordsDescendingInv[c][E]||(this._coordsDescendingInv[c][E]=[]),this._coordsDescendingInv[c][E].push(b[E])}}for(const c of n._order){const p=n._layers[c],g=p.source;if(this._renderToTexture[p.type]&&!this._coordsDescendingInvStr[g]){this._coordsDescendingInvStr[g]={};for(const b in this._coordsDescendingInv[g])this._coordsDescendingInvStr[g][b]=this._coordsDescendingInv[g][b].map(E=>E.key).sort().join()}}return this._renderableTiles.forEach(c=>{for(const p in this._coordsDescendingInvStr){const g=this._coordsDescendingInvStr[p][c.tileID.key];g&&g!==c.textureCoords[p]&&c.clearTextures(this.painter),a.needsRerender(p,c.tileID)&&c.clearTextures(this.painter)}this._rerender[c.tileID.key]=!c.textures.length}),a.clearRerenderCache(),a.sourceCache.removeOutdated(this.painter),this}renderLayer(n){const a=n.type,c=this.painter,p=c.style._order,g=c.currentLayer,b=g+1===p.length;if(this._renderToTexture[a]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=a,this._stacks[this._stacks.length-1].push(p[g]),!b))return!0;if(this._renderToTexture[this._prevType]||a==="hillshade"||this._renderToTexture[a]&&b){this._prevType=a;const E=this._stacks.length-1,k=this._stacks[E]||[];for(const P of this._renderableTiles){if(ot(c,c.style.terrain,P,E),this._rerender[P.tileID.key]){c.context.clear({color:u.Color.transparent});for(let z=0;z<k.length;z++){const R=c.style._layers[k[z]],N=R.source?this._coordsDescendingInv[R.source][P.tileID.key]:[P.tileID];c._renderTileClippingMasks(R,N),c.renderLayer(c,c.style.sourceCaches[R.source],R,N),R.source&&(P.textureCoords[R.source]=this._coordsDescendingInvStr[R.source][P.tileID.key])}}Ae(c,c.style.terrain,P)}if(a==="hillshade"){this._stacks.push([p[g]]);for(const P of this._renderableTiles){const z=this._coordsDescendingInv[n.source][P.tileID.key];ot(c,c.style.terrain,P,this._stacks.length-1),c.context.clear({color:u.Color.transparent}),c._renderTileClippingMasks(n,z),c.renderLayer(c,c.style.sourceCaches[n.source],n,z),Ae(c,c.style.terrain,P)}return!0}return this._renderToTexture[a]}return!1}}const Sn={symbol:function(h,n,a,c,p){if(h.renderPass!=="translucent")return;const g=vn.disabled,b=h.colorModeForRenderPass();a.layout.get("text-variable-anchor")&&function(E,k,P,z,R,N,X){const Z=k.transform,H=R==="map",le=N==="map";for(const de of E){const ye=z.getTile(de),Y=ye.getBucket(P);if(!Y||!Y.text||!Y.text.segments.get().length)continue;const Se=u.evaluateSizeForZoom(Y.textSizeData,Z.zoom),ve=rr(ye,1,k.transform.zoom),De=Yn(de.posMatrix,le,H,k.transform,ve),Re=P.layout.get("icon-text-fit")!=="none"&&Y.hasIconData();if(Se){const $e=Math.pow(2,Z.zoom-ye.tileID.overscaledZ);Fl(Y,H,le,X,Z,De,de.posMatrix,$e,Se,Re,k.style.terrain?(Pe,ht)=>k.style.terrain.getElevation(de,Pe,ht):null)}}}(c,h,a,n,a.layout.get("text-rotation-alignment"),a.layout.get("text-pitch-alignment"),p),a.paint.get("icon-opacity").constantOr(1)!==0&&So(h,n,a,c,!1,a.paint.get("icon-translate"),a.paint.get("icon-translate-anchor"),a.layout.get("icon-rotation-alignment"),a.layout.get("icon-pitch-alignment"),a.layout.get("icon-keep-upright"),g,b),a.paint.get("text-opacity").constantOr(1)!==0&&So(h,n,a,c,!0,a.paint.get("text-translate"),a.paint.get("text-translate-anchor"),a.layout.get("text-rotation-alignment"),a.layout.get("text-pitch-alignment"),a.layout.get("text-keep-upright"),g,b),n.map.showCollisionBoxes&&(La(h,n,a,c,a.paint.get("text-translate"),a.paint.get("text-translate-anchor"),!0),La(h,n,a,c,a.paint.get("icon-translate"),a.paint.get("icon-translate-anchor"),!1))},circle:function(h,n,a,c){if(h.renderPass!=="translucent")return;const p=a.paint.get("circle-opacity"),g=a.paint.get("circle-stroke-width"),b=a.paint.get("circle-stroke-opacity"),E=!a.layout.get("circle-sort-key").isConstant();if(p.constantOr(1)===0&&(g.constantOr(1)===0||b.constantOr(1)===0))return;const k=h.context,P=k.gl,z=h.depthModeForSublayer(0,Yt.ReadOnly),R=vn.disabled,N=h.colorModeForRenderPass(),X=[];for(let Z=0;Z<c.length;Z++){const H=c[Z],le=n.getTile(H),de=le.getBucket(a);if(!de)continue;const ye=de.programConfigurations.get(a.id),Y=h.useProgram("circle",ye),Se=de.layoutVertexBuffer,ve=de.indexBuffer,De=h.style.terrain&&h.style.terrain.getTerrainData(H),Re={programConfiguration:ye,program:Y,layoutVertexBuffer:Se,indexBuffer:ve,uniformValues:kl(h,H,le,a),terrainData:De};if(E){const $e=de.segments.get();for(const Pe of $e)X.push({segments:new u.SegmentVector([Pe]),sortKey:Pe.sortKey,state:Re})}else X.push({segments:de.segments,sortKey:0,state:Re})}E&&X.sort((Z,H)=>Z.sortKey-H.sortKey);for(const Z of X){const{programConfiguration:H,program:le,layoutVertexBuffer:de,indexBuffer:ye,uniformValues:Y,terrainData:Se}=Z.state;le.draw(k,P.TRIANGLES,z,R,N,Mn.disabled,Y,Se,a.id,de,ye,Z.segments,a.paint,h.transform.zoom,H)}},heatmap:function(h,n,a,c){if(a.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){const p=h.context,g=p.gl,b=vn.disabled,E=new wn([g.ONE,g.ONE],u.Color.transparent,[!0,!0,!0,!0]);(function(k,P,z){const R=k.gl;k.activeTexture.set(R.TEXTURE1),k.viewport.set([0,0,P.width/4,P.height/4]);let N=z.heatmapFbo;if(N)R.bindTexture(R.TEXTURE_2D,N.colorAttachment.get()),k.bindFramebuffer.set(N.framebuffer);else{const X=R.createTexture();R.bindTexture(R.TEXTURE_2D,X),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_S,R.CLAMP_TO_EDGE),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_T,R.CLAMP_TO_EDGE),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MIN_FILTER,R.LINEAR),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MAG_FILTER,R.LINEAR),N=z.heatmapFbo=k.createFramebuffer(P.width/4,P.height/4,!1),function(Z,H,le,de){const ye=Z.gl;ye.texImage2D(ye.TEXTURE_2D,0,ye.RGBA,H.width/4,H.height/4,0,ye.RGBA,Z.extRenderToTextureHalfFloat?Z.extTextureHalfFloat.HALF_FLOAT_OES:ye.UNSIGNED_BYTE,null),de.colorAttachment.set(le)}(k,P,X,N)}})(p,h,a),p.clear({color:u.Color.transparent});for(let k=0;k<c.length;k++){const P=c[k];if(n.hasRenderableParent(P))continue;const z=n.getTile(P),R=z.getBucket(a);if(!R)continue;const N=R.programConfigurations.get(a.id),X=h.useProgram("heatmap",N),{zoom:Z}=h.transform;X.draw(p,g.TRIANGLES,Yt.disabled,b,E,Mn.disabled,ae(P.posMatrix,z,Z,a.paint.get("heatmap-intensity")),null,a.id,R.layoutVertexBuffer,R.indexBuffer,R.segments,a.paint,h.transform.zoom,N)}p.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),function(p,g){const b=p.context,E=b.gl,k=g.heatmapFbo;if(!k)return;b.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,k.colorAttachment.get()),b.activeTexture.set(E.TEXTURE1);let P=g.colorRampTexture;P||(P=g.colorRampTexture=new Ce(b,g.colorRamp,E.RGBA)),P.bind(E.LINEAR,E.CLAMP_TO_EDGE),p.useProgram("heatmapTexture").draw(b,E.TRIANGLES,Yt.disabled,vn.disabled,p.colorModeForRenderPass(),Mn.disabled,((z,R,N,X)=>{const Z=u.create();u.ortho(Z,0,z.width,z.height,0,0,1);const H=z.context.gl;return{u_matrix:Z,u_world:[H.drawingBufferWidth,H.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:R.paint.get("heatmap-opacity")}})(p,g),null,g.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments,g.paint,p.transform.zoom)}(h,a))},line:function(h,n,a,c){if(h.renderPass!=="translucent")return;const p=a.paint.get("line-opacity"),g=a.paint.get("line-width");if(p.constantOr(1)===0||g.constantOr(1)===0)return;const b=h.depthModeForSublayer(0,Yt.ReadOnly),E=h.colorModeForRenderPass(),k=a.paint.get("line-dasharray"),P=a.paint.get("line-pattern"),z=P.constantOr(1),R=a.paint.get("line-gradient"),N=a.getCrossfadeParameters(),X=z?"linePattern":k?"lineSDF":R?"lineGradient":"line",Z=h.context,H=Z.gl;let le=!0;for(const de of c){const ye=n.getTile(de);if(z&&!ye.patternsLoaded())continue;const Y=ye.getBucket(a);if(!Y)continue;const Se=Y.programConfigurations.get(a.id),ve=h.context.program.get(),De=h.useProgram(X,Se),Re=le||De.program!==ve,$e=h.style.terrain&&h.style.terrain.getTerrainData(de),Pe=P.constantOr(null);if(Pe&&ye.imageAtlas){const pt=ye.imageAtlas,Vt=pt.patternPositions[Pe.to.toString()],Wt=pt.patternPositions[Pe.from.toString()];Vt&&Wt&&Se.setConstantPatternPositions(Vt,Wt)}const ht=$e?de:null,nt=z?je(h,ye,a,N,ht):k?Ve(h,ye,a,k,N,ht):R?ge(h,ye,a,Y.lineClipsArray.length,ht):he(h,ye,a,ht);if(z)Z.activeTexture.set(H.TEXTURE0),ye.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),Se.updatePaintBuffers(N);else if(k&&(Re||h.lineAtlas.dirty))Z.activeTexture.set(H.TEXTURE0),h.lineAtlas.bind(Z);else if(R){const pt=Y.gradients[a.id];let Vt=pt.texture;if(a.gradientVersion!==pt.version){let Wt=256;if(a.stepInterpolant){const Ct=n.getSource().maxzoom,En=de.canonical.z===Ct?Math.ceil(1<<h.transform.maxZoom-de.canonical.z):1;Wt=u.clamp(u.nextPowerOfTwo(Y.maxLineLength/u.EXTENT*1024*En),256,Z.maxTextureSize)}pt.gradient=u.renderColorRamp({expression:a.gradientExpression(),evaluationKey:"lineProgress",resolution:Wt,image:pt.gradient||void 0,clips:Y.lineClipsArray}),pt.texture?pt.texture.update(pt.gradient):pt.texture=new Ce(Z,pt.gradient,H.RGBA),pt.version=a.gradientVersion,Vt=pt.texture}Z.activeTexture.set(H.TEXTURE0),Vt.bind(a.stepInterpolant?H.NEAREST:H.LINEAR,H.CLAMP_TO_EDGE)}De.draw(Z,H.TRIANGLES,b,h.stencilModeForClipping(de),E,Mn.disabled,nt,$e,a.id,Y.layoutVertexBuffer,Y.indexBuffer,Y.segments,a.paint,h.transform.zoom,Se,Y.layoutVertexBuffer2),le=!1}},fill:function(h,n,a,c){const p=a.paint.get("fill-color"),g=a.paint.get("fill-opacity");if(g.constantOr(1)===0)return;const b=h.colorModeForRenderPass(),E=a.paint.get("fill-pattern"),k=h.opaquePassEnabledForLayer()&&!E.constantOr(1)&&p.constantOr(u.Color.transparent).a===1&&g.constantOr(0)===1?"opaque":"translucent";if(h.renderPass===k){const P=h.depthModeForSublayer(1,h.renderPass==="opaque"?Yt.ReadWrite:Yt.ReadOnly);Ii(h,n,a,c,P,b,!1)}if(h.renderPass==="translucent"&&a.paint.get("fill-antialias")){const P=h.depthModeForSublayer(a.getPaintProperty("fill-outline-color")?2:0,Yt.ReadOnly);Ii(h,n,a,c,P,b,!0)}},"fill-extrusion":function(h,n,a,c){const p=a.paint.get("fill-extrusion-opacity");if(p!==0&&h.renderPass==="translucent"){const g=new Yt(h.context.gl.LEQUAL,Yt.ReadWrite,h.depthRangeFor3D);if(p!==1||a.paint.get("fill-extrusion-pattern").constantOr(1))ns(h,n,a,c,g,vn.disabled,wn.disabled),ns(h,n,a,c,g,h.stencilModeFor3D(),h.colorModeForRenderPass());else{const b=h.colorModeForRenderPass();ns(h,n,a,c,g,vn.disabled,b)}}},hillshade:function(h,n,a,c){if(h.renderPass!=="offscreen"&&h.renderPass!=="translucent")return;const p=h.context,g=h.depthModeForSublayer(0,Yt.ReadOnly),b=h.colorModeForRenderPass(),[E,k]=h.renderPass==="translucent"?h.stencilConfigForOverlap(c):[{},c];for(const P of k){const z=n.getTile(P);z.needsHillshadePrepare!==void 0&&z.needsHillshadePrepare&&h.renderPass==="offscreen"?Ol(h,z,a,g,vn.disabled,b):h.renderPass==="translucent"&&Eo(h,P,z,a,g,E[P.overscaledZ],b)}p.viewport.set([0,0,h.width,h.height])},raster:function(h,n,a,c){if(h.renderPass!=="translucent"||a.paint.get("raster-opacity")===0||!c.length)return;const p=h.context,g=p.gl,b=n.getSource(),E=h.useProgram("raster"),k=h.colorModeForRenderPass(),[P,z]=b instanceof Pt?[{},c]:h.stencilConfigForOverlap(c),R=z[z.length-1].overscaledZ,N=!h.options.moving;for(const X of z){const Z=h.depthModeForSublayer(X.overscaledZ-R,a.paint.get("raster-opacity")===1?Yt.ReadWrite:Yt.ReadOnly,g.LESS),H=n.getTile(X);H.registerFadeDuration(a.paint.get("raster-fade-duration"));const le=n.findLoadedParent(X,0),de=Vs(H,le,n,a,h.transform,h.style.terrain);let ye,Y;const Se=a.paint.get("raster-resampling")==="nearest"?g.NEAREST:g.LINEAR;p.activeTexture.set(g.TEXTURE0),H.texture.bind(Se,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST),p.activeTexture.set(g.TEXTURE1),le?(le.texture.bind(Se,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST),ye=Math.pow(2,le.tileID.overscaledZ-H.tileID.overscaledZ),Y=[H.tileID.canonical.x*ye%1,H.tileID.canonical.y*ye%1]):H.texture.bind(Se,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST);const ve=h.style.terrain&&h.style.terrain.getTerrainData(X),De=ve?X:null,Re=De?De.posMatrix:h.transform.calculatePosMatrix(X.toUnwrapped(),N),$e=et(Re,Y||[0,0],ye||1,de,a);b instanceof Pt?E.draw(p,g.TRIANGLES,Z,vn.disabled,k,Mn.disabled,$e,ve,a.id,b.boundsBuffer,h.quadTriangleIndexBuffer,b.boundsSegments):E.draw(p,g.TRIANGLES,Z,P[X.overscaledZ],k,Mn.disabled,$e,ve,a.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}},background:function(h,n,a,c){const p=a.paint.get("background-color"),g=a.paint.get("background-opacity");if(g===0)return;const b=h.context,E=b.gl,k=h.transform,P=k.tileSize,z=a.paint.get("background-pattern");if(h.isPatternMissing(z))return;const R=!z&&p.a===1&&g===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==R)return;const N=vn.disabled,X=h.depthModeForSublayer(0,R==="opaque"?Yt.ReadWrite:Yt.ReadOnly),Z=h.colorModeForRenderPass(),H=h.useProgram(z?"backgroundPattern":"background"),le=c||k.coveringTiles({tileSize:P,terrain:h.style.terrain});z&&(b.activeTexture.set(E.TEXTURE0),h.imageManager.bind(h.context));const de=a.getCrossfadeParameters();for(const ye of le){const Y=c?ye.posMatrix:h.transform.calculatePosMatrix(ye.toUnwrapped()),Se=z?yt(Y,g,h,z,{tileID:ye,tileSize:P},de):Ne(Y,g,p),ve=h.style.terrain&&h.style.terrain.getTerrainData(ye);H.draw(b,E.TRIANGLES,X,N,Z,Mn.disabled,Se,ve,a.id,h.tileExtentBuffer,h.quadTriangleIndexBuffer,h.tileExtentSegments)}},debug:function(h,n,a){for(let c=0;c<a.length;c++)fe(h,n,a[c])},custom:function(h,n,a){const c=h.context,p=a.implementation;if(h.renderPass==="offscreen"){const g=p.prerender;g&&(h.setCustomLayerDefaults(),c.setColorMode(h.colorModeForRenderPass()),g.call(p,c.gl,h.transform.customLayerMatrix()),c.setDirty(),h.setBaseState())}else if(h.renderPass==="translucent"){h.setCustomLayerDefaults(),c.setColorMode(h.colorModeForRenderPass()),c.setStencilMode(vn.disabled);const g=p.renderingMode==="3d"?new Yt(h.context.gl.LEQUAL,Yt.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,Yt.ReadOnly);c.setDepthMode(g),p.render(c.gl,h.transform.customLayerMatrix()),c.setDirty(),h.setBaseState(),c.bindFramebuffer.set(null)}}};class en{constructor(n,a){this.context=new wo(n),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.create(),renderTime:0},this.setup(),this.numSublayers=Jr.maxUnderzooming+Jr.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Dt,this.gpuTimers={}}resize(n,a,c){if(this.width=n*c,this.height=a*c,this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style._order)this.style._layers[p].resize()}setup(){const n=this.context,a=new u.PosArray;a.emplaceBack(0,0),a.emplaceBack(u.EXTENT,0),a.emplaceBack(0,u.EXTENT),a.emplaceBack(u.EXTENT,u.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(a,Qt.members),this.tileExtentSegments=u.SegmentVector.simpleSegment(0,0,4,2);const c=new u.PosArray;c.emplaceBack(0,0),c.emplaceBack(u.EXTENT,0),c.emplaceBack(0,u.EXTENT),c.emplaceBack(u.EXTENT,u.EXTENT),this.debugBuffer=n.createVertexBuffer(c,Qt.members),this.debugSegments=u.SegmentVector.simpleSegment(0,0,4,5);const p=new u.RasterBoundsArray;p.emplaceBack(0,0,0,0),p.emplaceBack(u.EXTENT,0,u.EXTENT,0),p.emplaceBack(0,u.EXTENT,0,u.EXTENT),p.emplaceBack(u.EXTENT,u.EXTENT,u.EXTENT,u.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(p,at.members),this.rasterBoundsSegments=u.SegmentVector.simpleSegment(0,0,4,2);const g=new u.PosArray;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(g,Qt.members),this.viewportSegments=u.SegmentVector.simpleSegment(0,0,4,2);const b=new u.LineStripIndexArray;b.emplaceBack(0),b.emplaceBack(1),b.emplaceBack(3),b.emplaceBack(2),b.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(b);const E=new u.TriangleIndexArray;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(E),this.emptyTexture=new Ce(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);const k=this.context.gl;this.stencilClearMode=new vn({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)}clearStencil(){const n=this.context,a=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=u.create();u.ortho(c,0,this.width,this.height,0,0,1),u.scale(c,c,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,a.TRIANGLES,Yt.disabled,this.stencilClearMode,wn.disabled,Mn.disabled,B(c),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,a){if(this.currentStencilSource===n.source||!n.isTileClipped()||!a||!a.length)return;this.currentStencilSource=n.source;const c=this.context,p=c.gl;this.nextStencilID+a.length>256&&this.clearStencil(),c.setColorMode(wn.disabled),c.setDepthMode(Yt.disabled);const g=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const b of a){const E=this._tileClippingMaskIDs[b.key]=this.nextStencilID++,k=this.style.terrain&&this.style.terrain.getTerrainData(b);g.draw(c,p.TRIANGLES,Yt.disabled,new vn({func:p.ALWAYS,mask:0},E,255,p.KEEP,p.KEEP,p.REPLACE),wn.disabled,Mn.disabled,B(b.posMatrix),k,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,a=this.context.gl;return new vn({func:a.NOTEQUAL,mask:255},n,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(n){const a=this.context.gl;return new vn({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(n){const a=this.context.gl,c=n.sort((b,E)=>E.overscaledZ-b.overscaledZ),p=c[c.length-1].overscaledZ,g=c[0].overscaledZ-p+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();const b={};for(let E=0;E<g;E++)b[E+p]=new vn({func:a.GEQUAL,mask:255},E+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=g,[b,c]}return[{[p]:vn.disabled},c]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new wn([n.CONSTANT_COLOR,n.ONE],new u.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?wn.unblended:wn.alphaBlended}depthModeForSublayer(n,a,c){if(!this.opaquePassEnabledForLayer())return Yt.disabled;const p=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new Yt(c||this.context.gl.LEQUAL,a,[p,p])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,a){this.style=n,this.options=a,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(u.exported.now()),this.imageManager.beginFrame();const c=this.style._order,p=this.style.sourceCaches,g=this.style.terrain&&new Mt(this);for(const P in p){const z=p[P];z.used&&z.prepare(this.context)}const b={},E={},k={};for(const P in p){const z=p[P];b[P]=z.getVisibleCoordinates(),E[P]=b[P].slice().reverse(),k[P]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let P=0;P<c.length;P++)if(this.style._layers[c[P]].is3D()){this.opaquePassCutoff=P;break}if(g){this.opaquePassCutoff=0;const P=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!u.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||P.length)&&(u.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(z,R){const N=z.context,X=N.gl,Z=wn.unblended,H=new Yt(X.LEQUAL,Yt.ReadWrite,[0,1]),le=R.getTerrainMesh(),de=R.sourceCache.getRenderableTiles(),ye=z.useProgram("terrainDepth");N.bindFramebuffer.set(R.getFramebuffer("depth").framebuffer),N.viewport.set([0,0,z.width/devicePixelRatio,z.height/devicePixelRatio]),N.clear({color:u.Color.transparent,depth:1});for(const Y of de){const Se=R.getTerrainData(Y.tileID),ve=z.transform.calculatePosMatrix(Y.tileID.toUnwrapped());ye.draw(N,X.TRIANGLES,H,vn.disabled,Z,Mn.backCCW,{u_matrix:ve},Se,"terrain",le.vertexBuffer,le.indexBuffer,le.segments)}N.bindFramebuffer.set(null),N.viewport.set([0,0,z.width,z.height])}(this,this.style.terrain),function(z,R){const N=z.context,X=N.gl,Z=wn.unblended,H=new Yt(X.LEQUAL,Yt.ReadWrite,[0,1]),le=R.getTerrainMesh(),de=R.getCoordsTexture(),ye=R.sourceCache.getRenderableTiles(),Y=z.useProgram("terrainCoords");N.bindFramebuffer.set(R.getFramebuffer("coords").framebuffer),N.viewport.set([0,0,z.width/devicePixelRatio,z.height/devicePixelRatio]),N.clear({color:u.Color.transparent,depth:1}),R.coordsIndex=[];for(const Se of ye){const ve=R.getTerrainData(Se.tileID);N.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,de.texture);const De=z.transform.calculatePosMatrix(Se.tileID.toUnwrapped());Y.draw(N,X.TRIANGLES,H,vn.disabled,Z,Mn.backCCW,{u_matrix:De,u_terrain_coords_id:(255-R.coordsIndex.length)/255,u_texture:0},ve,"terrain",le.vertexBuffer,le.indexBuffer,le.segments),R.coordsIndex.push(Se.tileID.key)}N.bindFramebuffer.set(null),N.viewport.set([0,0,z.width,z.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const P of c){const z=this.style._layers[P];if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const R=E[z.source];(z.type==="custom"||R.length)&&this.renderLayer(this,p[z.source],z,R)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?u.Color.black:u.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!g)for(this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const P=this.style._layers[c[this.currentLayer]],z=p[P.source],R=b[P.source];this._renderTileClippingMasks(P,R),this.renderLayer(this,z,P,R)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const P=this.style._layers[c[this.currentLayer]],z=p[P.source];if(g&&g.renderLayer(P))continue;const R=(P.type==="symbol"?k:E)[P.source];this._renderTileClippingMasks(P,b[P.source]),this.renderLayer(this,z,P,R)}if(this.options.showTileBoundaries){let P,z;Object.values(this.style._layers).forEach(R=>{R.source&&!R.isHidden(this.transform.zoom)&&(R.source!==(z&&z.id)&&(z=this.style.sourceCaches[R.source]),(!P||P.getSource().maxzoom<z.getSource().maxzoom)&&(P=z))}),P&&Sn.debug(this,P,P.getVisibleCoordinates())}this.options.showPadding&&function(P){const z=P.transform.padding;Ui(P,P.transform.height-(z.top||0),3,ca),Ui(P,z.bottom||0,3,mi),Da(P,z.left||0,3,Bl),Da(P,P.transform.width-(z.right||0),3,$s);const R=P.transform.centerPoint;(function(N,X,Z,H){Ra(N,X-1,Z-10,2,20,H),Ra(N,X-10,Z-1,20,2,H)})(P,R.x,P.transform.height-R.y,Nl)}(this),this.context.setDefault()}renderLayer(n,a,c,p){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(p||[]).length)&&(this.id=c.id,this.gpuTimingStart(c),Sn[c.type](n,a,c,p,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const a=this.context.extTimerQuery;let c=this.gpuTimers[n.id];c||(c=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),c.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,c.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}queryGpuTimers(n){const a={};for(const c in n){const p=n[c],g=this.context.extTimerQuery,b=g.getQueryObjectEXT(p.query,g.QUERY_RESULT_EXT)/1e6;g.deleteQueryEXT(p.query),a[c]=b}return a}translatePosMatrix(n,a,c,p,g){if(!c[0]&&!c[1])return n;const b=g?p==="map"?this.transform.angle:0:p==="viewport"?-this.transform.angle:0;if(b){const P=Math.sin(b),z=Math.cos(b);c=[c[0]*z-c[1]*P,c[0]*P+c[1]*z]}const E=[g?c[0]:rr(a,c[0],this.transform.zoom),g?c[1]:rr(a,c[1],this.transform.zoom),0],k=new Float32Array(16);return u.translate(k,n,E),k}saveTileTexture(n){const a=this._tileTextures[n.size[0]];a?a.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const a=this._tileTextures[n];return a&&a.length>0?a.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const a=this.imageManager.getPattern(n.from.toString()),c=this.imageManager.getPattern(n.to.toString());return!a||!c}useProgram(n,a){this.cache=this.cache||{};const c=n+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[c]||(this.cache[c]=new yu(this.context,n,sa[n],a,_n[n],this._showOverdrawInspector,this.style.terrain)),this.cache[c]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ce(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Fn{constructor(n,a){this.points=n,this.planes=a}static fromInvProjectionMatrix(n,a,c){const p=Math.pow(2,c),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const k=1/(E=u.transformMat4([],E,n))[3]/a*p;return u.mul$1(E,E,[k,k,1/E[3],k])}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const k=u.sub([],g[E[0]],g[E[1]]),P=u.sub([],g[E[2]],g[E[1]]),z=u.normalize([],u.cross([],k,P)),R=-u.dot(z,g[E[1]]);return z.concat(R)});return new Fn(g,b)}}class Bn{constructor(n,a){this.min=n,this.max=a,this.center=u.scale$1([],u.add([],this.min,this.max),.5)}quadrant(n){const a=[n%2==0,n<2],c=u.clone$2(this.min),p=u.clone$2(this.max);for(let g=0;g<a.length;g++)c[g]=a[g]?this.min[g]:this.center[g],p[g]=a[g]?this.center[g]:this.max[g];return p[2]=this.max[2],new Bn(c,p)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersects(n){const a=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let c=!0;for(let p=0;p<n.planes.length;p++){const g=n.planes[p];let b=0;for(let E=0;E<a.length;E++)u.dot$1(g,a[E])>=0&&b++;if(b===0)return 0;b!==a.length&&(c=!1)}if(c)return 2;for(let p=0;p<3;p++){let g=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(let E=0;E<n.points.length;E++){const k=n.points[E][p]-this.min[p];g=Math.min(g,k),b=Math.max(b,k)}if(b<0||g>this.max[p]-this.min[p])return 0}return 1}}class Ar{constructor(n=0,a=0,c=0,p=0){if(isNaN(n)||n<0||isNaN(a)||a<0||isNaN(c)||c<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=a,this.left=c,this.right=p}interpolate(n,a,c){return a.top!=null&&n.top!=null&&(this.top=u.number(n.top,a.top,c)),a.bottom!=null&&n.bottom!=null&&(this.bottom=u.number(n.bottom,a.bottom,c)),a.left!=null&&n.left!=null&&(this.left=u.number(n.left,a.left,c)),a.right!=null&&n.right!=null&&(this.right=u.number(n.right,a.right,c)),this}getCenter(n,a){const c=u.clamp((this.left+n-this.right)/2,0,n),p=u.clamp((this.top+a-this.bottom)/2,0,a);return new u.pointGeometry(c,p)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new Ar(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class jn{constructor(n,a,c,p,g){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=g===void 0||!!g,this._minZoom=n||0,this._maxZoom=a||22,this._minPitch=c==null?0:c,this._maxPitch=p==null?60:p,this.setMaxBounds(),this.width=0,this.height=0,this._center=new u.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ar,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const n=new jn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n._elevation=this._elevation,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(n){const a=-u.wrap(n,-180,180)*Math.PI/180;var c;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=(c=new u.ARRAY_TYPE(4),u.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c),function(p,g,b){var E=g[0],k=g[1],P=g[2],z=g[3],R=Math.sin(b),N=Math.cos(b);p[0]=E*N+P*R,p[1]=k*N+z*R,p[2]=E*-R+P*N,p[3]=k*-R+z*N}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const a=u.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(n){const a=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,a,c){this._unmodified=!1,this._edgeInsets.interpolate(n,a,c),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const a=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(n){const a=[new u.UnwrappedTileID(0,n)];if(this._renderWorldCopies){const c=this.pointCoordinate(new u.pointGeometry(0,0)),p=this.pointCoordinate(new u.pointGeometry(this.width,0)),g=this.pointCoordinate(new u.pointGeometry(this.width,this.height)),b=this.pointCoordinate(new u.pointGeometry(0,this.height)),E=Math.floor(Math.min(c.x,p.x,g.x,b.x)),k=Math.floor(Math.max(c.x,p.x,g.x,b.x)),P=1;for(let z=E-P;z<=k+P;z++)z!==0&&a.push(new u.UnwrappedTileID(z,n))}return a}coveringTiles(n){var a,c;let p=this.coveringZoomLevel(n);const g=p;if(n.minzoom!==void 0&&p<n.minzoom)return[];n.maxzoom!==void 0&&p>n.maxzoom&&(p=n.maxzoom);const b=this.pointCoordinate(this.getCameraPoint()),E=u.MercatorCoordinate.fromLngLat(this.center),k=Math.pow(2,p),P=[k*b.x,k*b.y,0],z=[k*E.x,k*E.y,0],R=Fn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p);let N=n.minzoom||0;!n.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(N=p);const X=n.terrain?2/Math.min(this.tileSize,n.tileSize)*this.tileSize:3,Z=Y=>({aabb:new Bn([Y*k,0,0],[(Y+1)*k,k,0]),zoom:0,x:0,y:0,wrap:Y,fullyVisible:!1}),H=[],le=[],de=p,ye=n.reparseOverscaled?g:p;if(this._renderWorldCopies)for(let Y=1;Y<=3;Y++)H.push(Z(-Y)),H.push(Z(Y));for(H.push(Z(0));H.length>0;){const Y=H.pop(),Se=Y.x,ve=Y.y;let De=Y.fullyVisible;if(!De){const pt=Y.aabb.intersects(R);if(pt===0)continue;De=pt===2}const Re=n.terrain?P:z,$e=Y.aabb.distanceX(Re),Pe=Y.aabb.distanceY(Re),ht=Math.max(Math.abs($e),Math.abs(Pe)),nt=X+(1<<de-Y.zoom)-2;if(Y.zoom===de||ht>nt&&Y.zoom>=N){const pt=de-Y.zoom,Vt=P[0]-.5-(Se<<pt),Wt=P[1]-.5-(ve<<pt);le.push({tileID:new u.OverscaledTileID(Y.zoom===de?ye:Y.zoom,Y.wrap,Y.zoom,Se,ve),distanceSq:u.sqrLen([z[0]-.5-Se,z[1]-.5-ve]),tileDistanceToCamera:Math.sqrt(Vt*Vt+Wt*Wt)})}else for(let pt=0;pt<4;pt++){const Vt=(Se<<1)+pt%2,Wt=(ve<<1)+(pt>>1),Ct=Y.zoom+1;let En=Y.aabb.quadrant(pt);if(n.terrain){const Tn=new u.OverscaledTileID(Ct,Y.wrap,Ct,Vt,Wt),un=n.terrain.getMinMaxElevation(Tn),cn=(a=un.minElevation)!==null&&a!==void 0?a:this.elevation,Cn=(c=un.maxElevation)!==null&&c!==void 0?c:this.elevation;En=new Bn([En.min[0],En.min[1],cn],[En.max[0],En.max[1],Cn])}H.push({aabb:En,zoom:Ct,x:Vt,y:Wt,wrap:Y.wrap,fullyVisible:De})}}return le.sort((Y,Se)=>Y.distanceSq-Se.distanceSq).map(Y=>Y.tileID)}resize(n,a){this.width=n,this.height=a,this.pixelsToGLUnits=[2/n,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const a=u.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new u.pointGeometry(u.mercatorXfromLng(n.lng)*this.worldSize,u.mercatorYfromLat(a)*this.worldSize)}unproject(n){return new u.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(n){this.freezeElevation||(this.elevation=n?this.getElevation(this._center,n):0)}getElevation(n,a){const c=u.MercatorCoordinate.fromLngLat(n),p=(1<<this.tileZoom)*u.EXTENT,g=c.x*p,b=c.y*p,E=Math.floor(g/u.EXTENT),k=Math.floor(b/u.EXTENT),P=new u.OverscaledTileID(this.tileZoom,0,this.tileZoom,E,k);return a.getElevation(P,g%u.EXTENT,b%u.EXTENT,u.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(n){const a=this.pointLocation(this.centerPoint,n),c=this.getElevation(a,n);if(!(this.elevation-c))return;const p=this.getCameraPosition(),g=u.MercatorCoordinate.fromLngLat(p.lngLat,p.altitude),b=u.MercatorCoordinate.fromLngLat(a,c),E=g.x-b.x,k=g.y-b.y,P=g.z-b.z,z=Math.sqrt(E*E+k*k+P*P),R=this.scaleZoom(this.cameraToCenterDistance/z/this.tileSize);this._elevation=c,this._center=a,this.zoom=R}setLocationAtPoint(n,a){const c=this.pointCoordinate(a),p=this.pointCoordinate(this.centerPoint),g=this.locationCoordinate(n),b=new u.MercatorCoordinate(g.x-(c.x-p.x),g.y-(c.y-p.y));this.center=this.coordinateLocation(b),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(n,a){return a?this.coordinatePoint(this.locationCoordinate(n),this.getElevation(n,a),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(n))}pointLocation(n,a){return this.coordinateLocation(this.pointCoordinate(n,a))}locationCoordinate(n){return u.MercatorCoordinate.fromLngLat(n)}coordinateLocation(n){return n&&n.toLngLat()}pointCoordinate(n,a){if(a){const N=a.pointCoordinate(n);if(N!=null)return N}const c=[n.x,n.y,0,1],p=[n.x,n.y,1,1];u.transformMat4(c,c,this.pixelMatrixInverse),u.transformMat4(p,p,this.pixelMatrixInverse);const g=c[3],b=p[3],E=c[1]/g,k=p[1]/b,P=c[2]/g,z=p[2]/b,R=P===z?0:(0-P)/(z-P);return new u.MercatorCoordinate(u.number(c[0]/g,p[0]/b,R)/this.worldSize,u.number(E,k,R)/this.worldSize)}coordinatePoint(n,a=0,c=this.pixelMatrix){const p=[n.x*this.worldSize,n.y*this.worldSize,a,1];return u.transformMat4(p,p,c),new u.pointGeometry(p[0]/p[3],p[1]/p[3])}getBounds(){const n=Math.max(0,this.height/2-this.getHorizon());return new u.LngLatBounds().extend(this.pointLocation(new u.pointGeometry(0,n))).extend(this.pointLocation(new u.pointGeometry(this.width,n))).extend(this.pointLocation(new u.pointGeometry(this.width,this.height))).extend(this.pointLocation(new u.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new u.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(n,a=!1){const c=n.key,p=a?this._alignedPosMatrixCache:this._posMatrixCache;if(p[c])return p[c];const g=n.canonical,b=this.worldSize/this.zoomScale(g.z),E=g.x+Math.pow(2,g.z)*n.wrap,k=u.identity(new Float64Array(16));return u.translate(k,k,[E*b,g.y*b,0]),u.scale(k,k,[b/u.EXTENT,b/u.EXTENT,1]),u.multiply(k,a?this.alignedProjMatrix:this.projMatrix,k),p[c]=new Float32Array(k),p[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let n,a,c,p,g=-90,b=90,E=-180,k=180;const P=this.size,z=this._unmodified;if(this.latRange){const X=this.latRange;g=u.mercatorYfromLat(X[1])*this.worldSize,b=u.mercatorYfromLat(X[0])*this.worldSize,n=b-g<P.y?P.y/(b-g):0}if(this.lngRange){const X=this.lngRange;E=u.wrap(u.mercatorXfromLng(X[0])*this.worldSize,0,this.worldSize),k=u.wrap(u.mercatorXfromLng(X[1])*this.worldSize,0,this.worldSize),k<E&&(k+=this.worldSize),a=k-E<P.x?P.x/(k-E):0}const R=this.point,N=Math.max(a||0,n||0);if(N)return this.center=this.unproject(new u.pointGeometry(a?(k+E)/2:R.x,n?(b+g)/2:R.y)),this.zoom+=this.scaleZoom(N),this._unmodified=z,void(this._constraining=!1);if(this.latRange){const X=R.y,Z=P.y/2;X-Z<g&&(p=g+Z),X+Z>b&&(p=b-Z)}if(this.lngRange){const X=(E+k)/2,Z=u.wrap(R.x,X-this.worldSize/2,X+this.worldSize/2),H=P.x/2;Z-H<E&&(c=E+H),Z+H>k&&(c=k-H)}c===void 0&&p===void 0||(this.center=this.unproject(new u.pointGeometry(c!==void 0?c:R.x,p!==void 0?p:R.y)).wrap()),this._unmodified=z,this._constraining=!1}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,a=this.point.x,c=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=u.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let p=u.identity(new Float64Array(16));u.scale(p,p,[this.width/2,-this.height/2,1]),u.translate(p,p,[1,-1,0]),this.labelPlaneMatrix=p,p=u.identity(new Float64Array(16)),u.scale(p,p,[1,-1,1]),u.translate(p,p,[-1,-1,0]),u.scale(p,p,[2/this.width,2/this.height,1]),this.glCoordMatrix=p,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const g=Math.PI/2+this._pitch,b=this._fov*(.5+n.y/this.height),E=Math.sin(b)*this.cameraToSeaLevelDistance/Math.sin(u.clamp(Math.PI-g-b,.01,Math.PI-.01)),k=this.getHorizon(),P=2*Math.atan(k/this.cameraToCenterDistance)*(.5+n.y/(2*k)),z=Math.sin(P)*this.cameraToSeaLevelDistance/Math.sin(u.clamp(Math.PI-g-P,.01,Math.PI-.01)),R=Math.cos(Math.PI/2-this._pitch)*E+this.cameraToSeaLevelDistance,N=Math.cos(Math.PI/2-this._pitch)*z+this.cameraToSeaLevelDistance,X=1.01*Math.min(R,N),Z=this.height/50;p=new Float64Array(16),u.perspective(p,this._fov,this.width/this.height,Z,X),p[8]=2*-n.x/this.width,p[9]=2*n.y/this.height,u.scale(p,p,[1,-1,1]),u.translate(p,p,[0,0,-this.cameraToCenterDistance]),u.rotateX(p,p,this._pitch),u.rotateZ(p,p,this.angle),u.translate(p,p,[-a,-c,0]),this.mercatorMatrix=u.scale([],p,[this.worldSize,this.worldSize,this.worldSize]),u.scale(p,p,[1,1,this._pixelPerMeter]),this.pixelMatrix=u.multiply(new Float64Array(16),this.labelPlaneMatrix,p),u.translate(p,p,[0,0,-this.elevation]),this.projMatrix=p,this.invProjMatrix=u.invert([],p),this.pixelMatrix3D=u.multiply(new Float64Array(16),this.labelPlaneMatrix,p);const H=this.width%2/2,le=this.height%2/2,de=Math.cos(this.angle),ye=Math.sin(this.angle),Y=a-Math.round(a)+de*H+ye*le,Se=c-Math.round(c)+de*le+ye*H,ve=new Float64Array(p);if(u.translate(ve,ve,[Y>.5?Y-1:Y,Se>.5?Se-1:Se,0]),this.alignedProjMatrix=ve,p=u.invert(new Float64Array(16),this.pixelMatrix),!p)throw new Error("failed to invert matrix");this.pixelMatrixInverse=p,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const n=this.pointCoordinate(new u.pointGeometry(0,0)),a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return u.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.pointGeometry(0,n))}getCameraQueryGeometry(n){const a=this.getCameraPoint();if(n.length===1)return[n[0],a];{let c=a.x,p=a.y,g=a.x,b=a.y;for(const E of n)c=Math.min(c,E.x),p=Math.min(p,E.y),g=Math.max(g,E.x),b=Math.max(b,E.y);return[new u.pointGeometry(c,p),new u.pointGeometry(g,p),new u.pointGeometry(g,b),new u.pointGeometry(c,b),new u.pointGeometry(c,p)]}}}class ir{constructor(n){this._hashName=n&&encodeURIComponent(n),u.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(a,c){let p=!1,g=null;const b=()=>{g=null,p&&(a(),g=setTimeout(b,300),p=!1)};return()=>(p=!0,g||b(),g)}(this._updateHashUnthrottled.bind(this))}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(n){const a=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,p=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,p),b=Math.round(a.lng*g)/g,E=Math.round(a.lat*g)/g,k=this._map.getBearing(),P=this._map.getPitch();let z="";if(z+=n?`/${b}/${E}/${c}`:`${c}/${E}/${b}`,(k||P)&&(z+="/"+Math.round(10*k)/10),P&&(z+=`/${Math.round(P)}`),this._hashName){const R=this._hashName;let N=!1;const X=window.location.hash.slice(1).split("&").map(Z=>{const H=Z.split("=")[0];return H===R?(N=!0,`${H}=${z}`):Z}).filter(Z=>Z);return N||X.push(`${R}=${z}`),`#${X.join("&")}`}return`#${z}`}_getCurrentHash(){const n=window.location.hash.replace("#","");if(this._hashName){let a;return n.split("&").map(c=>c.split("=")).forEach(c=>{c[0]===this._hashName&&(a=c)}),(a&&a[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._getCurrentHash();if(n.length>=3&&!n.some(a=>isNaN(a))){const a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:a,pitch:+(n[4]||0)}),!0}return!1}_updateHashUnthrottled(){const n=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,n)}catch{}}}const ei={linearity:.3,easing:u.bezier(0,0,.3,1)},eo=u.extend({deceleration:2500,maxSpeed:1400},ei),Mr=u.extend({deceleration:20,maxSpeed:1400},ei),to=u.extend({deceleration:1e3,maxSpeed:360},ei),Vi=u.extend({deceleration:1e3,maxSpeed:90},ei);class rs{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:u.exported.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,a=u.exported.now();for(;n.length>0&&a-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,pan:new u.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:g}of this._inertiaBuffer)a.zoom+=g.zoomDelta||0,a.bearing+=g.bearingDelta||0,a.pitch+=g.pitchDelta||0,g.panDelta&&a.pan._add(g.panDelta),g.around&&(a.around=g.around),g.pinchAround&&(a.pinchAround=g.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(a.pan.mag()){const g=To(a.pan.mag(),c,u.extend({},eo,n||{}));p.offset=a.pan.mult(g.amount/a.pan.mag()),p.center=this._map.transform.center,no(p,g)}if(a.zoom){const g=To(a.zoom,c,Mr);p.zoom=this._map.transform.zoom+g.amount,no(p,g)}if(a.bearing){const g=To(a.bearing,c,to);p.bearing=this._map.transform.bearing+u.clamp(g.amount,-179,179),no(p,g)}if(a.pitch){const g=To(a.pitch,c,Vi);p.pitch=this._map.transform.pitch+g.amount,no(p,g)}if(p.zoom||p.bearing){const g=a.pinchAround===void 0?a.around:a.pinchAround;p.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),u.extend(p,{noMoveStart:!0})}}function no(h,n){(!h.duration||h.duration<n.duration)&&(h.duration=n.duration,h.easing=n.easing)}function To(h,n,a){const{maxSpeed:c,linearity:p,deceleration:g}=a,b=u.clamp(h*p/(n/1e3),-c,c),E=Math.abs(b)/(g*p);return{easing:a.easing,duration:1e3*E,amount:b*(E/2)}}class ti extends u.Event{constructor(n,a,c,p={}){const g=G.mousePos(a.getCanvasContainer(),c),b=a.unproject(g);super(n,u.extend({point:g,lngLat:b,originalEvent:c},p)),this._defaultPrevented=!1,this.target=a}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class is extends u.Event{constructor(n,a,c){const p=n==="touchend"?c.changedTouches:c.touches,g=G.touchPos(a.getCanvasContainer(),p),b=g.map(k=>a.unproject(k)),E=g.reduce((k,P,z,R)=>k.add(P.div(R.length)),new u.pointGeometry(0,0));super(n,{points:g,point:E,lngLats:b,lngLat:a.unproject(E),originalEvent:c}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class gi extends u.Event{constructor(n,a,c){super(n,{originalEvent:c}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class In{constructor(n,a){this._map=n,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new gi(n.type,this._map,n))}mousedown(n,a){return this._mousedownPos=a,this._firePreventable(new ti(n.type,this._map,n))}mouseup(n){this._map.fire(new ti(n.type,this._map,n))}click(n,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new ti(n.type,this._map,n))}dblclick(n){return this._firePreventable(new ti(n.type,this._map,n))}mouseover(n){this._map.fire(new ti(n.type,this._map,n))}mouseout(n){this._map.fire(new ti(n.type,this._map,n))}touchstart(n){return this._firePreventable(new is(n.type,this._map,n))}touchmove(n){this._map.fire(new is(n.type,this._map,n))}touchend(n){this._map.fire(new is(n.type,this._map,n))}touchcancel(n){this._map.fire(new is(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class an{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new ti(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ti("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new ti(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class os{constructor(n,a){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,a){this.isEnabled()&&n.shiftKey&&n.button===0&&(G.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(n,a){if(!this._active)return;const c=a;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const p=this._startPos;this._lastPos=c,this._box||(this._box=G.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const g=Math.min(p.x,c.x),b=Math.max(p.x,c.x),E=Math.min(p.y,c.y),k=Math.max(p.y,c.y);G.setTransform(this._box,`translate(${g}px,${E}px)`),this._box.style.width=b-g+"px",this._box.style.height=k-E+"px"}mouseupWindow(n,a){if(!this._active||n.button!==0)return;const c=this._startPos,p=a;if(this.reset(),G.suppressClick(),c.x!==p.x||c.y!==p.y)return this._map.fire(new u.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:g=>g.fitScreenCoordinates(c,p,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(G.remove(this._box),this._box=null),G.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,a){return this._map.fire(new u.Event(n,{originalEvent:a}))}}function zr(h,n){if(h.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${h.length}, points ${n.length}`);const a={};for(let c=0;c<h.length;c++)a[h[c].identifier]=n[c];return a}class ha{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,a,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),c.length===this.numTouches&&(this.centroid=function(p){const g=new u.pointGeometry(0,0);for(const b of p)g._add(b);return g.div(p.length)}(a),this.touches=zr(c,a)))}touchmove(n,a,c){if(this.aborted||!this.centroid)return;const p=zr(c,a);for(const g in this.touches){const b=this.touches[g],E=p[g];(!E||E.dist(b)>30)&&(this.aborted=!0)}}touchend(n,a,c){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class ni{constructor(n){this.singleTap=new ha(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,a,c){this.singleTap.touchstart(n,a,c)}touchmove(n,a,c){this.singleTap.touchmove(n,a,c)}touchend(n,a,c){const p=this.singleTap.touchend(n,a,c);if(p){const g=n.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(p)<30;if(g&&b||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class ko{constructor(){this._zoomIn=new ni({numTouches:1,numTaps:2}),this._zoomOut=new ni({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,a,c){this._zoomIn.touchstart(n,a,c),this._zoomOut.touchstart(n,a,c)}touchmove(n,a,c){this._zoomIn.touchmove(n,a,c),this._zoomOut.touchmove(n,a,c)}touchend(n,a,c){const p=this._zoomIn.touchend(n,a,c),g=this._zoomOut.touchend(n,a,c);return p?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:b.getZoom()+1,around:b.unproject(p)},{originalEvent:n})}):g?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:b.getZoom()-1,around:b.unproject(g)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Go={0:1,2:2};class qo{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(n,a){return!1}_move(n,a){return{}}mousedown(n,a){if(this._lastPoint)return;const c=G.mouseButton(n);this._correctButton(n,c)&&(this._lastPoint=a,this._eventButton=c)}mousemoveWindow(n,a){const c=this._lastPoint;if(c){if(n.preventDefault(),function(p,g){const b=Go[g];return p.buttons===void 0||(p.buttons&b)!==b}(n,this._eventButton))this.reset();else if(this._moved||!(a.dist(c)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(c,a)}}mouseupWindow(n){this._lastPoint&&G.mouseButton(n)===this._eventButton&&(this._moved&&G.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zo extends qo{mousedown(n,a){super.mousedown(n,a),this._lastPoint&&(this._active=!0)}_correctButton(n,a){return a===0&&!n.ctrlKey}_move(n,a){return{around:a,panDelta:a.sub(n)}}}class ri extends qo{_correctButton(n,a){return a===0&&n.ctrlKey||a===2}_move(n,a){const c=.8*(a.x-n.x);if(c)return this._active=!0,{bearingDelta:c}}contextmenu(n){n.preventDefault()}}class lt extends qo{_correctButton(n,a){return a===0&&n.ctrlKey||a===2}_move(n,a){const c=-.5*(a.y-n.y);if(c)return this._active=!0,{pitchDelta:c}}contextmenu(n){n.preventDefault()}}class Ul{constructor(n,a){this._minTouches=n.cooperativeGestures?2:1,this._clickTolerance=n.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(n,a,c){return this._calculateTransform(n,a,c)}touchmove(n,a,c){if(this._map._cooperativeGestures&&(this._minTouches===2&&c.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(n,!1,c.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(c.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,a,c)}touchend(n,a,c){this._calculateTransform(n,a,c),this._active&&c.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,a,c){c.length>0&&(this._active=!0);const p=zr(c,a),g=new u.pointGeometry(0,0),b=new u.pointGeometry(0,0);let E=0;for(const P in p){const z=p[P],R=this._touches[P];R&&(g._add(z),b._add(z.sub(R)),E++,p[P]=z)}if(this._touches=p,E<this._minTouches||!b.mag())return;const k=b.div(E);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(E),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ro{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(n){}_move(n,a,c){return{}}touchstart(n,a,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([a[0],a[1]]))}touchmove(n,a,c){if(!this._firstTwoTouches)return;n.preventDefault();const[p,g]=this._firstTwoTouches,b=io(c,a,p),E=io(c,a,g);if(!b||!E)return;const k=this._aroundCenter?null:b.add(E).div(2);return this._move([b,E],k,n)}touchend(n,a,c){if(!this._firstTwoTouches)return;const[p,g]=this._firstTwoTouches,b=io(c,a,p),E=io(c,a,g);b&&E||(this._active&&G.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function io(h,n,a){for(let c=0;c<h.length;c++)if(h[c].identifier===a)return n[c]}function Fa(h,n){return Math.log(h/n)/Math.LN2}class tt extends ro{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,a){const c=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(Fa(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Fa(this._distance,c),pinchAround:a}}}function as(h,n){return 180*h.angleWith(n)/Math.PI}class js extends ro{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,a){const c=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:as(this._vector,c),pinchAround:a}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const a=25/(Math.PI*this._minDiameter)*360,c=as(n,this._startVector);return Math.abs(c)<a}}function Oa(h){return Math.abs(h.y)>Math.abs(h.x)}class xc extends ro{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,a,c){super.touchstart(n,a,c),this._currentTouchCount=c.length}_start(n){this._lastPoints=n,Oa(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,a,c){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const p=n[0].sub(this._lastPoints[0]),g=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,g,c.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(p.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(n,a,c){if(this._valid!==void 0)return this._valid;const p=n.mag()>=2,g=a.mag()>=2;if(!p&&!g)return;if(!p||!g)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const b=n.y>0==a.y>0;return Oa(n)&&Oa(a)&&b}}const Yh={panStep:100,bearingStep:15,pitchStep:10};class Kh{constructor(){const n=Yh;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let a=0,c=0,p=0,g=0,b=0;switch(n.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:n.shiftKey?c=-1:(n.preventDefault(),g=-1);break;case 39:n.shiftKey?c=1:(n.preventDefault(),g=1);break;case 38:n.shiftKey?p=1:(n.preventDefault(),b=-1);break;case 40:n.shiftKey?p=-1:(n.preventDefault(),b=1);break;default:return}return this._rotationDisabled&&(c=0,p=0),{cameraAnimation:E=>{const k=E.getZoom();E.easeTo({duration:300,easeId:"keyboardHandler",easing:yf,zoom:a?Math.round(k)+a*(n.shiftKey?2:1):k,bearing:E.getBearing()+c*this._bearingStep,pitch:E.getPitch()+p*this._pitchStep,offset:[-g*this._panStep,-b*this._panStep],center:E.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function yf(h){return h*(2-h)}const Jh=4.000244140625;class bc{constructor(n,a){this._map=n,this._el=n.getCanvasContainer(),this._handler=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,u.bindAll(["_onTimeout"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;n.preventDefault()}let a=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const c=u.exported.now(),p=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,a!==0&&a%Jh==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(p*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),n.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=n,this._delta-=a,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=G.mousePos(this._el,n);this._around=u.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform;if(this._delta!==0){const E=this._type==="wheel"&&Math.abs(this._delta)>Jh?this._wheelZoomRate:this._defaultZoomRate;let k=2/(1+Math.exp(-Math.abs(this._delta*E)));this._delta<0&&k!==0&&(k=1/k);const P=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(P*k))),this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom=="number"?this._targetZoom:n.zoom,c=this._startZoom,p=this._easing;let g,b=!1;if(this._type==="wheel"&&c&&p){const E=Math.min((u.exported.now()-this._lastWheelEventTime)/200,1),k=p(E);g=u.number(c,a,k),E<1?this._frameId||(this._frameId=!0):b=!0}else g=a,b=!0;return this._active=!0,b&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!b,zoomDelta:g-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let a=u.ease;if(this._prevEase){const c=this._prevEase,p=(u.exported.now()-c.start)/c.duration,g=c.easing(p+.01)-c.easing(p),b=.27/Math.sqrt(g*g+1e-4)*.01,E=Math.sqrt(.0729-b*b);a=u.bezier(b,E,.25,1)}return this._prevEase={start:u.exported.now(),duration:n,easing:a},a}reset(){this._active=!1}}class wc{constructor(n,a){this._clickZoom=n,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Sc{constructor(){this.reset()}reset(){this._active=!1}dblclick(n,a){return n.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:c.getZoom()+(n.shiftKey?-1:1),around:c.unproject(a)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ec{constructor(){this._tap=new ni({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(n,a,c){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?c.length>0&&(this._swipePoint=a[0],this._swipeTouch=c[0].identifier):this._tap.touchstart(n,a,c))}touchmove(n,a,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const p=a[0],g=p.y-this._swipePoint.y;return this._swipePoint=p,n.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(n,a,c)}touchend(n,a,c){this._tapTime?this._swipePoint&&c.length===0&&this.reset():this._tap.touchend(n,a,c)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pi{constructor(n,a,c){this._el=n,this._mousePan=a,this._touchPan=c}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ba{constructor(n,a,c){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=a,this._mousePitch=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Qh{constructor(n,a,c,p){this._el=n,this._touchZoom=a,this._touchRotate=c,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Gs=h=>h.zoom||h.drag||h.pitch||h.rotate;class Tc extends u.Event{}function Vl(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class ed{constructor(n,a){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new rs(n),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a),u.bindAll(["handleEvent","handleWindowEvent"],this);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,g,b]of this._listeners)G.addEventListener(p,g,p===document?this.handleWindowEvent:this.handleEvent,b)}destroy(){for(const[n,a,c]of this._listeners)G.removeEventListener(n,a,n===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(n){const a=this._map,c=a.getCanvasContainer();this._add("mapEvent",new In(a,n));const p=a.boxZoom=new os(a,n);this._add("boxZoom",p);const g=new ko,b=new Sc;a.doubleClickZoom=new wc(b,g),this._add("tapZoom",g),this._add("clickZoom",b);const E=new Ec;this._add("tapDragZoom",E);const k=a.touchPitch=new xc(a);this._add("touchPitch",k);const P=new ri(n),z=new lt(n);a.dragRotate=new Ba(n,P,z),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]);const R=new Zo(n),N=new Ul(n,a);a.dragPan=new Pi(c,R,N),this._add("mousePan",R),this._add("touchPan",N,["touchZoom","touchRotate"]);const X=new js,Z=new tt;a.touchZoomRotate=new Qh(c,Z,X,E),this._add("touchRotate",X,["touchPan","touchZoom"]),this._add("touchZoom",Z,["touchPan","touchRotate"]);const H=a.scrollZoom=new bc(a,this);this._add("scrollZoom",H,["mousePan"]);const le=a.keyboard=new Kh;this._add("keyboard",le),this._add("blockableMapEvent",new an(a));for(const de of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[de]&&a[de].enable(n[de])}_add(n,a,c){this._handlers.push({handlerName:n,handler:a,allowed:c}),this._handlersById[n]=a}stop(n){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Gs(this._eventsInProgress))||this.isZooming()}_blockedByActive(n,a,c){for(const p in n)if(p!==c&&(!a||a.indexOf(p)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const a=[];for(const c of n)this._el.contains(c.target)&&a.push(c);return a}handleEvent(n,a){if(n.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const c=n.type==="renderFrame"?void 0:n,p={needsRenderFrame:!1},g={},b={},E=n.touches,k=E?this._getMapTouches(E):void 0,P=k?G.touchPos(this._el,k):G.mousePos(this._el,n);for(const{handlerName:N,handler:X,allowed:Z}of this._handlers){if(!X.isEnabled())continue;let H;this._blockedByActive(b,Z,N)?X.reset():X[a||n.type]&&(H=X[a||n.type](n,P,k),this.mergeHandlerResult(p,g,H,N,c),H&&H.needsRenderFrame&&this._triggerRenderFrame()),(H||X.isActive())&&(b[N]=X)}const z={};for(const N in this._previousActiveHandlers)b[N]||(z[N]=c);this._previousActiveHandlers=b,(Object.keys(z).length||Vl(p))&&(this._changes.push([p,g,z]),this._triggerRenderFrame()),(Object.keys(b).length||Vl(p))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:R}=p;R&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],R(this._map))}mergeHandlerResult(n,a,c,p,g){if(!c)return;u.extend(n,c);const b={handlerName:p,originalEvent:c.originalEvent||g};c.zoomDelta!==void 0&&(a.zoom=b),c.panDelta!==void 0&&(a.drag=b),c.pitchDelta!==void 0&&(a.pitch=b),c.bearingDelta!==void 0&&(a.rotate=b)}_applyChanges(){const n={},a={},c={};for(const[p,g,b]of this._changes)p.panDelta&&(n.panDelta=(n.panDelta||new u.pointGeometry(0,0))._add(p.panDelta)),p.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+p.pitchDelta),p.around!==void 0&&(n.around=p.around),p.pinchAround!==void 0&&(n.pinchAround=p.pinchAround),p.noInertia&&(n.noInertia=p.noInertia),u.extend(a,g),u.extend(c,b);this._updateMapTransform(n,a,c),this._changes=[]}_updateMapTransform(n,a,c){const p=this._map,g=p.transform,b=p.style&&p.style.terrain;if(!(Vl(n)||b&&this._drag))return this._fireEvents(a,c,!0);let{panDelta:E,zoomDelta:k,bearingDelta:P,pitchDelta:z,around:R,pinchAround:N}=n;N!==void 0&&(R=N),p._stop(!0),R=R||p.transform.centerPoint;const X=g.pointLocation(E?R.sub(E):R);P&&(g.bearing+=P),z&&(g.pitch+=z),k&&(g.zoom+=k),b?a.drag&&!this._drag?(this._drag={center:g.centerPoint,lngLat:g.pointLocation(R),point:R,handlerName:a.drag.handlerName},p.fire(new u.Event("freezeElevation",{freeze:!0}))):this._drag&&c[this._drag.handlerName]?(p.fire(new u.Event("freezeElevation",{freeze:!1})),this._drag=null):a.drag&&this._drag&&(g.center=g.pointLocation(g.centerPoint.sub(E))):g.setLocationAtPoint(X,R),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(a,c,!0)}_fireEvents(n,a,c){const p=Gs(this._eventsInProgress),g=Gs(n),b={};for(const z in n){const{originalEvent:R}=n[z];this._eventsInProgress[z]||(b[`${z}start`]=R),this._eventsInProgress[z]=n[z]}!p&&g&&this._fireEvent("movestart",g.originalEvent);for(const z in b)this._fireEvent(z,b[z]);g&&this._fireEvent("move",g.originalEvent);for(const z in n){const{originalEvent:R}=n[z];this._fireEvent(z,R)}const E={};let k;for(const z in this._eventsInProgress){const{handlerName:R,originalEvent:N}=this._eventsInProgress[z];this._handlersById[R].isActive()||(delete this._eventsInProgress[z],k=a[R]||N,E[`${z}end`]=k)}for(const z in E)this._fireEvent(z,E[z]);const P=Gs(this._eventsInProgress);if(c&&(p||g)&&!P){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),R=N=>N!==0&&-this._bearingSnap<N&&N<this._bearingSnap;z?(R(z.bearing||this._map.getBearing())&&(z.bearing=0),this._map.easeTo(z,{originalEvent:k})):(this._map.fire(new u.Event("moveend",{originalEvent:k})),R(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,a){this._map.fire(new u.Event(n,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new Tc("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const oo={extend:(h,...n)=>u.extend(h,...n),run(h){h()},logToElement(h,n=!1,a="log"){const c=window.document.getElementById(a);c&&(n&&(c.innerHTML=""),c.innerHTML+=`<br>${h}`)}};class Gn extends u.Evented{constructor(n,a){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=a.bearingSnap,u.bindAll(["_renderFrameCallback"],this)}getCenter(){return new u.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(n,a){return this.jumpTo({center:n},a)}panBy(n,a,c){return n=u.pointGeometry.convert(n).mult(-1),this.panTo(this.transform.center,u.extend({offset:n},a),c)}panTo(n,a,c){return this.easeTo(u.extend({center:n},a),c)}getZoom(){return this.transform.zoom}setZoom(n,a){return this.jumpTo({zoom:n},a),this}zoomTo(n,a,c){return this.easeTo(u.extend({zoom:n},a),c)}zoomIn(n,a){return this.zoomTo(this.getZoom()+1,n,a),this}zoomOut(n,a){return this.zoomTo(this.getZoom()-1,n,a),this}getBearing(){return this.transform.bearing}setBearing(n,a){return this.jumpTo({bearing:n},a),this}getPadding(){return this.transform.padding}setPadding(n,a){return this.jumpTo({padding:n},a),this}rotateTo(n,a,c){return this.easeTo(u.extend({bearing:n},a),c)}resetNorth(n,a){return this.rotateTo(0,u.extend({duration:1e3},n),a),this}resetNorthPitch(n,a){return this.easeTo(u.extend({bearing:0,pitch:0,duration:1e3},n),a),this}snapToNorth(n,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,a):this}getPitch(){return this.transform.pitch}setPitch(n,a){return this.jumpTo({pitch:n},a),this}cameraForBounds(n,a){n=u.LngLatBounds.convert(n);const c=a&&a.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),c,a)}_cameraForBoxAndBearing(n,a,c,p){const g={top:0,bottom:0,right:0,left:0};if(typeof(p=u.extend({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},p)).padding=="number"){const ve=p.padding;p.padding={top:ve,bottom:ve,right:ve,left:ve}}p.padding=u.extend(g,p.padding);const b=this.transform,E=b.padding,k=b.project(u.LngLat.convert(n)),P=b.project(u.LngLat.convert(a)),z=k.rotate(-c*Math.PI/180),R=P.rotate(-c*Math.PI/180),N=new u.pointGeometry(Math.max(z.x,R.x),Math.max(z.y,R.y)),X=new u.pointGeometry(Math.min(z.x,R.x),Math.min(z.y,R.y)),Z=N.sub(X),H=(b.width-(E.left+E.right+p.padding.left+p.padding.right))/Z.x,le=(b.height-(E.top+E.bottom+p.padding.top+p.padding.bottom))/Z.y;if(le<0||H<0)return void u.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const de=Math.min(b.scaleZoom(b.scale*Math.min(H,le)),p.maxZoom),ye=u.pointGeometry.convert(p.offset),Y=new u.pointGeometry((p.padding.left-p.padding.right)/2,(p.padding.top-p.padding.bottom)/2).rotate(c*Math.PI/180),Se=ye.add(Y).mult(b.scale/b.zoomScale(de));return{center:b.unproject(k.add(P).div(2).sub(Se)),zoom:de,bearing:c}}fitBounds(n,a,c){return this._fitInternal(this.cameraForBounds(n,a),a,c)}fitScreenCoordinates(n,a,c,p,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(u.pointGeometry.convert(n)),this.transform.pointLocation(u.pointGeometry.convert(a)),c,p),p,g)}_fitInternal(n,a,c){return n?(delete(a=u.extend(n,a)).padding,a.linear?this.easeTo(a,c):this.flyTo(a,c)):this}jumpTo(n,a){this.stop();const c=this.transform;let p=!1,g=!1,b=!1;return"zoom"in n&&c.zoom!==+n.zoom&&(p=!0,c.zoom=+n.zoom),n.center!==void 0&&(c.center=u.LngLat.convert(n.center)),"bearing"in n&&c.bearing!==+n.bearing&&(g=!0,c.bearing=+n.bearing),"pitch"in n&&c.pitch!==+n.pitch&&(b=!0,c.pitch=+n.pitch),n.padding==null||c.isPaddingEqual(n.padding)||(c.padding=n.padding),this.fire(new u.Event("movestart",a)).fire(new u.Event("move",a)),p&&this.fire(new u.Event("zoomstart",a)).fire(new u.Event("zoom",a)).fire(new u.Event("zoomend",a)),g&&this.fire(new u.Event("rotatestart",a)).fire(new u.Event("rotate",a)).fire(new u.Event("rotateend",a)),b&&this.fire(new u.Event("pitchstart",a)).fire(new u.Event("pitch",a)).fire(new u.Event("pitchend",a)),this.fire(new u.Event("moveend",a))}calculateCameraOptionsFromTo(n,a,c,p=0){const g=u.MercatorCoordinate.fromLngLat(n,a),b=u.MercatorCoordinate.fromLngLat(c,p),E=b.x-g.x,k=b.y-g.y,P=b.z-g.z,z=Math.hypot(E,k,P);if(z===0)throw new Error("Can't calculate camera options with same From and To");const R=Math.hypot(E,k),N=this.transform.scaleZoom(this.transform.cameraToCenterDistance/z/this.transform.tileSize),X=180*Math.atan2(E,-k)/Math.PI;let Z=180*Math.acos(R/z)/Math.PI;return Z=P<0?90-Z:90+Z,{center:b.toLngLat(),zoom:N,pitch:Z,bearing:X}}easeTo(n,a){this._stop(!1,n.easeId),((n=u.extend({offset:[0,0],duration:500,easing:u.ease},n)).animate===!1||!n.essential&&u.exported.prefersReducedMotion)&&(n.duration=0);const c=this.transform,p=this.getZoom(),g=this.getBearing(),b=this.getPitch(),E=this.getPadding(),k="zoom"in n?+n.zoom:p,P="bearing"in n?this._normalizeBearing(n.bearing,g):g,z="pitch"in n?+n.pitch:b,R="padding"in n?n.padding:c.padding,N=u.pointGeometry.convert(n.offset);let X=c.centerPoint.add(N);const Z=c.pointLocation(X),H=u.LngLat.convert(n.center||Z);this._normalizeCenter(H);const le=c.project(Z),de=c.project(H).sub(le),ye=c.zoomScale(k-p);let Y,Se;n.around&&(Y=u.LngLat.convert(n.around),Se=c.locationPoint(Y));const ve={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||k!==p,this._rotating=this._rotating||g!==P,this._pitching=this._pitching||z!==b,this._padding=!c.isPaddingEqual(R),this._easeId=n.easeId,this._prepareEase(a,n.noMoveStart,ve),this._ease(De=>{if(this._zooming&&(c.zoom=u.number(p,k,De)),this._rotating&&(c.bearing=u.number(g,P,De)),this._pitching&&(c.pitch=u.number(b,z,De)),this._padding&&(c.interpolatePadding(E,R,De),X=c.centerPoint.add(N)),Y)c.setLocationAtPoint(Y,Se);else{const Re=c.zoomScale(c.zoom-p),$e=k>p?Math.min(2,ye):Math.max(.5,ye),Pe=Math.pow($e,1-De),ht=c.unproject(le.add(de.mult(De*Pe)).mult(Re));c.setLocationAtPoint(c.renderWorldCopies?ht.wrap():ht,X)}this._fireMoveEvents(a)},De=>{this._afterEase(a,De)},n),this}_prepareEase(n,a,c={}){this._moving=!0,this.fire(new u.Event("freezeElevation",{freeze:!0})),a||c.moving||this.fire(new u.Event("movestart",n)),this._zooming&&!c.zooming&&this.fire(new u.Event("zoomstart",n)),this._rotating&&!c.rotating&&this.fire(new u.Event("rotatestart",n)),this._pitching&&!c.pitching&&this.fire(new u.Event("pitchstart",n))}_fireMoveEvents(n){this.fire(new u.Event("move",n)),this._zooming&&this.fire(new u.Event("zoom",n)),this._rotating&&this.fire(new u.Event("rotate",n)),this._pitching&&this.fire(new u.Event("pitch",n))}_afterEase(n,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId,this.fire(new u.Event("freezeElevation",{freeze:!1}));const c=this._zooming,p=this._rotating,g=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,c&&this.fire(new u.Event("zoomend",n)),p&&this.fire(new u.Event("rotateend",n)),g&&this.fire(new u.Event("pitchend",n)),this.fire(new u.Event("moveend",n))}flyTo(n,a){if(!n.essential&&u.exported.prefersReducedMotion){const Ct=u.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ct,a)}this.stop(),n=u.extend({offset:[0,0],speed:1.2,curve:1.42,easing:u.ease},n);const c=this.transform,p=this.getZoom(),g=this.getBearing(),b=this.getPitch(),E=this.getPadding(),k="zoom"in n?u.clamp(+n.zoom,c.minZoom,c.maxZoom):p,P="bearing"in n?this._normalizeBearing(n.bearing,g):g,z="pitch"in n?+n.pitch:b,R="padding"in n?n.padding:c.padding,N=c.zoomScale(k-p),X=u.pointGeometry.convert(n.offset);let Z=c.centerPoint.add(X);const H=c.pointLocation(Z),le=u.LngLat.convert(n.center||H);this._normalizeCenter(le);const de=c.project(H),ye=c.project(le).sub(de);let Y=n.curve;const Se=Math.max(c.width,c.height),ve=Se/N,De=ye.mag();if("minZoom"in n){const Ct=u.clamp(Math.min(n.minZoom,p,k),c.minZoom,c.maxZoom),En=Se/c.zoomScale(Ct-p);Y=Math.sqrt(En/De*2)}const Re=Y*Y;function $e(Ct){const En=(ve*ve-Se*Se+(Ct?-1:1)*Re*Re*De*De)/(2*(Ct?ve:Se)*Re*De);return Math.log(Math.sqrt(En*En+1)-En)}function Pe(Ct){return(Math.exp(Ct)-Math.exp(-Ct))/2}function ht(Ct){return(Math.exp(Ct)+Math.exp(-Ct))/2}const nt=$e(0);let pt=function(Ct){return ht(nt)/ht(nt+Y*Ct)},Vt=function(Ct){return Se*((ht(nt)*(Pe(En=nt+Y*Ct)/ht(En))-Pe(nt))/Re)/De;var En},Wt=($e(1)-nt)/Y;if(Math.abs(De)<1e-6||!isFinite(Wt)){if(Math.abs(Se-ve)<1e-6)return this.easeTo(n,a);const Ct=ve<Se?-1:1;Wt=Math.abs(Math.log(ve/Se))/Y,Vt=function(){return 0},pt=function(En){return Math.exp(Ct*Y*En)}}return n.duration="duration"in n?+n.duration:1e3*Wt/("screenSpeed"in n?+n.screenSpeed/Y:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=g!==P,this._pitching=z!==b,this._padding=!c.isPaddingEqual(R),this._prepareEase(a,!1),this._ease(Ct=>{const En=Ct*Wt,Tn=1/pt(En);c.zoom=Ct===1?k:p+c.scaleZoom(Tn),this._rotating&&(c.bearing=u.number(g,P,Ct)),this._pitching&&(c.pitch=u.number(b,z,Ct)),this._padding&&(c.interpolatePadding(E,R,Ct),Z=c.centerPoint.add(X));const un=Ct===1?le:c.unproject(de.add(ye.mult(Vt(En))).mult(Tn));c.setLocationAtPoint(c.renderWorldCopies?un.wrap():un,Z),this._fireMoveEvents(a)},()=>this._afterEase(a),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,a){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const c=this._onEaseEnd;delete this._onEaseEnd,c.call(this,a)}if(!n){const c=this.handlers;c&&c.stop(!1)}return this}_ease(n,a,c){c.animate===!1||c.duration===0?(n(1),a()):(this._easeStart=u.exported.now(),this._easeOptions=c,this._onEaseFrame=n,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((u.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,a){n=u.wrap(n,-180,180);const c=Math.abs(n-a);return Math.abs(n-360-a)<c&&(n-=360),Math.abs(n+360-a)<c&&(n+=360),n}_normalizeCenter(n){const a=this.transform;if(!a.renderWorldCopies||a.lngRange)return;const c=n.lng-a.center.lng;n.lng+=c>180?-360:c<-180?360:0}}class $l{constructor(n={}){this.options=n,u.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options&&this.options.compact,this._container=G.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=G.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=G.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){G.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,a){const c=this._map._getUIString(`AttributionControl.${a}`);n.title=c,n.setAttribute("aria-label",c)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"&&n.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(p=>typeof p!="string"?"":p)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const a=this._map.style.sourceCaches;for(const p in a){const g=a[p];if(g.used||g.usedForTerrain){const b=g.getSource();b.attribution&&n.indexOf(b.attribution)<0&&n.push(b.attribution)}}n=n.filter(p=>String(p).trim()),n.sort((p,g)=>p.length-g.length),n=n.filter((p,g)=>{for(let b=g+1;b<n.length;b++)if(n[b].indexOf(p)>=0)return!1;return!0});const c=n.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,n.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Eu{constructor(n={}){this.options=n,u.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=G.create("div","maplibregl-ctrl mapboxgl-ctrl");const a=G.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){G.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const n=this._container.children;if(n.length){const a=n[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&a.classList.add("maplibregl-compact","mapboxgl-compact"):a.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class td{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const a=++this._id;return this._queue.push({callback:n,id:a,cancelled:!1}),a}remove(n){const a=this._currentlyRunning,c=a?this._queue.concat(a):this._queue;for(const p of c)if(p.id===n)return void(p.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const c of a)if(!c.cancelled&&(c.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const nd={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},rd={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},_f={showCompass:!0,showZoom:!0,visualizePitch:!1};class Wo{constructor(n,a,c=!1){this._clickTolerance=10,this.element=a,this.mouseRotate=new ri({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,c&&(this.mousePitch=new lt({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),u.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),G.addEventListener(a,"mousedown",this.mousedown),G.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),G.addEventListener(a,"touchmove",this.touchmove),G.addEventListener(a,"touchend",this.touchend),G.addEventListener(a,"touchcancel",this.reset)}down(n,a){this.mouseRotate.mousedown(n,a),this.mousePitch&&this.mousePitch.mousedown(n,a),G.disableDrag()}move(n,a){const c=this.map,p=this.mouseRotate.mousemoveWindow(n,a);if(p&&p.bearingDelta&&c.setBearing(c.getBearing()+p.bearingDelta),this.mousePitch){const g=this.mousePitch.mousemoveWindow(n,a);g&&g.pitchDelta&&c.setPitch(c.getPitch()+g.pitchDelta)}}off(){const n=this.element;G.removeEventListener(n,"mousedown",this.mousedown),G.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),G.removeEventListener(n,"touchmove",this.touchmove),G.removeEventListener(n,"touchend",this.touchend),G.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){G.enableDrag(),G.removeEventListener(window,"mousemove",this.mousemove),G.removeEventListener(window,"mouseup",this.mouseup)}mousedown(n){this.down(u.extend({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),G.mousePos(this.element,n)),G.addEventListener(window,"mousemove",this.mousemove),G.addEventListener(window,"mouseup",this.mouseup)}mousemove(n){this.move(n,G.mousePos(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=G.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=G.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function jl(h,n,a){if(h=new u.LngLat(h.lng,h.lat),n){const c=new u.LngLat(h.lng-360,h.lat),p=new u.LngLat(h.lng+360,h.lat),g=a.locationPoint(h).distSqr(n);a.locationPoint(c).distSqr(n)<g?h=c:a.locationPoint(p).distSqr(n)<g&&(h=p)}for(;Math.abs(h.lng-a.center.lng)>180;){const c=a.locationPoint(h);if(c.x>=0&&c.y>=0&&c.x<=a.width&&c.y<=a.height)break;h.lng>a.center.lng?h.lng-=360:h.lng+=360}return h}const bt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Lt(h,n,a){const c=h.classList;for(const p in bt)c.remove(`maplibregl-${a}-anchor-${p}`,`mapboxgl-${a}-anchor-${p}`);c.add(`maplibregl-${a}-anchor-${n}`,`mapboxgl-${a}-anchor-${n}`)}class qs extends u.Evented{constructor(n,a){if(super(),(n instanceof HTMLElement||a)&&(n=u.extend({element:n},a)),u.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=u.pointGeometry.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=G.create("div"),this._element.setAttribute("aria-label","Map marker");const c=G.createNS("http://www.w3.org/2000/svg","svg"),p=41,g=27;c.setAttributeNS(null,"display","block"),c.setAttributeNS(null,"height",`${p}px`),c.setAttributeNS(null,"width",`${g}px`),c.setAttributeNS(null,"viewBox",`0 0 ${g} ${p}`);const b=G.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"stroke","none"),b.setAttributeNS(null,"stroke-width","1"),b.setAttributeNS(null,"fill","none"),b.setAttributeNS(null,"fill-rule","evenodd");const E=G.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const k=G.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");const P=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ye of P){const Y=G.createNS("http://www.w3.org/2000/svg","ellipse");Y.setAttributeNS(null,"opacity","0.04"),Y.setAttributeNS(null,"cx","10.5"),Y.setAttributeNS(null,"cy","5.80029008"),Y.setAttributeNS(null,"rx",ye.rx),Y.setAttributeNS(null,"ry",ye.ry),k.appendChild(Y)}const z=G.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill",this._color);const R=G.createNS("http://www.w3.org/2000/svg","path");R.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),z.appendChild(R);const N=G.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"opacity","0.25"),N.setAttributeNS(null,"fill","#000000");const X=G.createNS("http://www.w3.org/2000/svg","path");X.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),N.appendChild(X);const Z=G.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Z.setAttributeNS(null,"fill","#FFFFFF");const H=G.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(8.0, 8.0)");const le=G.createNS("http://www.w3.org/2000/svg","circle");le.setAttributeNS(null,"fill","#000000"),le.setAttributeNS(null,"opacity","0.25"),le.setAttributeNS(null,"cx","5.5"),le.setAttributeNS(null,"cy","5.5"),le.setAttributeNS(null,"r","5.4999962");const de=G.createNS("http://www.w3.org/2000/svg","circle");de.setAttributeNS(null,"fill","#FFFFFF"),de.setAttributeNS(null,"cx","5.5"),de.setAttributeNS(null,"cy","5.5"),de.setAttributeNS(null,"r","5.4999962"),H.appendChild(le),H.appendChild(de),E.appendChild(k),E.appendChild(z),E.appendChild(N),E.appendChild(Z),E.appendChild(H),c.appendChild(E),c.setAttributeNS(null,"height",p*this._scale+"px"),c.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(c),this._offset=u.pointGeometry.convert(n&&n.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",c=>{c.preventDefault()}),this._element.addEventListener("mousedown",c=>{c.preventDefault()}),Lt(this._element,this._anchor,"marker"),this._popup=null}addTo(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),G.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=u.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const p=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(n){const a=n.code,c=n.charCode||n.keyCode;a!=="Space"&&a!=="Enter"&&c!==32&&c!==13||this.togglePopup()}_onMapClick(n){const a=n.originalEvent.target,c=this._element;this._popup&&(a===c||c.contains(a))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this}_update(n){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=jl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let a="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?a=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(a=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let c="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?c="rotateX(0deg)":this._pitchAlignment==="map"&&(c=`rotateX(${this._map.getPitch()}deg)`),n&&n.type!=="moveend"||(this._pos=this._pos.round()),G.setTransform(this._element,`${bt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${c} ${a}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const p=this._map.unproject(this._pos),g=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=p.distanceTo(this._lngLat)>20*g?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(n){return this._offset=u.pointGeometry.convert(n),this._update(),this}_onMove(n){if(!this._isDragging){const a=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=a}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.Event("dragstart"))),this.fire(new u.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.Event("dragend")),this._state="inactive"}_addDragHandler(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const kc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Na,qr=0,Ua=!1;const Ho={maxWidth:100,unit:"metric"};function id(h,n,a){const c=a&&a.maxWidth||100,p=h._container.clientHeight/2,g=h.unproject([0,p]),b=h.unproject([c,p]),E=g.distanceTo(b);if(a&&a.unit==="imperial"){const k=3.2808*E;k>5280?Va(n,c,k/5280,h._getUIString("ScaleControl.Miles")):Va(n,c,k,h._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?Va(n,c,E/1852,h._getUIString("ScaleControl.NauticalMiles")):E>=1e3?Va(n,c,E/1e3,h._getUIString("ScaleControl.Kilometers")):Va(n,c,E,h._getUIString("ScaleControl.Meters"))}function Va(h,n,a,c){const p=function(g){const b=Math.pow(10,`${Math.floor(g)}`.length-1);let E=g/b;return E=E>=10?10:E>=5?5:E>=3?3:E>=2?2:E>=1?1:function(k){const P=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*P)/P}(E),b*E}(a);h.style.width=n*(p/a)+"px",h.innerHTML=`${p}&nbsp;${c}`}const or={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},gr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Cc(h){if(h){if(typeof h=="number"){const n=Math.round(Math.sqrt(.5*Math.pow(h,2)));return{center:new u.pointGeometry(0,0),top:new u.pointGeometry(0,h),"top-left":new u.pointGeometry(n,n),"top-right":new u.pointGeometry(-n,n),bottom:new u.pointGeometry(0,-h),"bottom-left":new u.pointGeometry(n,-n),"bottom-right":new u.pointGeometry(-n,-n),left:new u.pointGeometry(h,0),right:new u.pointGeometry(-h,0)}}if(h instanceof u.pointGeometry||Array.isArray(h)){const n=u.pointGeometry.convert(h);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:u.pointGeometry.convert(h.center||[0,0]),top:u.pointGeometry.convert(h.top||[0,0]),"top-left":u.pointGeometry.convert(h["top-left"]||[0,0]),"top-right":u.pointGeometry.convert(h["top-right"]||[0,0]),bottom:u.pointGeometry.convert(h.bottom||[0,0]),"bottom-left":u.pointGeometry.convert(h["bottom-left"]||[0,0]),"bottom-right":u.pointGeometry.convert(h["bottom-right"]||[0,0]),left:u.pointGeometry.convert(h.left||[0,0]),right:u.pointGeometry.convert(h.right||[0,0])}}return Cc(new u.pointGeometry(0,0))}const ss={supported:F,setRTLTextPlugin:u.setRTLTextPlugin,getRTLTextPluginStatus:u.getRTLTextPluginStatus,Map:class extends Gn{constructor(h){var n;if(u.PerformanceUtils.mark(u.PerformanceMarkers.create),(h=u.extend({},rd,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new jn(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),{bearingSnap:h.bearingSnap}),this._interactive=h.interactive,this._cooperativeGestures=h.cooperativeGestures,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._crossSourceCollisions=h.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=h.collectResourceTiming,this._renderTaskQueue=new td,this._controls=[],this._mapId=u.uniqueId(),this._locale=u.extend({},nd,h.locale),this._clickTolerance=h.clickTolerance,this._pixelRatio=(n=h.pixelRatio)!==null&&n!==void 0?n:devicePixelRatio,this._requestManager=new we(h.transformRequest),typeof h.container=="string"){if(this._container=document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(h.maxBounds&&this.setMaxBounds(h.maxBounds),u.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new ed(this,h),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=h.hash&&new ir(typeof h.hash=="string"&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,u.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localIdeographFontFamily:h.localIdeographFontFamily}),h.attributionControl&&this.addControl(new $l({customAttribution:h.customAttribution})),h.maplibreLogo&&this.addControl(new Eu,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new u.Event(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new u.Event(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new u.Event("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(h,n){if(n===void 0&&(n=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=h.onAdd(this);this._controls.push(h);const c=this._controlPositions[n];return n.indexOf("bottom")!==-1?c.insertBefore(a,c.firstChild):c.appendChild(a),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(h);return n>-1&&this._controls.splice(n,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}calculateCameraOptionsFromTo(h,n,a,c){return c==null&&this.style.terrain&&(c=this.transform.getElevation(a,this.style.terrain)),super.calculateCameraOptionsFromTo(h,n,a,c)}resize(h){const n=this._containerDimensions(),a=n[0],c=n[1];this._resizeCanvas(a,c,this.getPixelRatio()),this.transform.resize(a,c),this.painter.resize(a,c,this.getPixelRatio());const p=!this._moving;return p&&(this.stop(),this.fire(new u.Event("movestart",h)).fire(new u.Event("move",h))),this.fire(new u.Event("resize",h)),p&&this.fire(new u.Event("moveend",h)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(h){const[n,a]=this._containerDimensions();this._pixelRatio=h,this._resizeCanvas(n,a,h),this.painter.resize(n,a,h)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(h){return this.transform.setMaxBounds(u.LngLatBounds.convert(h)),this._update()}setMinZoom(h){if((h=h==null?-2:h)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h&&this.setZoom(h),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h==null?22:h)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h&&this.setZoom(h),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h==null?0:h)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h&&this.setPitch(h),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h==null?60:h)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h&&this.setPitch(h),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this._update()}project(h){return this.transform.locationPoint(u.LngLat.convert(h),this.style&&this.style.terrain)}unproject(h){return this.transform.pointLocation(u.pointGeometry.convert(h),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(h,n,a){if(h==="mouseenter"||h==="mouseover"){let c=!1;return{layer:n,listener:a,delegates:{mousemove:g=>{const b=this.getLayer(n)?this.queryRenderedFeatures(g.point,{layers:[n]}):[];b.length?c||(c=!0,a.call(this,new ti(h,this,g.originalEvent,{features:b}))):c=!1},mouseout:()=>{c=!1}}}}if(h==="mouseleave"||h==="mouseout"){let c=!1;return{layer:n,listener:a,delegates:{mousemove:b=>{(this.getLayer(n)?this.queryRenderedFeatures(b.point,{layers:[n]}):[]).length?c=!0:c&&(c=!1,a.call(this,new ti(h,this,b.originalEvent)))},mouseout:b=>{c&&(c=!1,a.call(this,new ti(h,this,b.originalEvent)))}}}}{const c=p=>{const g=this.getLayer(n)?this.queryRenderedFeatures(p.point,{layers:[n]}):[];g.length&&(p.features=g,a.call(this,p),delete p.features)};return{layer:n,listener:a,delegates:{[h]:c}}}}on(h,n,a){if(a===void 0)return super.on(h,n);const c=this._createDelegatedListener(h,n,a);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(c);for(const p in c.delegates)this.on(p,c.delegates[p]);return this}once(h,n,a){if(a===void 0)return super.once(h,n);const c=this._createDelegatedListener(h,n,a);for(const p in c.delegates)this.once(p,c.delegates[p]);return this}off(h,n,a){return a===void 0?super.off(h,n):(this._delegatedListeners&&this._delegatedListeners[h]&&(c=>{const p=this._delegatedListeners[h];for(let g=0;g<p.length;g++){const b=p[g];if(b.layer===n&&b.listener===a){for(const E in b.delegates)this.off(E,b.delegates[E]);return p.splice(g,1),this}}})(),this)}queryRenderedFeatures(h,n){if(!this.style)return[];let a;if(n!==void 0||h===void 0||h instanceof u.pointGeometry||Array.isArray(h)||(n=h,h=void 0),n=n||{},(h=h||[[0,0],[this.transform.width,this.transform.height]])instanceof u.pointGeometry||typeof h[0]=="number")a=[u.pointGeometry.convert(h)];else{const c=u.pointGeometry.convert(h[0]),p=u.pointGeometry.convert(h[1]);a=[c,new u.pointGeometry(p.x,c.y),p,new u.pointGeometry(c.x,p.y),c]}return this.style.queryRenderedFeatures(a,n,this.transform)}querySourceFeatures(h,n){return this.style.querySourceFeatures(h,n)}setStyle(h,n){return(n=u.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&h?(this._diffStyle(h,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(h,n))}setTransformRequest(h){return this._requestManager.setTransformRequest(h),this}_getUIString(h){const n=this._locale[h];if(n==null)throw new Error(`Missing UI string '${h}'`);return n}_updateStyle(h,n){return this.style&&(this.style.setEventedParent(null),this.style._remove()),h?(this.style=new $n(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof h=="string"?this.style.loadURL(h):this.style.loadJSON(h),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new $n(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(h,n){if(typeof h=="string"){const a=this._requestManager.transformRequest(h,u.ResourceType.Style);u.getJSON(a,(c,p)=>{c?this.fire(new u.ErrorEvent(c)):p&&this._updateDiff(p,n)})}else typeof h=="object"&&this._updateDiff(h,n)}_updateDiff(h,n){try{this.style.setState(h)&&this._update(!0)}catch(a){u.warnOnce(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(h,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.warnOnce("There is no style added to the map.")}addSource(h,n){return this._lazyInitEmptyStyle(),this.style.addSource(h,n),this._update(!0)}isSourceLoaded(h){const n=this.style&&this.style.sourceCaches[h];if(n!==void 0)return n.loaded();this.fire(new u.ErrorEvent(new Error(`There is no source with ID '${h}'`)))}setTerrain(h){return this.style.setTerrain(h),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const h=this.style&&this.style.sourceCaches;for(const n in h){const a=h[n]._tiles;for(const c in a){const p=a[c];if(p.state!=="loaded"&&p.state!=="errored")return!1}}return!0}addSourceType(h,n,a){return this._lazyInitEmptyStyle(),this.style.addSourceType(h,n,a)}removeSource(h){return this.style.removeSource(h),this._update(!0)}getSource(h){return this.style.getSource(h)}addImage(h,n,{pixelRatio:a=1,sdf:c=!1,stretchX:p,stretchY:g,content:b}={}){if(this._lazyInitEmptyStyle(),n instanceof HTMLImageElement||u.isImageBitmap(n)){const{width:E,height:k,data:P}=u.exported.getImageData(n);this.style.addImage(h,{data:new u.RGBAImage({width:E,height:k},P),pixelRatio:a,stretchX:p,stretchY:g,content:b,sdf:c,version:0})}else{if(n.width===void 0||n.height===void 0)return this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:E,height:k,data:P}=n,z=n;this.style.addImage(h,{data:new u.RGBAImage({width:E,height:k},new Uint8Array(P)),pixelRatio:a,stretchX:p,stretchY:g,content:b,sdf:c,version:0,userImage:z}),z.onAdd&&z.onAdd(this,h)}}}updateImage(h,n){const a=this.style.getImage(h);if(!a)return this.fire(new u.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=n instanceof HTMLImageElement||u.isImageBitmap(n)?u.exported.getImageData(n):n,{width:p,height:g,data:b}=c;if(p===void 0||g===void 0)return this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==a.data.width||g!==a.data.height)return this.fire(new u.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const E=!(n instanceof HTMLImageElement||u.isImageBitmap(n));a.data.replace(b,E),this.style.updateImage(h,a)}hasImage(h){return h?!!this.style.getImage(h):(this.fire(new u.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,n){u.getImage(this._requestManager.transformRequest(h,u.ResourceType.Image),n)}listImages(){return this.style.listImages()}addLayer(h,n){return this._lazyInitEmptyStyle(),this.style.addLayer(h,n),this._update(!0)}moveLayer(h,n){return this.style.moveLayer(h,n),this._update(!0)}removeLayer(h){return this.style.removeLayer(h),this._update(!0)}getLayer(h){return this.style.getLayer(h)}setLayerZoomRange(h,n,a){return this.style.setLayerZoomRange(h,n,a),this._update(!0)}setFilter(h,n,a={}){return this.style.setFilter(h,n,a),this._update(!0)}getFilter(h){return this.style.getFilter(h)}setPaintProperty(h,n,a,c={}){return this.style.setPaintProperty(h,n,a,c),this._update(!0)}getPaintProperty(h,n){return this.style.getPaintProperty(h,n)}setLayoutProperty(h,n,a,c={}){return this.style.setLayoutProperty(h,n,a,c),this._update(!0)}getLayoutProperty(h,n){return this.style.getLayoutProperty(h,n)}setLight(h,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(h,n),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(h,n){return this.style.setFeatureState(h,n),this._update()}removeFeatureState(h,n){return this.style.removeFeatureState(h,n),this._update()}getFeatureState(h){return this.style.getFeatureState(h)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let h=0,n=0;return this._container&&(h=this._container.clientWidth||400,n=this._container.clientHeight||300),[h,n]}_setupContainer(){const h=this._container;h.classList.add("maplibregl-map","mapboxgl-map");const n=this._canvasContainer=G.create("div","maplibregl-canvas-container mapboxgl-canvas-container",h);this._interactive&&n.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=G.create("canvas","maplibregl-canvas mapboxgl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const a=this._containerDimensions();this._resizeCanvas(a[0],a[1],this.getPixelRatio());const c=this._controlContainer=G.create("div","maplibregl-control-container mapboxgl-control-container",h),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(g=>{p[g]=G.create("div",`maplibregl-ctrl-${g} mapboxgl-ctrl-${g}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const h=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=G.create("div","maplibregl-cooperative-gesture-screen",h);let n="Control",a=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(a=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map",n="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${a}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",c=>{c.key===n&&(this._metaPress=!0)}),document.addEventListener("keyup",c=>{c.key===n&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",c=>{this._onCooperativeGesture(c,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(h,n,a){this._canvas.width=a*h,this._canvas.height=a*n,this._canvas.style.width=`${h}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const h=u.extend({},F.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);n?(this.painter=new en(n,this.transform),u.exported$1.testSupport(n)):this.fire(new u.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new u.Event("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new u.Event("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(h,n,a){return!n&&a<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_render(h){let n,a=0;const c=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(n=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,n),a=u.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(h),this._removed)return;let p=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const b=this.transform.zoom,E=u.exported.now();this.style.zoomHistory.update(b,E);const k=new u.EvaluationParameters(b,{now:E,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),P=k.crossFadingFactor();P===1&&P===this._crossFadingFactor||(p=!0,this._crossFadingFactor=P),this.style.update(k)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new u.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.PerformanceUtils.mark(u.PerformanceMarkers.load),this.fire(new u.Event("load"))),this.style&&(this.style.hasTransitions()||p)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const b=u.exported.now()-a;c.endQueryEXT(c.TIME_ELAPSED_EXT,n),setTimeout(()=>{const E=c.getQueryObjectEXT(n,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(n),this.fire(new u.Event("gpu-timing-frame",{cpuTime:b,gpuTime:E}))},50)}if(this.listens("gpu-timing-layer")){const b=this.painter.collectGpuTimers();setTimeout(()=>{const E=this.painter.queryGpuTimers(b);this.fire(new u.Event("gpu-timing-layer",{layerTimes:E}))},50)}const g=this._sourcesDirty||this._styleDirty||this._placementDirty;return g||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.Event("idle")),!this._loaded||this._fullyLoaded||g||(this._fullyLoaded=!0,u.PerformanceUtils.mark(u.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),G.remove(this._canvasContainer),G.remove(this._controlContainer),this._cooperativeGestures&&G.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),u.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new u.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=u.exported.frame(h=>{u.PerformanceUtils.frame(h),this._frame=null,this._render(h)}))}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}_setCacheLimits(h,n){u.setCacheLimits(h,n)}get version(){return"2.4.0"}},NavigationControl:class{constructor(h){this.options=u.extend({},_f,h),this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(u.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),G.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),G.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(u.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=G.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map.getZoom(),n=h===this._map.getMaxZoom(),a=h===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=a,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",a.toString())}_rotateCompassArrow(){const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=h}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Wo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){G.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(h,n){const a=G.create("button",h,this._container);return a.type="button",a.addEventListener("click",n),a}_setButtonTitle(h,n){const a=this._map._getUIString(`NavigationControl.${n}`);h.title=a,h.setAttribute("aria-label",a)}},GeolocateControl:class extends u.Evented{constructor(h){super(),this.options=u.extend({},kc,h),u.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(h){var n;return this._map=h,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),n=this._setupUI,Na!==void 0?n(Na):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(a=>{Na=a.state!=="denied",n(Na)}):(Na=!!window.navigator.geolocation,n(Na)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),G.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,qr=0,Ua=!1}_isOutOfMapMaxBounds(h){const n=this._map.getMaxBounds(),a=h.coords;return n&&(a.longitude<n.getWest()||a.longitude>n.getEast()||a.latitude<n.getSouth()||a.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new u.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new u.Event("geolocate",h)),this._finish()}}_updateCamera(h){const n=new u.LngLat(h.coords.longitude,h.coords.latitude),a=h.coords.accuracy,c=this._map.getBearing(),p=u.extend({bearing:c},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(a),p,{geolocateSource:!0})}_updateMarker(h){if(h){const n=new u.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map._container.clientHeight/2,n=this._map.unproject([0,h]),a=this._map.unproject([1,h]),c=n.distanceTo(a),p=Math.ceil(2*this._accuracy/c);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&Ua)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new u.Event("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=G.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),G.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",h===!1){u.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=G.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new qs(this._dotElement),this._circleElement=G.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new qs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new u.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return u.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":qr--,Ua=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new u.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let h;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),qr++,qr>1?(h={maximumAge:6e5,timeout:0},Ua=!0):(h=this.options.positionOptions,Ua=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,h)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:$l,LogoControl:Eu,ScaleControl:class{constructor(h){this.options=u.extend({},Ho,h),u.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){id(this._map,this._container,this.options)}onAdd(h){return this._map=h,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){G.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(h){this.options.unit=h,id(this._map,this._container,this.options)}},FullscreenControl:class{constructor(h){this._fullscreen=!1,h&&h.container&&(h.container instanceof HTMLElement?this._container=h.container:u.warnOnce("Full screen control 'container' must be a DOM element.")),u.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=G.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",u.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){G.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=G.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);G.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.title=h}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(h){this.options=h,u.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(h){return this._map=h,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=G.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),G.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){G.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends u.Evented{constructor(h){super(),this.options=u.extend(Object.create(or),h),u.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new u.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&G.remove(this._content),this._container&&(G.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new u.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=u.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(document.createTextNode(h))}setHTML(h){const n=document.createDocumentFragment(),a=document.createElement("body");let c;for(a.innerHTML=h;c=a.firstChild,c;)n.appendChild(c);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=G.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(h),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(h){this._container&&this._container.classList.add(h)}removeClassName(h){this._container&&this._container.classList.remove(h)}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){if(this._container)return this._container.classList.toggle(h)}_createCloseButton(){this.options.closeButton&&(this._closeButton=G.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(h){this._update(h.point)}_onMouseMove(h){this._update(h.point)}_onDrag(h){this._update(h.point)}_update(h){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=G.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=G.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(g=>this._container.classList.add(g)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=jl(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!h))return;const n=this._pos=this._trackPointer&&h?h:this._map.project(this._lngLat);let a=this.options.anchor;const c=Cc(this.options.offset);if(!a){const g=this._container.offsetWidth,b=this._container.offsetHeight;let E;E=n.y+c.bottom.y<b?["top"]:n.y>this._map.transform.height-b?["bottom"]:[],n.x<g/2?E.push("left"):n.x>this._map.transform.width-g/2&&E.push("right"),a=E.length===0?"bottom":E.join("-")}const p=n.add(c[a]).round();G.setTransform(this._container,`${bt[a]} translate(${p.x}px,${p.y}px)`),Lt(this._container,a,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(gr);h&&h.focus()}_onClose(){this.remove()}},Marker:qs,Style:$n,LngLat:u.LngLat,LngLatBounds:u.LngLatBounds,Point:u.pointGeometry,MercatorCoordinate:u.MercatorCoordinate,Evented:u.Evented,AJAXError:u.AJAXError,config:u.config,CanvasSource:yn,GeoJSONSource:Un,ImageSource:Pt,RasterDEMTileSource:mt,RasterTileSource:sn,VectorTileSource:An,VideoSource:Qe,prewarm:function(){hi().acquire(Nr)},clearPrewarmedResources:function(){const h=Ir;h&&(h.isPreloaded()&&h.numActive()===1?(h.release(Nr),Ir=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return Ur.workerCount},set workerCount(h){Ur.workerCount=h},get maxParallelImageRequests(){return u.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){u.config.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){u.clearTileCache(h)},workerUrl:"",addProtocol(h,n){u.config.REGISTERED_PROTOCOLS[h]=n},removeProtocol(h){delete u.config.REGISTERED_PROTOCOLS[h]}};return oo.extend(ss,{isSafari:u.isSafari,getPerformanceMetrics:u.PerformanceUtils.getPerformanceMetrics}),ss});var T=y;return T})})(Zb);const ep=Zb.exports;var Hb={exports:{}};(function(t,i){(function(s,f){t.exports=f()})(Ou,function(){var s=function(x,C){var B={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},ae={on:function(he,ge,je){if(B[he]===void 0)throw new Error("Invalid event type: "+he);B[he].push({selector:ge,fn:je})},render:function(he){C.store.featureChanged(he)}},_e=function(he,ge){for(var je=B[he],Ve=je.length;Ve--;){var Ge=je[Ve];if(Ge.selector(ge)){Ge.fn.call(ae,ge)||C.store.render(),C.ui.updateMapClasses();break}}};return x.start.call(ae),{render:x.render,stop:function(){x.stop&&x.stop()},trash:function(){x.trash&&(x.trash(),C.store.render())},combineFeatures:function(){x.combineFeatures&&x.combineFeatures()},uncombineFeatures:function(){x.uncombineFeatures&&x.uncombineFeatures()},drag:function(he){_e("drag",he)},click:function(he){_e("click",he)},mousemove:function(he){_e("mousemove",he)},mousedown:function(he){_e("mousedown",he)},mouseup:function(he){_e("mouseup",he)},mouseout:function(he){_e("mouseout",he)},keydown:function(he){_e("keydown",he)},keyup:function(he){_e("keyup",he)},touchstart:function(he){_e("touchstart",he)},touchmove:function(he){_e("touchmove",he)},touchend:function(he){_e("touchend",he)},tap:function(he){_e("tap",he)}}},f=6378137;function y(x){var C=0;if(x&&x.length>0){C+=Math.abs(v(x[0]));for(var B=1;B<x.length;B++)C-=Math.abs(v(x[B]))}return C}function v(x){var C,B,ae,_e,he,ge,je=0,Ve=x.length;if(Ve>2){for(ge=0;ge<Ve;ge++)ge===Ve-2?(ae=Ve-2,_e=Ve-1,he=0):ge===Ve-1?(ae=Ve-1,_e=0,he=1):(ae=ge,_e=ge+1,he=ge+2),C=x[ae],B=x[_e],je+=(T(x[he][0])-T(C[0]))*Math.sin(T(B[1]));je=je*f*f/2}return je}function T(x){return x*Math.PI/180}var u={geometry:function x(C){var B,ae=0;switch(C.type){case"Polygon":return y(C.coordinates);case"MultiPolygon":for(B=0;B<C.coordinates.length;B++)ae+=y(C.coordinates[B]);return ae;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(B=0;B<C.geometries.length;B++)ae+=x(C.geometries[B]);return ae}},ring:v},F="mapboxgl-ctrl",W="mapbox-gl-draw_ctrl-draw-btn",ie="mapbox-gl-draw_line",ne="mapbox-gl-draw_polygon",G="mapbox-gl-draw_point",we="mapbox-gl-draw_trash",Me="mapbox-gl-draw_combine",Ce="mapbox-gl-draw_uncombine",Ze="mapboxgl-ctrl-group",re="active",J="mapbox-gl-draw_boxselect",se="mapbox-gl-draw-hot",Te="mapbox-gl-draw-cold",ze="add",He="move",it="drag",Xe="pointer",Ut="none",xt={POLYGON:"polygon",LINE:"line_string",POINT:"point"},Zt="Feature",dn="Polygon",An="LineString",sn="Point",zn="FeatureCollection",mt="Multi",Un="MultiPoint",at="MultiLineString",Pt="MultiPolygon",Qe={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},yn="draw.create",Ln="draw.delete",Ei="draw.update",Yr="draw.selectionchange",Kr="draw.modechange",Cr="draw.actionable",ci="draw.render",No="draw.combine",Jr="draw.uncombine",Ta="move",Ka="change_coordinates",Nr="feature",Ur="midpoint",go="vertex",Ir="true",hi="false",ka=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],Ca={Point:0,LineString:1,Polygon:2};function rn(x,C){var B=Ca[x.geometry.type]-Ca[C.geometry.type];return B===0&&x.geometry.type===dn?x.area-C.area:B}function nr(x){if(this._items={},this._nums={},this._length=x?x.length:0,x)for(var C=0,B=x.length;C<B;C++)this.add(x[C]),x[C]!==void 0&&(typeof x[C]=="string"?this._items[x[C]]=C:this._nums[x[C]]=C)}nr.prototype.add=function(x){return this.has(x)||(this._length++,typeof x=="string"?this._items[x]=this._length:this._nums[x]=this._length),this},nr.prototype.delete=function(x){return this.has(x)===!1||(this._length--,delete this._items[x],delete this._nums[x]),this},nr.prototype.has=function(x){return(typeof x=="string"||typeof x=="number")&&(this._items[x]!==void 0||this._nums[x]!==void 0)},nr.prototype.values=function(){var x=this,C=[];return Object.keys(this._items).forEach(function(B){C.push({k:B,v:x._items[B]})}),Object.keys(this._nums).forEach(function(B){C.push({k:JSON.parse(B),v:x._nums[B]})}),C.sort(function(B,ae){return B.v-ae.v}).map(function(B){return B.k})},nr.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var Uo=[Nr,Ur,go],Ti={click:function(x,C,B){return Ia(x,C,B,B.options.clickBuffer)},touch:function(x,C,B){return Ia(x,C,B,B.options.touchBuffer)}};function Ia(x,C,B,ae){if(B.map===null)return[];var _e=x?function(Ge,xe){return xe===void 0&&(xe=0),[[Ge.point.x-xe,Ge.point.y-xe],[Ge.point.x+xe,Ge.point.y+xe]]}(x,ae):C,he={};B.options.styles&&(he.layers=B.options.styles.map(function(Ge){return Ge.id}));var ge=B.map.queryRenderedFeatures(_e,he).filter(function(Ge){return Uo.indexOf(Ge.properties.meta)!==-1}),je=new nr,Ve=[];return ge.forEach(function(Ge){var xe=Ge.properties.id;je.has(xe)||(je.add(xe),Ve.push(Ge))}),function(Ge){return Ge.map(function(xe){return xe.geometry.type===dn&&(xe.area=u.geometry({type:Zt,property:{},geometry:xe.geometry})),xe}).sort(rn).map(function(xe){return delete xe.area,xe})}(Ve)}function Bi(x,C){var B=Ti.click(x,null,C),ae={mouse:Ut};return B[0]&&(ae.mouse=B[0].properties.active===Ir?He:Xe,ae.feature=B[0].properties.meta),C.events.currentModeName().indexOf("draw")!==-1&&(ae.mouse=ze),C.ui.queueMapClasses(ae),C.ui.updateMapClasses(),B[0]}function Ki(x,C){var B=x.x-C.x,ae=x.y-C.y;return Math.sqrt(B*B+ae*ae)}function aa(x,C,B){B===void 0&&(B={});var ae=B.fineTolerance!=null?B.fineTolerance:4,_e=B.grossTolerance!=null?B.grossTolerance:12,he=B.interval!=null?B.interval:500;x.point=x.point||C.point,x.time=x.time||C.time;var ge=Ki(x.point,C.point);return ge<ae||ge<_e&&C.time-x.time<he}function Ji(x,C,B){B===void 0&&(B={});var ae=B.tolerance!=null?B.tolerance:25,_e=B.interval!=null?B.interval:250;return x.point=x.point||C.point,x.time=x.time||C.time,Ki(x.point,C.point)<ae&&C.time-x.time<_e}function Le(x,C){return x(C={exports:{}},C.exports),C.exports}var Je=Le(function(x){var C=x.exports=function(B,ae){if(ae||(ae=16),B===void 0&&(B=128),B<=0)return"0";for(var _e=Math.log(Math.pow(2,B))/Math.log(ae),he=2;_e===1/0;he*=2)_e=Math.log(Math.pow(2,B/he))/Math.log(ae)*he;var ge=_e-Math.floor(_e),je="";for(he=0;he<Math.floor(_e);he++)je=Math.floor(Math.random()*ae).toString(ae)+je;if(ge){var Ve=Math.pow(ae,ge);je=Math.floor(Math.random()*Ve).toString(ae)+je}var Ge=parseInt(je,ae);return Ge!==1/0&&Ge>=Math.pow(2,B)?C(B,ae):je};C.rack=function(B,ae,_e){var he=function(je){var Ve=0;do{if(Ve++>10){if(!_e)throw new Error("too many ID collisions, use more bits");B+=_e}var Ge=C(B,ae)}while(Object.hasOwnProperty.call(ge,Ge));return ge[Ge]=je,Ge},ge=he.hats={};return he.get=function(je){return he.hats[je]},he.set=function(je,Ve){return he.hats[je]=Ve,he},he.bits=B||128,he.base=ae||16,he}}),Yn=function(x,C){this.ctx=x,this.properties=C.properties||{},this.coordinates=C.geometry.coordinates,this.id=C.id||Je(),this.type=C.geometry.type};Yn.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},Yn.prototype.incomingCoords=function(x){this.setCoordinates(x)},Yn.prototype.setCoordinates=function(x){this.coordinates=x,this.changed()},Yn.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},Yn.prototype.setProperty=function(x,C){this.properties[x]=C},Yn.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:Zt,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},Yn.prototype.internal=function(x){var C={id:this.id,meta:Nr,"meta:type":this.type,active:hi,mode:x};if(this.ctx.options.userProperties)for(var B in this.properties)C["user_"+B]=this.properties[B];return{type:Zt,properties:C,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var br=function(x,C){Yn.call(this,x,C)};(br.prototype=Object.create(Yn.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},br.prototype.updateCoordinate=function(x,C,B){this.coordinates=arguments.length===3?[C,B]:[x,C],this.changed()},br.prototype.getCoordinate=function(){return this.getCoordinates()};var jt=function(x,C){Yn.call(this,x,C)};(jt.prototype=Object.create(Yn.prototype)).isValid=function(){return this.coordinates.length>1},jt.prototype.addCoordinate=function(x,C,B){this.changed();var ae=parseInt(x,10);this.coordinates.splice(ae,0,[C,B])},jt.prototype.getCoordinate=function(x){var C=parseInt(x,10);return JSON.parse(JSON.stringify(this.coordinates[C]))},jt.prototype.removeCoordinate=function(x){this.changed(),this.coordinates.splice(parseInt(x,10),1)},jt.prototype.updateCoordinate=function(x,C,B){var ae=parseInt(x,10);this.coordinates[ae]=[C,B],this.changed()};var Vn=function(x,C){Yn.call(this,x,C),this.coordinates=this.coordinates.map(function(B){return B.slice(0,-1)})};(Vn.prototype=Object.create(Yn.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(x){return x.length>2})},Vn.prototype.incomingCoords=function(x){this.coordinates=x.map(function(C){return C.slice(0,-1)}),this.changed()},Vn.prototype.setCoordinates=function(x){this.coordinates=x,this.changed()},Vn.prototype.addCoordinate=function(x,C,B){this.changed();var ae=x.split(".").map(function(_e){return parseInt(_e,10)});this.coordinates[ae[0]].splice(ae[1],0,[C,B])},Vn.prototype.removeCoordinate=function(x){this.changed();var C=x.split(".").map(function(ae){return parseInt(ae,10)}),B=this.coordinates[C[0]];B&&(B.splice(C[1],1),B.length<3&&this.coordinates.splice(C[0],1))},Vn.prototype.getCoordinate=function(x){var C=x.split(".").map(function(ae){return parseInt(ae,10)}),B=this.coordinates[C[0]];return JSON.parse(JSON.stringify(B[C[1]]))},Vn.prototype.getCoordinates=function(){return this.coordinates.map(function(x){return x.concat([x[0]])})},Vn.prototype.updateCoordinate=function(x,C,B){this.changed();var ae=x.split("."),_e=parseInt(ae[0],10),he=parseInt(ae[1],10);this.coordinates[_e]===void 0&&(this.coordinates[_e]=[]),this.coordinates[_e][he]=[C,B]};var di={MultiPoint:br,MultiLineString:jt,MultiPolygon:Vn},Pr=function(x,C,B,ae,_e){var he=B.split("."),ge=parseInt(he[0],10),je=he[1]?he.slice(1).join("."):null;return x[ge][C](je,ae,_e)},Kn=function(x,C){if(Yn.call(this,x,C),delete this.coordinates,this.model=di[C.geometry.type],this.model===void 0)throw new TypeError(C.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(C.geometry.coordinates)};function Fe(x){this.map=x.map,this.drawConfig=JSON.parse(JSON.stringify(x.options||{})),this._ctx=x}(Kn.prototype=Object.create(Yn.prototype))._coordinatesToFeatures=function(x){var C=this,B=this.model.bind(this);return x.map(function(ae){return new B(C.ctx,{id:Je(),type:Zt,properties:{},geometry:{coordinates:ae,type:C.type.replace("Multi","")}})})},Kn.prototype.isValid=function(){return this.features.every(function(x){return x.isValid()})},Kn.prototype.setCoordinates=function(x){this.features=this._coordinatesToFeatures(x),this.changed()},Kn.prototype.getCoordinate=function(x){return Pr(this.features,"getCoordinate",x)},Kn.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(x){return x.type===dn?x.getCoordinates():x.coordinates})))},Kn.prototype.updateCoordinate=function(x,C,B){Pr(this.features,"updateCoordinate",x,C,B),this.changed()},Kn.prototype.addCoordinate=function(x,C,B){Pr(this.features,"addCoordinate",x,C,B),this.changed()},Kn.prototype.removeCoordinate=function(x){Pr(this.features,"removeCoordinate",x),this.changed()},Kn.prototype.getFeatures=function(){return this.features},Fe.prototype.setSelected=function(x){return this._ctx.store.setSelected(x)},Fe.prototype.setSelectedCoordinates=function(x){var C=this;this._ctx.store.setSelectedCoordinates(x),x.reduce(function(B,ae){return B[ae.feature_id]===void 0&&(B[ae.feature_id]=!0,C._ctx.store.get(ae.feature_id).changed()),B},{})},Fe.prototype.getSelected=function(){return this._ctx.store.getSelected()},Fe.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},Fe.prototype.isSelected=function(x){return this._ctx.store.isSelected(x)},Fe.prototype.getFeature=function(x){return this._ctx.store.get(x)},Fe.prototype.select=function(x){return this._ctx.store.select(x)},Fe.prototype.deselect=function(x){return this._ctx.store.deselect(x)},Fe.prototype.deleteFeature=function(x,C){return C===void 0&&(C={}),this._ctx.store.delete(x,C)},Fe.prototype.addFeature=function(x){return this._ctx.store.add(x)},Fe.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},Fe.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},Fe.prototype.setActionableState=function(x){x===void 0&&(x={});var C={trash:x.trash||!1,combineFeatures:x.combineFeatures||!1,uncombineFeatures:x.uncombineFeatures||!1};return this._ctx.events.actionable(C)},Fe.prototype.changeMode=function(x,C,B){return C===void 0&&(C={}),B===void 0&&(B={}),this._ctx.events.changeMode(x,C,B)},Fe.prototype.updateUIClasses=function(x){return this._ctx.ui.queueMapClasses(x)},Fe.prototype.activateUIButton=function(x){return this._ctx.ui.setActiveButton(x)},Fe.prototype.featuresAt=function(x,C,B){if(B===void 0&&(B="click"),B!=="click"&&B!=="touch")throw new Error("invalid buffer type");return Ti[B](x,C,this._ctx)},Fe.prototype.newFeature=function(x){var C=x.geometry.type;return C===sn?new br(this._ctx,x):C===An?new jt(this._ctx,x):C===dn?new Vn(this._ctx,x):new Kn(this._ctx,x)},Fe.prototype.isInstanceOf=function(x,C){if(x===sn)return C instanceof br;if(x===An)return C instanceof jt;if(x===dn)return C instanceof Vn;if(x==="MultiFeature")return C instanceof Kn;throw new Error("Unknown feature class: "+x)},Fe.prototype.doRender=function(x){return this._ctx.store.featureChanged(x)},Fe.prototype.onSetup=function(){},Fe.prototype.onDrag=function(){},Fe.prototype.onClick=function(){},Fe.prototype.onMouseMove=function(){},Fe.prototype.onMouseDown=function(){},Fe.prototype.onMouseUp=function(){},Fe.prototype.onMouseOut=function(){},Fe.prototype.onKeyUp=function(){},Fe.prototype.onKeyDown=function(){},Fe.prototype.onTouchStart=function(){},Fe.prototype.onTouchMove=function(){},Fe.prototype.onTouchEnd=function(){},Fe.prototype.onTap=function(){},Fe.prototype.onStop=function(){},Fe.prototype.onTrash=function(){},Fe.prototype.onCombineFeature=function(){},Fe.prototype.onUncombineFeature=function(){},Fe.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var Gt={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Bt=Object.keys(Gt);function wr(x){var C=Object.keys(x);return function(B,ae){ae===void 0&&(ae={});var _e={},he=C.reduce(function(ge,je){return ge[je]=x[je],ge},new Fe(B));return{start:function(){var ge=this;_e=he.onSetup(ae),Bt.forEach(function(je){var Ve,Ge=Gt[je],xe=function(){return!1};x[Ge]&&(xe=function(){return!0}),ge.on(je,xe,(Ve=Ge,function(et){return he[Ve](_e,et)}))})},stop:function(){he.onStop(_e)},trash:function(){he.onTrash(_e)},combineFeatures:function(){he.onCombineFeatures(_e)},uncombineFeatures:function(){he.onUncombineFeatures(_e)},render:function(ge,je){he.toDisplayFeatures(_e,ge,je)}}}}function Ni(x){return[].concat(x).filter(function(C){return C!==void 0})}function Ot(){var x=this;if(!(x.ctx.map&&x.ctx.map.getSource(se)!==void 0))return Ve();var C=x.ctx.events.currentModeName();x.ctx.ui.queueMapClasses({mode:C});var B=[],ae=[];x.isDirty?ae=x.getAllIds():(B=x.getChangedIds().filter(function(Ge){return x.get(Ge)!==void 0}),ae=x.sources.hot.filter(function(Ge){return Ge.properties.id&&B.indexOf(Ge.properties.id)===-1&&x.get(Ge.properties.id)!==void 0}).map(function(Ge){return Ge.properties.id})),x.sources.hot=[];var _e=x.sources.cold.length;x.sources.cold=x.isDirty?[]:x.sources.cold.filter(function(Ge){var xe=Ge.properties.id||Ge.properties.parent;return B.indexOf(xe)===-1});var he=_e!==x.sources.cold.length||ae.length>0;function ge(Ge,xe){var et=x.get(Ge).internal(C);x.ctx.events.currentModeRender(et,function(dt){x.sources[xe].push(dt)})}if(B.forEach(function(Ge){return ge(Ge,"hot")}),ae.forEach(function(Ge){return ge(Ge,"cold")}),he&&x.ctx.map.getSource(Te).setData({type:zn,features:x.sources.cold}),x.ctx.map.getSource(se).setData({type:zn,features:x.sources.hot}),x._emitSelectionChange&&(x.ctx.map.fire(Yr,{features:x.getSelected().map(function(Ge){return Ge.toGeoJSON()}),points:x.getSelectedCoordinates().map(function(Ge){return{type:Zt,properties:{},geometry:{type:sn,coordinates:Ge.coordinates}}})}),x._emitSelectionChange=!1),x._deletedFeaturesToEmit.length){var je=x._deletedFeaturesToEmit.map(function(Ge){return Ge.toGeoJSON()});x._deletedFeaturesToEmit=[],x.ctx.map.fire(Ln,{features:je})}function Ve(){x.isDirty=!1,x.clearChangedIds()}Ve(),x.ctx.map.fire(ci,{})}function pn(x){var C,B=this;this._features={},this._featureIds=new nr,this._selectedFeatureIds=new nr,this._selectedCoordinates=[],this._changedFeatureIds=new nr,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=x,this.sources={hot:[],cold:[]},this.render=function(){C||(C=requestAnimationFrame(function(){C=null,Ot.call(B)}))},this.isDirty=!1}function ur(x,C){var B=x._selectedCoordinates.filter(function(ae){return x._selectedFeatureIds.has(ae.feature_id)});x._selectedCoordinates.length===B.length||C.silent||(x._emitSelectionChange=!0),x._selectedCoordinates=B}pn.prototype.createRenderBatch=function(){var x=this,C=this.render,B=0;return this.render=function(){B++},function(){x.render=C,B>0&&x.render()}},pn.prototype.setDirty=function(){return this.isDirty=!0,this},pn.prototype.featureChanged=function(x){return this._changedFeatureIds.add(x),this},pn.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},pn.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},pn.prototype.getAllIds=function(){return this._featureIds.values()},pn.prototype.add=function(x){return this.featureChanged(x.id),this._features[x.id]=x,this._featureIds.add(x.id),this},pn.prototype.delete=function(x,C){var B=this;return C===void 0&&(C={}),Ni(x).forEach(function(ae){B._featureIds.has(ae)&&(B._featureIds.delete(ae),B._selectedFeatureIds.delete(ae),C.silent||B._deletedFeaturesToEmit.indexOf(B._features[ae])===-1&&B._deletedFeaturesToEmit.push(B._features[ae]),delete B._features[ae],B.isDirty=!0)}),ur(this,C),this},pn.prototype.get=function(x){return this._features[x]},pn.prototype.getAll=function(){var x=this;return Object.keys(this._features).map(function(C){return x._features[C]})},pn.prototype.select=function(x,C){var B=this;return C===void 0&&(C={}),Ni(x).forEach(function(ae){B._selectedFeatureIds.has(ae)||(B._selectedFeatureIds.add(ae),B._changedFeatureIds.add(ae),C.silent||(B._emitSelectionChange=!0))}),this},pn.prototype.deselect=function(x,C){var B=this;return C===void 0&&(C={}),Ni(x).forEach(function(ae){B._selectedFeatureIds.has(ae)&&(B._selectedFeatureIds.delete(ae),B._changedFeatureIds.add(ae),C.silent||(B._emitSelectionChange=!0))}),ur(this,C),this},pn.prototype.clearSelected=function(x){return x===void 0&&(x={}),this.deselect(this._selectedFeatureIds.values(),{silent:x.silent}),this},pn.prototype.setSelected=function(x,C){var B=this;return C===void 0&&(C={}),x=Ni(x),this.deselect(this._selectedFeatureIds.values().filter(function(ae){return x.indexOf(ae)===-1}),{silent:C.silent}),this.select(x.filter(function(ae){return!B._selectedFeatureIds.has(ae)}),{silent:C.silent}),this},pn.prototype.setSelectedCoordinates=function(x){return this._selectedCoordinates=x,this._emitSelectionChange=!0,this},pn.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},pn.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},pn.prototype.getSelected=function(){var x=this;return this._selectedFeatureIds.values().map(function(C){return x.get(C)})},pn.prototype.getSelectedCoordinates=function(){var x=this;return this._selectedCoordinates.map(function(C){return{coordinates:x.get(C.feature_id).getCoordinate(C.coord_path)}})},pn.prototype.isSelected=function(x){return this._selectedFeatureIds.has(x)},pn.prototype.setFeatureProperty=function(x,C,B){this.get(x).setProperty(C,B),this.featureChanged(x)},pn.prototype.storeMapConfig=function(){var x=this;ka.forEach(function(C){x.ctx.map[C]&&(x._mapInitialConfig[C]=x.ctx.map[C].isEnabled())})},pn.prototype.restoreMapConfig=function(){var x=this;Object.keys(this._mapInitialConfig).forEach(function(C){x._mapInitialConfig[C]?x.ctx.map[C].enable():x.ctx.map[C].disable()})},pn.prototype.getInitialConfigValue=function(x){return this._mapInitialConfig[x]===void 0||this._mapInitialConfig[x]};var pi=function(){for(var x=arguments,C={},B=0;B<arguments.length;B++){var ae=x[B];for(var _e in ae)rr.call(ae,_e)&&(C[_e]=ae[_e])}return C},rr=Object.prototype.hasOwnProperty,Vr=["mode","feature","mouse"];function xn(x){var C=null,B=null,ae={onRemove:function(){return x.map.off("load",ae.connect),clearInterval(B),ae.removeLayers(),x.store.restoreMapConfig(),x.ui.removeButtons(),x.events.removeEventListeners(),x.ui.clearMapClasses(),x.map=null,x.container=null,x.store=null,C&&C.parentNode&&C.parentNode.removeChild(C),C=null,this},connect:function(){x.map.off("load",ae.connect),clearInterval(B),ae.addLayers(),x.store.storeMapConfig(),x.events.addEventListeners()},onAdd:function(_e){var he=_e.fire;return _e.fire=function(ge,je){var Ve=arguments;return he.length===1&&arguments.length!==1&&(Ve=[pi({},{type:ge},je)]),he.apply(_e,Ve)},x.map=_e,x.events=function(ge){var je=Object.keys(ge.options.modes).reduce(function(Ne,yt){return Ne[yt]=wr(ge.options.modes[yt]),Ne},{}),Ve={},Ge={},xe={},et=null,dt=null;xe.drag=function(Ne,yt){yt({point:Ne.point,time:new Date().getTime()})?(ge.ui.queueMapClasses({mouse:it}),dt.drag(Ne)):Ne.originalEvent.stopPropagation()},xe.mousedrag=function(Ne){xe.drag(Ne,function(yt){return!aa(Ve,yt)})},xe.touchdrag=function(Ne){xe.drag(Ne,function(yt){return!Ji(Ge,yt)})},xe.mousemove=function(Ne){if((Ne.originalEvent.buttons!==void 0?Ne.originalEvent.buttons:Ne.originalEvent.which)===1)return xe.mousedrag(Ne);var yt=Bi(Ne,ge);Ne.featureTarget=yt,dt.mousemove(Ne)},xe.mousedown=function(Ne){Ve={time:new Date().getTime(),point:Ne.point};var yt=Bi(Ne,ge);Ne.featureTarget=yt,dt.mousedown(Ne)},xe.mouseup=function(Ne){var yt=Bi(Ne,ge);Ne.featureTarget=yt,aa(Ve,{point:Ne.point,time:new Date().getTime()})?dt.click(Ne):dt.mouseup(Ne)},xe.mouseout=function(Ne){dt.mouseout(Ne)},xe.touchstart=function(Ne){if(Ne.originalEvent.preventDefault(),ge.options.touchEnabled){Ge={time:new Date().getTime(),point:Ne.point};var yt=Ti.touch(Ne,null,ge)[0];Ne.featureTarget=yt,dt.touchstart(Ne)}},xe.touchmove=function(Ne){if(Ne.originalEvent.preventDefault(),ge.options.touchEnabled)return dt.touchmove(Ne),xe.touchdrag(Ne)},xe.touchend=function(Ne){if(Ne.originalEvent.preventDefault(),ge.options.touchEnabled){var yt=Ti.touch(Ne,null,ge)[0];Ne.featureTarget=yt,Ji(Ge,{time:new Date().getTime(),point:Ne.point})?dt.tap(Ne):dt.touchend(Ne)}};var Tt=function(Ne){return!(Ne===8||Ne===46||Ne>=48&&Ne<=57)};function Rt(Ne,yt,_n){_n===void 0&&(_n={}),dt.stop();var mn=je[Ne];if(mn===void 0)throw new Error(Ne+" is not valid");et=Ne;var Rn=mn(ge,yt);dt=s(Rn,ge),_n.silent||ge.map.fire(Kr,{mode:Ne}),ge.store.setDirty(),ge.store.render()}xe.keydown=function(Ne){(Ne.srcElement||Ne.target).classList[0]==="mapboxgl-canvas"&&(Ne.keyCode!==8&&Ne.keyCode!==46||!ge.options.controls.trash?Tt(Ne.keyCode)?dt.keydown(Ne):Ne.keyCode===49&&ge.options.controls.point?Rt(Qe.DRAW_POINT):Ne.keyCode===50&&ge.options.controls.line_string?Rt(Qe.DRAW_LINE_STRING):Ne.keyCode===51&&ge.options.controls.polygon&&Rt(Qe.DRAW_POLYGON):(Ne.preventDefault(),dt.trash()))},xe.keyup=function(Ne){Tt(Ne.keyCode)&&dt.keyup(Ne)},xe.zoomend=function(){ge.store.changeZoom()},xe.data=function(Ne){if(Ne.dataType==="style"){var yt=ge.setup,_n=ge.map,mn=ge.options,Rn=ge.store;mn.styles.some(function(kt){return _n.getLayer(kt.id)})||(yt.addLayers(),Rn.setDirty(),Rn.render())}};var Wn={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){et=ge.options.defaultMode,dt=s(je[et](ge),ge)},changeMode:Rt,actionable:function(Ne){var yt=!1;Object.keys(Ne).forEach(function(_n){if(Wn[_n]===void 0)throw new Error("Invalid action type");Wn[_n]!==Ne[_n]&&(yt=!0),Wn[_n]=Ne[_n]}),yt&&ge.map.fire(Cr,{actions:Wn})},currentModeName:function(){return et},currentModeRender:function(Ne,yt){return dt.render(Ne,yt)},fire:function(Ne,yt){xe[Ne]&&xe[Ne](yt)},addEventListeners:function(){ge.map.on("mousemove",xe.mousemove),ge.map.on("mousedown",xe.mousedown),ge.map.on("mouseup",xe.mouseup),ge.map.on("data",xe.data),ge.map.on("touchmove",xe.touchmove),ge.map.on("touchstart",xe.touchstart),ge.map.on("touchend",xe.touchend),ge.container.addEventListener("mouseout",xe.mouseout),ge.options.keybindings&&(ge.container.addEventListener("keydown",xe.keydown),ge.container.addEventListener("keyup",xe.keyup))},removeEventListeners:function(){ge.map.off("mousemove",xe.mousemove),ge.map.off("mousedown",xe.mousedown),ge.map.off("mouseup",xe.mouseup),ge.map.off("data",xe.data),ge.map.off("touchmove",xe.touchmove),ge.map.off("touchstart",xe.touchstart),ge.map.off("touchend",xe.touchend),ge.container.removeEventListener("mouseout",xe.mouseout),ge.options.keybindings&&(ge.container.removeEventListener("keydown",xe.keydown),ge.container.removeEventListener("keyup",xe.keyup))},trash:function(Ne){dt.trash(Ne)},combineFeatures:function(){dt.combineFeatures()},uncombineFeatures:function(){dt.uncombineFeatures()},getMode:function(){return et}}}(x),x.ui=function(ge){var je={},Ve=null,Ge={mode:null,feature:null,mouse:null},xe={mode:null,feature:null,mouse:null};function et(Ne){xe=pi(xe,Ne)}function dt(){var Ne,yt;if(ge.container){var _n=[],mn=[];Vr.forEach(function(Rn){xe[Rn]!==Ge[Rn]&&(_n.push(Rn+"-"+Ge[Rn]),xe[Rn]!==null&&mn.push(Rn+"-"+xe[Rn]))}),_n.length>0&&(Ne=ge.container.classList).remove.apply(Ne,_n),mn.length>0&&(yt=ge.container.classList).add.apply(yt,mn),Ge=pi(Ge,xe)}}function Tt(Ne,yt){yt===void 0&&(yt={});var _n=document.createElement("button");return _n.className=W+" "+yt.className,_n.setAttribute("title",yt.title),yt.container.appendChild(_n),_n.addEventListener("click",function(mn){if(mn.preventDefault(),mn.stopPropagation(),mn.target===Ve)return Rt(),void yt.onDeactivate();Wn(Ne),yt.onActivate()},!0),_n}function Rt(){Ve&&(Ve.classList.remove(re),Ve=null)}function Wn(Ne){Rt();var yt=je[Ne];yt&&yt&&Ne!=="trash"&&(yt.classList.add(re),Ve=yt)}return{setActiveButton:Wn,queueMapClasses:et,updateMapClasses:dt,clearMapClasses:function(){et({mode:null,feature:null,mouse:null}),dt()},addButtons:function(){var Ne=ge.options.controls,yt=document.createElement("div");return yt.className=Ze+" "+F,Ne&&(Ne[xt.LINE]&&(je[xt.LINE]=Tt(xt.LINE,{container:yt,className:ie,title:"LineString tool "+(ge.options.keybindings?"(l)":""),onActivate:function(){return ge.events.changeMode(Qe.DRAW_LINE_STRING)},onDeactivate:function(){return ge.events.trash()}})),Ne[xt.POLYGON]&&(je[xt.POLYGON]=Tt(xt.POLYGON,{container:yt,className:ne,title:"Polygon tool "+(ge.options.keybindings?"(p)":""),onActivate:function(){return ge.events.changeMode(Qe.DRAW_POLYGON)},onDeactivate:function(){return ge.events.trash()}})),Ne[xt.POINT]&&(je[xt.POINT]=Tt(xt.POINT,{container:yt,className:G,title:"Marker tool "+(ge.options.keybindings?"(m)":""),onActivate:function(){return ge.events.changeMode(Qe.DRAW_POINT)},onDeactivate:function(){return ge.events.trash()}})),Ne.trash&&(je.trash=Tt("trash",{container:yt,className:we,title:"Delete",onActivate:function(){ge.events.trash()}})),Ne.combine_features&&(je.combine_features=Tt("combineFeatures",{container:yt,className:Me,title:"Combine",onActivate:function(){ge.events.combineFeatures()}})),Ne.uncombine_features&&(je.uncombine_features=Tt("uncombineFeatures",{container:yt,className:Ce,title:"Uncombine",onActivate:function(){ge.events.uncombineFeatures()}}))),yt},removeButtons:function(){Object.keys(je).forEach(function(Ne){var yt=je[Ne];yt.parentNode&&yt.parentNode.removeChild(yt),delete je[Ne]})}}}(x),x.container=_e.getContainer(),x.store=new pn(x),C=x.ui.addButtons(),x.options.boxSelect&&(_e.boxZoom.disable(),_e.dragPan.disable(),_e.dragPan.enable()),_e.loaded()?ae.connect():(_e.on("load",ae.connect),B=setInterval(function(){_e.loaded()&&ae.connect()},16)),x.events.start(),C},addLayers:function(){x.map.addSource(Te,{data:{type:zn,features:[]},type:"geojson"}),x.map.addSource(se,{data:{type:zn,features:[]},type:"geojson"}),x.options.styles.forEach(function(_e){x.map.addLayer(_e)}),x.store.setDirty(!0),x.store.render()},removeLayers:function(){x.options.styles.forEach(function(_e){x.map.getLayer(_e.id)&&x.map.removeLayer(_e.id)}),x.map.getSource(Te)&&x.map.removeSource(Te),x.map.getSource(se)&&x.map.removeSource(se)}};return x.setup=ae,ae}function Vo(x){return function(C){var B=C.featureTarget;return!!B&&!!B.properties&&B.properties.meta===x}}function $r(x){return!!x.featureTarget&&!!x.featureTarget.properties&&x.featureTarget.properties.active===Ir&&x.featureTarget.properties.meta===Nr}function $o(x){return!!x.featureTarget&&!!x.featureTarget.properties&&x.featureTarget.properties.active===hi&&x.featureTarget.properties.meta===Nr}function yo(x){return x.featureTarget===void 0}function _o(x){var C=x.featureTarget;return!!C&&!!C.properties&&C.properties.meta===go}function vo(x){return!!x.originalEvent&&x.originalEvent.shiftKey===!0}function q(x){return x.keyCode===27}function A(x){return x.keyCode===13}var D=$;function $(x,C){this.x=x,this.y=C}function j(x,C){var B=C.getBoundingClientRect();return new D(x.clientX-B.left-(C.clientLeft||0),x.clientY-B.top-(C.clientTop||0))}function Q(x,C,B,ae){return{type:Zt,properties:{meta:go,parent:x,coord_path:B,active:ae?Ir:hi},geometry:{type:sn,coordinates:C}}}function ue(x,C,B){C===void 0&&(C={}),B===void 0&&(B=null);var ae,_e=x.geometry,he=_e.type,ge=_e.coordinates,je=x.properties&&x.properties.id,Ve=[];function Ge(et,dt){var Tt="",Rt=null;et.forEach(function(Wn,Ne){var yt=dt!=null?dt+"."+Ne:String(Ne),_n=Q(je,Wn,yt,xe(yt));if(C.midpoints&&Rt){var mn=function(kt,Xt,bo){var fn=Xt.geometry.coordinates,Gr=bo.geometry.coordinates;if(fn[1]>85||fn[1]<-85||Gr[1]>85||Gr[1]<-85)return null;var mr={lng:(fn[0]+Gr[0])/2,lat:(fn[1]+Gr[1])/2};return{type:Zt,properties:{meta:Ur,parent:kt,lng:mr.lng,lat:mr.lat,coord_path:bo.properties.coord_path},geometry:{type:sn,coordinates:[mr.lng,mr.lat]}}}(je,Rt,_n);mn&&Ve.push(mn)}Rt=_n;var Rn=JSON.stringify(Wn);Tt!==Rn&&Ve.push(_n),Ne===0&&(Tt=Rn)})}function xe(et){return!!C.selectedPaths&&C.selectedPaths.indexOf(et)!==-1}return he===sn?Ve.push(Q(je,ge,B,xe(B))):he===dn?ge.forEach(function(et,dt){Ge(et,B!==null?B+"."+dt:String(dt))}):he===An?Ge(ge,B):he.indexOf(mt)===0&&(ae=he.replace(mt,""),ge.forEach(function(et,dt){var Tt={type:Zt,properties:x.properties,geometry:{type:ae,coordinates:et}};Ve=Ve.concat(ue(Tt,C,dt))})),Ve}$.prototype={clone:function(){return new $(this.x,this.y)},add:function(x){return this.clone()._add(x)},sub:function(x){return this.clone()._sub(x)},multByPoint:function(x){return this.clone()._multByPoint(x)},divByPoint:function(x){return this.clone()._divByPoint(x)},mult:function(x){return this.clone()._mult(x)},div:function(x){return this.clone()._div(x)},rotate:function(x){return this.clone()._rotate(x)},rotateAround:function(x,C){return this.clone()._rotateAround(x,C)},matMult:function(x){return this.clone()._matMult(x)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(x){return this.x===x.x&&this.y===x.y},dist:function(x){return Math.sqrt(this.distSqr(x))},distSqr:function(x){var C=x.x-this.x,B=x.y-this.y;return C*C+B*B},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(x){return Math.atan2(this.y-x.y,this.x-x.x)},angleWith:function(x){return this.angleWithSep(x.x,x.y)},angleWithSep:function(x,C){return Math.atan2(this.x*C-this.y*x,this.x*x+this.y*C)},_matMult:function(x){var C=x[0]*this.x+x[1]*this.y,B=x[2]*this.x+x[3]*this.y;return this.x=C,this.y=B,this},_add:function(x){return this.x+=x.x,this.y+=x.y,this},_sub:function(x){return this.x-=x.x,this.y-=x.y,this},_mult:function(x){return this.x*=x,this.y*=x,this},_div:function(x){return this.x/=x,this.y/=x,this},_multByPoint:function(x){return this.x*=x.x,this.y*=x.y,this},_divByPoint:function(x){return this.x/=x.x,this.y/=x.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var x=this.y;return this.y=this.x,this.x=-x,this},_rotate:function(x){var C=Math.cos(x),B=Math.sin(x),ae=C*this.x-B*this.y,_e=B*this.x+C*this.y;return this.x=ae,this.y=_e,this},_rotateAround:function(x,C){var B=Math.cos(x),ae=Math.sin(x),_e=C.x+B*(this.x-C.x)-ae*(this.y-C.y),he=C.y+ae*(this.x-C.x)+B*(this.y-C.y);return this.x=_e,this.y=he,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},$.convert=function(x){return x instanceof $?x:Array.isArray(x)?new $(x[0],x[1]):x};var oe=function(x){setTimeout(function(){x.map&&x.map.doubleClickZoom&&x._ctx&&x._ctx.store&&x._ctx.store.getInitialConfigValue&&x._ctx.store.getInitialConfigValue("doubleClickZoom")&&x.map.doubleClickZoom.enable()},0)},ee=function(x){setTimeout(function(){x.map&&x.map.doubleClickZoom&&x.map.doubleClickZoom.disable()},0)},ce=function(x){if(!x||!x.type)return null;var C=Ie[x.type];if(!C)return null;if(C==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:x}]};if(C==="feature")return{type:"FeatureCollection",features:[x]};if(C==="featurecollection")return x},Ie={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function Ue(x){switch(x&&x.type||null){case"FeatureCollection":return x.features=x.features.reduce(function(C,B){return C.concat(Ue(B))},[]),x;case"Feature":return x.geometry?Ue(x.geometry).map(function(C){var B={type:"Feature",properties:JSON.parse(JSON.stringify(x.properties)),geometry:C};return x.id!==void 0&&(B.id=x.id),B}):[x];case"MultiPoint":return x.coordinates.map(function(C){return{type:"Point",coordinates:C}});case"MultiPolygon":return x.coordinates.map(function(C){return{type:"Polygon",coordinates:C}});case"MultiLineString":return x.coordinates.map(function(C){return{type:"LineString",coordinates:C}});case"GeometryCollection":return x.geometries.map(Ue).reduce(function(C,B){return C.concat(B)},[]);case"Point":case"Polygon":case"LineString":return[x]}}var ke=function(x){if(!x)return[];var C=Ue(ce(x)),B=[];return C.features.forEach(function(ae){ae.geometry&&(B=B.concat(function _e(he){return Array.isArray(he)&&he.length&&typeof he[0]=="number"?[he]:he.reduce(function(ge,je){return Array.isArray(je)&&Array.isArray(je[0])?ge.concat(_e(je)):(ge.push(je),ge)},[])}(ae.geometry.coordinates)))}),B},gt=Le(function(x){var C=x.exports=function(xe){return new B(xe)};function B(xe){this.value=xe}function ae(xe,et,dt){var Tt=[],Rt=[],Wn=!0;return function Ne(yt){var _n=dt?_e(yt):yt,mn={},Rn=!0,kt={node:_n,node_:yt,path:[].concat(Tt),parent:Rt[Rt.length-1],parents:Rt,key:Tt.slice(-1)[0],isRoot:Tt.length===0,level:Tt.length,circular:null,update:function(fn,Gr){kt.isRoot||(kt.parent.node[kt.key]=fn),kt.node=fn,Gr&&(Rn=!1)},delete:function(fn){delete kt.parent.node[kt.key],fn&&(Rn=!1)},remove:function(fn){je(kt.parent.node)?kt.parent.node.splice(kt.key,1):delete kt.parent.node[kt.key],fn&&(Rn=!1)},keys:null,before:function(fn){mn.before=fn},after:function(fn){mn.after=fn},pre:function(fn){mn.pre=fn},post:function(fn){mn.post=fn},stop:function(){Wn=!1},block:function(){Rn=!1}};if(!Wn)return kt;function Xt(){if(typeof kt.node=="object"&&kt.node!==null){kt.keys&&kt.node_===kt.node||(kt.keys=he(kt.node)),kt.isLeaf=kt.keys.length==0;for(var fn=0;fn<Rt.length;fn++)if(Rt[fn].node_===yt){kt.circular=Rt[fn];break}}else kt.isLeaf=!0,kt.keys=null;kt.notLeaf=!kt.isLeaf,kt.notRoot=!kt.isRoot}Xt();var bo=et.call(kt,kt.node);return bo!==void 0&&kt.update&&kt.update(bo),mn.before&&mn.before.call(kt,kt.node),Rn&&(typeof kt.node!="object"||kt.node===null||kt.circular||(Rt.push(kt),Xt(),Ve(kt.keys,function(fn,Gr){Tt.push(fn),mn.pre&&mn.pre.call(kt,kt.node[fn],fn);var mr=Ne(kt.node[fn]);dt&&Ge.call(kt.node,fn)&&(kt.node[fn]=mr.node),mr.isLast=Gr==kt.keys.length-1,mr.isFirst=Gr==0,mn.post&&mn.post.call(kt,mr),Tt.pop()}),Rt.pop()),mn.after&&mn.after.call(kt,kt.node)),kt}(xe).node}function _e(xe){if(typeof xe=="object"&&xe!==null){var et;if(je(xe))et=[];else if(ge(xe)==="[object Date]")et=new Date(xe.getTime?xe.getTime():xe);else if(function(Rt){return ge(Rt)==="[object RegExp]"}(xe))et=new RegExp(xe);else if(function(Rt){return ge(Rt)==="[object Error]"}(xe))et={message:xe.message};else if(function(Rt){return ge(Rt)==="[object Boolean]"}(xe))et=new Boolean(xe);else if(function(Rt){return ge(Rt)==="[object Number]"}(xe))et=new Number(xe);else if(function(Rt){return ge(Rt)==="[object String]"}(xe))et=new String(xe);else if(Object.create&&Object.getPrototypeOf)et=Object.create(Object.getPrototypeOf(xe));else if(xe.constructor===Object)et={};else{var dt=xe.constructor&&xe.constructor.prototype||xe.__proto__||{},Tt=function(){};Tt.prototype=dt,et=new Tt}return Ve(he(xe),function(Rt){et[Rt]=xe[Rt]}),et}return xe}B.prototype.get=function(xe){for(var et=this.value,dt=0;dt<xe.length;dt++){var Tt=xe[dt];if(!et||!Ge.call(et,Tt)){et=void 0;break}et=et[Tt]}return et},B.prototype.has=function(xe){for(var et=this.value,dt=0;dt<xe.length;dt++){var Tt=xe[dt];if(!et||!Ge.call(et,Tt))return!1;et=et[Tt]}return!0},B.prototype.set=function(xe,et){for(var dt=this.value,Tt=0;Tt<xe.length-1;Tt++){var Rt=xe[Tt];Ge.call(dt,Rt)||(dt[Rt]={}),dt=dt[Rt]}return dt[xe[Tt]]=et,et},B.prototype.map=function(xe){return ae(this.value,xe,!0)},B.prototype.forEach=function(xe){return this.value=ae(this.value,xe,!1),this.value},B.prototype.reduce=function(xe,et){var dt=arguments.length===1,Tt=dt?this.value:et;return this.forEach(function(Rt){this.isRoot&&dt||(Tt=xe.call(this,Tt,Rt))}),Tt},B.prototype.paths=function(){var xe=[];return this.forEach(function(et){xe.push(this.path)}),xe},B.prototype.nodes=function(){var xe=[];return this.forEach(function(et){xe.push(this.node)}),xe},B.prototype.clone=function(){var xe=[],et=[];return function dt(Tt){for(var Rt=0;Rt<xe.length;Rt++)if(xe[Rt]===Tt)return et[Rt];if(typeof Tt=="object"&&Tt!==null){var Wn=_e(Tt);return xe.push(Tt),et.push(Wn),Ve(he(Tt),function(Ne){Wn[Ne]=dt(Tt[Ne])}),xe.pop(),et.pop(),Wn}return Tt}(this.value)};var he=Object.keys||function(xe){var et=[];for(var dt in xe)et.push(dt);return et};function ge(xe){return Object.prototype.toString.call(xe)}var je=Array.isArray||function(xe){return Object.prototype.toString.call(xe)==="[object Array]"},Ve=function(xe,et){if(xe.forEach)return xe.forEach(et);for(var dt=0;dt<xe.length;dt++)et(xe[dt],dt,xe)};Ve(he(B.prototype),function(xe){C[xe]=function(et){var dt=[].slice.call(arguments,1),Tt=new B(et);return Tt[xe].apply(Tt,dt)}});var Ge=Object.hasOwnProperty||function(xe,et){return et in xe}}),_t=We;function We(x){if(!(this instanceof We))return new We(x);this._bbox=x||[1/0,1/0,-1/0,-1/0],this._valid=!!x}We.prototype.include=function(x){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],x[0]),this._bbox[1]=Math.min(this._bbox[1],x[1]),this._bbox[2]=Math.max(this._bbox[2],x[0]),this._bbox[3]=Math.max(this._bbox[3],x[1]),this},We.prototype.equals=function(x){var C;return C=x instanceof We?x.bbox():x,this._bbox[0]==C[0]&&this._bbox[1]==C[1]&&this._bbox[2]==C[2]&&this._bbox[3]==C[3]},We.prototype.center=function(x){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},We.prototype.union=function(x){var C;return this._valid=!0,C=x instanceof We?x.bbox():x,this._bbox[0]=Math.min(this._bbox[0],C[0]),this._bbox[1]=Math.min(this._bbox[1],C[1]),this._bbox[2]=Math.max(this._bbox[2],C[2]),this._bbox[3]=Math.max(this._bbox[3],C[3]),this},We.prototype.bbox=function(){return this._valid?this._bbox:null},We.prototype.contains=function(x){if(!x)return this._fastContains();if(!this._valid)return null;var C=x[0],B=x[1];return this._bbox[0]<=C&&this._bbox[1]<=B&&this._bbox[2]>=C&&this._bbox[3]>=B},We.prototype.intersect=function(x){return this._valid?(C=x instanceof We?x.bbox():x,!(this._bbox[0]>C[2]||this._bbox[2]<C[0]||this._bbox[3]<C[1]||this._bbox[1]>C[3])):null;var C},We.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var x="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",x)},We.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var At={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Dt=Object.keys(At),Qt=function(x){return Ft(x).bbox()};function Ft(x){for(var C=_t(),B=ke(x),ae=0;ae<B.length;ae++)C.include(B[ae]);return C}Qt.polygon=function(x){return Ft(x).polygon()},Qt.bboxify=function(x){return gt(x).map(function(C){C&&Dt.some(function(B){return!!C[B]&&At[B].indexOf(C.type)!==-1})&&(C.bbox=Ft(C).bbox(),this.update(C))})};function qt(x,C){var B=-90,ae=90,_e=-90,he=90,ge=270,je=-270;x.forEach(function(Ge){var xe=Qt(Ge),et=xe[1],dt=xe[3],Tt=xe[0],Rt=xe[2];et>B&&(B=et),dt<ae&&(ae=dt),dt>_e&&(_e=dt),et<he&&(he=et),Tt<ge&&(ge=Tt),Rt>je&&(je=Rt)});var Ve=C;return B+Ve.lat>85&&(Ve.lat=85-B),_e+Ve.lat>90&&(Ve.lat=90-_e),ae+Ve.lat<-85&&(Ve.lat=-85-ae),he+Ve.lat<-90&&(Ve.lat=-90-he),ge+Ve.lng<=-270&&(Ve.lng+=360*Math.ceil(Math.abs(Ve.lng)/360)),je+Ve.lng>=270&&(Ve.lng-=360*Math.ceil(Math.abs(Ve.lng)/360)),Ve}function nn(x,C){var B=qt(x.map(function(ae){return ae.toGeoJSON()}),C);x.forEach(function(ae){var _e,he=ae.getCoordinates(),ge=function(Ve){var Ge={lng:Ve[0]+B.lng,lat:Ve[1]+B.lat};return[Ge.lng,Ge.lat]},je=function(Ve){return Ve.map(function(Ge){return ge(Ge)})};ae.type===sn?_e=ge(he):ae.type===An||ae.type===Un?_e=he.map(ge):ae.type===dn||ae.type===at?_e=he.map(je):ae.type===Pt&&(_e=he.map(function(Ve){return Ve.map(function(Ge){return je(Ge)})})),ae.incomingCoords(_e)})}var Nt={onSetup:function(x){var C=this,B={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:x.featureIds||[]};return this.setSelected(B.initiallySelectedFeatureIds.filter(function(ae){return C.getFeature(ae)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),B},fireUpdate:function(){this.map.fire(Ei,{action:Ta,features:this.getSelected().map(function(x){return x.toGeoJSON()})})},fireActionable:function(){var x=this,C=this.getSelected(),B=C.filter(function(je){return x.isInstanceOf("MultiFeature",je)}),ae=!1;if(C.length>1){ae=!0;var _e=C[0].type.replace("Multi","");C.forEach(function(je){je.type.replace("Multi","")!==_e&&(ae=!1)})}var he=B.length>0,ge=C.length>0;this.setActionableState({combineFeatures:ae,uncombineFeatures:he,trash:ge})},getUniqueIds:function(x){return x.length?x.map(function(C){return C.properties.id}).filter(function(C){return C!==void 0}).reduce(function(C,B){return C.add(B),C},new nr).values():[]},stopExtendedInteractions:function(x){x.boxSelectElement&&(x.boxSelectElement.parentNode&&x.boxSelectElement.parentNode.removeChild(x.boxSelectElement),x.boxSelectElement=null),this.map.dragPan.enable(),x.boxSelecting=!1,x.canBoxSelect=!1,x.dragMoving=!1,x.canDragMove=!1},onStop:function(){oe(this)},onMouseMove:function(x){return this.stopExtendedInteractions(x),!0},onMouseOut:function(x){return!x.dragMoving||this.fireUpdate()}};Nt.onTap=Nt.onClick=function(x,C){return yo(C)?this.clickAnywhere(x,C):Vo(go)(C)?this.clickOnVertex(x,C):function(B){return!!B.featureTarget&&!!B.featureTarget.properties&&B.featureTarget.properties.meta===Nr}(C)?this.clickOnFeature(x,C):void 0},Nt.clickAnywhere=function(x){var C=this,B=this.getSelectedIds();B.length&&(this.clearSelectedFeatures(),B.forEach(function(ae){return C.doRender(ae)})),oe(this),this.stopExtendedInteractions(x)},Nt.clickOnVertex=function(x,C){this.changeMode(Qe.DIRECT_SELECT,{featureId:C.featureTarget.properties.parent,coordPath:C.featureTarget.properties.coord_path,startPos:C.lngLat}),this.updateUIClasses({mouse:He})},Nt.startOnActiveFeature=function(x,C){this.stopExtendedInteractions(x),this.map.dragPan.disable(),this.doRender(C.featureTarget.properties.id),x.canDragMove=!0,x.dragMoveLocation=C.lngLat},Nt.clickOnFeature=function(x,C){var B=this;ee(this),this.stopExtendedInteractions(x);var ae=vo(C),_e=this.getSelectedIds(),he=C.featureTarget.properties.id,ge=this.isSelected(he);if(!ae&&ge&&this.getFeature(he).type!==sn)return this.changeMode(Qe.DIRECT_SELECT,{featureId:he});ge&&ae?(this.deselect(he),this.updateUIClasses({mouse:Xe}),_e.length===1&&oe(this)):!ge&&ae?(this.select(he),this.updateUIClasses({mouse:He})):ge||ae||(_e.forEach(function(je){return B.doRender(je)}),this.setSelected(he),this.updateUIClasses({mouse:He})),this.doRender(he)},Nt.onMouseDown=function(x,C){return $r(C)?this.startOnActiveFeature(x,C):this.drawConfig.boxSelect&&function(B){return!!B.originalEvent&&!!B.originalEvent.shiftKey&&B.originalEvent.button===0}(C)?this.startBoxSelect(x,C):void 0},Nt.startBoxSelect=function(x,C){this.stopExtendedInteractions(x),this.map.dragPan.disable(),x.boxSelectStartLocation=j(C.originalEvent,this.map.getContainer()),x.canBoxSelect=!0},Nt.onTouchStart=function(x,C){if($r(C))return this.startOnActiveFeature(x,C)},Nt.onDrag=function(x,C){return x.canDragMove?this.dragMove(x,C):this.drawConfig.boxSelect&&x.canBoxSelect?this.whileBoxSelect(x,C):void 0},Nt.whileBoxSelect=function(x,C){x.boxSelecting=!0,this.updateUIClasses({mouse:ze}),x.boxSelectElement||(x.boxSelectElement=document.createElement("div"),x.boxSelectElement.classList.add(J),this.map.getContainer().appendChild(x.boxSelectElement));var B=j(C.originalEvent,this.map.getContainer()),ae=Math.min(x.boxSelectStartLocation.x,B.x),_e=Math.max(x.boxSelectStartLocation.x,B.x),he=Math.min(x.boxSelectStartLocation.y,B.y),ge=Math.max(x.boxSelectStartLocation.y,B.y),je="translate("+ae+"px, "+he+"px)";x.boxSelectElement.style.transform=je,x.boxSelectElement.style.WebkitTransform=je,x.boxSelectElement.style.width=_e-ae+"px",x.boxSelectElement.style.height=ge-he+"px"},Nt.dragMove=function(x,C){x.dragMoving=!0,C.originalEvent.stopPropagation();var B={lng:C.lngLat.lng-x.dragMoveLocation.lng,lat:C.lngLat.lat-x.dragMoveLocation.lat};nn(this.getSelected(),B),x.dragMoveLocation=C.lngLat},Nt.onMouseUp=function(x,C){var B=this;if(x.dragMoving)this.fireUpdate();else if(x.boxSelecting){var ae=[x.boxSelectStartLocation,j(C.originalEvent,this.map.getContainer())],_e=this.featuresAt(null,ae,"click"),he=this.getUniqueIds(_e).filter(function(ge){return!B.isSelected(ge)});he.length&&(this.select(he),he.forEach(function(ge){return B.doRender(ge)}),this.updateUIClasses({mouse:He}))}this.stopExtendedInteractions(x)},Nt.toDisplayFeatures=function(x,C,B){C.properties.active=this.isSelected(C.properties.id)?Ir:hi,B(C),this.fireActionable(),C.properties.active===Ir&&C.geometry.type!==sn&&ue(C).forEach(B)},Nt.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},Nt.onCombineFeatures=function(){var x=this.getSelected();if(!(x.length===0||x.length<2)){for(var C=[],B=[],ae=x[0].type.replace("Multi",""),_e=0;_e<x.length;_e++){var he=x[_e];if(he.type.replace("Multi","")!==ae)return;he.type.includes("Multi")?he.getCoordinates().forEach(function(je){C.push(je)}):C.push(he.getCoordinates()),B.push(he.toGeoJSON())}if(B.length>1){var ge=this.newFeature({type:Zt,properties:B[0].properties,geometry:{type:"Multi"+ae,coordinates:C}});this.addFeature(ge),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([ge.id]),this.map.fire(No,{createdFeatures:[ge.toGeoJSON()],deletedFeatures:B})}this.fireActionable()}},Nt.onUncombineFeatures=function(){var x=this,C=this.getSelected();if(C.length!==0){for(var B=[],ae=[],_e=function(ge){var je=C[ge];x.isInstanceOf("MultiFeature",je)&&(je.getFeatures().forEach(function(Ve){x.addFeature(Ve),Ve.properties=je.properties,B.push(Ve.toGeoJSON()),x.select([Ve.id])}),x.deleteFeature(je.id,{silent:!0}),ae.push(je.toGeoJSON()))},he=0;he<C.length;he++)_e(he);B.length>1&&this.map.fire(Jr,{createdFeatures:B,deletedFeatures:ae}),this.fireActionable()}};var cr=Vo(go),Dn=Vo(Ur),$n={fireUpdate:function(){this.map.fire(Ei,{action:Ka,features:this.getSelected().map(function(x){return x.toGeoJSON()})})},fireActionable:function(x){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:x.selectedCoordPaths.length>0})},startDragging:function(x,C){this.map.dragPan.disable(),x.canDragMove=!0,x.dragMoveLocation=C.lngLat},stopDragging:function(x){this.map.dragPan.enable(),x.dragMoving=!1,x.canDragMove=!1,x.dragMoveLocation=null},onVertex:function(x,C){this.startDragging(x,C);var B=C.featureTarget.properties,ae=x.selectedCoordPaths.indexOf(B.coord_path);vo(C)||ae!==-1?vo(C)&&ae===-1&&x.selectedCoordPaths.push(B.coord_path):x.selectedCoordPaths=[B.coord_path];var _e=this.pathsToCoordinates(x.featureId,x.selectedCoordPaths);this.setSelectedCoordinates(_e)},onMidpoint:function(x,C){this.startDragging(x,C);var B=C.featureTarget.properties;x.feature.addCoordinate(B.coord_path,B.lng,B.lat),this.fireUpdate(),x.selectedCoordPaths=[B.coord_path]},pathsToCoordinates:function(x,C){return C.map(function(B){return{feature_id:x,coord_path:B}})},onFeature:function(x,C){x.selectedCoordPaths.length===0?this.startDragging(x,C):this.stopDragging(x)},dragFeature:function(x,C,B){nn(this.getSelected(),B),x.dragMoveLocation=C.lngLat},dragVertex:function(x,C,B){for(var ae=x.selectedCoordPaths.map(function(je){return x.feature.getCoordinate(je)}),_e=qt(ae.map(function(je){return{type:Zt,properties:{},geometry:{type:sn,coordinates:je}}}),B),he=0;he<ae.length;he++){var ge=ae[he];x.feature.updateCoordinate(x.selectedCoordPaths[he],ge[0]+_e.lng,ge[1]+_e.lat)}},clickNoTarget:function(){this.changeMode(Qe.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(Qe.SIMPLE_SELECT)},clickActiveFeature:function(x){x.selectedCoordPaths=[],this.clearSelectedCoordinates(),x.feature.changed()},onSetup:function(x){var C=x.featureId,B=this.getFeature(C);if(!B)throw new Error("You must provide a featureId to enter direct_select mode");if(B.type===sn)throw new TypeError("direct_select mode doesn't handle point features");var ae={featureId:C,feature:B,dragMoveLocation:x.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:x.coordPath?[x.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(C,ae.selectedCoordPaths)),this.setSelected(C),ee(this),this.setActionableState({trash:!0}),ae},onStop:function(){oe(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(x,C,B){x.featureId===C.properties.id?(C.properties.active=Ir,B(C),ue(C,{map:this.map,midpoints:!0,selectedPaths:x.selectedCoordPaths}).forEach(B)):(C.properties.active=hi,B(C)),this.fireActionable(x)},onTrash:function(x){x.selectedCoordPaths.sort(function(C,B){return B.localeCompare(C,"en",{numeric:!0})}).forEach(function(C){return x.feature.removeCoordinate(C)}),this.fireUpdate(),x.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(x),x.feature.isValid()===!1&&(this.deleteFeature([x.featureId]),this.changeMode(Qe.SIMPLE_SELECT,{}))},onMouseMove:function(x,C){var B=$r(C),ae=cr(C),_e=x.selectedCoordPaths.length===0;return B&&_e||ae&&!_e?this.updateUIClasses({mouse:He}):this.updateUIClasses({mouse:Ut}),this.stopDragging(x),!0},onMouseOut:function(x){return x.dragMoving&&this.fireUpdate(),!0}};$n.onTouchStart=$n.onMouseDown=function(x,C){return cr(C)?this.onVertex(x,C):$r(C)?this.onFeature(x,C):Dn(C)?this.onMidpoint(x,C):void 0},$n.onDrag=function(x,C){if(x.canDragMove===!0){x.dragMoving=!0,C.originalEvent.stopPropagation();var B={lng:C.lngLat.lng-x.dragMoveLocation.lng,lat:C.lngLat.lat-x.dragMoveLocation.lat};x.selectedCoordPaths.length>0?this.dragVertex(x,C,B):this.dragFeature(x,C,B),x.dragMoveLocation=C.lngLat}},$n.onClick=function(x,C){return yo(C)?this.clickNoTarget(x,C):$r(C)?this.clickActiveFeature(x,C):$o(C)?this.clickInactive(x,C):void this.stopDragging(x)},$n.onTap=function(x,C){return yo(C)?this.clickNoTarget(x,C):$r(C)?this.clickActiveFeature(x,C):$o(C)?this.clickInactive(x,C):void 0},$n.onTouchEnd=$n.onMouseUp=function(x){x.dragMoving&&this.fireUpdate(),this.stopDragging(x)};var jr={};function sa(x,C){return!!x.lngLat&&x.lngLat.lng===C[0]&&x.lngLat.lat===C[1]}jr.onSetup=function(){var x=this.newFeature({type:Zt,properties:{},geometry:{type:sn,coordinates:[]}});return this.addFeature(x),this.clearSelectedFeatures(),this.updateUIClasses({mouse:ze}),this.activateUIButton(xt.POINT),this.setActionableState({trash:!0}),{point:x}},jr.stopDrawingAndRemove=function(x){this.deleteFeature([x.point.id],{silent:!0}),this.changeMode(Qe.SIMPLE_SELECT)},jr.onTap=jr.onClick=function(x,C){this.updateUIClasses({mouse:He}),x.point.updateCoordinate("",C.lngLat.lng,C.lngLat.lat),this.map.fire(yn,{features:[x.point.toGeoJSON()]}),this.changeMode(Qe.SIMPLE_SELECT,{featureIds:[x.point.id]})},jr.onStop=function(x){this.activateUIButton(),x.point.getCoordinate().length||this.deleteFeature([x.point.id],{silent:!0})},jr.toDisplayFeatures=function(x,C,B){var ae=C.properties.id===x.point.id;if(C.properties.active=ae?Ir:hi,!ae)return B(C)},jr.onTrash=jr.stopDrawingAndRemove,jr.onKeyUp=function(x,C){if(q(C)||A(C))return this.stopDrawingAndRemove(x,C)};var ln={onSetup:function(){var x=this.newFeature({type:Zt,properties:{},geometry:{type:dn,coordinates:[[]]}});return this.addFeature(x),this.clearSelectedFeatures(),ee(this),this.updateUIClasses({mouse:ze}),this.activateUIButton(xt.POLYGON),this.setActionableState({trash:!0}),{polygon:x,currentVertexPosition:0}},clickAnywhere:function(x,C){if(x.currentVertexPosition>0&&sa(C,x.polygon.coordinates[0][x.currentVertexPosition-1]))return this.changeMode(Qe.SIMPLE_SELECT,{featureIds:[x.polygon.id]});this.updateUIClasses({mouse:ze}),x.polygon.updateCoordinate("0."+x.currentVertexPosition,C.lngLat.lng,C.lngLat.lat),x.currentVertexPosition++,x.polygon.updateCoordinate("0."+x.currentVertexPosition,C.lngLat.lng,C.lngLat.lat)},clickOnVertex:function(x){return this.changeMode(Qe.SIMPLE_SELECT,{featureIds:[x.polygon.id]})},onMouseMove:function(x,C){x.polygon.updateCoordinate("0."+x.currentVertexPosition,C.lngLat.lng,C.lngLat.lat),_o(C)&&this.updateUIClasses({mouse:Xe})}};ln.onTap=ln.onClick=function(x,C){return _o(C)?this.clickOnVertex(x,C):this.clickAnywhere(x,C)},ln.onKeyUp=function(x,C){q(C)?(this.deleteFeature([x.polygon.id],{silent:!0}),this.changeMode(Qe.SIMPLE_SELECT)):A(C)&&this.changeMode(Qe.SIMPLE_SELECT,{featureIds:[x.polygon.id]})},ln.onStop=function(x){this.updateUIClasses({mouse:Ut}),oe(this),this.activateUIButton(),this.getFeature(x.polygon.id)!==void 0&&(x.polygon.removeCoordinate("0."+x.currentVertexPosition),x.polygon.isValid()?this.map.fire(yn,{features:[x.polygon.toGeoJSON()]}):(this.deleteFeature([x.polygon.id],{silent:!0}),this.changeMode(Qe.SIMPLE_SELECT,{},{silent:!0})))},ln.toDisplayFeatures=function(x,C,B){var ae=C.properties.id===x.polygon.id;if(C.properties.active=ae?Ir:hi,!ae)return B(C);if(C.geometry.coordinates.length!==0){var _e=C.geometry.coordinates[0].length;if(!(_e<3)){if(C.properties.meta=Nr,B(Q(x.polygon.id,C.geometry.coordinates[0][0],"0.0",!1)),_e>3){var he=C.geometry.coordinates[0].length-3;B(Q(x.polygon.id,C.geometry.coordinates[0][he],"0."+he,!1))}if(_e<=4){var ge=[[C.geometry.coordinates[0][0][0],C.geometry.coordinates[0][0][1]],[C.geometry.coordinates[0][1][0],C.geometry.coordinates[0][1][1]]];if(B({type:Zt,properties:C.properties,geometry:{coordinates:ge,type:An}}),_e===3)return}return B(C)}}},ln.onTrash=function(x){this.deleteFeature([x.polygon.id],{silent:!0}),this.changeMode(Qe.SIMPLE_SELECT)};var xo={onSetup:function(x){var C,B,ae=(x=x||{}).featureId,_e="forward";if(ae){if(!(C=this.getFeature(ae)))throw new Error("Could not find a feature with the provided featureId");var he=x.from;if(he&&he.type==="Feature"&&he.geometry&&he.geometry.type==="Point"&&(he=he.geometry),he&&he.type==="Point"&&he.coordinates&&he.coordinates.length===2&&(he=he.coordinates),!he||!Array.isArray(he))throw new Error("Please use the `from` property to indicate which point to continue the line from");var ge=C.coordinates.length-1;if(C.coordinates[ge][0]===he[0]&&C.coordinates[ge][1]===he[1])B=ge+1,C.addCoordinate.apply(C,[B].concat(C.coordinates[ge]));else{if(C.coordinates[0][0]!==he[0]||C.coordinates[0][1]!==he[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");_e="backwards",B=0,C.addCoordinate.apply(C,[B].concat(C.coordinates[0]))}}else C=this.newFeature({type:Zt,properties:{},geometry:{type:An,coordinates:[]}}),B=0,this.addFeature(C);return this.clearSelectedFeatures(),ee(this),this.updateUIClasses({mouse:ze}),this.activateUIButton(xt.LINE),this.setActionableState({trash:!0}),{line:C,currentVertexPosition:B,direction:_e}},clickAnywhere:function(x,C){if(x.currentVertexPosition>0&&sa(C,x.line.coordinates[x.currentVertexPosition-1])||x.direction==="backwards"&&sa(C,x.line.coordinates[x.currentVertexPosition+1]))return this.changeMode(Qe.SIMPLE_SELECT,{featureIds:[x.line.id]});this.updateUIClasses({mouse:ze}),x.line.updateCoordinate(x.currentVertexPosition,C.lngLat.lng,C.lngLat.lat),x.direction==="forward"?(x.currentVertexPosition++,x.line.updateCoordinate(x.currentVertexPosition,C.lngLat.lng,C.lngLat.lat)):x.line.addCoordinate(0,C.lngLat.lng,C.lngLat.lat)},clickOnVertex:function(x){return this.changeMode(Qe.SIMPLE_SELECT,{featureIds:[x.line.id]})},onMouseMove:function(x,C){x.line.updateCoordinate(x.currentVertexPosition,C.lngLat.lng,C.lngLat.lat),_o(C)&&this.updateUIClasses({mouse:Xe})}};xo.onTap=xo.onClick=function(x,C){if(_o(C))return this.clickOnVertex(x,C);this.clickAnywhere(x,C)},xo.onKeyUp=function(x,C){A(C)?this.changeMode(Qe.SIMPLE_SELECT,{featureIds:[x.line.id]}):q(C)&&(this.deleteFeature([x.line.id],{silent:!0}),this.changeMode(Qe.SIMPLE_SELECT))},xo.onStop=function(x){oe(this),this.activateUIButton(),this.getFeature(x.line.id)!==void 0&&(x.line.removeCoordinate(""+x.currentVertexPosition),x.line.isValid()?this.map.fire(yn,{features:[x.line.toGeoJSON()]}):(this.deleteFeature([x.line.id],{silent:!0}),this.changeMode(Qe.SIMPLE_SELECT,{},{silent:!0})))},xo.onTrash=function(x){this.deleteFeature([x.line.id],{silent:!0}),this.changeMode(Qe.SIMPLE_SELECT)},xo.toDisplayFeatures=function(x,C,B){var ae=C.properties.id===x.line.id;if(C.properties.active=ae?Ir:hi,!ae)return B(C);C.geometry.coordinates.length<2||(C.properties.meta=Nr,B(Q(x.line.id,C.geometry.coordinates[x.direction==="forward"?C.geometry.coordinates.length-2:1],""+(x.direction==="forward"?C.geometry.coordinates.length-2:1),!1)),B(C))};var zs={simple_select:Nt,direct_select:$n,draw_point:jr,draw_polygon:ln,draw_line_string:xo},yu={defaultMode:Qe.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}],modes:zs,controls:{},userProperties:!1},_u={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},El={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function vu(x,C){return x.map(function(B){return B.source?B:pi(B,{id:B.id+"."+C,source:C==="hot"?se:Te})})}var Ls=Le(function(x,C){var B="[object Arguments]",ae="[object Map]",_e="[object Object]",he="[object Set]",ge=/^\[object .+?Constructor\]$/,je=/^(?:0|[1-9]\d*)$/,Ve={};Ve["[object Float32Array]"]=Ve["[object Float64Array]"]=Ve["[object Int8Array]"]=Ve["[object Int16Array]"]=Ve["[object Int32Array]"]=Ve["[object Uint8Array]"]=Ve["[object Uint8ClampedArray]"]=Ve["[object Uint16Array]"]=Ve["[object Uint32Array]"]=!0,Ve[B]=Ve["[object Array]"]=Ve["[object ArrayBuffer]"]=Ve["[object Boolean]"]=Ve["[object DataView]"]=Ve["[object Date]"]=Ve["[object Error]"]=Ve["[object Function]"]=Ve[ae]=Ve["[object Number]"]=Ve[_e]=Ve["[object RegExp]"]=Ve[he]=Ve["[object String]"]=Ve["[object WeakMap]"]=!1;var Ge=typeof Ou=="object"&&Ou&&Ou.Object===Object&&Ou,xe=typeof self=="object"&&self&&self.Object===Object&&self,et=Ge||xe||Function("return this")(),dt=C&&!C.nodeType&&C,Tt=dt&&x&&!x.nodeType&&x,Rt=Tt&&Tt.exports===dt,Wn=Rt&&Ge.process,Ne=function(){try{return Wn&&Wn.binding&&Wn.binding("util")}catch{}}(),yt=Ne&&Ne.isTypedArray;function _n(fe,Ae){for(var ot=-1,Mt=fe==null?0:fe.length;++ot<Mt;)if(Ae(fe[ot],ot,fe))return!0;return!1}function mn(fe){var Ae=-1,ot=Array(fe.size);return fe.forEach(function(Mt,Sn){ot[++Ae]=[Sn,Mt]}),ot}function Rn(fe){var Ae=-1,ot=Array(fe.size);return fe.forEach(function(Mt){ot[++Ae]=Mt}),ot}var kt,Xt,bo,fn=Array.prototype,Gr=Function.prototype,mr=Object.prototype,Ds=et["__core-js_shared__"],Qr=Gr.toString,ki=mr.hasOwnProperty,Ja=(kt=/[^.]+$/.exec(Ds&&Ds.keys&&Ds.keys.IE_PROTO||""))?"Symbol(src)_1."+kt:"",Qa=mr.toString,Cl=RegExp("^"+Qr.call(ki).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Rs=Rt?et.Buffer:void 0,la=et.Symbol,Fs=et.Uint8Array,Os=mr.propertyIsEnumerable,Bs=fn.splice,jo=la?la.toStringTag:void 0,Il=Object.getOwnPropertySymbols,Pa=Rs?Rs.isBuffer:void 0,_c=(Xt=Object.keys,bo=Object,function(fe){return Xt(bo(fe))}),Pl=So(et,"DataView"),es=So(et,"Map"),Al=So(et,"Promise"),Ml=So(et,"Set"),zl=So(et,"WeakMap"),ua=So(Object,"create"),Ns=Eo(Pl),Ll=Eo(es),Dl=Eo(Al),Aa=Eo(Ml),wu=Eo(zl),Rl=la?la.prototype:void 0,Ma=Rl?Rl.valueOf:void 0;function fi(fe){var Ae=-1,ot=fe==null?0:fe.length;for(this.clear();++Ae<ot;){var Mt=fe[Ae];this.set(Mt[0],Mt[1])}}function Qi(fe){var Ae=-1,ot=fe==null?0:fe.length;for(this.clear();++Ae<ot;){var Mt=fe[Ae];this.set(Mt[0],Mt[1])}}function Ci(fe){var Ae=-1,ot=fe==null?0:fe.length;for(this.clear();++Ae<ot;){var Mt=fe[Ae];this.set(Mt[0],Mt[1])}}function wn(fe){var Ae=-1,ot=fe==null?0:fe.length;for(this.__data__=new Ci;++Ae<ot;)this.add(fe[Ae])}function wo(fe){var Ae=this.__data__=new Qi(fe);this.size=Ae.size}function Yt(fe,Ae){var ot=ca(fe),Mt=!ot&&Vs(fe),Sn=!ot&&!Mt&&mi(fe),en=!ot&&!Mt&&!Sn&&Da(fe),Fn=ot||Mt||Sn||en,Bn=Fn?function(ir,ei){for(var eo=-1,Mr=Array(ir);++eo<ir;)Mr[eo]=ei(eo);return Mr}(fe.length,String):[],Ar=Bn.length;for(var jn in fe)!Ae&&!ki.call(fe,jn)||Fn&&(jn=="length"||Sn&&(jn=="offset"||jn=="parent")||en&&(jn=="buffer"||jn=="byteLength"||jn=="byteOffset")||ns(jn,Ar))||Bn.push(jn);return Bn}function on(fe,Ae){for(var ot=fe.length;ot--;)if(Ol(fe[ot][0],Ae))return ot;return-1}function vn(fe){return fe==null?fe===void 0?"[object Undefined]":"[object Null]":jo&&jo in Object(fe)?function(Ae){var ot=ki.call(Ae,jo),Mt=Ae[jo];try{Ae[jo]=void 0;var Sn=!0}catch{}var en=Qa.call(Ae);return Sn&&(ot?Ae[jo]=Mt:delete Ae[jo]),en}(fe):function(Ae){return Qa.call(Ae)}(fe)}function Mn(fe){return Ui(fe)&&vn(fe)==B}function za(fe,Ae,ot,Mt,Sn){return fe===Ae||(fe==null||Ae==null||!Ui(fe)&&!Ui(Ae)?fe!=fe&&Ae!=Ae:function(en,Fn,Bn,Ar,jn,ir){var ei=ca(en),eo=ca(Fn),Mr=ei?"[object Array]":Ii(en),to=eo?"[object Array]":Ii(Fn),Vi=(Mr=Mr==B?_e:Mr)==_e,rs=(to=to==B?_e:to)==_e,no=Mr==to;if(no&&mi(en)){if(!mi(Fn))return!1;ei=!0,Vi=!1}if(no&&!Vi)return ir||(ir=new wo),ei||Da(en)?Su(en,Fn,Bn,Ar,jn,ir):function(In,an,os,zr,ha,ni,ko){switch(os){case"[object DataView]":if(In.byteLength!=an.byteLength||In.byteOffset!=an.byteOffset)return!1;In=In.buffer,an=an.buffer;case"[object ArrayBuffer]":return!(In.byteLength!=an.byteLength||!ni(new Fs(In),new Fs(an)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Ol(+In,+an);case"[object Error]":return In.name==an.name&&In.message==an.message;case"[object RegExp]":case"[object String]":return In==an+"";case ae:var Go=mn;case he:var qo=1&zr;if(Go||(Go=Rn),In.size!=an.size&&!qo)return!1;var Zo=ko.get(In);if(Zo)return Zo==an;zr|=2,ko.set(In,an);var ri=Su(Go(In),Go(an),zr,ha,ni,ko);return ko.delete(In),ri;case"[object Symbol]":if(Ma)return Ma.call(In)==Ma.call(an)}return!1}(en,Fn,Mr,Bn,Ar,jn,ir);if(!(1&Bn)){var To=Vi&&ki.call(en,"__wrapped__"),ti=rs&&ki.call(Fn,"__wrapped__");if(To||ti){var is=To?en.value():en,gi=ti?Fn.value():Fn;return ir||(ir=new wo),jn(is,gi,Bn,Ar,ir)}}return no?(ir||(ir=new wo),function(In,an,os,zr,ha,ni){var ko=1&os,Go=Fl(In),qo=Go.length,Zo=Fl(an).length;if(qo!=Zo&&!ko)return!1;for(var ri=qo;ri--;){var lt=Go[ri];if(!(ko?lt in an:ki.call(an,lt)))return!1}var Ul=ni.get(In);if(Ul&&ni.get(an))return Ul==an;var ro=!0;ni.set(In,an),ni.set(an,In);for(var io=ko;++ri<qo;){lt=Go[ri];var Fa=In[lt],tt=an[lt];if(zr)var as=ko?zr(tt,Fa,lt,an,In,ni):zr(Fa,tt,lt,In,an,ni);if(!(as===void 0?Fa===tt||ha(Fa,tt,os,zr,ni):as)){ro=!1;break}io||(io=lt=="constructor")}if(ro&&!io){var js=In.constructor,Oa=an.constructor;js==Oa||!("constructor"in In)||!("constructor"in an)||typeof js=="function"&&js instanceof js&&typeof Oa=="function"&&Oa instanceof Oa||(ro=!1)}return ni.delete(In),ni.delete(an),ro}(en,Fn,Bn,Ar,jn,ir)):!1}(fe,Ae,ot,Mt,za,Sn))}function La(fe){return!(!Nl(fe)||function(Ae){return!!Ja&&Ja in Ae}(fe))&&(Bl(fe)?Cl:ge).test(Eo(fe))}function vc(fe){if(ot=(Ae=fe)&&Ae.constructor,Mt=typeof ot=="function"&&ot.prototype||mr,Ae!==Mt)return _c(fe);var Ae,ot,Mt,Sn=[];for(var en in Object(fe))ki.call(fe,en)&&en!="constructor"&&Sn.push(en);return Sn}function Su(fe,Ae,ot,Mt,Sn,en){var Fn=1&ot,Bn=fe.length,Ar=Ae.length;if(Bn!=Ar&&!(Fn&&Ar>Bn))return!1;var jn=en.get(fe);if(jn&&en.get(Ae))return jn==Ae;var ir=-1,ei=!0,eo=2&ot?new wn:void 0;for(en.set(fe,Ae),en.set(Ae,fe);++ir<Bn;){var Mr=fe[ir],to=Ae[ir];if(Mt)var Vi=Fn?Mt(to,Mr,ir,Ae,fe,en):Mt(Mr,to,ir,fe,Ae,en);if(Vi!==void 0){if(Vi)continue;ei=!1;break}if(eo){if(!_n(Ae,function(rs,no){if(To=no,!eo.has(To)&&(Mr===rs||Sn(Mr,rs,ot,Mt,en)))return eo.push(no);var To})){ei=!1;break}}else if(Mr!==to&&!Sn(Mr,to,ot,Mt,en)){ei=!1;break}}return en.delete(fe),en.delete(Ae),ei}function Fl(fe){return function(Ae,ot,Mt){var Sn=ot(Ae);return ca(Ae)?Sn:function(en,Fn){for(var Bn=-1,Ar=Fn.length,jn=en.length;++Bn<Ar;)en[jn+Bn]=Fn[Bn];return en}(Sn,Mt(Ae))}(fe,Ra,ts)}function Us(fe,Ae){var ot,Mt,Sn=fe.__data__;return((Mt=typeof(ot=Ae))=="string"||Mt=="number"||Mt=="symbol"||Mt=="boolean"?ot!=="__proto__":ot===null)?Sn[typeof Ae=="string"?"string":"hash"]:Sn.map}function So(fe,Ae){var ot=function(Mt,Sn){return Mt==null?void 0:Mt[Sn]}(fe,Ae);return La(ot)?ot:void 0}fi.prototype.clear=function(){this.__data__=ua?ua(null):{},this.size=0},fi.prototype.delete=function(fe){var Ae=this.has(fe)&&delete this.__data__[fe];return this.size-=Ae?1:0,Ae},fi.prototype.get=function(fe){var Ae=this.__data__;if(ua){var ot=Ae[fe];return ot==="__lodash_hash_undefined__"?void 0:ot}return ki.call(Ae,fe)?Ae[fe]:void 0},fi.prototype.has=function(fe){var Ae=this.__data__;return ua?Ae[fe]!==void 0:ki.call(Ae,fe)},fi.prototype.set=function(fe,Ae){var ot=this.__data__;return this.size+=this.has(fe)?0:1,ot[fe]=ua&&Ae===void 0?"__lodash_hash_undefined__":Ae,this},Qi.prototype.clear=function(){this.__data__=[],this.size=0},Qi.prototype.delete=function(fe){var Ae=this.__data__,ot=on(Ae,fe);return!(ot<0)&&(ot==Ae.length-1?Ae.pop():Bs.call(Ae,ot,1),--this.size,!0)},Qi.prototype.get=function(fe){var Ae=this.__data__,ot=on(Ae,fe);return ot<0?void 0:Ae[ot][1]},Qi.prototype.has=function(fe){return on(this.__data__,fe)>-1},Qi.prototype.set=function(fe,Ae){var ot=this.__data__,Mt=on(ot,fe);return Mt<0?(++this.size,ot.push([fe,Ae])):ot[Mt][1]=Ae,this},Ci.prototype.clear=function(){this.size=0,this.__data__={hash:new fi,map:new(es||Qi),string:new fi}},Ci.prototype.delete=function(fe){var Ae=Us(this,fe).delete(fe);return this.size-=Ae?1:0,Ae},Ci.prototype.get=function(fe){return Us(this,fe).get(fe)},Ci.prototype.has=function(fe){return Us(this,fe).has(fe)},Ci.prototype.set=function(fe,Ae){var ot=Us(this,fe),Mt=ot.size;return ot.set(fe,Ae),this.size+=ot.size==Mt?0:1,this},wn.prototype.add=wn.prototype.push=function(fe){return this.__data__.set(fe,"__lodash_hash_undefined__"),this},wn.prototype.has=function(fe){return this.__data__.has(fe)},wo.prototype.clear=function(){this.__data__=new Qi,this.size=0},wo.prototype.delete=function(fe){var Ae=this.__data__,ot=Ae.delete(fe);return this.size=Ae.size,ot},wo.prototype.get=function(fe){return this.__data__.get(fe)},wo.prototype.has=function(fe){return this.__data__.has(fe)},wo.prototype.set=function(fe,Ae){var ot=this.__data__;if(ot instanceof Qi){var Mt=ot.__data__;if(!es||Mt.length<199)return Mt.push([fe,Ae]),this.size=++ot.size,this;ot=this.__data__=new Ci(Mt)}return ot.set(fe,Ae),this.size=ot.size,this};var ts=Il?function(fe){return fe==null?[]:(fe=Object(fe),function(Ae,ot){for(var Mt=-1,Sn=Ae==null?0:Ae.length,en=0,Fn=[];++Mt<Sn;){var Bn=Ae[Mt];ot(Bn,Mt,Ae)&&(Fn[en++]=Bn)}return Fn}(Il(fe),function(Ae){return Os.call(fe,Ae)}))}:function(){return[]},Ii=vn;function ns(fe,Ae){return!!(Ae=Ae==null?9007199254740991:Ae)&&(typeof fe=="number"||je.test(fe))&&fe>-1&&fe%1==0&&fe<Ae}function Eo(fe){if(fe!=null){try{return Qr.call(fe)}catch{}try{return fe+""}catch{}}return""}function Ol(fe,Ae){return fe===Ae||fe!=fe&&Ae!=Ae}(Pl&&Ii(new Pl(new ArrayBuffer(1)))!="[object DataView]"||es&&Ii(new es)!=ae||Al&&Ii(Al.resolve())!="[object Promise]"||Ml&&Ii(new Ml)!=he||zl&&Ii(new zl)!="[object WeakMap]")&&(Ii=function(fe){var Ae=vn(fe),ot=Ae==_e?fe.constructor:void 0,Mt=ot?Eo(ot):"";if(Mt)switch(Mt){case Ns:return"[object DataView]";case Ll:return ae;case Dl:return"[object Promise]";case Aa:return he;case wu:return"[object WeakMap]"}return Ae});var Vs=Mn(function(){return arguments}())?Mn:function(fe){return Ui(fe)&&ki.call(fe,"callee")&&!Os.call(fe,"callee")},ca=Array.isArray,mi=Pa||function(){return!1};function Bl(fe){if(!Nl(fe))return!1;var Ae=vn(fe);return Ae=="[object Function]"||Ae=="[object GeneratorFunction]"||Ae=="[object AsyncFunction]"||Ae=="[object Proxy]"}function $s(fe){return typeof fe=="number"&&fe>-1&&fe%1==0&&fe<=9007199254740991}function Nl(fe){var Ae=typeof fe;return fe!=null&&(Ae=="object"||Ae=="function")}function Ui(fe){return fe!=null&&typeof fe=="object"}var Da=yt?function(fe){return function(Ae){return fe(Ae)}}(yt):function(fe){return Ui(fe)&&$s(fe.length)&&!!Ve[vn(fe)]};function Ra(fe){return(Ae=fe)!=null&&$s(Ae.length)&&!Bl(Ae)?Yt(fe):vc(fe);var Ae}x.exports=function(fe,Ae){return za(fe,Ae)}}),Tl={Polygon:Vn,LineString:jt,Point:br,MultiPolygon:Kn,MultiLineString:Kn,MultiPoint:Kn};function xu(x,C){return C.modes=Qe,C.getFeatureIdsAt=function(B){return Ti.click({point:B},null,x).map(function(ae){return ae.properties.id})},C.getSelectedIds=function(){return x.store.getSelectedIds()},C.getSelected=function(){return{type:zn,features:x.store.getSelectedIds().map(function(B){return x.store.get(B)}).map(function(B){return B.toGeoJSON()})}},C.getSelectedPoints=function(){return{type:zn,features:x.store.getSelectedCoordinates().map(function(B){return{type:Zt,properties:{},geometry:{type:sn,coordinates:B.coordinates}}})}},C.set=function(B){if(B.type===void 0||B.type!==zn||!Array.isArray(B.features))throw new Error("Invalid FeatureCollection");var ae=x.store.createRenderBatch(),_e=x.store.getAllIds().slice(),he=C.add(B),ge=new nr(he);return(_e=_e.filter(function(je){return!ge.has(je)})).length&&C.delete(_e),ae(),he},C.add=function(B){var ae=JSON.parse(JSON.stringify(ce(B))).features.map(function(_e){if(_e.id=_e.id||Je(),_e.geometry===null)throw new Error("Invalid geometry: null");if(x.store.get(_e.id)===void 0||x.store.get(_e.id).type!==_e.geometry.type){var he=Tl[_e.geometry.type];if(he===void 0)throw new Error("Invalid geometry type: "+_e.geometry.type+".");var ge=new he(x,_e);x.store.add(ge)}else{var je=x.store.get(_e.id);je.properties=_e.properties,Ls(je.getCoordinates(),_e.geometry.coordinates)||je.incomingCoords(_e.geometry.coordinates)}return _e.id});return x.store.render(),ae},C.get=function(B){var ae=x.store.get(B);if(ae)return ae.toGeoJSON()},C.getAll=function(){return{type:zn,features:x.store.getAll().map(function(B){return B.toGeoJSON()})}},C.delete=function(B){return x.store.delete(B,{silent:!0}),C.getMode()!==Qe.DIRECT_SELECT||x.store.getSelectedIds().length?x.store.render():x.events.changeMode(Qe.SIMPLE_SELECT,void 0,{silent:!0}),C},C.deleteAll=function(){return x.store.delete(x.store.getAllIds(),{silent:!0}),C.getMode()===Qe.DIRECT_SELECT?x.events.changeMode(Qe.SIMPLE_SELECT,void 0,{silent:!0}):x.store.render(),C},C.changeMode=function(B,ae){return ae===void 0&&(ae={}),B===Qe.SIMPLE_SELECT&&C.getMode()===Qe.SIMPLE_SELECT?(_e=ae.featureIds||[],he=x.store.getSelectedIds(),_e.length===he.length&&JSON.stringify(_e.map(function(ge){return ge}).sort())===JSON.stringify(he.map(function(ge){return ge}).sort())||(x.store.setSelected(ae.featureIds,{silent:!0}),x.store.render()),C):(B===Qe.DIRECT_SELECT&&C.getMode()===Qe.DIRECT_SELECT&&ae.featureId===x.store.getSelectedIds()[0]||x.events.changeMode(B,ae,{silent:!0}),C);var _e,he},C.getMode=function(){return x.events.getMode()},C.trash=function(){return x.events.trash({silent:!0}),C},C.combineFeatures=function(){return x.events.combineFeatures({silent:!0}),C},C.uncombineFeatures=function(){return x.events.uncombineFeatures({silent:!0}),C},C.setFeatureProperty=function(B,ae,_e){return x.store.setFeatureProperty(B,ae,_e),C},C}var bu=function(x,C){var B={options:x=function(_e){_e===void 0&&(_e={});var he=pi(_e);return _e.controls||(he.controls={}),_e.displayControlsDefault===!1?he.controls=pi(El,_e.controls):he.controls=pi(_u,_e.controls),(he=pi(yu,he)).styles=vu(he.styles,"cold").concat(vu(he.styles,"hot")),he}(x)};C=xu(B,C),B.api=C;var ae=xn(B);return C.onAdd=ae.onAdd,C.onRemove=ae.onRemove,C.types=xt,C.options=x,C};function kl(x){bu(x,this)}return kl.modes=zs,kl})})(Hb);const aC=Hb.exports;function Xb(t){var i,s,f="";if(typeof t=="string"||typeof t=="number")f+=t;else if(typeof t=="object")if(Array.isArray(t))for(i=0;i<t.length;i++)t[i]&&(s=Xb(t[i]))&&(f&&(f+=" "),f+=s);else for(i in t)t[i]&&(f&&(f+=" "),f+=i);return f}function sl(){for(var t,i,s=0,f="";s<arguments.length;)(t=arguments[s++])&&(i=Xb(t))&&(f&&(f+=" "),f+=i);return f}var pf={exports:{}},ff={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sC=Jt.exports,lC=Symbol.for("react.element"),uC=Symbol.for("react.fragment"),cC=Object.prototype.hasOwnProperty,hC=sC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dC={key:!0,ref:!0,__self:!0,__source:!0};function Yb(t,i,s){var f,y={},v=null,T=null;s!==void 0&&(v=""+s),i.key!==void 0&&(v=""+i.key),i.ref!==void 0&&(T=i.ref);for(f in i)cC.call(i,f)&&!dC.hasOwnProperty(f)&&(y[f]=i[f]);if(t&&t.defaultProps)for(f in i=t.defaultProps,i)y[f]===void 0&&(y[f]=i[f]);return{$$typeof:lC,type:t,key:v,ref:T,props:y,_owner:hC.current}}ff.Fragment=uC;ff.jsx=Yb;ff.jsxs=Yb;(function(t){t.exports=ff})(pf);const pC=pf.exports.Fragment,$t=pf.exports.jsx,xi=pf.exports.jsxs,_h=t=>typeof t=="number"&&!isNaN(t),fu=t=>typeof t=="string",ho=t=>typeof t=="function",yp=t=>fu(t)||ho(t)?t:null,Dm=t=>Jt.exports.isValidElement(t)||fu(t)||ho(t)||_h(t);function fC(t,i,s){s===void 0&&(s=300);const{scrollHeight:f,style:y}=t;requestAnimationFrame(()=>{y.minHeight="initial",y.height=f+"px",y.transition=`all ${s}ms`,requestAnimationFrame(()=>{y.height="0",y.padding="0",y.margin="0",setTimeout(i,s)})})}function mf(t){let{enter:i,exit:s,appendPosition:f=!1,collapse:y=!0,collapseDuration:v=300}=t;return function(T){let{children:u,position:F,preventExitTransition:W,done:ie,nodeRef:ne,isIn:G}=T;const we=f?`${i}--${F}`:i,Me=f?`${s}--${F}`:s,Ce=Jt.exports.useRef(0);return Jt.exports.useLayoutEffect(()=>{const Ze=ne.current,re=we.split(" "),J=se=>{se.target===ne.current&&(Ze.dispatchEvent(new Event("d")),Ze.removeEventListener("animationend",J),Ze.removeEventListener("animationcancel",J),Ce.current===0&&se.type!=="animationcancel"&&Ze.classList.remove(...re))};Ze.classList.add(...re),Ze.addEventListener("animationend",J),Ze.addEventListener("animationcancel",J)},[]),Jt.exports.useEffect(()=>{const Ze=ne.current,re=()=>{Ze.removeEventListener("animationend",re),y?fC(Ze,ie,v):ie()};G||(W?re():(Ce.current=1,Ze.className+=` ${Me}`,Ze.addEventListener("animationend",re)))},[G]),au.createElement(au.Fragment,null,u)}}function nx(t,i){return{content:t.content,containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,status:i}}const Qo={list:new Map,emitQueue:new Map,on(t,i){return this.list.has(t)||this.list.set(t,[]),this.list.get(t).push(i),this},off(t,i){if(i){const s=this.list.get(t).filter(f=>f!==i);return this.list.set(t,s),this}return this.list.delete(t),this},cancelEmit(t){const i=this.emitQueue.get(t);return i&&(i.forEach(clearTimeout),this.emitQueue.delete(t)),this},emit(t){this.list.has(t)&&this.list.get(t).forEach(i=>{const s=setTimeout(()=>{i(...[].slice.call(arguments,1))},0);this.emitQueue.has(t)||this.emitQueue.set(t,[]),this.emitQueue.get(t).push(s)})}},tp=t=>{let{theme:i,type:s,...f}=t;return $t("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:i==="colored"?"currentColor":`var(--toastify-icon-color-${s})`,...f})},Rm={info:function(t){return $t(tp,{...t,children:$t("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"})})},warning:function(t){return $t(tp,{...t,children:$t("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"})})},success:function(t){return $t(tp,{...t,children:$t("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"})})},error:function(t){return $t(tp,{...t,children:$t("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"})})},spinner:function(){return $t("div",{className:"Toastify__spinner"})}};function mC(t){const[,i]=Jt.exports.useReducer(we=>we+1,0),[s,f]=Jt.exports.useState([]),y=Jt.exports.useRef(null),v=Jt.exports.useRef(new Map).current,T=we=>s.indexOf(we)!==-1,u=Jt.exports.useRef({toastKey:1,displayedToast:0,count:0,queue:[],props:t,containerId:null,isToastActive:T,getToast:we=>v.get(we)}).current;function F(we){let{containerId:Me}=we;const{limit:Ce}=u.props;!Ce||Me&&u.containerId!==Me||(u.count-=u.queue.length,u.queue=[])}function W(we){f(Me=>we==null?[]:Me.filter(Ce=>Ce!==we))}function ie(){const{toastContent:we,toastProps:Me,staleId:Ce}=u.queue.shift();G(we,Me,Ce)}function ne(we,Me){let{delay:Ce,staleId:Ze,...re}=Me;if(!Dm(we)||function(dn){return!y.current||u.props.enableMultiContainer&&dn.containerId!==u.props.containerId||v.has(dn.toastId)&&dn.updateId==null}(re))return;const{toastId:J,updateId:se,data:Te}=re,{props:ze}=u,He=()=>W(J),it=se==null;it&&u.count++;const Xe={...ze,style:ze.toastStyle,key:u.toastKey++,...re,toastId:J,updateId:se,data:Te,closeToast:He,isIn:!1,className:yp(re.className||ze.toastClassName),bodyClassName:yp(re.bodyClassName||ze.bodyClassName),progressClassName:yp(re.progressClassName||ze.progressClassName),autoClose:!re.isLoading&&(Ut=re.autoClose,xt=ze.autoClose,Ut===!1||_h(Ut)&&Ut>0?Ut:xt),deleteToast(){const dn=nx(v.get(J),"removed");v.delete(J),Qo.emit(4,dn);const An=u.queue.length;if(u.count=J==null?u.count-u.displayedToast:u.count-1,u.count<0&&(u.count=0),An>0){const sn=J==null?u.props.limit:1;if(An===1||sn===1)u.displayedToast++,ie();else{const zn=sn>An?An:sn;u.displayedToast=zn;for(let mt=0;mt<zn;mt++)ie()}}else i()}};var Ut,xt;Xe.iconOut=function(dn){let{theme:An,type:sn,isLoading:zn,icon:mt}=dn,Un=null;const at={theme:An,type:sn};return mt===!1||(ho(mt)?Un=mt(at):Jt.exports.isValidElement(mt)?Un=Jt.exports.cloneElement(mt,at):fu(mt)||_h(mt)?Un=mt:zn?Un=Rm.spinner():(Pt=>Pt in Rm)(sn)&&(Un=Rm[sn](at))),Un}(Xe),ho(re.onOpen)&&(Xe.onOpen=re.onOpen),ho(re.onClose)&&(Xe.onClose=re.onClose),Xe.closeButton=ze.closeButton,re.closeButton===!1||Dm(re.closeButton)?Xe.closeButton=re.closeButton:re.closeButton===!0&&(Xe.closeButton=!Dm(ze.closeButton)||ze.closeButton);let Zt=we;Jt.exports.isValidElement(we)&&!fu(we.type)?Zt=Jt.exports.cloneElement(we,{closeToast:He,toastProps:Xe,data:Te}):ho(we)&&(Zt=we({closeToast:He,toastProps:Xe,data:Te})),ze.limit&&ze.limit>0&&u.count>ze.limit&&it?u.queue.push({toastContent:Zt,toastProps:Xe,staleId:Ze}):_h(Ce)?setTimeout(()=>{G(Zt,Xe,Ze)},Ce):G(Zt,Xe,Ze)}function G(we,Me,Ce){const{toastId:Ze}=Me;Ce&&v.delete(Ce);const re={content:we,props:Me};v.set(Ze,re),f(J=>[...J,Ze].filter(se=>se!==Ce)),Qo.emit(4,nx(re,re.props.updateId==null?"added":"updated"))}return Jt.exports.useEffect(()=>(u.containerId=t.containerId,Qo.cancelEmit(3).on(0,ne).on(1,we=>y.current&&W(we)).on(5,F).emit(2,u),()=>{v.clear(),Qo.emit(3,u)}),[]),Jt.exports.useEffect(()=>{u.props=t,u.isToastActive=T,u.displayedToast=s.length}),{getToastToRender:function(we){const Me=new Map,Ce=Array.from(v.values());return t.newestOnTop&&Ce.reverse(),Ce.forEach(Ze=>{const{position:re}=Ze.props;Me.has(re)||Me.set(re,[]),Me.get(re).push(Ze)}),Array.from(Me,Ze=>we(Ze[0],Ze[1]))},containerRef:y,isToastActive:T}}function rx(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientX:t.clientX}function ix(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientY:t.clientY}function gC(t){const[i,s]=Jt.exports.useState(!1),[f,y]=Jt.exports.useState(!1),v=Jt.exports.useRef(null),T=Jt.exports.useRef({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,u=Jt.exports.useRef(t),{autoClose:F,pauseOnHover:W,closeToast:ie,onClick:ne,closeOnClick:G}=t;function we(Te){if(t.draggable){Te.nativeEvent.type==="touchstart"&&Te.nativeEvent.preventDefault(),T.didMove=!1,document.addEventListener("mousemove",re),document.addEventListener("mouseup",J),document.addEventListener("touchmove",re),document.addEventListener("touchend",J);const ze=v.current;T.canCloseOnClick=!0,T.canDrag=!0,T.boundingRect=ze.getBoundingClientRect(),ze.style.transition="",T.x=rx(Te.nativeEvent),T.y=ix(Te.nativeEvent),t.draggableDirection==="x"?(T.start=T.x,T.removalDistance=ze.offsetWidth*(t.draggablePercent/100)):(T.start=T.y,T.removalDistance=ze.offsetHeight*(t.draggablePercent===80?1.5*t.draggablePercent:t.draggablePercent/100))}}function Me(Te){if(T.boundingRect){const{top:ze,bottom:He,left:it,right:Xe}=T.boundingRect;Te.nativeEvent.type!=="touchend"&&t.pauseOnHover&&T.x>=it&&T.x<=Xe&&T.y>=ze&&T.y<=He?Ze():Ce()}}function Ce(){s(!0)}function Ze(){s(!1)}function re(Te){const ze=v.current;T.canDrag&&ze&&(T.didMove=!0,i&&Ze(),T.x=rx(Te),T.y=ix(Te),T.delta=t.draggableDirection==="x"?T.x-T.start:T.y-T.start,T.start!==T.x&&(T.canCloseOnClick=!1),ze.style.transform=`translate${t.draggableDirection}(${T.delta}px)`,ze.style.opacity=""+(1-Math.abs(T.delta/T.removalDistance)))}function J(){document.removeEventListener("mousemove",re),document.removeEventListener("mouseup",J),document.removeEventListener("touchmove",re),document.removeEventListener("touchend",J);const Te=v.current;if(T.canDrag&&T.didMove&&Te){if(T.canDrag=!1,Math.abs(T.delta)>T.removalDistance)return y(!0),void t.closeToast();Te.style.transition="transform 0.2s, opacity 0.2s",Te.style.transform=`translate${t.draggableDirection}(0)`,Te.style.opacity="1"}}Jt.exports.useEffect(()=>{u.current=t}),Jt.exports.useEffect(()=>(v.current&&v.current.addEventListener("d",Ce,{once:!0}),ho(t.onOpen)&&t.onOpen(Jt.exports.isValidElement(t.children)&&t.children.props),()=>{const Te=u.current;ho(Te.onClose)&&Te.onClose(Jt.exports.isValidElement(Te.children)&&Te.children.props)}),[]),Jt.exports.useEffect(()=>(t.pauseOnFocusLoss&&(document.hasFocus()||Ze(),window.addEventListener("focus",Ce),window.addEventListener("blur",Ze)),()=>{t.pauseOnFocusLoss&&(window.removeEventListener("focus",Ce),window.removeEventListener("blur",Ze))}),[t.pauseOnFocusLoss]);const se={onMouseDown:we,onTouchStart:we,onMouseUp:Me,onTouchEnd:Me};return F&&W&&(se.onMouseEnter=Ze,se.onMouseLeave=Ce),G&&(se.onClick=Te=>{ne&&ne(Te),T.canCloseOnClick&&ie()}),{playToast:Ce,pauseToast:Ze,isRunning:i,preventExitTransition:f,toastRef:v,eventHandlers:se}}function Kb(t){let{closeToast:i,theme:s,ariaLabel:f="close"}=t;return $t("button",{className:`Toastify__close-button Toastify__close-button--${s}`,type:"button",onClick:y=>{y.stopPropagation(),i(y)},"aria-label":f,children:$t("svg",{"aria-hidden":"true",viewBox:"0 0 14 16",children:$t("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})})})}function yC(t){let{delay:i,isRunning:s,closeToast:f,type:y="default",hide:v,className:T,style:u,controlledProgress:F,progress:W,rtl:ie,isIn:ne,theme:G}=t;const we=v||F&&W===0,Me={...u,animationDuration:`${i}ms`,animationPlayState:s?"running":"paused",opacity:we?0:1};F&&(Me.transform=`scaleX(${W})`);const Ce=sl("Toastify__progress-bar",F?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${G}`,`Toastify__progress-bar--${y}`,{"Toastify__progress-bar--rtl":ie}),Ze=ho(T)?T({rtl:ie,type:y,defaultClassName:Ce}):sl(Ce,T);return au.createElement("div",{role:"progressbar","aria-hidden":we?"true":"false","aria-label":"notification timer",className:Ze,style:Me,[F&&W>=1?"onTransitionEnd":"onAnimationEnd"]:F&&W<1?null:()=>{ne&&f()}})}const _C=t=>{const{isRunning:i,preventExitTransition:s,toastRef:f,eventHandlers:y}=gC(t),{closeButton:v,children:T,autoClose:u,onClick:F,type:W,hideProgressBar:ie,closeToast:ne,transition:G,position:we,className:Me,style:Ce,bodyClassName:Ze,bodyStyle:re,progressClassName:J,progressStyle:se,updateId:Te,role:ze,progress:He,rtl:it,toastId:Xe,deleteToast:Ut,isIn:xt,isLoading:Zt,iconOut:dn,closeOnClick:An,theme:sn}=t,zn=sl("Toastify__toast",`Toastify__toast-theme--${sn}`,`Toastify__toast--${W}`,{"Toastify__toast--rtl":it},{"Toastify__toast--close-on-click":An}),mt=ho(Me)?Me({rtl:it,position:we,type:W,defaultClassName:zn}):sl(zn,Me),Un=!!He||!u,at={closeToast:ne,type:W,theme:sn};let Pt=null;return v===!1||(Pt=ho(v)?v(at):Jt.exports.isValidElement(v)?Jt.exports.cloneElement(v,at):Kb(at)),au.createElement(G,{isIn:xt,done:Ut,position:we,preventExitTransition:s,nodeRef:f},xi("div",{id:Xe,onClick:F,className:mt,...y,style:Ce,ref:f,children:[xi("div",{...xt&&{role:ze},className:ho(Ze)?Ze({type:W}):sl("Toastify__toast-body",Ze),style:re,children:[dn!=null&&$t("div",{className:sl("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!Zt}),children:dn}),$t("div",{children:T})]}),Pt,$t(yC,{...Te&&!Un?{key:`pb-${Te}`}:{},rtl:it,theme:sn,delay:u,isRunning:i,isIn:xt,closeToast:ne,hide:ie,type:W,style:se,className:J,controlledProgress:Un,progress:He||0})]}))},gf=function(t,i){return i===void 0&&(i=!1),{enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:i}},vC=mf(gf("bounce",!0));mf(gf("slide",!0));mf(gf("zoom"));mf(gf("flip"));const Gg=Jt.exports.forwardRef((t,i)=>{const{getToastToRender:s,containerRef:f,isToastActive:y}=mC(t),{className:v,style:T,rtl:u,containerId:F}=t;function W(ie){const ne=sl("Toastify__toast-container",`Toastify__toast-container--${ie}`,{"Toastify__toast-container--rtl":u});return ho(v)?v({position:ie,rtl:u,defaultClassName:ne}):sl(ne,yp(v))}return Jt.exports.useEffect(()=>{i&&(i.current=f.current)},[]),$t("div",{ref:f,className:"Toastify",id:F,children:s((ie,ne)=>{const G=ne.length?{...T}:{...T,pointerEvents:"none"};return $t("div",{className:W(ie),style:G,children:ne.map((we,Me)=>{let{content:Ce,props:Ze}=we;return Jt.exports.createElement(_C,{...Ze,isIn:y(Ze.toastId),style:{...Ze.style,"--nth":Me+1,"--len":ne.length},key:`toast-${Ze.key}`},Ce)})},`container-${ie}`)})})});Gg.displayName="ToastContainer",Gg.defaultProps={position:"top-right",transition:vC,autoClose:5e3,closeButton:Kb,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};let Fm,Jl=new Map,ah=[],xC=1;function Jb(){return""+xC++}function bC(t){return t&&(fu(t.toastId)||_h(t.toastId))?t.toastId:Jb()}function vh(t,i){return Jl.size>0?Qo.emit(0,t,i):ah.push({content:t,options:i}),i.toastId}function Zp(t,i){return{...i,type:i&&i.type||t,toastId:bC(i)}}function np(t){return(i,s)=>vh(i,Zp(t,s))}function sr(t,i){return vh(t,Zp("default",i))}sr.loading=(t,i)=>vh(t,Zp("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...i})),sr.promise=function(t,i,s){let f,{pending:y,error:v,success:T}=i;y&&(f=fu(y)?sr.loading(y,s):sr.loading(y.render,{...s,...y}));const u={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null,delay:100},F=(ie,ne,G)=>{if(ne==null)return void sr.dismiss(f);const we={type:ie,...u,...s,data:G},Me=fu(ne)?{render:ne}:ne;return f?sr.update(f,{...we,...Me}):sr(Me.render,{...we,...Me}),G},W=ho(t)?t():t;return W.then(ie=>F("success",T,ie)).catch(ie=>F("error",v,ie)),W},sr.success=np("success"),sr.info=np("info"),sr.error=np("error"),sr.warning=np("warning"),sr.warn=sr.warning,sr.dark=(t,i)=>vh(t,Zp("default",{theme:"dark",...i})),sr.dismiss=t=>{Jl.size>0?Qo.emit(1,t):ah=ah.filter(i=>t!=null&&i.options.toastId!==t)},sr.clearWaitingQueue=function(t){return t===void 0&&(t={}),Qo.emit(5,t)},sr.isActive=t=>{let i=!1;return Jl.forEach(s=>{s.isToastActive&&s.isToastActive(t)&&(i=!0)}),i},sr.update=function(t,i){i===void 0&&(i={}),setTimeout(()=>{const s=function(f,y){let{containerId:v}=y;const T=Jl.get(v||Fm);return T&&T.getToast(f)}(t,i);if(s){const{props:f,content:y}=s,v={...f,...i,toastId:i.toastId||t,updateId:Jb()};v.toastId!==t&&(v.staleId=t);const T=v.render||y;delete v.render,vh(T,v)}},0)},sr.done=t=>{sr.update(t,{progress:1})},sr.onChange=t=>(Qo.on(4,t),()=>{Qo.off(4,t)}),sr.POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},sr.TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},Qo.on(2,t=>{Fm=t.containerId||t,Jl.set(Fm,t),ah.forEach(i=>{Qo.emit(0,i.content,i.options)}),ah=[]}).on(3,t=>{Jl.delete(t.containerId||t),Jl.size===0&&Qo.off(0).off(1).off(5)});function wC(t){const i=Jt.exports.useRef(null),s=Jt.exports.useRef(null),[f,y]=Jt.exports.useState({lng:23.061283454082968,lat:38.17137059297082}),[v,T]=Jt.exports.useState(5.8),u=t.basemap;function F(){s.current.getStyle().layers.forEach(ne=>{ne.id.includes("-basemap")&&(console.log(ne.id),ne.id.includes(u)?s.current.setLayoutProperty(ne.id,"visibility","visible"):s.current.setLayoutProperty(ne.id,"visibility","none"))})}Jt.exports.useEffect(()=>{if(s.current)try{F();return}catch{}s.current=new ep.Map({container:i.current,style:"map_conf.json",center:f,zoom:v,hash:!0}),s.current.addControl(new ep.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0})),s.current.addControl(new aC({displayControlsDefault:!1,controls:{polygon:!0,trash:!0}})),s.current.addControl(new ep.ScaleControl({maxWidth:200,unit:"metric"},"bottomright")),s.current.addControl(new ep.TerrainControl({source:"terrainSource",exaggeration:1})),s.current.on("draw.create",ie=>{W(ie,"Selection created succesfully")}),s.current.on("draw.update",ie=>{W(ie,"Selection updated succesfully")}),s.current.on("draw.delete",ie=>{W(ie,"Selection deleted succesfully")}),window.map=s.current},[u,s.current]),Jt.exports.useEffect(()=>{},[u]);function W(ie,ne){const G=ie.features[0];console.log(G),sr(ne)}return xi(pC,{children:[$t("div",{ref:i,id:"map"}),$t(Gg,{position:"bottom-right",autoClose:5e3,theme:"colored",pauseOnFocusLoss:!0})]})}function SC(){const[t,i]=Jt.exports.useState(!1),[s,f]=Jt.exports.useState("bing");function y(W){f(W.target.value)}function v(){document.getElementsByClassName("mapbox-gl-draw_polygon")[0].click()}function T(){document.getElementsByClassName("mapbox-gl-draw_trash")[0].click()}function u(){document.getElementsByClassName("mapboxgl-ctrl-geolocate")[0].click()}function F(W){i(W.target.checked);try{document.getElementsByClassName("maplibregl-ctrl-terrain")[0].click()}catch{document.getElementsByClassName("maplibregl-ctrl-terrain-enabled")[0].click()}}return xi("div",{className:"drawer drawer-mobile",style:{position:"absolute"},children:[$t("input",{id:"my-drawer-2",type:"checkbox",className:"drawer-toggle"}),xi("div",{className:"drawer-content flex flex-col items-center justify-center",children:[xi("label",{htmlFor:"my-drawer-2",className:"btn btn-circle  lg:hidden",style:{zIndex:1e3,position:"absolute",top:0,left:0,margin:"10px"},children:[$t(vs,{icon:tC})," "]}),$t(wC,{use3d:t,basemap:s})]}),xi("div",{className:"drawer-side z-50 shadow shadow-lg",children:[$t("label",{htmlFor:"my-drawer-2",className:"drawer-overlay"}),$t("div",{className:"menu p-4 w-60 bg-base-100 ",children:xi("div",{className:"h-full",style:{display:"flex",flexDirection:"column"},children:[$t("label",{htmlFor:"my-drawer-2",className:"btn btn-circle btn-outline lg:hidden ",style:{alignSelf:"end"},children:$t("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:$t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),$t("h1",{className:"font-bold",style:{marginBottom:"40px"},children:"Terra Pindus"}),xi("ul",{style:{display:"flex",flexDirection:"column"},children:[$t("li",{children:xi("a",{onClick:v,children:[" ",$t(vs,{icon:oC})," Select area"]})}),$t("li",{children:xi("a",{onClick:T,children:[" ",$t(vs,{icon:iC}),"Delete selection"]})}),xi("li",{className:"prose mt-5",children:[$t("h5",{children:"Basemap"}),xi("select",{className:"select select-bordered w-full max-w-xs prose",onChange:y,children:[$t("option",{value:"bing",children:"   Bing"}),$t("option",{value:"ktima",children:"            Cadastre"}),$t("option",{value:"esri",children:"            ESRI"}),$t("option",{value:"thunderforest",children:"            OSM"})]})]}),$t("div",{className:"divider"}),$t("li",{children:xi("a",{onClick:u,children:[" ",$t(vs,{icon:rC}),"My Location"]})})]}),xi("ul",{style:{display:"flex",flexDirection:"column",marginTop:"auto"},children:[xi("li",{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:["3D  ",$t("input",{type:"checkbox",className:"toggle",checked:t,onChange:F})]}),$t("div",{className:"divider"}),$t("li",{children:xi("a",{children:[" ",$t(vs,{icon:nC})," \u0395\u03AF\u03C3\u03BF\u03B4\u03BF\u03C2   "]})})]})]})})]})]})}function EC(){return Jt.exports.useState(0),$t("div",{className:"App",children:$t(SC,{})})}Om.createRoot(document.getElementById("root")).render($t(au.StrictMode,{children:$t(EC,{})}));
