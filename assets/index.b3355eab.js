(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))f(_);new MutationObserver(_=>{for(const v of _)if(v.type==="childList")for(const T of v.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&f(T)}).observe(document,{childList:!0,subtree:!0});function s(_){const v={};return _.integrity&&(v.integrity=_.integrity),_.referrerpolicy&&(v.referrerPolicy=_.referrerpolicy),_.crossorigin==="use-credentials"?v.credentials="include":_.crossorigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function f(_){if(_.ep)return;_.ep=!0;const v=s(_);fetch(_.href,v)}})();var L2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function R2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _t={exports:{}},Rt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $c=Symbol.for("react.element"),B2=Symbol.for("react.portal"),F2=Symbol.for("react.fragment"),O2=Symbol.for("react.strict_mode"),N2=Symbol.for("react.profiler"),U2=Symbol.for("react.provider"),V2=Symbol.for("react.context"),$2=Symbol.for("react.forward_ref"),j2=Symbol.for("react.suspense"),G2=Symbol.for("react.memo"),q2=Symbol.for("react.lazy"),pv=Symbol.iterator;function Z2(t){return t===null||typeof t!="object"?null:(t=pv&&t[pv]||t["@@iterator"],typeof t=="function"?t:null)}var ex={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tx=Object.assign,nx={};function Xl(t,i,s){this.props=t,this.context=i,this.refs=nx,this.updater=s||ex}Xl.prototype.isReactComponent={};Xl.prototype.setState=function(t,i){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,i,"setState")};Xl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function rx(){}rx.prototype=Xl.prototype;function Og(t,i,s){this.props=t,this.context=i,this.refs=nx,this.updater=s||ex}var Ng=Og.prototype=new rx;Ng.constructor=Og;tx(Ng,Xl.prototype);Ng.isPureReactComponent=!0;var fv=Array.isArray,ix=Object.prototype.hasOwnProperty,Ug={current:null},ax={key:!0,ref:!0,__self:!0,__source:!0};function ox(t,i,s){var f,_={},v=null,T=null;if(i!=null)for(f in i.ref!==void 0&&(T=i.ref),i.key!==void 0&&(v=""+i.key),i)ix.call(i,f)&&!ax.hasOwnProperty(f)&&(_[f]=i[f]);var u=arguments.length-2;if(u===1)_.children=s;else if(1<u){for(var L=Array(u),q=0;q<u;q++)L[q]=arguments[q+2];_.children=L}if(t&&t.defaultProps)for(f in u=t.defaultProps,u)_[f]===void 0&&(_[f]=u[f]);return{$$typeof:$c,type:t,key:v,ref:T,props:_,_owner:Ug.current}}function W2(t,i){return{$$typeof:$c,type:t.type,key:i,ref:t.ref,props:t.props,_owner:t._owner}}function Vg(t){return typeof t=="object"&&t!==null&&t.$$typeof===$c}function H2(t){var i={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(s){return i[s]})}var mv=/\/+/g;function Yf(t,i){return typeof t=="object"&&t!==null&&t.key!=null?H2(""+t.key):i.toString(36)}function zd(t,i,s,f,_){var v=typeof t;(v==="undefined"||v==="boolean")&&(t=null);var T=!1;if(t===null)T=!0;else switch(v){case"string":case"number":T=!0;break;case"object":switch(t.$$typeof){case $c:case B2:T=!0}}if(T)return T=t,_=_(T),t=f===""?"."+Yf(T,0):f,fv(_)?(s="",t!=null&&(s=t.replace(mv,"$&/")+"/"),zd(_,i,s,"",function(q){return q})):_!=null&&(Vg(_)&&(_=W2(_,s+(!_.key||T&&T.key===_.key?"":(""+_.key).replace(mv,"$&/")+"/")+t)),i.push(_)),1;if(T=0,f=f===""?".":f+":",fv(t))for(var u=0;u<t.length;u++){v=t[u];var L=f+Yf(v,u);T+=zd(v,i,s,L,_)}else if(L=Z2(t),typeof L=="function")for(t=L.call(t),u=0;!(v=t.next()).done;)v=v.value,L=f+Yf(v,u++),T+=zd(v,i,s,L,_);else if(v==="object")throw i=String(t),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return T}function rd(t,i,s){if(t==null)return t;var f=[],_=0;return zd(t,f,"","",function(v){return i.call(s,v,_++)}),f}function X2(t){if(t._status===-1){var i=t._result;i=i(),i.then(function(s){(t._status===0||t._status===-1)&&(t._status=1,t._result=s)},function(s){(t._status===0||t._status===-1)&&(t._status=2,t._result=s)}),t._status===-1&&(t._status=0,t._result=i)}if(t._status===1)return t._result.default;throw t._result}var Fr={current:null},Md={transition:null},Y2={ReactCurrentDispatcher:Fr,ReactCurrentBatchConfig:Md,ReactCurrentOwner:Ug};Rt.Children={map:rd,forEach:function(t,i,s){rd(t,function(){i.apply(this,arguments)},s)},count:function(t){var i=0;return rd(t,function(){i++}),i},toArray:function(t){return rd(t,function(i){return i})||[]},only:function(t){if(!Vg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Rt.Component=Xl;Rt.Fragment=F2;Rt.Profiler=N2;Rt.PureComponent=Og;Rt.StrictMode=O2;Rt.Suspense=j2;Rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y2;Rt.cloneElement=function(t,i,s){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var f=tx({},t.props),_=t.key,v=t.ref,T=t._owner;if(i!=null){if(i.ref!==void 0&&(v=i.ref,T=Ug.current),i.key!==void 0&&(_=""+i.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(L in i)ix.call(i,L)&&!ax.hasOwnProperty(L)&&(f[L]=i[L]===void 0&&u!==void 0?u[L]:i[L])}var L=arguments.length-2;if(L===1)f.children=s;else if(1<L){u=Array(L);for(var q=0;q<L;q++)u[q]=arguments[q+2];f.children=u}return{$$typeof:$c,type:t.type,key:_,ref:v,props:f,_owner:T}};Rt.createContext=function(t){return t={$$typeof:V2,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:U2,_context:t},t.Consumer=t};Rt.createElement=ox;Rt.createFactory=function(t){var i=ox.bind(null,t);return i.type=t,i};Rt.createRef=function(){return{current:null}};Rt.forwardRef=function(t){return{$$typeof:$2,render:t}};Rt.isValidElement=Vg;Rt.lazy=function(t){return{$$typeof:q2,_payload:{_status:-1,_result:t},_init:X2}};Rt.memo=function(t,i){return{$$typeof:G2,type:t,compare:i===void 0?null:i}};Rt.startTransition=function(t){var i=Md.transition;Md.transition={};try{t()}finally{Md.transition=i}};Rt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Rt.useCallback=function(t,i){return Fr.current.useCallback(t,i)};Rt.useContext=function(t){return Fr.current.useContext(t)};Rt.useDebugValue=function(){};Rt.useDeferredValue=function(t){return Fr.current.useDeferredValue(t)};Rt.useEffect=function(t,i){return Fr.current.useEffect(t,i)};Rt.useId=function(){return Fr.current.useId()};Rt.useImperativeHandle=function(t,i,s){return Fr.current.useImperativeHandle(t,i,s)};Rt.useInsertionEffect=function(t,i){return Fr.current.useInsertionEffect(t,i)};Rt.useLayoutEffect=function(t,i){return Fr.current.useLayoutEffect(t,i)};Rt.useMemo=function(t,i){return Fr.current.useMemo(t,i)};Rt.useReducer=function(t,i,s){return Fr.current.useReducer(t,i,s)};Rt.useRef=function(t){return Fr.current.useRef(t)};Rt.useState=function(t){return Fr.current.useState(t)};Rt.useSyncExternalStore=function(t,i,s){return Fr.current.useSyncExternalStore(t,i,s)};Rt.useTransition=function(){return Fr.current.useTransition()};Rt.version="18.2.0";(function(t){t.exports=Rt})(_t);const Ms=R2(_t.exports);var Pm={},sx={exports:{}},li={},lx={exports:{}},ux={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function i($e,st){var pt=$e.length;$e.push(st);e:for(;0<pt;){var Gt=pt-1>>>1,en=$e[Gt];if(0<_(en,st))$e[Gt]=st,$e[pt]=en,pt=Gt;else break e}}function s($e){return $e.length===0?null:$e[0]}function f($e){if($e.length===0)return null;var st=$e[0],pt=$e.pop();if(pt!==st){$e[0]=pt;e:for(var Gt=0,en=$e.length,Xr=en>>>1;Gt<Xr;){var cr=2*(Gt+1)-1,hr=$e[cr],Xn=cr+1,br=$e[Xn];if(0>_(hr,pt))Xn<en&&0>_(br,hr)?($e[Gt]=br,$e[Xn]=pt,Gt=Xn):($e[Gt]=hr,$e[cr]=pt,Gt=cr);else if(Xn<en&&0>_(br,pt))$e[Gt]=br,$e[Xn]=pt,Gt=Xn;else break e}}return st}function _($e,st){var pt=$e.sortIndex-st.sortIndex;return pt!==0?pt:$e.id-st.id}if(typeof performance=="object"&&typeof performance.now=="function"){var v=performance;t.unstable_now=function(){return v.now()}}else{var T=Date,u=T.now();t.unstable_now=function(){return T.now()-u}}var L=[],q=[],ne=1,Q=null,V=3,pe=!1,be=!1,ye=!1,ze=typeof setTimeout=="function"?setTimeout:null,ee=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ie($e){for(var st=s(q);st!==null;){if(st.callback===null)f(q);else if(st.startTime<=$e)f(q),st.sortIndex=st.expirationTime,i(L,st);else break;st=s(q)}}function xe($e){if(ye=!1,ie($e),!be)if(s(L)!==null)be=!0,Ke(Ee);else{var st=s(q);st!==null&&hn(xe,st.startTime-$e)}}function Ee($e,st){be=!1,ye&&(ye=!1,ee(Le),Le=-1),pe=!0;var pt=V;try{for(ie(st),Q=s(L);Q!==null&&(!(Q.expirationTime>st)||$e&&!Ht());){var Gt=Q.callback;if(typeof Gt=="function"){Q.callback=null,V=Q.priorityLevel;var en=Gt(Q.expirationTime<=st);st=t.unstable_now(),typeof en=="function"?Q.callback=en:Q===s(L)&&f(L),ie(st)}else f(L);Q=s(L)}if(Q!==null)var Xr=!0;else{var cr=s(q);cr!==null&&hn(xe,cr.startTime-st),Xr=!1}return Xr}finally{Q=null,V=pt,pe=!1}}var Oe=!1,Ve=null,Le=-1,vt=5,ht=-1;function Ht(){return!(t.unstable_now()-ht<vt)}function Kt(){if(Ve!==null){var $e=t.unstable_now();ht=$e;var st=!0;try{st=Ve(!0,$e)}finally{st?vn():(Oe=!1,Ve=null)}}else Oe=!1}var vn;if(typeof X=="function")vn=function(){X(Kt)};else if(typeof MessageChannel<"u"){var cn=new MessageChannel,Ln=cn.port2;cn.port1.onmessage=Kt,vn=function(){Ln.postMessage(null)}}else vn=function(){ze(Kt,0)};function Ke($e){Ve=$e,Oe||(Oe=!0,vn())}function hn($e,st){Le=ze(function(){$e(t.unstable_now())},st)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($e){$e.callback=null},t.unstable_continueExecution=function(){be||pe||(be=!0,Ke(Ee))},t.unstable_forceFrameRate=function($e){0>$e||125<$e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):vt=0<$e?Math.floor(1e3/$e):5},t.unstable_getCurrentPriorityLevel=function(){return V},t.unstable_getFirstCallbackNode=function(){return s(L)},t.unstable_next=function($e){switch(V){case 1:case 2:case 3:var st=3;break;default:st=V}var pt=V;V=st;try{return $e()}finally{V=pt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($e,st){switch($e){case 1:case 2:case 3:case 4:case 5:break;default:$e=3}var pt=V;V=$e;try{return st()}finally{V=pt}},t.unstable_scheduleCallback=function($e,st,pt){var Gt=t.unstable_now();switch(typeof pt=="object"&&pt!==null?(pt=pt.delay,pt=typeof pt=="number"&&0<pt?Gt+pt:Gt):pt=Gt,$e){case 1:var en=-1;break;case 2:en=250;break;case 5:en=1073741823;break;case 4:en=1e4;break;default:en=5e3}return en=pt+en,$e={id:ne++,callback:st,priorityLevel:$e,startTime:pt,expirationTime:en,sortIndex:-1},pt>Gt?($e.sortIndex=pt,i(q,$e),s(L)===null&&$e===s(q)&&(ye?(ee(Le),Le=-1):ye=!0,hn(xe,pt-Gt))):($e.sortIndex=en,i(L,$e),be||pe||(be=!0,Ke(Ee))),$e},t.unstable_shouldYield=Ht,t.unstable_wrapCallback=function($e){var st=V;return function(){var pt=V;V=st;try{return $e.apply(this,arguments)}finally{V=pt}}}})(ux);(function(t){t.exports=ux})(lx);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cx=_t.exports,si=lx.exports;function Me(t){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+t,s=1;s<arguments.length;s++)i+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+t+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var hx=new Set,xc={};function Us(t,i){Vl(t,i),Vl(t+"Capture",i)}function Vl(t,i){for(xc[t]=i,t=0;t<i.length;t++)hx.add(i[t])}var Ra=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zm=Object.prototype.hasOwnProperty,K2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gv={},yv={};function J2(t){return zm.call(yv,t)?!0:zm.call(gv,t)?!1:K2.test(t)?yv[t]=!0:(gv[t]=!0,!1)}function Q2(t,i,s,f){if(s!==null&&s.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return f?!1:s!==null?!s.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function eS(t,i,s,f){if(i===null||typeof i>"u"||Q2(t,i,s,f))return!0;if(f)return!1;if(s!==null)switch(s.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function Or(t,i,s,f,_,v,T){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=f,this.attributeNamespace=_,this.mustUseProperty=s,this.propertyName=t,this.type=i,this.sanitizeURL=v,this.removeEmptyString=T}var ur={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ur[t]=new Or(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var i=t[0];ur[i]=new Or(i,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ur[t]=new Or(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ur[t]=new Or(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ur[t]=new Or(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ur[t]=new Or(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ur[t]=new Or(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ur[t]=new Or(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ur[t]=new Or(t,5,!1,t.toLowerCase(),null,!1,!1)});var $g=/[\-:]([a-z])/g;function jg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var i=t.replace($g,jg);ur[i]=new Or(i,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var i=t.replace($g,jg);ur[i]=new Or(i,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var i=t.replace($g,jg);ur[i]=new Or(i,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ur[t]=new Or(t,1,!1,t.toLowerCase(),null,!1,!1)});ur.xlinkHref=new Or("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ur[t]=new Or(t,1,!1,t.toLowerCase(),null,!0,!0)});function Gg(t,i,s,f){var _=ur.hasOwnProperty(i)?ur[i]:null;(_!==null?_.type!==0:f||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(eS(i,s,_,f)&&(s=null),f||_===null?J2(i)&&(s===null?t.removeAttribute(i):t.setAttribute(i,""+s)):_.mustUseProperty?t[_.propertyName]=s===null?_.type===3?!1:"":s:(i=_.attributeName,f=_.attributeNamespace,s===null?t.removeAttribute(i):(_=_.type,s=_===3||_===4&&s===!0?"":""+s,f?t.setAttributeNS(f,i,s):t.setAttribute(i,s))))}var $a=cx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,id=Symbol.for("react.element"),vl=Symbol.for("react.portal"),xl=Symbol.for("react.fragment"),qg=Symbol.for("react.strict_mode"),Mm=Symbol.for("react.profiler"),dx=Symbol.for("react.provider"),px=Symbol.for("react.context"),Zg=Symbol.for("react.forward_ref"),Dm=Symbol.for("react.suspense"),Lm=Symbol.for("react.suspense_list"),Wg=Symbol.for("react.memo"),_o=Symbol.for("react.lazy"),fx=Symbol.for("react.offscreen"),_v=Symbol.iterator;function Yu(t){return t===null||typeof t!="object"?null:(t=_v&&t[_v]||t["@@iterator"],typeof t=="function"?t:null)}var Sn=Object.assign,Kf;function ic(t){if(Kf===void 0)try{throw Error()}catch(s){var i=s.stack.trim().match(/\n( *(at )?)/);Kf=i&&i[1]||""}return`
`+Kf+t}var Jf=!1;function Qf(t,i){if(!t||Jf)return"";Jf=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(q){var f=q}Reflect.construct(t,[],i)}else{try{i.call()}catch(q){f=q}t.call(i.prototype)}else{try{throw Error()}catch(q){f=q}t()}}catch(q){if(q&&f&&typeof q.stack=="string"){for(var _=q.stack.split(`
`),v=f.stack.split(`
`),T=_.length-1,u=v.length-1;1<=T&&0<=u&&_[T]!==v[u];)u--;for(;1<=T&&0<=u;T--,u--)if(_[T]!==v[u]){if(T!==1||u!==1)do if(T--,u--,0>u||_[T]!==v[u]){var L=`
`+_[T].replace(" at new "," at ");return t.displayName&&L.includes("<anonymous>")&&(L=L.replace("<anonymous>",t.displayName)),L}while(1<=T&&0<=u);break}}}finally{Jf=!1,Error.prepareStackTrace=s}return(t=t?t.displayName||t.name:"")?ic(t):""}function tS(t){switch(t.tag){case 5:return ic(t.type);case 16:return ic("Lazy");case 13:return ic("Suspense");case 19:return ic("SuspenseList");case 0:case 2:case 15:return t=Qf(t.type,!1),t;case 11:return t=Qf(t.type.render,!1),t;case 1:return t=Qf(t.type,!0),t;default:return""}}function Rm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case xl:return"Fragment";case vl:return"Portal";case Mm:return"Profiler";case qg:return"StrictMode";case Dm:return"Suspense";case Lm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case px:return(t.displayName||"Context")+".Consumer";case dx:return(t._context.displayName||"Context")+".Provider";case Zg:var i=t.render;return t=t.displayName,t||(t=i.displayName||i.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Wg:return i=t.displayName||null,i!==null?i:Rm(t.type)||"Memo";case _o:i=t._payload,t=t._init;try{return Rm(t(i))}catch{}}return null}function nS(t){var i=t.type;switch(t.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=i.render,t=t.displayName||t.name||"",i.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Rm(i);case 8:return i===qg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Lo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function mx(t){var i=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function rS(t){var i=mx(t)?"checked":"value",s=Object.getOwnPropertyDescriptor(t.constructor.prototype,i),f=""+t[i];if(!t.hasOwnProperty(i)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var _=s.get,v=s.set;return Object.defineProperty(t,i,{configurable:!0,get:function(){return _.call(this)},set:function(T){f=""+T,v.call(this,T)}}),Object.defineProperty(t,i,{enumerable:s.enumerable}),{getValue:function(){return f},setValue:function(T){f=""+T},stopTracking:function(){t._valueTracker=null,delete t[i]}}}}function ad(t){t._valueTracker||(t._valueTracker=rS(t))}function gx(t){if(!t)return!1;var i=t._valueTracker;if(!i)return!0;var s=i.getValue(),f="";return t&&(f=mx(t)?t.checked?"true":"false":t.value),t=f,t!==s?(i.setValue(t),!0):!1}function Wd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Bm(t,i){var s=i.checked;return Sn({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s!=null?s:t._wrapperState.initialChecked})}function vv(t,i){var s=i.defaultValue==null?"":i.defaultValue,f=i.checked!=null?i.checked:i.defaultChecked;s=Lo(i.value!=null?i.value:s),t._wrapperState={initialChecked:f,initialValue:s,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function yx(t,i){i=i.checked,i!=null&&Gg(t,"checked",i,!1)}function Fm(t,i){yx(t,i);var s=Lo(i.value),f=i.type;if(s!=null)f==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+s):t.value!==""+s&&(t.value=""+s);else if(f==="submit"||f==="reset"){t.removeAttribute("value");return}i.hasOwnProperty("value")?Om(t,i.type,s):i.hasOwnProperty("defaultValue")&&Om(t,i.type,Lo(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(t.defaultChecked=!!i.defaultChecked)}function xv(t,i,s){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var f=i.type;if(!(f!=="submit"&&f!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+t._wrapperState.initialValue,s||i===t.value||(t.value=i),t.defaultValue=i}s=t.name,s!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,s!==""&&(t.name=s)}function Om(t,i,s){(i!=="number"||Wd(t.ownerDocument)!==t)&&(s==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+s&&(t.defaultValue=""+s))}var ac=Array.isArray;function Ll(t,i,s,f){if(t=t.options,i){i={};for(var _=0;_<s.length;_++)i["$"+s[_]]=!0;for(s=0;s<t.length;s++)_=i.hasOwnProperty("$"+t[s].value),t[s].selected!==_&&(t[s].selected=_),_&&f&&(t[s].defaultSelected=!0)}else{for(s=""+Lo(s),i=null,_=0;_<t.length;_++){if(t[_].value===s){t[_].selected=!0,f&&(t[_].defaultSelected=!0);return}i!==null||t[_].disabled||(i=t[_])}i!==null&&(i.selected=!0)}}function Nm(t,i){if(i.dangerouslySetInnerHTML!=null)throw Error(Me(91));return Sn({},i,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function wv(t,i){var s=i.value;if(s==null){if(s=i.children,i=i.defaultValue,s!=null){if(i!=null)throw Error(Me(92));if(ac(s)){if(1<s.length)throw Error(Me(93));s=s[0]}i=s}i==null&&(i=""),s=i}t._wrapperState={initialValue:Lo(s)}}function _x(t,i){var s=Lo(i.value),f=Lo(i.defaultValue);s!=null&&(s=""+s,s!==t.value&&(t.value=s),i.defaultValue==null&&t.defaultValue!==s&&(t.defaultValue=s)),f!=null&&(t.defaultValue=""+f)}function bv(t){var i=t.textContent;i===t._wrapperState.initialValue&&i!==""&&i!==null&&(t.value=i)}function vx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Um(t,i){return t==null||t==="http://www.w3.org/1999/xhtml"?vx(i):t==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var od,xx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,s,f,_){MSApp.execUnsafeLocalFunction(function(){return t(i,s,f,_)})}:t}(function(t,i){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=i;else{for(od=od||document.createElement("div"),od.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=od.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;i.firstChild;)t.appendChild(i.firstChild)}});function wc(t,i){if(i){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=i;return}}t.textContent=i}var uc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},iS=["Webkit","ms","Moz","O"];Object.keys(uc).forEach(function(t){iS.forEach(function(i){i=i+t.charAt(0).toUpperCase()+t.substring(1),uc[i]=uc[t]})});function wx(t,i,s){return i==null||typeof i=="boolean"||i===""?"":s||typeof i!="number"||i===0||uc.hasOwnProperty(t)&&uc[t]?(""+i).trim():i+"px"}function bx(t,i){t=t.style;for(var s in i)if(i.hasOwnProperty(s)){var f=s.indexOf("--")===0,_=wx(s,i[s],f);s==="float"&&(s="cssFloat"),f?t.setProperty(s,_):t[s]=_}}var aS=Sn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vm(t,i){if(i){if(aS[t]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(Me(137,t));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(Me(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(Me(61))}if(i.style!=null&&typeof i.style!="object")throw Error(Me(62))}}function $m(t,i){if(t.indexOf("-")===-1)return typeof i.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jm=null;function Hg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Gm=null,Rl=null,Bl=null;function Sv(t){if(t=qc(t)){if(typeof Gm!="function")throw Error(Me(280));var i=t.stateNode;i&&(i=kp(i),Gm(t.stateNode,t.type,i))}}function Sx(t){Rl?Bl?Bl.push(t):Bl=[t]:Rl=t}function Tx(){if(Rl){var t=Rl,i=Bl;if(Bl=Rl=null,Sv(t),i)for(t=0;t<i.length;t++)Sv(i[t])}}function Ex(t,i){return t(i)}function kx(){}var em=!1;function Ix(t,i,s){if(em)return t(i,s);em=!0;try{return Ex(t,i,s)}finally{em=!1,(Rl!==null||Bl!==null)&&(kx(),Tx())}}function bc(t,i){var s=t.stateNode;if(s===null)return null;var f=kp(s);if(f===null)return null;s=f[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(t=t.type,f=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!f;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(Me(231,i,typeof s));return s}var qm=!1;if(Ra)try{var Ku={};Object.defineProperty(Ku,"passive",{get:function(){qm=!0}}),window.addEventListener("test",Ku,Ku),window.removeEventListener("test",Ku,Ku)}catch{qm=!1}function oS(t,i,s,f,_,v,T,u,L){var q=Array.prototype.slice.call(arguments,3);try{i.apply(s,q)}catch(ne){this.onError(ne)}}var cc=!1,Hd=null,Xd=!1,Zm=null,sS={onError:function(t){cc=!0,Hd=t}};function lS(t,i,s,f,_,v,T,u,L){cc=!1,Hd=null,oS.apply(sS,arguments)}function uS(t,i,s,f,_,v,T,u,L){if(lS.apply(this,arguments),cc){if(cc){var q=Hd;cc=!1,Hd=null}else throw Error(Me(198));Xd||(Xd=!0,Zm=q)}}function Vs(t){var i=t,s=t;if(t.alternate)for(;i.return;)i=i.return;else{t=i;do i=t,(i.flags&4098)!==0&&(s=i.return),t=i.return;while(t)}return i.tag===3?s:null}function Cx(t){if(t.tag===13){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function Tv(t){if(Vs(t)!==t)throw Error(Me(188))}function cS(t){var i=t.alternate;if(!i){if(i=Vs(t),i===null)throw Error(Me(188));return i!==t?null:t}for(var s=t,f=i;;){var _=s.return;if(_===null)break;var v=_.alternate;if(v===null){if(f=_.return,f!==null){s=f;continue}break}if(_.child===v.child){for(v=_.child;v;){if(v===s)return Tv(_),t;if(v===f)return Tv(_),i;v=v.sibling}throw Error(Me(188))}if(s.return!==f.return)s=_,f=v;else{for(var T=!1,u=_.child;u;){if(u===s){T=!0,s=_,f=v;break}if(u===f){T=!0,f=_,s=v;break}u=u.sibling}if(!T){for(u=v.child;u;){if(u===s){T=!0,s=v,f=_;break}if(u===f){T=!0,f=v,s=_;break}u=u.sibling}if(!T)throw Error(Me(189))}}if(s.alternate!==f)throw Error(Me(190))}if(s.tag!==3)throw Error(Me(188));return s.stateNode.current===s?t:i}function Ax(t){return t=cS(t),t!==null?Px(t):null}function Px(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var i=Px(t);if(i!==null)return i;t=t.sibling}return null}var zx=si.unstable_scheduleCallback,Ev=si.unstable_cancelCallback,hS=si.unstable_shouldYield,dS=si.unstable_requestPaint,Dn=si.unstable_now,pS=si.unstable_getCurrentPriorityLevel,Xg=si.unstable_ImmediatePriority,Mx=si.unstable_UserBlockingPriority,Yd=si.unstable_NormalPriority,fS=si.unstable_LowPriority,Dx=si.unstable_IdlePriority,bp=null,ca=null;function mS(t){if(ca&&typeof ca.onCommitFiberRoot=="function")try{ca.onCommitFiberRoot(bp,t,void 0,(t.current.flags&128)===128)}catch{}}var $i=Math.clz32?Math.clz32:_S,gS=Math.log,yS=Math.LN2;function _S(t){return t>>>=0,t===0?32:31-(gS(t)/yS|0)|0}var sd=64,ld=4194304;function oc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Kd(t,i){var s=t.pendingLanes;if(s===0)return 0;var f=0,_=t.suspendedLanes,v=t.pingedLanes,T=s&268435455;if(T!==0){var u=T&~_;u!==0?f=oc(u):(v&=T,v!==0&&(f=oc(v)))}else T=s&~_,T!==0?f=oc(T):v!==0&&(f=oc(v));if(f===0)return 0;if(i!==0&&i!==f&&(i&_)===0&&(_=f&-f,v=i&-i,_>=v||_===16&&(v&4194240)!==0))return i;if((f&4)!==0&&(f|=s&16),i=t.entangledLanes,i!==0)for(t=t.entanglements,i&=f;0<i;)s=31-$i(i),_=1<<s,f|=t[s],i&=~_;return f}function vS(t,i){switch(t){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xS(t,i){for(var s=t.suspendedLanes,f=t.pingedLanes,_=t.expirationTimes,v=t.pendingLanes;0<v;){var T=31-$i(v),u=1<<T,L=_[T];L===-1?((u&s)===0||(u&f)!==0)&&(_[T]=vS(u,i)):L<=i&&(t.expiredLanes|=u),v&=~u}}function Wm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Lx(){var t=sd;return sd<<=1,(sd&4194240)===0&&(sd=64),t}function tm(t){for(var i=[],s=0;31>s;s++)i.push(t);return i}function jc(t,i,s){t.pendingLanes|=i,i!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,i=31-$i(i),t[i]=s}function wS(t,i){var s=t.pendingLanes&~i;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=i,t.mutableReadLanes&=i,t.entangledLanes&=i,i=t.entanglements;var f=t.eventTimes;for(t=t.expirationTimes;0<s;){var _=31-$i(s),v=1<<_;i[_]=0,f[_]=-1,t[_]=-1,s&=~v}}function Yg(t,i){var s=t.entangledLanes|=i;for(t=t.entanglements;s;){var f=31-$i(s),_=1<<f;_&i|t[f]&i&&(t[f]|=i),s&=~_}}var Yt=0;function Rx(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var Bx,Kg,Fx,Ox,Nx,Hm=!1,ud=[],ko=null,Io=null,Co=null,Sc=new Map,Tc=new Map,xo=[],bS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kv(t,i){switch(t){case"focusin":case"focusout":ko=null;break;case"dragenter":case"dragleave":Io=null;break;case"mouseover":case"mouseout":Co=null;break;case"pointerover":case"pointerout":Sc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tc.delete(i.pointerId)}}function Ju(t,i,s,f,_,v){return t===null||t.nativeEvent!==v?(t={blockedOn:i,domEventName:s,eventSystemFlags:f,nativeEvent:v,targetContainers:[_]},i!==null&&(i=qc(i),i!==null&&Kg(i)),t):(t.eventSystemFlags|=f,i=t.targetContainers,_!==null&&i.indexOf(_)===-1&&i.push(_),t)}function SS(t,i,s,f,_){switch(i){case"focusin":return ko=Ju(ko,t,i,s,f,_),!0;case"dragenter":return Io=Ju(Io,t,i,s,f,_),!0;case"mouseover":return Co=Ju(Co,t,i,s,f,_),!0;case"pointerover":var v=_.pointerId;return Sc.set(v,Ju(Sc.get(v)||null,t,i,s,f,_)),!0;case"gotpointercapture":return v=_.pointerId,Tc.set(v,Ju(Tc.get(v)||null,t,i,s,f,_)),!0}return!1}function Ux(t){var i=Ss(t.target);if(i!==null){var s=Vs(i);if(s!==null){if(i=s.tag,i===13){if(i=Cx(s),i!==null){t.blockedOn=i,Nx(t.priority,function(){Fx(s)});return}}else if(i===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Dd(t){if(t.blockedOn!==null)return!1;for(var i=t.targetContainers;0<i.length;){var s=Xm(t.domEventName,t.eventSystemFlags,i[0],t.nativeEvent);if(s===null){s=t.nativeEvent;var f=new s.constructor(s.type,s);jm=f,s.target.dispatchEvent(f),jm=null}else return i=qc(s),i!==null&&Kg(i),t.blockedOn=s,!1;i.shift()}return!0}function Iv(t,i,s){Dd(t)&&s.delete(i)}function TS(){Hm=!1,ko!==null&&Dd(ko)&&(ko=null),Io!==null&&Dd(Io)&&(Io=null),Co!==null&&Dd(Co)&&(Co=null),Sc.forEach(Iv),Tc.forEach(Iv)}function Qu(t,i){t.blockedOn===i&&(t.blockedOn=null,Hm||(Hm=!0,si.unstable_scheduleCallback(si.unstable_NormalPriority,TS)))}function Ec(t){function i(_){return Qu(_,t)}if(0<ud.length){Qu(ud[0],t);for(var s=1;s<ud.length;s++){var f=ud[s];f.blockedOn===t&&(f.blockedOn=null)}}for(ko!==null&&Qu(ko,t),Io!==null&&Qu(Io,t),Co!==null&&Qu(Co,t),Sc.forEach(i),Tc.forEach(i),s=0;s<xo.length;s++)f=xo[s],f.blockedOn===t&&(f.blockedOn=null);for(;0<xo.length&&(s=xo[0],s.blockedOn===null);)Ux(s),s.blockedOn===null&&xo.shift()}var Fl=$a.ReactCurrentBatchConfig,Jd=!0;function ES(t,i,s,f){var _=Yt,v=Fl.transition;Fl.transition=null;try{Yt=1,Jg(t,i,s,f)}finally{Yt=_,Fl.transition=v}}function kS(t,i,s,f){var _=Yt,v=Fl.transition;Fl.transition=null;try{Yt=4,Jg(t,i,s,f)}finally{Yt=_,Fl.transition=v}}function Jg(t,i,s,f){if(Jd){var _=Xm(t,i,s,f);if(_===null)hm(t,i,f,Qd,s),kv(t,f);else if(SS(_,t,i,s,f))f.stopPropagation();else if(kv(t,f),i&4&&-1<bS.indexOf(t)){for(;_!==null;){var v=qc(_);if(v!==null&&Bx(v),v=Xm(t,i,s,f),v===null&&hm(t,i,f,Qd,s),v===_)break;_=v}_!==null&&f.stopPropagation()}else hm(t,i,f,null,s)}}var Qd=null;function Xm(t,i,s,f){if(Qd=null,t=Hg(f),t=Ss(t),t!==null)if(i=Vs(t),i===null)t=null;else if(s=i.tag,s===13){if(t=Cx(i),t!==null)return t;t=null}else if(s===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;t=null}else i!==t&&(t=null);return Qd=t,null}function Vx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pS()){case Xg:return 1;case Mx:return 4;case Yd:case fS:return 16;case Dx:return 536870912;default:return 16}default:return 16}}var bo=null,Qg=null,Ld=null;function $x(){if(Ld)return Ld;var t,i=Qg,s=i.length,f,_="value"in bo?bo.value:bo.textContent,v=_.length;for(t=0;t<s&&i[t]===_[t];t++);var T=s-t;for(f=1;f<=T&&i[s-f]===_[v-f];f++);return Ld=_.slice(t,1<f?1-f:void 0)}function Rd(t){var i=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&i===13&&(t=13)):t=i,t===10&&(t=13),32<=t||t===13?t:0}function cd(){return!0}function Cv(){return!1}function ui(t){function i(s,f,_,v,T){this._reactName=s,this._targetInst=_,this.type=f,this.nativeEvent=v,this.target=T,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(s=t[u],this[u]=s?s(v):v[u]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?cd:Cv,this.isPropagationStopped=Cv,this}return Sn(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=cd)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=cd)},persist:function(){},isPersistent:cd}),i}var Yl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ey=ui(Yl),Gc=Sn({},Yl,{view:0,detail:0}),IS=ui(Gc),nm,rm,ec,Sp=Sn({},Gc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ty,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ec&&(ec&&t.type==="mousemove"?(nm=t.screenX-ec.screenX,rm=t.screenY-ec.screenY):rm=nm=0,ec=t),nm)},movementY:function(t){return"movementY"in t?t.movementY:rm}}),Av=ui(Sp),CS=Sn({},Sp,{dataTransfer:0}),AS=ui(CS),PS=Sn({},Gc,{relatedTarget:0}),im=ui(PS),zS=Sn({},Yl,{animationName:0,elapsedTime:0,pseudoElement:0}),MS=ui(zS),DS=Sn({},Yl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),LS=ui(DS),RS=Sn({},Yl,{data:0}),Pv=ui(RS),BS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},FS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},OS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function NS(t){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(t):(t=OS[t])?!!i[t]:!1}function ty(){return NS}var US=Sn({},Gc,{key:function(t){if(t.key){var i=BS[t.key]||t.key;if(i!=="Unidentified")return i}return t.type==="keypress"?(t=Rd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?FS[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ty,charCode:function(t){return t.type==="keypress"?Rd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Rd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),VS=ui(US),$S=Sn({},Sp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zv=ui($S),jS=Sn({},Gc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ty}),GS=ui(jS),qS=Sn({},Yl,{propertyName:0,elapsedTime:0,pseudoElement:0}),ZS=ui(qS),WS=Sn({},Sp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),HS=ui(WS),XS=[9,13,27,32],ny=Ra&&"CompositionEvent"in window,hc=null;Ra&&"documentMode"in document&&(hc=document.documentMode);var YS=Ra&&"TextEvent"in window&&!hc,jx=Ra&&(!ny||hc&&8<hc&&11>=hc),Mv=String.fromCharCode(32),Dv=!1;function Gx(t,i){switch(t){case"keyup":return XS.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var wl=!1;function KS(t,i){switch(t){case"compositionend":return qx(i);case"keypress":return i.which!==32?null:(Dv=!0,Mv);case"textInput":return t=i.data,t===Mv&&Dv?null:t;default:return null}}function JS(t,i){if(wl)return t==="compositionend"||!ny&&Gx(t,i)?(t=$x(),Ld=Qg=bo=null,wl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return jx&&i.locale!=="ko"?null:i.data;default:return null}}var QS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lv(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i==="input"?!!QS[t.type]:i==="textarea"}function Zx(t,i,s,f){Sx(f),i=ep(i,"onChange"),0<i.length&&(s=new ey("onChange","change",null,s,f),t.push({event:s,listeners:i}))}var dc=null,kc=null;function eT(t){r1(t,0)}function Tp(t){var i=Tl(t);if(gx(i))return t}function tT(t,i){if(t==="change")return i}var Wx=!1;if(Ra){var am;if(Ra){var om="oninput"in document;if(!om){var Rv=document.createElement("div");Rv.setAttribute("oninput","return;"),om=typeof Rv.oninput=="function"}am=om}else am=!1;Wx=am&&(!document.documentMode||9<document.documentMode)}function Bv(){dc&&(dc.detachEvent("onpropertychange",Hx),kc=dc=null)}function Hx(t){if(t.propertyName==="value"&&Tp(kc)){var i=[];Zx(i,kc,t,Hg(t)),Ix(eT,i)}}function nT(t,i,s){t==="focusin"?(Bv(),dc=i,kc=s,dc.attachEvent("onpropertychange",Hx)):t==="focusout"&&Bv()}function rT(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Tp(kc)}function iT(t,i){if(t==="click")return Tp(i)}function aT(t,i){if(t==="input"||t==="change")return Tp(i)}function oT(t,i){return t===i&&(t!==0||1/t===1/i)||t!==t&&i!==i}var Gi=typeof Object.is=="function"?Object.is:oT;function Ic(t,i){if(Gi(t,i))return!0;if(typeof t!="object"||t===null||typeof i!="object"||i===null)return!1;var s=Object.keys(t),f=Object.keys(i);if(s.length!==f.length)return!1;for(f=0;f<s.length;f++){var _=s[f];if(!zm.call(i,_)||!Gi(t[_],i[_]))return!1}return!0}function Fv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ov(t,i){var s=Fv(t);t=0;for(var f;s;){if(s.nodeType===3){if(f=t+s.textContent.length,t<=i&&f>=i)return{node:s,offset:i-t};t=f}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Fv(s)}}function Xx(t,i){return t&&i?t===i?!0:t&&t.nodeType===3?!1:i&&i.nodeType===3?Xx(t,i.parentNode):"contains"in t?t.contains(i):t.compareDocumentPosition?!!(t.compareDocumentPosition(i)&16):!1:!1}function Yx(){for(var t=window,i=Wd();i instanceof t.HTMLIFrameElement;){try{var s=typeof i.contentWindow.location.href=="string"}catch{s=!1}if(s)t=i.contentWindow;else break;i=Wd(t.document)}return i}function ry(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i&&(i==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||i==="textarea"||t.contentEditable==="true")}function sT(t){var i=Yx(),s=t.focusedElem,f=t.selectionRange;if(i!==s&&s&&s.ownerDocument&&Xx(s.ownerDocument.documentElement,s)){if(f!==null&&ry(s)){if(i=f.start,t=f.end,t===void 0&&(t=i),"selectionStart"in s)s.selectionStart=i,s.selectionEnd=Math.min(t,s.value.length);else if(t=(i=s.ownerDocument||document)&&i.defaultView||window,t.getSelection){t=t.getSelection();var _=s.textContent.length,v=Math.min(f.start,_);f=f.end===void 0?v:Math.min(f.end,_),!t.extend&&v>f&&(_=f,f=v,v=_),_=Ov(s,v);var T=Ov(s,f);_&&T&&(t.rangeCount!==1||t.anchorNode!==_.node||t.anchorOffset!==_.offset||t.focusNode!==T.node||t.focusOffset!==T.offset)&&(i=i.createRange(),i.setStart(_.node,_.offset),t.removeAllRanges(),v>f?(t.addRange(i),t.extend(T.node,T.offset)):(i.setEnd(T.node,T.offset),t.addRange(i)))}}for(i=[],t=s;t=t.parentNode;)t.nodeType===1&&i.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<i.length;s++)t=i[s],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var lT=Ra&&"documentMode"in document&&11>=document.documentMode,bl=null,Ym=null,pc=null,Km=!1;function Nv(t,i,s){var f=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Km||bl==null||bl!==Wd(f)||(f=bl,"selectionStart"in f&&ry(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),pc&&Ic(pc,f)||(pc=f,f=ep(Ym,"onSelect"),0<f.length&&(i=new ey("onSelect","select",null,i,s),t.push({event:i,listeners:f}),i.target=bl)))}function hd(t,i){var s={};return s[t.toLowerCase()]=i.toLowerCase(),s["Webkit"+t]="webkit"+i,s["Moz"+t]="moz"+i,s}var Sl={animationend:hd("Animation","AnimationEnd"),animationiteration:hd("Animation","AnimationIteration"),animationstart:hd("Animation","AnimationStart"),transitionend:hd("Transition","TransitionEnd")},sm={},Kx={};Ra&&(Kx=document.createElement("div").style,"AnimationEvent"in window||(delete Sl.animationend.animation,delete Sl.animationiteration.animation,delete Sl.animationstart.animation),"TransitionEvent"in window||delete Sl.transitionend.transition);function Ep(t){if(sm[t])return sm[t];if(!Sl[t])return t;var i=Sl[t],s;for(s in i)if(i.hasOwnProperty(s)&&s in Kx)return sm[t]=i[s];return t}var Jx=Ep("animationend"),Qx=Ep("animationiteration"),e1=Ep("animationstart"),t1=Ep("transitionend"),n1=new Map,Uv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function No(t,i){n1.set(t,i),Us(i,[t])}for(var lm=0;lm<Uv.length;lm++){var um=Uv[lm],uT=um.toLowerCase(),cT=um[0].toUpperCase()+um.slice(1);No(uT,"on"+cT)}No(Jx,"onAnimationEnd");No(Qx,"onAnimationIteration");No(e1,"onAnimationStart");No("dblclick","onDoubleClick");No("focusin","onFocus");No("focusout","onBlur");No(t1,"onTransitionEnd");Vl("onMouseEnter",["mouseout","mouseover"]);Vl("onMouseLeave",["mouseout","mouseover"]);Vl("onPointerEnter",["pointerout","pointerover"]);Vl("onPointerLeave",["pointerout","pointerover"]);Us("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Us("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Us("onBeforeInput",["compositionend","keypress","textInput","paste"]);Us("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Us("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Us("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hT=new Set("cancel close invalid load scroll toggle".split(" ").concat(sc));function Vv(t,i,s){var f=t.type||"unknown-event";t.currentTarget=s,uS(f,i,void 0,t),t.currentTarget=null}function r1(t,i){i=(i&4)!==0;for(var s=0;s<t.length;s++){var f=t[s],_=f.event;f=f.listeners;e:{var v=void 0;if(i)for(var T=f.length-1;0<=T;T--){var u=f[T],L=u.instance,q=u.currentTarget;if(u=u.listener,L!==v&&_.isPropagationStopped())break e;Vv(_,u,q),v=L}else for(T=0;T<f.length;T++){if(u=f[T],L=u.instance,q=u.currentTarget,u=u.listener,L!==v&&_.isPropagationStopped())break e;Vv(_,u,q),v=L}}}if(Xd)throw t=Zm,Xd=!1,Zm=null,t}function dn(t,i){var s=i[ng];s===void 0&&(s=i[ng]=new Set);var f=t+"__bubble";s.has(f)||(i1(i,t,2,!1),s.add(f))}function cm(t,i,s){var f=0;i&&(f|=4),i1(s,t,f,i)}var dd="_reactListening"+Math.random().toString(36).slice(2);function Cc(t){if(!t[dd]){t[dd]=!0,hx.forEach(function(s){s!=="selectionchange"&&(hT.has(s)||cm(s,!1,t),cm(s,!0,t))});var i=t.nodeType===9?t:t.ownerDocument;i===null||i[dd]||(i[dd]=!0,cm("selectionchange",!1,i))}}function i1(t,i,s,f){switch(Vx(i)){case 1:var _=ES;break;case 4:_=kS;break;default:_=Jg}s=_.bind(null,i,s,t),_=void 0,!qm||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(_=!0),f?_!==void 0?t.addEventListener(i,s,{capture:!0,passive:_}):t.addEventListener(i,s,!0):_!==void 0?t.addEventListener(i,s,{passive:_}):t.addEventListener(i,s,!1)}function hm(t,i,s,f,_){var v=f;if((i&1)===0&&(i&2)===0&&f!==null)e:for(;;){if(f===null)return;var T=f.tag;if(T===3||T===4){var u=f.stateNode.containerInfo;if(u===_||u.nodeType===8&&u.parentNode===_)break;if(T===4)for(T=f.return;T!==null;){var L=T.tag;if((L===3||L===4)&&(L=T.stateNode.containerInfo,L===_||L.nodeType===8&&L.parentNode===_))return;T=T.return}for(;u!==null;){if(T=Ss(u),T===null)return;if(L=T.tag,L===5||L===6){f=v=T;continue e}u=u.parentNode}}f=f.return}Ix(function(){var q=v,ne=Hg(s),Q=[];e:{var V=n1.get(t);if(V!==void 0){var pe=ey,be=t;switch(t){case"keypress":if(Rd(s)===0)break e;case"keydown":case"keyup":pe=VS;break;case"focusin":be="focus",pe=im;break;case"focusout":be="blur",pe=im;break;case"beforeblur":case"afterblur":pe=im;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pe=Av;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pe=AS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pe=GS;break;case Jx:case Qx:case e1:pe=MS;break;case t1:pe=ZS;break;case"scroll":pe=IS;break;case"wheel":pe=HS;break;case"copy":case"cut":case"paste":pe=LS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pe=zv}var ye=(i&4)!==0,ze=!ye&&t==="scroll",ee=ye?V!==null?V+"Capture":null:V;ye=[];for(var X=q,ie;X!==null;){ie=X;var xe=ie.stateNode;if(ie.tag===5&&xe!==null&&(ie=xe,ee!==null&&(xe=bc(X,ee),xe!=null&&ye.push(Ac(X,xe,ie)))),ze)break;X=X.return}0<ye.length&&(V=new pe(V,be,null,s,ne),Q.push({event:V,listeners:ye}))}}if((i&7)===0){e:{if(V=t==="mouseover"||t==="pointerover",pe=t==="mouseout"||t==="pointerout",V&&s!==jm&&(be=s.relatedTarget||s.fromElement)&&(Ss(be)||be[Ba]))break e;if((pe||V)&&(V=ne.window===ne?ne:(V=ne.ownerDocument)?V.defaultView||V.parentWindow:window,pe?(be=s.relatedTarget||s.toElement,pe=q,be=be?Ss(be):null,be!==null&&(ze=Vs(be),be!==ze||be.tag!==5&&be.tag!==6)&&(be=null)):(pe=null,be=q),pe!==be)){if(ye=Av,xe="onMouseLeave",ee="onMouseEnter",X="mouse",(t==="pointerout"||t==="pointerover")&&(ye=zv,xe="onPointerLeave",ee="onPointerEnter",X="pointer"),ze=pe==null?V:Tl(pe),ie=be==null?V:Tl(be),V=new ye(xe,X+"leave",pe,s,ne),V.target=ze,V.relatedTarget=ie,xe=null,Ss(ne)===q&&(ye=new ye(ee,X+"enter",be,s,ne),ye.target=ie,ye.relatedTarget=ze,xe=ye),ze=xe,pe&&be)t:{for(ye=pe,ee=be,X=0,ie=ye;ie;ie=_l(ie))X++;for(ie=0,xe=ee;xe;xe=_l(xe))ie++;for(;0<X-ie;)ye=_l(ye),X--;for(;0<ie-X;)ee=_l(ee),ie--;for(;X--;){if(ye===ee||ee!==null&&ye===ee.alternate)break t;ye=_l(ye),ee=_l(ee)}ye=null}else ye=null;pe!==null&&$v(Q,V,pe,ye,!1),be!==null&&ze!==null&&$v(Q,ze,be,ye,!0)}}e:{if(V=q?Tl(q):window,pe=V.nodeName&&V.nodeName.toLowerCase(),pe==="select"||pe==="input"&&V.type==="file")var Ee=tT;else if(Lv(V))if(Wx)Ee=aT;else{Ee=rT;var Oe=nT}else(pe=V.nodeName)&&pe.toLowerCase()==="input"&&(V.type==="checkbox"||V.type==="radio")&&(Ee=iT);if(Ee&&(Ee=Ee(t,q))){Zx(Q,Ee,s,ne);break e}Oe&&Oe(t,V,q),t==="focusout"&&(Oe=V._wrapperState)&&Oe.controlled&&V.type==="number"&&Om(V,"number",V.value)}switch(Oe=q?Tl(q):window,t){case"focusin":(Lv(Oe)||Oe.contentEditable==="true")&&(bl=Oe,Ym=q,pc=null);break;case"focusout":pc=Ym=bl=null;break;case"mousedown":Km=!0;break;case"contextmenu":case"mouseup":case"dragend":Km=!1,Nv(Q,s,ne);break;case"selectionchange":if(lT)break;case"keydown":case"keyup":Nv(Q,s,ne)}var Ve;if(ny)e:{switch(t){case"compositionstart":var Le="onCompositionStart";break e;case"compositionend":Le="onCompositionEnd";break e;case"compositionupdate":Le="onCompositionUpdate";break e}Le=void 0}else wl?Gx(t,s)&&(Le="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(Le="onCompositionStart");Le&&(jx&&s.locale!=="ko"&&(wl||Le!=="onCompositionStart"?Le==="onCompositionEnd"&&wl&&(Ve=$x()):(bo=ne,Qg="value"in bo?bo.value:bo.textContent,wl=!0)),Oe=ep(q,Le),0<Oe.length&&(Le=new Pv(Le,t,null,s,ne),Q.push({event:Le,listeners:Oe}),Ve?Le.data=Ve:(Ve=qx(s),Ve!==null&&(Le.data=Ve)))),(Ve=YS?KS(t,s):JS(t,s))&&(q=ep(q,"onBeforeInput"),0<q.length&&(ne=new Pv("onBeforeInput","beforeinput",null,s,ne),Q.push({event:ne,listeners:q}),ne.data=Ve))}r1(Q,i)})}function Ac(t,i,s){return{instance:t,listener:i,currentTarget:s}}function ep(t,i){for(var s=i+"Capture",f=[];t!==null;){var _=t,v=_.stateNode;_.tag===5&&v!==null&&(_=v,v=bc(t,s),v!=null&&f.unshift(Ac(t,v,_)),v=bc(t,i),v!=null&&f.push(Ac(t,v,_))),t=t.return}return f}function _l(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function $v(t,i,s,f,_){for(var v=i._reactName,T=[];s!==null&&s!==f;){var u=s,L=u.alternate,q=u.stateNode;if(L!==null&&L===f)break;u.tag===5&&q!==null&&(u=q,_?(L=bc(s,v),L!=null&&T.unshift(Ac(s,L,u))):_||(L=bc(s,v),L!=null&&T.push(Ac(s,L,u)))),s=s.return}T.length!==0&&t.push({event:i,listeners:T})}var dT=/\r\n?/g,pT=/\u0000|\uFFFD/g;function jv(t){return(typeof t=="string"?t:""+t).replace(dT,`
`).replace(pT,"")}function pd(t,i,s){if(i=jv(i),jv(t)!==i&&s)throw Error(Me(425))}function tp(){}var Jm=null,Qm=null;function eg(t,i){return t==="textarea"||t==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var tg=typeof setTimeout=="function"?setTimeout:void 0,fT=typeof clearTimeout=="function"?clearTimeout:void 0,Gv=typeof Promise=="function"?Promise:void 0,mT=typeof queueMicrotask=="function"?queueMicrotask:typeof Gv<"u"?function(t){return Gv.resolve(null).then(t).catch(gT)}:tg;function gT(t){setTimeout(function(){throw t})}function dm(t,i){var s=i,f=0;do{var _=s.nextSibling;if(t.removeChild(s),_&&_.nodeType===8)if(s=_.data,s==="/$"){if(f===0){t.removeChild(_),Ec(i);return}f--}else s!=="$"&&s!=="$?"&&s!=="$!"||f++;s=_}while(s);Ec(i)}function Ao(t){for(;t!=null;t=t.nextSibling){var i=t.nodeType;if(i===1||i===3)break;if(i===8){if(i=t.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return t}function qv(t){t=t.previousSibling;for(var i=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"){if(i===0)return t;i--}else s==="/$"&&i++}t=t.previousSibling}return null}var Kl=Math.random().toString(36).slice(2),la="__reactFiber$"+Kl,Pc="__reactProps$"+Kl,Ba="__reactContainer$"+Kl,ng="__reactEvents$"+Kl,yT="__reactListeners$"+Kl,_T="__reactHandles$"+Kl;function Ss(t){var i=t[la];if(i)return i;for(var s=t.parentNode;s;){if(i=s[Ba]||s[la]){if(s=i.alternate,i.child!==null||s!==null&&s.child!==null)for(t=qv(t);t!==null;){if(s=t[la])return s;t=qv(t)}return i}t=s,s=t.parentNode}return null}function qc(t){return t=t[la]||t[Ba],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Tl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Me(33))}function kp(t){return t[Pc]||null}var rg=[],El=-1;function Uo(t){return{current:t}}function fn(t){0>El||(t.current=rg[El],rg[El]=null,El--)}function un(t,i){El++,rg[El]=t.current,t.current=i}var Ro={},wr=Uo(Ro),Zr=Uo(!1),Ds=Ro;function $l(t,i){var s=t.type.contextTypes;if(!s)return Ro;var f=t.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===i)return f.__reactInternalMemoizedMaskedChildContext;var _={},v;for(v in s)_[v]=i[v];return f&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=_),_}function Wr(t){return t=t.childContextTypes,t!=null}function np(){fn(Zr),fn(wr)}function Zv(t,i,s){if(wr.current!==Ro)throw Error(Me(168));un(wr,i),un(Zr,s)}function a1(t,i,s){var f=t.stateNode;if(i=i.childContextTypes,typeof f.getChildContext!="function")return s;f=f.getChildContext();for(var _ in f)if(!(_ in i))throw Error(Me(108,nS(t)||"Unknown",_));return Sn({},s,f)}function rp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ro,Ds=wr.current,un(wr,t),un(Zr,Zr.current),!0}function Wv(t,i,s){var f=t.stateNode;if(!f)throw Error(Me(169));s?(t=a1(t,i,Ds),f.__reactInternalMemoizedMergedChildContext=t,fn(Zr),fn(wr),un(wr,t)):fn(Zr),un(Zr,s)}var za=null,Ip=!1,pm=!1;function o1(t){za===null?za=[t]:za.push(t)}function vT(t){Ip=!0,o1(t)}function Vo(){if(!pm&&za!==null){pm=!0;var t=0,i=Yt;try{var s=za;for(Yt=1;t<s.length;t++){var f=s[t];do f=f(!0);while(f!==null)}za=null,Ip=!1}catch(_){throw za!==null&&(za=za.slice(t+1)),zx(Xg,Vo),_}finally{Yt=i,pm=!1}}return null}var kl=[],Il=0,ip=null,ap=0,vi=[],xi=0,Ls=null,Ma=1,Da="";function ws(t,i){kl[Il++]=ap,kl[Il++]=ip,ip=t,ap=i}function s1(t,i,s){vi[xi++]=Ma,vi[xi++]=Da,vi[xi++]=Ls,Ls=t;var f=Ma;t=Da;var _=32-$i(f)-1;f&=~(1<<_),s+=1;var v=32-$i(i)+_;if(30<v){var T=_-_%5;v=(f&(1<<T)-1).toString(32),f>>=T,_-=T,Ma=1<<32-$i(i)+_|s<<_|f,Da=v+t}else Ma=1<<v|s<<_|f,Da=t}function iy(t){t.return!==null&&(ws(t,1),s1(t,1,0))}function ay(t){for(;t===ip;)ip=kl[--Il],kl[Il]=null,ap=kl[--Il],kl[Il]=null;for(;t===Ls;)Ls=vi[--xi],vi[xi]=null,Da=vi[--xi],vi[xi]=null,Ma=vi[--xi],vi[xi]=null}var oi=null,ii=null,_n=!1,Ui=null;function l1(t,i){var s=wi(5,null,null,0);s.elementType="DELETED",s.stateNode=i,s.return=t,i=t.deletions,i===null?(t.deletions=[s],t.flags|=16):i.push(s)}function Hv(t,i){switch(t.tag){case 5:var s=t.type;return i=i.nodeType!==1||s.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(t.stateNode=i,oi=t,ii=Ao(i.firstChild),!0):!1;case 6:return i=t.pendingProps===""||i.nodeType!==3?null:i,i!==null?(t.stateNode=i,oi=t,ii=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(s=Ls!==null?{id:Ma,overflow:Da}:null,t.memoizedState={dehydrated:i,treeContext:s,retryLane:1073741824},s=wi(18,null,null,0),s.stateNode=i,s.return=t,t.child=s,oi=t,ii=null,!0):!1;default:return!1}}function ig(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ag(t){if(_n){var i=ii;if(i){var s=i;if(!Hv(t,i)){if(ig(t))throw Error(Me(418));i=Ao(s.nextSibling);var f=oi;i&&Hv(t,i)?l1(f,s):(t.flags=t.flags&-4097|2,_n=!1,oi=t)}}else{if(ig(t))throw Error(Me(418));t.flags=t.flags&-4097|2,_n=!1,oi=t}}}function Xv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;oi=t}function fd(t){if(t!==oi)return!1;if(!_n)return Xv(t),_n=!0,!1;var i;if((i=t.tag!==3)&&!(i=t.tag!==5)&&(i=t.type,i=i!=="head"&&i!=="body"&&!eg(t.type,t.memoizedProps)),i&&(i=ii)){if(ig(t))throw u1(),Error(Me(418));for(;i;)l1(t,i),i=Ao(i.nextSibling)}if(Xv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Me(317));e:{for(t=t.nextSibling,i=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"){if(i===0){ii=Ao(t.nextSibling);break e}i--}else s!=="$"&&s!=="$!"&&s!=="$?"||i++}t=t.nextSibling}ii=null}}else ii=oi?Ao(t.stateNode.nextSibling):null;return!0}function u1(){for(var t=ii;t;)t=Ao(t.nextSibling)}function jl(){ii=oi=null,_n=!1}function oy(t){Ui===null?Ui=[t]:Ui.push(t)}var xT=$a.ReactCurrentBatchConfig;function Oi(t,i){if(t&&t.defaultProps){i=Sn({},i),t=t.defaultProps;for(var s in t)i[s]===void 0&&(i[s]=t[s]);return i}return i}var op=Uo(null),sp=null,Cl=null,sy=null;function ly(){sy=Cl=sp=null}function uy(t){var i=op.current;fn(op),t._currentValue=i}function og(t,i,s){for(;t!==null;){var f=t.alternate;if((t.childLanes&i)!==i?(t.childLanes|=i,f!==null&&(f.childLanes|=i)):f!==null&&(f.childLanes&i)!==i&&(f.childLanes|=i),t===s)break;t=t.return}}function Ol(t,i){sp=t,sy=Cl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&i)!==0&&(qr=!0),t.firstContext=null)}function Si(t){var i=t._currentValue;if(sy!==t)if(t={context:t,memoizedValue:i,next:null},Cl===null){if(sp===null)throw Error(Me(308));Cl=t,sp.dependencies={lanes:0,firstContext:t}}else Cl=Cl.next=t;return i}var Ts=null;function cy(t){Ts===null?Ts=[t]:Ts.push(t)}function c1(t,i,s,f){var _=i.interleaved;return _===null?(s.next=s,cy(i)):(s.next=_.next,_.next=s),i.interleaved=s,Fa(t,f)}function Fa(t,i){t.lanes|=i;var s=t.alternate;for(s!==null&&(s.lanes|=i),s=t,t=t.return;t!==null;)t.childLanes|=i,s=t.alternate,s!==null&&(s.childLanes|=i),s=t,t=t.return;return s.tag===3?s.stateNode:null}var vo=!1;function hy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function h1(t,i){t=t.updateQueue,i.updateQueue===t&&(i.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function La(t,i){return{eventTime:t,lane:i,tag:0,payload:null,callback:null,next:null}}function Po(t,i,s){var f=t.updateQueue;if(f===null)return null;if(f=f.shared,(Vt&2)!==0){var _=f.pending;return _===null?i.next=i:(i.next=_.next,_.next=i),f.pending=i,Fa(t,s)}return _=f.interleaved,_===null?(i.next=i,cy(f)):(i.next=_.next,_.next=i),f.interleaved=i,Fa(t,s)}function Bd(t,i,s){if(i=i.updateQueue,i!==null&&(i=i.shared,(s&4194240)!==0)){var f=i.lanes;f&=t.pendingLanes,s|=f,i.lanes=s,Yg(t,s)}}function Yv(t,i){var s=t.updateQueue,f=t.alternate;if(f!==null&&(f=f.updateQueue,s===f)){var _=null,v=null;if(s=s.firstBaseUpdate,s!==null){do{var T={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};v===null?_=v=T:v=v.next=T,s=s.next}while(s!==null);v===null?_=v=i:v=v.next=i}else _=v=i;s={baseState:f.baseState,firstBaseUpdate:_,lastBaseUpdate:v,shared:f.shared,effects:f.effects},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=i:t.next=i,s.lastBaseUpdate=i}function lp(t,i,s,f){var _=t.updateQueue;vo=!1;var v=_.firstBaseUpdate,T=_.lastBaseUpdate,u=_.shared.pending;if(u!==null){_.shared.pending=null;var L=u,q=L.next;L.next=null,T===null?v=q:T.next=q,T=L;var ne=t.alternate;ne!==null&&(ne=ne.updateQueue,u=ne.lastBaseUpdate,u!==T&&(u===null?ne.firstBaseUpdate=q:u.next=q,ne.lastBaseUpdate=L))}if(v!==null){var Q=_.baseState;T=0,ne=q=L=null,u=v;do{var V=u.lane,pe=u.eventTime;if((f&V)===V){ne!==null&&(ne=ne.next={eventTime:pe,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var be=t,ye=u;switch(V=i,pe=s,ye.tag){case 1:if(be=ye.payload,typeof be=="function"){Q=be.call(pe,Q,V);break e}Q=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=ye.payload,V=typeof be=="function"?be.call(pe,Q,V):be,V==null)break e;Q=Sn({},Q,V);break e;case 2:vo=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,V=_.effects,V===null?_.effects=[u]:V.push(u))}else pe={eventTime:pe,lane:V,tag:u.tag,payload:u.payload,callback:u.callback,next:null},ne===null?(q=ne=pe,L=Q):ne=ne.next=pe,T|=V;if(u=u.next,u===null){if(u=_.shared.pending,u===null)break;V=u,u=V.next,V.next=null,_.lastBaseUpdate=V,_.shared.pending=null}}while(1);if(ne===null&&(L=Q),_.baseState=L,_.firstBaseUpdate=q,_.lastBaseUpdate=ne,i=_.shared.interleaved,i!==null){_=i;do T|=_.lane,_=_.next;while(_!==i)}else v===null&&(_.shared.lanes=0);Bs|=T,t.lanes=T,t.memoizedState=Q}}function Kv(t,i,s){if(t=i.effects,i.effects=null,t!==null)for(i=0;i<t.length;i++){var f=t[i],_=f.callback;if(_!==null){if(f.callback=null,f=s,typeof _!="function")throw Error(Me(191,_));_.call(f)}}}var d1=new cx.Component().refs;function sg(t,i,s,f){i=t.memoizedState,s=s(f,i),s=s==null?i:Sn({},i,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var Cp={isMounted:function(t){return(t=t._reactInternals)?Vs(t)===t:!1},enqueueSetState:function(t,i,s){t=t._reactInternals;var f=Br(),_=Mo(t),v=La(f,_);v.payload=i,s!=null&&(v.callback=s),i=Po(t,v,_),i!==null&&(ji(i,t,_,f),Bd(i,t,_))},enqueueReplaceState:function(t,i,s){t=t._reactInternals;var f=Br(),_=Mo(t),v=La(f,_);v.tag=1,v.payload=i,s!=null&&(v.callback=s),i=Po(t,v,_),i!==null&&(ji(i,t,_,f),Bd(i,t,_))},enqueueForceUpdate:function(t,i){t=t._reactInternals;var s=Br(),f=Mo(t),_=La(s,f);_.tag=2,i!=null&&(_.callback=i),i=Po(t,_,f),i!==null&&(ji(i,t,f,s),Bd(i,t,f))}};function Jv(t,i,s,f,_,v,T){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(f,v,T):i.prototype&&i.prototype.isPureReactComponent?!Ic(s,f)||!Ic(_,v):!0}function p1(t,i,s){var f=!1,_=Ro,v=i.contextType;return typeof v=="object"&&v!==null?v=Si(v):(_=Wr(i)?Ds:wr.current,f=i.contextTypes,v=(f=f!=null)?$l(t,_):Ro),i=new i(s,v),t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Cp,t.stateNode=i,i._reactInternals=t,f&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=_,t.__reactInternalMemoizedMaskedChildContext=v),i}function Qv(t,i,s,f){t=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(s,f),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(s,f),i.state!==t&&Cp.enqueueReplaceState(i,i.state,null)}function lg(t,i,s,f){var _=t.stateNode;_.props=s,_.state=t.memoizedState,_.refs=d1,hy(t);var v=i.contextType;typeof v=="object"&&v!==null?_.context=Si(v):(v=Wr(i)?Ds:wr.current,_.context=$l(t,v)),_.state=t.memoizedState,v=i.getDerivedStateFromProps,typeof v=="function"&&(sg(t,i,v,s),_.state=t.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(i=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),i!==_.state&&Cp.enqueueReplaceState(_,_.state,null),lp(t,s,_,f),_.state=t.memoizedState),typeof _.componentDidMount=="function"&&(t.flags|=4194308)}function tc(t,i,s){if(t=s.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(Me(309));var f=s.stateNode}if(!f)throw Error(Me(147,t));var _=f,v=""+t;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===v?i.ref:(i=function(T){var u=_.refs;u===d1&&(u=_.refs={}),T===null?delete u[v]:u[v]=T},i._stringRef=v,i)}if(typeof t!="string")throw Error(Me(284));if(!s._owner)throw Error(Me(290,t))}return t}function md(t,i){throw t=Object.prototype.toString.call(i),Error(Me(31,t==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":t))}function e0(t){var i=t._init;return i(t._payload)}function f1(t){function i(ee,X){if(t){var ie=ee.deletions;ie===null?(ee.deletions=[X],ee.flags|=16):ie.push(X)}}function s(ee,X){if(!t)return null;for(;X!==null;)i(ee,X),X=X.sibling;return null}function f(ee,X){for(ee=new Map;X!==null;)X.key!==null?ee.set(X.key,X):ee.set(X.index,X),X=X.sibling;return ee}function _(ee,X){return ee=Do(ee,X),ee.index=0,ee.sibling=null,ee}function v(ee,X,ie){return ee.index=ie,t?(ie=ee.alternate,ie!==null?(ie=ie.index,ie<X?(ee.flags|=2,X):ie):(ee.flags|=2,X)):(ee.flags|=1048576,X)}function T(ee){return t&&ee.alternate===null&&(ee.flags|=2),ee}function u(ee,X,ie,xe){return X===null||X.tag!==6?(X=xm(ie,ee.mode,xe),X.return=ee,X):(X=_(X,ie),X.return=ee,X)}function L(ee,X,ie,xe){var Ee=ie.type;return Ee===xl?ne(ee,X,ie.props.children,xe,ie.key):X!==null&&(X.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===_o&&e0(Ee)===X.type)?(xe=_(X,ie.props),xe.ref=tc(ee,X,ie),xe.return=ee,xe):(xe=$d(ie.type,ie.key,ie.props,null,ee.mode,xe),xe.ref=tc(ee,X,ie),xe.return=ee,xe)}function q(ee,X,ie,xe){return X===null||X.tag!==4||X.stateNode.containerInfo!==ie.containerInfo||X.stateNode.implementation!==ie.implementation?(X=wm(ie,ee.mode,xe),X.return=ee,X):(X=_(X,ie.children||[]),X.return=ee,X)}function ne(ee,X,ie,xe,Ee){return X===null||X.tag!==7?(X=Ps(ie,ee.mode,xe,Ee),X.return=ee,X):(X=_(X,ie),X.return=ee,X)}function Q(ee,X,ie){if(typeof X=="string"&&X!==""||typeof X=="number")return X=xm(""+X,ee.mode,ie),X.return=ee,X;if(typeof X=="object"&&X!==null){switch(X.$$typeof){case id:return ie=$d(X.type,X.key,X.props,null,ee.mode,ie),ie.ref=tc(ee,null,X),ie.return=ee,ie;case vl:return X=wm(X,ee.mode,ie),X.return=ee,X;case _o:var xe=X._init;return Q(ee,xe(X._payload),ie)}if(ac(X)||Yu(X))return X=Ps(X,ee.mode,ie,null),X.return=ee,X;md(ee,X)}return null}function V(ee,X,ie,xe){var Ee=X!==null?X.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number")return Ee!==null?null:u(ee,X,""+ie,xe);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case id:return ie.key===Ee?L(ee,X,ie,xe):null;case vl:return ie.key===Ee?q(ee,X,ie,xe):null;case _o:return Ee=ie._init,V(ee,X,Ee(ie._payload),xe)}if(ac(ie)||Yu(ie))return Ee!==null?null:ne(ee,X,ie,xe,null);md(ee,ie)}return null}function pe(ee,X,ie,xe,Ee){if(typeof xe=="string"&&xe!==""||typeof xe=="number")return ee=ee.get(ie)||null,u(X,ee,""+xe,Ee);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case id:return ee=ee.get(xe.key===null?ie:xe.key)||null,L(X,ee,xe,Ee);case vl:return ee=ee.get(xe.key===null?ie:xe.key)||null,q(X,ee,xe,Ee);case _o:var Oe=xe._init;return pe(ee,X,ie,Oe(xe._payload),Ee)}if(ac(xe)||Yu(xe))return ee=ee.get(ie)||null,ne(X,ee,xe,Ee,null);md(X,xe)}return null}function be(ee,X,ie,xe){for(var Ee=null,Oe=null,Ve=X,Le=X=0,vt=null;Ve!==null&&Le<ie.length;Le++){Ve.index>Le?(vt=Ve,Ve=null):vt=Ve.sibling;var ht=V(ee,Ve,ie[Le],xe);if(ht===null){Ve===null&&(Ve=vt);break}t&&Ve&&ht.alternate===null&&i(ee,Ve),X=v(ht,X,Le),Oe===null?Ee=ht:Oe.sibling=ht,Oe=ht,Ve=vt}if(Le===ie.length)return s(ee,Ve),_n&&ws(ee,Le),Ee;if(Ve===null){for(;Le<ie.length;Le++)Ve=Q(ee,ie[Le],xe),Ve!==null&&(X=v(Ve,X,Le),Oe===null?Ee=Ve:Oe.sibling=Ve,Oe=Ve);return _n&&ws(ee,Le),Ee}for(Ve=f(ee,Ve);Le<ie.length;Le++)vt=pe(Ve,ee,Le,ie[Le],xe),vt!==null&&(t&&vt.alternate!==null&&Ve.delete(vt.key===null?Le:vt.key),X=v(vt,X,Le),Oe===null?Ee=vt:Oe.sibling=vt,Oe=vt);return t&&Ve.forEach(function(Ht){return i(ee,Ht)}),_n&&ws(ee,Le),Ee}function ye(ee,X,ie,xe){var Ee=Yu(ie);if(typeof Ee!="function")throw Error(Me(150));if(ie=Ee.call(ie),ie==null)throw Error(Me(151));for(var Oe=Ee=null,Ve=X,Le=X=0,vt=null,ht=ie.next();Ve!==null&&!ht.done;Le++,ht=ie.next()){Ve.index>Le?(vt=Ve,Ve=null):vt=Ve.sibling;var Ht=V(ee,Ve,ht.value,xe);if(Ht===null){Ve===null&&(Ve=vt);break}t&&Ve&&Ht.alternate===null&&i(ee,Ve),X=v(Ht,X,Le),Oe===null?Ee=Ht:Oe.sibling=Ht,Oe=Ht,Ve=vt}if(ht.done)return s(ee,Ve),_n&&ws(ee,Le),Ee;if(Ve===null){for(;!ht.done;Le++,ht=ie.next())ht=Q(ee,ht.value,xe),ht!==null&&(X=v(ht,X,Le),Oe===null?Ee=ht:Oe.sibling=ht,Oe=ht);return _n&&ws(ee,Le),Ee}for(Ve=f(ee,Ve);!ht.done;Le++,ht=ie.next())ht=pe(Ve,ee,Le,ht.value,xe),ht!==null&&(t&&ht.alternate!==null&&Ve.delete(ht.key===null?Le:ht.key),X=v(ht,X,Le),Oe===null?Ee=ht:Oe.sibling=ht,Oe=ht);return t&&Ve.forEach(function(Kt){return i(ee,Kt)}),_n&&ws(ee,Le),Ee}function ze(ee,X,ie,xe){if(typeof ie=="object"&&ie!==null&&ie.type===xl&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case id:e:{for(var Ee=ie.key,Oe=X;Oe!==null;){if(Oe.key===Ee){if(Ee=ie.type,Ee===xl){if(Oe.tag===7){s(ee,Oe.sibling),X=_(Oe,ie.props.children),X.return=ee,ee=X;break e}}else if(Oe.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===_o&&e0(Ee)===Oe.type){s(ee,Oe.sibling),X=_(Oe,ie.props),X.ref=tc(ee,Oe,ie),X.return=ee,ee=X;break e}s(ee,Oe);break}else i(ee,Oe);Oe=Oe.sibling}ie.type===xl?(X=Ps(ie.props.children,ee.mode,xe,ie.key),X.return=ee,ee=X):(xe=$d(ie.type,ie.key,ie.props,null,ee.mode,xe),xe.ref=tc(ee,X,ie),xe.return=ee,ee=xe)}return T(ee);case vl:e:{for(Oe=ie.key;X!==null;){if(X.key===Oe)if(X.tag===4&&X.stateNode.containerInfo===ie.containerInfo&&X.stateNode.implementation===ie.implementation){s(ee,X.sibling),X=_(X,ie.children||[]),X.return=ee,ee=X;break e}else{s(ee,X);break}else i(ee,X);X=X.sibling}X=wm(ie,ee.mode,xe),X.return=ee,ee=X}return T(ee);case _o:return Oe=ie._init,ze(ee,X,Oe(ie._payload),xe)}if(ac(ie))return be(ee,X,ie,xe);if(Yu(ie))return ye(ee,X,ie,xe);md(ee,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"?(ie=""+ie,X!==null&&X.tag===6?(s(ee,X.sibling),X=_(X,ie),X.return=ee,ee=X):(s(ee,X),X=xm(ie,ee.mode,xe),X.return=ee,ee=X),T(ee)):s(ee,X)}return ze}var Gl=f1(!0),m1=f1(!1),Zc={},ha=Uo(Zc),zc=Uo(Zc),Mc=Uo(Zc);function Es(t){if(t===Zc)throw Error(Me(174));return t}function dy(t,i){switch(un(Mc,i),un(zc,t),un(ha,Zc),t=i.nodeType,t){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Um(null,"");break;default:t=t===8?i.parentNode:i,i=t.namespaceURI||null,t=t.tagName,i=Um(i,t)}fn(ha),un(ha,i)}function ql(){fn(ha),fn(zc),fn(Mc)}function g1(t){Es(Mc.current);var i=Es(ha.current),s=Um(i,t.type);i!==s&&(un(zc,t),un(ha,s))}function py(t){zc.current===t&&(fn(ha),fn(zc))}var wn=Uo(0);function up(t){for(var i=t;i!==null;){if(i.tag===13){var s=i.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var fm=[];function fy(){for(var t=0;t<fm.length;t++)fm[t]._workInProgressVersionPrimary=null;fm.length=0}var Fd=$a.ReactCurrentDispatcher,mm=$a.ReactCurrentBatchConfig,Rs=0,bn=null,Zn=null,tr=null,cp=!1,fc=!1,Dc=0,wT=0;function _r(){throw Error(Me(321))}function my(t,i){if(i===null)return!1;for(var s=0;s<i.length&&s<t.length;s++)if(!Gi(t[s],i[s]))return!1;return!0}function gy(t,i,s,f,_,v){if(Rs=v,bn=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Fd.current=t===null||t.memoizedState===null?ET:kT,t=s(f,_),fc){v=0;do{if(fc=!1,Dc=0,25<=v)throw Error(Me(301));v+=1,tr=Zn=null,i.updateQueue=null,Fd.current=IT,t=s(f,_)}while(fc)}if(Fd.current=hp,i=Zn!==null&&Zn.next!==null,Rs=0,tr=Zn=bn=null,cp=!1,i)throw Error(Me(300));return t}function yy(){var t=Dc!==0;return Dc=0,t}function sa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return tr===null?bn.memoizedState=tr=t:tr=tr.next=t,tr}function Ti(){if(Zn===null){var t=bn.alternate;t=t!==null?t.memoizedState:null}else t=Zn.next;var i=tr===null?bn.memoizedState:tr.next;if(i!==null)tr=i,Zn=t;else{if(t===null)throw Error(Me(310));Zn=t,t={memoizedState:Zn.memoizedState,baseState:Zn.baseState,baseQueue:Zn.baseQueue,queue:Zn.queue,next:null},tr===null?bn.memoizedState=tr=t:tr=tr.next=t}return tr}function Lc(t,i){return typeof i=="function"?i(t):i}function gm(t){var i=Ti(),s=i.queue;if(s===null)throw Error(Me(311));s.lastRenderedReducer=t;var f=Zn,_=f.baseQueue,v=s.pending;if(v!==null){if(_!==null){var T=_.next;_.next=v.next,v.next=T}f.baseQueue=_=v,s.pending=null}if(_!==null){v=_.next,f=f.baseState;var u=T=null,L=null,q=v;do{var ne=q.lane;if((Rs&ne)===ne)L!==null&&(L=L.next={lane:0,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null}),f=q.hasEagerState?q.eagerState:t(f,q.action);else{var Q={lane:ne,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null};L===null?(u=L=Q,T=f):L=L.next=Q,bn.lanes|=ne,Bs|=ne}q=q.next}while(q!==null&&q!==v);L===null?T=f:L.next=u,Gi(f,i.memoizedState)||(qr=!0),i.memoizedState=f,i.baseState=T,i.baseQueue=L,s.lastRenderedState=f}if(t=s.interleaved,t!==null){_=t;do v=_.lane,bn.lanes|=v,Bs|=v,_=_.next;while(_!==t)}else _===null&&(s.lanes=0);return[i.memoizedState,s.dispatch]}function ym(t){var i=Ti(),s=i.queue;if(s===null)throw Error(Me(311));s.lastRenderedReducer=t;var f=s.dispatch,_=s.pending,v=i.memoizedState;if(_!==null){s.pending=null;var T=_=_.next;do v=t(v,T.action),T=T.next;while(T!==_);Gi(v,i.memoizedState)||(qr=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),s.lastRenderedState=v}return[v,f]}function y1(){}function _1(t,i){var s=bn,f=Ti(),_=i(),v=!Gi(f.memoizedState,_);if(v&&(f.memoizedState=_,qr=!0),f=f.queue,_y(w1.bind(null,s,f,t),[t]),f.getSnapshot!==i||v||tr!==null&&tr.memoizedState.tag&1){if(s.flags|=2048,Rc(9,x1.bind(null,s,f,_,i),void 0,null),nr===null)throw Error(Me(349));(Rs&30)!==0||v1(s,i,_)}return _}function v1(t,i,s){t.flags|=16384,t={getSnapshot:i,value:s},i=bn.updateQueue,i===null?(i={lastEffect:null,stores:null},bn.updateQueue=i,i.stores=[t]):(s=i.stores,s===null?i.stores=[t]:s.push(t))}function x1(t,i,s,f){i.value=s,i.getSnapshot=f,b1(i)&&S1(t)}function w1(t,i,s){return s(function(){b1(i)&&S1(t)})}function b1(t){var i=t.getSnapshot;t=t.value;try{var s=i();return!Gi(t,s)}catch{return!0}}function S1(t){var i=Fa(t,1);i!==null&&ji(i,t,1,-1)}function t0(t){var i=sa();return typeof t=="function"&&(t=t()),i.memoizedState=i.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Lc,lastRenderedState:t},i.queue=t,t=t.dispatch=TT.bind(null,bn,t),[i.memoizedState,t]}function Rc(t,i,s,f){return t={tag:t,create:i,destroy:s,deps:f,next:null},i=bn.updateQueue,i===null?(i={lastEffect:null,stores:null},bn.updateQueue=i,i.lastEffect=t.next=t):(s=i.lastEffect,s===null?i.lastEffect=t.next=t:(f=s.next,s.next=t,t.next=f,i.lastEffect=t)),t}function T1(){return Ti().memoizedState}function Od(t,i,s,f){var _=sa();bn.flags|=t,_.memoizedState=Rc(1|i,s,void 0,f===void 0?null:f)}function Ap(t,i,s,f){var _=Ti();f=f===void 0?null:f;var v=void 0;if(Zn!==null){var T=Zn.memoizedState;if(v=T.destroy,f!==null&&my(f,T.deps)){_.memoizedState=Rc(i,s,v,f);return}}bn.flags|=t,_.memoizedState=Rc(1|i,s,v,f)}function n0(t,i){return Od(8390656,8,t,i)}function _y(t,i){return Ap(2048,8,t,i)}function E1(t,i){return Ap(4,2,t,i)}function k1(t,i){return Ap(4,4,t,i)}function I1(t,i){if(typeof i=="function")return t=t(),i(t),function(){i(null)};if(i!=null)return t=t(),i.current=t,function(){i.current=null}}function C1(t,i,s){return s=s!=null?s.concat([t]):null,Ap(4,4,I1.bind(null,i,t),s)}function vy(){}function A1(t,i){var s=Ti();i=i===void 0?null:i;var f=s.memoizedState;return f!==null&&i!==null&&my(i,f[1])?f[0]:(s.memoizedState=[t,i],t)}function P1(t,i){var s=Ti();i=i===void 0?null:i;var f=s.memoizedState;return f!==null&&i!==null&&my(i,f[1])?f[0]:(t=t(),s.memoizedState=[t,i],t)}function z1(t,i,s){return(Rs&21)===0?(t.baseState&&(t.baseState=!1,qr=!0),t.memoizedState=s):(Gi(s,i)||(s=Lx(),bn.lanes|=s,Bs|=s,t.baseState=!0),i)}function bT(t,i){var s=Yt;Yt=s!==0&&4>s?s:4,t(!0);var f=mm.transition;mm.transition={};try{t(!1),i()}finally{Yt=s,mm.transition=f}}function M1(){return Ti().memoizedState}function ST(t,i,s){var f=Mo(t);if(s={lane:f,action:s,hasEagerState:!1,eagerState:null,next:null},D1(t))L1(i,s);else if(s=c1(t,i,s,f),s!==null){var _=Br();ji(s,t,f,_),R1(s,i,f)}}function TT(t,i,s){var f=Mo(t),_={lane:f,action:s,hasEagerState:!1,eagerState:null,next:null};if(D1(t))L1(i,_);else{var v=t.alternate;if(t.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var T=i.lastRenderedState,u=v(T,s);if(_.hasEagerState=!0,_.eagerState=u,Gi(u,T)){var L=i.interleaved;L===null?(_.next=_,cy(i)):(_.next=L.next,L.next=_),i.interleaved=_;return}}catch{}finally{}s=c1(t,i,_,f),s!==null&&(_=Br(),ji(s,t,f,_),R1(s,i,f))}}function D1(t){var i=t.alternate;return t===bn||i!==null&&i===bn}function L1(t,i){fc=cp=!0;var s=t.pending;s===null?i.next=i:(i.next=s.next,s.next=i),t.pending=i}function R1(t,i,s){if((s&4194240)!==0){var f=i.lanes;f&=t.pendingLanes,s|=f,i.lanes=s,Yg(t,s)}}var hp={readContext:Si,useCallback:_r,useContext:_r,useEffect:_r,useImperativeHandle:_r,useInsertionEffect:_r,useLayoutEffect:_r,useMemo:_r,useReducer:_r,useRef:_r,useState:_r,useDebugValue:_r,useDeferredValue:_r,useTransition:_r,useMutableSource:_r,useSyncExternalStore:_r,useId:_r,unstable_isNewReconciler:!1},ET={readContext:Si,useCallback:function(t,i){return sa().memoizedState=[t,i===void 0?null:i],t},useContext:Si,useEffect:n0,useImperativeHandle:function(t,i,s){return s=s!=null?s.concat([t]):null,Od(4194308,4,I1.bind(null,i,t),s)},useLayoutEffect:function(t,i){return Od(4194308,4,t,i)},useInsertionEffect:function(t,i){return Od(4,2,t,i)},useMemo:function(t,i){var s=sa();return i=i===void 0?null:i,t=t(),s.memoizedState=[t,i],t},useReducer:function(t,i,s){var f=sa();return i=s!==void 0?s(i):i,f.memoizedState=f.baseState=i,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:i},f.queue=t,t=t.dispatch=ST.bind(null,bn,t),[f.memoizedState,t]},useRef:function(t){var i=sa();return t={current:t},i.memoizedState=t},useState:t0,useDebugValue:vy,useDeferredValue:function(t){return sa().memoizedState=t},useTransition:function(){var t=t0(!1),i=t[0];return t=bT.bind(null,t[1]),sa().memoizedState=t,[i,t]},useMutableSource:function(){},useSyncExternalStore:function(t,i,s){var f=bn,_=sa();if(_n){if(s===void 0)throw Error(Me(407));s=s()}else{if(s=i(),nr===null)throw Error(Me(349));(Rs&30)!==0||v1(f,i,s)}_.memoizedState=s;var v={value:s,getSnapshot:i};return _.queue=v,n0(w1.bind(null,f,v,t),[t]),f.flags|=2048,Rc(9,x1.bind(null,f,v,s,i),void 0,null),s},useId:function(){var t=sa(),i=nr.identifierPrefix;if(_n){var s=Da,f=Ma;s=(f&~(1<<32-$i(f)-1)).toString(32)+s,i=":"+i+"R"+s,s=Dc++,0<s&&(i+="H"+s.toString(32)),i+=":"}else s=wT++,i=":"+i+"r"+s.toString(32)+":";return t.memoizedState=i},unstable_isNewReconciler:!1},kT={readContext:Si,useCallback:A1,useContext:Si,useEffect:_y,useImperativeHandle:C1,useInsertionEffect:E1,useLayoutEffect:k1,useMemo:P1,useReducer:gm,useRef:T1,useState:function(){return gm(Lc)},useDebugValue:vy,useDeferredValue:function(t){var i=Ti();return z1(i,Zn.memoizedState,t)},useTransition:function(){var t=gm(Lc)[0],i=Ti().memoizedState;return[t,i]},useMutableSource:y1,useSyncExternalStore:_1,useId:M1,unstable_isNewReconciler:!1},IT={readContext:Si,useCallback:A1,useContext:Si,useEffect:_y,useImperativeHandle:C1,useInsertionEffect:E1,useLayoutEffect:k1,useMemo:P1,useReducer:ym,useRef:T1,useState:function(){return ym(Lc)},useDebugValue:vy,useDeferredValue:function(t){var i=Ti();return Zn===null?i.memoizedState=t:z1(i,Zn.memoizedState,t)},useTransition:function(){var t=ym(Lc)[0],i=Ti().memoizedState;return[t,i]},useMutableSource:y1,useSyncExternalStore:_1,useId:M1,unstable_isNewReconciler:!1};function Zl(t,i){try{var s="",f=i;do s+=tS(f),f=f.return;while(f);var _=s}catch(v){_=`
Error generating stack: `+v.message+`
`+v.stack}return{value:t,source:i,stack:_,digest:null}}function _m(t,i,s){return{value:t,source:null,stack:s!=null?s:null,digest:i!=null?i:null}}function ug(t,i){try{console.error(i.value)}catch(s){setTimeout(function(){throw s})}}var CT=typeof WeakMap=="function"?WeakMap:Map;function B1(t,i,s){s=La(-1,s),s.tag=3,s.payload={element:null};var f=i.value;return s.callback=function(){pp||(pp=!0,vg=f),ug(t,i)},s}function F1(t,i,s){s=La(-1,s),s.tag=3;var f=t.type.getDerivedStateFromError;if(typeof f=="function"){var _=i.value;s.payload=function(){return f(_)},s.callback=function(){ug(t,i)}}var v=t.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(s.callback=function(){ug(t,i),typeof f!="function"&&(zo===null?zo=new Set([this]):zo.add(this));var T=i.stack;this.componentDidCatch(i.value,{componentStack:T!==null?T:""})}),s}function r0(t,i,s){var f=t.pingCache;if(f===null){f=t.pingCache=new CT;var _=new Set;f.set(i,_)}else _=f.get(i),_===void 0&&(_=new Set,f.set(i,_));_.has(s)||(_.add(s),t=$T.bind(null,t,i,s),i.then(t,t))}function i0(t){do{var i;if((i=t.tag===13)&&(i=t.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return t;t=t.return}while(t!==null);return null}function a0(t,i,s,f,_){return(t.mode&1)===0?(t===i?t.flags|=65536:(t.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(i=La(-1,1),i.tag=2,Po(s,i,1))),s.lanes|=1),t):(t.flags|=65536,t.lanes=_,t)}var AT=$a.ReactCurrentOwner,qr=!1;function Rr(t,i,s,f){i.child=t===null?m1(i,null,s,f):Gl(i,t.child,s,f)}function o0(t,i,s,f,_){s=s.render;var v=i.ref;return Ol(i,_),f=gy(t,i,s,f,v,_),s=yy(),t!==null&&!qr?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~_,Oa(t,i,_)):(_n&&s&&iy(i),i.flags|=1,Rr(t,i,f,_),i.child)}function s0(t,i,s,f,_){if(t===null){var v=s.type;return typeof v=="function"&&!Iy(v)&&v.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(i.tag=15,i.type=v,O1(t,i,v,f,_)):(t=$d(s.type,null,f,i,i.mode,_),t.ref=i.ref,t.return=i,i.child=t)}if(v=t.child,(t.lanes&_)===0){var T=v.memoizedProps;if(s=s.compare,s=s!==null?s:Ic,s(T,f)&&t.ref===i.ref)return Oa(t,i,_)}return i.flags|=1,t=Do(v,f),t.ref=i.ref,t.return=i,i.child=t}function O1(t,i,s,f,_){if(t!==null){var v=t.memoizedProps;if(Ic(v,f)&&t.ref===i.ref)if(qr=!1,i.pendingProps=f=v,(t.lanes&_)!==0)(t.flags&131072)!==0&&(qr=!0);else return i.lanes=t.lanes,Oa(t,i,_)}return cg(t,i,s,f,_)}function N1(t,i,s){var f=i.pendingProps,_=f.children,v=t!==null?t.memoizedState:null;if(f.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},un(Pl,ri),ri|=s;else{if((s&1073741824)===0)return t=v!==null?v.baseLanes|s:s,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:t,cachePool:null,transitions:null},i.updateQueue=null,un(Pl,ri),ri|=t,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=v!==null?v.baseLanes:s,un(Pl,ri),ri|=f}else v!==null?(f=v.baseLanes|s,i.memoizedState=null):f=s,un(Pl,ri),ri|=f;return Rr(t,i,_,s),i.child}function U1(t,i){var s=i.ref;(t===null&&s!==null||t!==null&&t.ref!==s)&&(i.flags|=512,i.flags|=2097152)}function cg(t,i,s,f,_){var v=Wr(s)?Ds:wr.current;return v=$l(i,v),Ol(i,_),s=gy(t,i,s,f,v,_),f=yy(),t!==null&&!qr?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~_,Oa(t,i,_)):(_n&&f&&iy(i),i.flags|=1,Rr(t,i,s,_),i.child)}function l0(t,i,s,f,_){if(Wr(s)){var v=!0;rp(i)}else v=!1;if(Ol(i,_),i.stateNode===null)Nd(t,i),p1(i,s,f),lg(i,s,f,_),f=!0;else if(t===null){var T=i.stateNode,u=i.memoizedProps;T.props=u;var L=T.context,q=s.contextType;typeof q=="object"&&q!==null?q=Si(q):(q=Wr(s)?Ds:wr.current,q=$l(i,q));var ne=s.getDerivedStateFromProps,Q=typeof ne=="function"||typeof T.getSnapshotBeforeUpdate=="function";Q||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(u!==f||L!==q)&&Qv(i,T,f,q),vo=!1;var V=i.memoizedState;T.state=V,lp(i,f,T,_),L=i.memoizedState,u!==f||V!==L||Zr.current||vo?(typeof ne=="function"&&(sg(i,s,ne,f),L=i.memoizedState),(u=vo||Jv(i,s,u,f,V,L,q))?(Q||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(i.flags|=4194308)):(typeof T.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=f,i.memoizedState=L),T.props=f,T.state=L,T.context=q,f=u):(typeof T.componentDidMount=="function"&&(i.flags|=4194308),f=!1)}else{T=i.stateNode,h1(t,i),u=i.memoizedProps,q=i.type===i.elementType?u:Oi(i.type,u),T.props=q,Q=i.pendingProps,V=T.context,L=s.contextType,typeof L=="object"&&L!==null?L=Si(L):(L=Wr(s)?Ds:wr.current,L=$l(i,L));var pe=s.getDerivedStateFromProps;(ne=typeof pe=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(u!==Q||V!==L)&&Qv(i,T,f,L),vo=!1,V=i.memoizedState,T.state=V,lp(i,f,T,_);var be=i.memoizedState;u!==Q||V!==be||Zr.current||vo?(typeof pe=="function"&&(sg(i,s,pe,f),be=i.memoizedState),(q=vo||Jv(i,s,q,f,V,be,L)||!1)?(ne||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(f,be,L),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(f,be,L)),typeof T.componentDidUpdate=="function"&&(i.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof T.componentDidUpdate!="function"||u===t.memoizedProps&&V===t.memoizedState||(i.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&V===t.memoizedState||(i.flags|=1024),i.memoizedProps=f,i.memoizedState=be),T.props=f,T.state=be,T.context=L,f=q):(typeof T.componentDidUpdate!="function"||u===t.memoizedProps&&V===t.memoizedState||(i.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&V===t.memoizedState||(i.flags|=1024),f=!1)}return hg(t,i,s,f,v,_)}function hg(t,i,s,f,_,v){U1(t,i);var T=(i.flags&128)!==0;if(!f&&!T)return _&&Wv(i,s,!1),Oa(t,i,v);f=i.stateNode,AT.current=i;var u=T&&typeof s.getDerivedStateFromError!="function"?null:f.render();return i.flags|=1,t!==null&&T?(i.child=Gl(i,t.child,null,v),i.child=Gl(i,null,u,v)):Rr(t,i,u,v),i.memoizedState=f.state,_&&Wv(i,s,!0),i.child}function V1(t){var i=t.stateNode;i.pendingContext?Zv(t,i.pendingContext,i.pendingContext!==i.context):i.context&&Zv(t,i.context,!1),dy(t,i.containerInfo)}function u0(t,i,s,f,_){return jl(),oy(_),i.flags|=256,Rr(t,i,s,f),i.child}var dg={dehydrated:null,treeContext:null,retryLane:0};function pg(t){return{baseLanes:t,cachePool:null,transitions:null}}function $1(t,i,s){var f=i.pendingProps,_=wn.current,v=!1,T=(i.flags&128)!==0,u;if((u=T)||(u=t!==null&&t.memoizedState===null?!1:(_&2)!==0),u?(v=!0,i.flags&=-129):(t===null||t.memoizedState!==null)&&(_|=1),un(wn,_&1),t===null)return ag(i),t=i.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((i.mode&1)===0?i.lanes=1:t.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(T=f.children,t=f.fallback,v?(f=i.mode,v=i.child,T={mode:"hidden",children:T},(f&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=T):v=Mp(T,f,0,null),t=Ps(t,f,s,null),v.return=i,t.return=i,v.sibling=t,i.child=v,i.child.memoizedState=pg(s),i.memoizedState=dg,t):xy(i,T));if(_=t.memoizedState,_!==null&&(u=_.dehydrated,u!==null))return PT(t,i,T,f,u,_,s);if(v){v=f.fallback,T=i.mode,_=t.child,u=_.sibling;var L={mode:"hidden",children:f.children};return(T&1)===0&&i.child!==_?(f=i.child,f.childLanes=0,f.pendingProps=L,i.deletions=null):(f=Do(_,L),f.subtreeFlags=_.subtreeFlags&14680064),u!==null?v=Do(u,v):(v=Ps(v,T,s,null),v.flags|=2),v.return=i,f.return=i,f.sibling=v,i.child=f,f=v,v=i.child,T=t.child.memoizedState,T=T===null?pg(s):{baseLanes:T.baseLanes|s,cachePool:null,transitions:T.transitions},v.memoizedState=T,v.childLanes=t.childLanes&~s,i.memoizedState=dg,f}return v=t.child,t=v.sibling,f=Do(v,{mode:"visible",children:f.children}),(i.mode&1)===0&&(f.lanes=s),f.return=i,f.sibling=null,t!==null&&(s=i.deletions,s===null?(i.deletions=[t],i.flags|=16):s.push(t)),i.child=f,i.memoizedState=null,f}function xy(t,i){return i=Mp({mode:"visible",children:i},t.mode,0,null),i.return=t,t.child=i}function gd(t,i,s,f){return f!==null&&oy(f),Gl(i,t.child,null,s),t=xy(i,i.pendingProps.children),t.flags|=2,i.memoizedState=null,t}function PT(t,i,s,f,_,v,T){if(s)return i.flags&256?(i.flags&=-257,f=_m(Error(Me(422))),gd(t,i,T,f)):i.memoizedState!==null?(i.child=t.child,i.flags|=128,null):(v=f.fallback,_=i.mode,f=Mp({mode:"visible",children:f.children},_,0,null),v=Ps(v,_,T,null),v.flags|=2,f.return=i,v.return=i,f.sibling=v,i.child=f,(i.mode&1)!==0&&Gl(i,t.child,null,T),i.child.memoizedState=pg(T),i.memoizedState=dg,v);if((i.mode&1)===0)return gd(t,i,T,null);if(_.data==="$!"){if(f=_.nextSibling&&_.nextSibling.dataset,f)var u=f.dgst;return f=u,v=Error(Me(419)),f=_m(v,f,void 0),gd(t,i,T,f)}if(u=(T&t.childLanes)!==0,qr||u){if(f=nr,f!==null){switch(T&-T){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(f.suspendedLanes|T))!==0?0:_,_!==0&&_!==v.retryLane&&(v.retryLane=_,Fa(t,_),ji(f,t,_,-1))}return ky(),f=_m(Error(Me(421))),gd(t,i,T,f)}return _.data==="$?"?(i.flags|=128,i.child=t.child,i=jT.bind(null,t),_._reactRetry=i,null):(t=v.treeContext,ii=Ao(_.nextSibling),oi=i,_n=!0,Ui=null,t!==null&&(vi[xi++]=Ma,vi[xi++]=Da,vi[xi++]=Ls,Ma=t.id,Da=t.overflow,Ls=i),i=xy(i,f.children),i.flags|=4096,i)}function c0(t,i,s){t.lanes|=i;var f=t.alternate;f!==null&&(f.lanes|=i),og(t.return,i,s)}function vm(t,i,s,f,_){var v=t.memoizedState;v===null?t.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:f,tail:s,tailMode:_}:(v.isBackwards=i,v.rendering=null,v.renderingStartTime=0,v.last=f,v.tail=s,v.tailMode=_)}function j1(t,i,s){var f=i.pendingProps,_=f.revealOrder,v=f.tail;if(Rr(t,i,f.children,s),f=wn.current,(f&2)!==0)f=f&1|2,i.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=i.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&c0(t,s,i);else if(t.tag===19)c0(t,s,i);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break e;for(;t.sibling===null;){if(t.return===null||t.return===i)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}f&=1}if(un(wn,f),(i.mode&1)===0)i.memoizedState=null;else switch(_){case"forwards":for(s=i.child,_=null;s!==null;)t=s.alternate,t!==null&&up(t)===null&&(_=s),s=s.sibling;s=_,s===null?(_=i.child,i.child=null):(_=s.sibling,s.sibling=null),vm(i,!1,_,s,v);break;case"backwards":for(s=null,_=i.child,i.child=null;_!==null;){if(t=_.alternate,t!==null&&up(t)===null){i.child=_;break}t=_.sibling,_.sibling=s,s=_,_=t}vm(i,!0,s,null,v);break;case"together":vm(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Nd(t,i){(i.mode&1)===0&&t!==null&&(t.alternate=null,i.alternate=null,i.flags|=2)}function Oa(t,i,s){if(t!==null&&(i.dependencies=t.dependencies),Bs|=i.lanes,(s&i.childLanes)===0)return null;if(t!==null&&i.child!==t.child)throw Error(Me(153));if(i.child!==null){for(t=i.child,s=Do(t,t.pendingProps),i.child=s,s.return=i;t.sibling!==null;)t=t.sibling,s=s.sibling=Do(t,t.pendingProps),s.return=i;s.sibling=null}return i.child}function zT(t,i,s){switch(i.tag){case 3:V1(i),jl();break;case 5:g1(i);break;case 1:Wr(i.type)&&rp(i);break;case 4:dy(i,i.stateNode.containerInfo);break;case 10:var f=i.type._context,_=i.memoizedProps.value;un(op,f._currentValue),f._currentValue=_;break;case 13:if(f=i.memoizedState,f!==null)return f.dehydrated!==null?(un(wn,wn.current&1),i.flags|=128,null):(s&i.child.childLanes)!==0?$1(t,i,s):(un(wn,wn.current&1),t=Oa(t,i,s),t!==null?t.sibling:null);un(wn,wn.current&1);break;case 19:if(f=(s&i.childLanes)!==0,(t.flags&128)!==0){if(f)return j1(t,i,s);i.flags|=128}if(_=i.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),un(wn,wn.current),f)break;return null;case 22:case 23:return i.lanes=0,N1(t,i,s)}return Oa(t,i,s)}var G1,fg,q1,Z1;G1=function(t,i){for(var s=i.child;s!==null;){if(s.tag===5||s.tag===6)t.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};fg=function(){};q1=function(t,i,s,f){var _=t.memoizedProps;if(_!==f){t=i.stateNode,Es(ha.current);var v=null;switch(s){case"input":_=Bm(t,_),f=Bm(t,f),v=[];break;case"select":_=Sn({},_,{value:void 0}),f=Sn({},f,{value:void 0}),v=[];break;case"textarea":_=Nm(t,_),f=Nm(t,f),v=[];break;default:typeof _.onClick!="function"&&typeof f.onClick=="function"&&(t.onclick=tp)}Vm(s,f);var T;s=null;for(q in _)if(!f.hasOwnProperty(q)&&_.hasOwnProperty(q)&&_[q]!=null)if(q==="style"){var u=_[q];for(T in u)u.hasOwnProperty(T)&&(s||(s={}),s[T]="")}else q!=="dangerouslySetInnerHTML"&&q!=="children"&&q!=="suppressContentEditableWarning"&&q!=="suppressHydrationWarning"&&q!=="autoFocus"&&(xc.hasOwnProperty(q)?v||(v=[]):(v=v||[]).push(q,null));for(q in f){var L=f[q];if(u=_!=null?_[q]:void 0,f.hasOwnProperty(q)&&L!==u&&(L!=null||u!=null))if(q==="style")if(u){for(T in u)!u.hasOwnProperty(T)||L&&L.hasOwnProperty(T)||(s||(s={}),s[T]="");for(T in L)L.hasOwnProperty(T)&&u[T]!==L[T]&&(s||(s={}),s[T]=L[T])}else s||(v||(v=[]),v.push(q,s)),s=L;else q==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,u=u?u.__html:void 0,L!=null&&u!==L&&(v=v||[]).push(q,L)):q==="children"?typeof L!="string"&&typeof L!="number"||(v=v||[]).push(q,""+L):q!=="suppressContentEditableWarning"&&q!=="suppressHydrationWarning"&&(xc.hasOwnProperty(q)?(L!=null&&q==="onScroll"&&dn("scroll",t),v||u===L||(v=[])):(v=v||[]).push(q,L))}s&&(v=v||[]).push("style",s);var q=v;(i.updateQueue=q)&&(i.flags|=4)}};Z1=function(t,i,s,f){s!==f&&(i.flags|=4)};function nc(t,i){if(!_n)switch(t.tailMode){case"hidden":i=t.tail;for(var s=null;i!==null;)i.alternate!==null&&(s=i),i=i.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var f=null;s!==null;)s.alternate!==null&&(f=s),s=s.sibling;f===null?i||t.tail===null?t.tail=null:t.tail.sibling=null:f.sibling=null}}function vr(t){var i=t.alternate!==null&&t.alternate.child===t.child,s=0,f=0;if(i)for(var _=t.child;_!==null;)s|=_.lanes|_.childLanes,f|=_.subtreeFlags&14680064,f|=_.flags&14680064,_.return=t,_=_.sibling;else for(_=t.child;_!==null;)s|=_.lanes|_.childLanes,f|=_.subtreeFlags,f|=_.flags,_.return=t,_=_.sibling;return t.subtreeFlags|=f,t.childLanes=s,i}function MT(t,i,s){var f=i.pendingProps;switch(ay(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vr(i),null;case 1:return Wr(i.type)&&np(),vr(i),null;case 3:return f=i.stateNode,ql(),fn(Zr),fn(wr),fy(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(t===null||t.child===null)&&(fd(i)?i.flags|=4:t===null||t.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Ui!==null&&(bg(Ui),Ui=null))),fg(t,i),vr(i),null;case 5:py(i);var _=Es(Mc.current);if(s=i.type,t!==null&&i.stateNode!=null)q1(t,i,s,f,_),t.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!f){if(i.stateNode===null)throw Error(Me(166));return vr(i),null}if(t=Es(ha.current),fd(i)){f=i.stateNode,s=i.type;var v=i.memoizedProps;switch(f[la]=i,f[Pc]=v,t=(i.mode&1)!==0,s){case"dialog":dn("cancel",f),dn("close",f);break;case"iframe":case"object":case"embed":dn("load",f);break;case"video":case"audio":for(_=0;_<sc.length;_++)dn(sc[_],f);break;case"source":dn("error",f);break;case"img":case"image":case"link":dn("error",f),dn("load",f);break;case"details":dn("toggle",f);break;case"input":vv(f,v),dn("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!v.multiple},dn("invalid",f);break;case"textarea":wv(f,v),dn("invalid",f)}Vm(s,v),_=null;for(var T in v)if(v.hasOwnProperty(T)){var u=v[T];T==="children"?typeof u=="string"?f.textContent!==u&&(v.suppressHydrationWarning!==!0&&pd(f.textContent,u,t),_=["children",u]):typeof u=="number"&&f.textContent!==""+u&&(v.suppressHydrationWarning!==!0&&pd(f.textContent,u,t),_=["children",""+u]):xc.hasOwnProperty(T)&&u!=null&&T==="onScroll"&&dn("scroll",f)}switch(s){case"input":ad(f),xv(f,v,!0);break;case"textarea":ad(f),bv(f);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(f.onclick=tp)}f=_,i.updateQueue=f,f!==null&&(i.flags|=4)}else{T=_.nodeType===9?_:_.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=vx(s)),t==="http://www.w3.org/1999/xhtml"?s==="script"?(t=T.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof f.is=="string"?t=T.createElement(s,{is:f.is}):(t=T.createElement(s),s==="select"&&(T=t,f.multiple?T.multiple=!0:f.size&&(T.size=f.size))):t=T.createElementNS(t,s),t[la]=i,t[Pc]=f,G1(t,i,!1,!1),i.stateNode=t;e:{switch(T=$m(s,f),s){case"dialog":dn("cancel",t),dn("close",t),_=f;break;case"iframe":case"object":case"embed":dn("load",t),_=f;break;case"video":case"audio":for(_=0;_<sc.length;_++)dn(sc[_],t);_=f;break;case"source":dn("error",t),_=f;break;case"img":case"image":case"link":dn("error",t),dn("load",t),_=f;break;case"details":dn("toggle",t),_=f;break;case"input":vv(t,f),_=Bm(t,f),dn("invalid",t);break;case"option":_=f;break;case"select":t._wrapperState={wasMultiple:!!f.multiple},_=Sn({},f,{value:void 0}),dn("invalid",t);break;case"textarea":wv(t,f),_=Nm(t,f),dn("invalid",t);break;default:_=f}Vm(s,_),u=_;for(v in u)if(u.hasOwnProperty(v)){var L=u[v];v==="style"?bx(t,L):v==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,L!=null&&xx(t,L)):v==="children"?typeof L=="string"?(s!=="textarea"||L!=="")&&wc(t,L):typeof L=="number"&&wc(t,""+L):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(xc.hasOwnProperty(v)?L!=null&&v==="onScroll"&&dn("scroll",t):L!=null&&Gg(t,v,L,T))}switch(s){case"input":ad(t),xv(t,f,!1);break;case"textarea":ad(t),bv(t);break;case"option":f.value!=null&&t.setAttribute("value",""+Lo(f.value));break;case"select":t.multiple=!!f.multiple,v=f.value,v!=null?Ll(t,!!f.multiple,v,!1):f.defaultValue!=null&&Ll(t,!!f.multiple,f.defaultValue,!0);break;default:typeof _.onClick=="function"&&(t.onclick=tp)}switch(s){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return vr(i),null;case 6:if(t&&i.stateNode!=null)Z1(t,i,t.memoizedProps,f);else{if(typeof f!="string"&&i.stateNode===null)throw Error(Me(166));if(s=Es(Mc.current),Es(ha.current),fd(i)){if(f=i.stateNode,s=i.memoizedProps,f[la]=i,(v=f.nodeValue!==s)&&(t=oi,t!==null))switch(t.tag){case 3:pd(f.nodeValue,s,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&pd(f.nodeValue,s,(t.mode&1)!==0)}v&&(i.flags|=4)}else f=(s.nodeType===9?s:s.ownerDocument).createTextNode(f),f[la]=i,i.stateNode=f}return vr(i),null;case 13:if(fn(wn),f=i.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(_n&&ii!==null&&(i.mode&1)!==0&&(i.flags&128)===0)u1(),jl(),i.flags|=98560,v=!1;else if(v=fd(i),f!==null&&f.dehydrated!==null){if(t===null){if(!v)throw Error(Me(318));if(v=i.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(Me(317));v[la]=i}else jl(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;vr(i),v=!1}else Ui!==null&&(bg(Ui),Ui=null),v=!0;if(!v)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=s,i):(f=f!==null,f!==(t!==null&&t.memoizedState!==null)&&f&&(i.child.flags|=8192,(i.mode&1)!==0&&(t===null||(wn.current&1)!==0?Wn===0&&(Wn=3):ky())),i.updateQueue!==null&&(i.flags|=4),vr(i),null);case 4:return ql(),fg(t,i),t===null&&Cc(i.stateNode.containerInfo),vr(i),null;case 10:return uy(i.type._context),vr(i),null;case 17:return Wr(i.type)&&np(),vr(i),null;case 19:if(fn(wn),v=i.memoizedState,v===null)return vr(i),null;if(f=(i.flags&128)!==0,T=v.rendering,T===null)if(f)nc(v,!1);else{if(Wn!==0||t!==null&&(t.flags&128)!==0)for(t=i.child;t!==null;){if(T=up(t),T!==null){for(i.flags|=128,nc(v,!1),f=T.updateQueue,f!==null&&(i.updateQueue=f,i.flags|=4),i.subtreeFlags=0,f=s,s=i.child;s!==null;)v=s,t=f,v.flags&=14680066,T=v.alternate,T===null?(v.childLanes=0,v.lanes=t,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=T.childLanes,v.lanes=T.lanes,v.child=T.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=T.memoizedProps,v.memoizedState=T.memoizedState,v.updateQueue=T.updateQueue,v.type=T.type,t=T.dependencies,v.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s=s.sibling;return un(wn,wn.current&1|2),i.child}t=t.sibling}v.tail!==null&&Dn()>Wl&&(i.flags|=128,f=!0,nc(v,!1),i.lanes=4194304)}else{if(!f)if(t=up(T),t!==null){if(i.flags|=128,f=!0,s=t.updateQueue,s!==null&&(i.updateQueue=s,i.flags|=4),nc(v,!0),v.tail===null&&v.tailMode==="hidden"&&!T.alternate&&!_n)return vr(i),null}else 2*Dn()-v.renderingStartTime>Wl&&s!==1073741824&&(i.flags|=128,f=!0,nc(v,!1),i.lanes=4194304);v.isBackwards?(T.sibling=i.child,i.child=T):(s=v.last,s!==null?s.sibling=T:i.child=T,v.last=T)}return v.tail!==null?(i=v.tail,v.rendering=i,v.tail=i.sibling,v.renderingStartTime=Dn(),i.sibling=null,s=wn.current,un(wn,f?s&1|2:s&1),i):(vr(i),null);case 22:case 23:return Ey(),f=i.memoizedState!==null,t!==null&&t.memoizedState!==null!==f&&(i.flags|=8192),f&&(i.mode&1)!==0?(ri&1073741824)!==0&&(vr(i),i.subtreeFlags&6&&(i.flags|=8192)):vr(i),null;case 24:return null;case 25:return null}throw Error(Me(156,i.tag))}function DT(t,i){switch(ay(i),i.tag){case 1:return Wr(i.type)&&np(),t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 3:return ql(),fn(Zr),fn(wr),fy(),t=i.flags,(t&65536)!==0&&(t&128)===0?(i.flags=t&-65537|128,i):null;case 5:return py(i),null;case 13:if(fn(wn),t=i.memoizedState,t!==null&&t.dehydrated!==null){if(i.alternate===null)throw Error(Me(340));jl()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 19:return fn(wn),null;case 4:return ql(),null;case 10:return uy(i.type._context),null;case 22:case 23:return Ey(),null;case 24:return null;default:return null}}var yd=!1,xr=!1,LT=typeof WeakSet=="function"?WeakSet:Set,it=null;function Al(t,i){var s=t.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(f){Cn(t,i,f)}else s.current=null}function mg(t,i,s){try{s()}catch(f){Cn(t,i,f)}}var h0=!1;function RT(t,i){if(Jm=Jd,t=Yx(),ry(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else e:{s=(s=t.ownerDocument)&&s.defaultView||window;var f=s.getSelection&&s.getSelection();if(f&&f.rangeCount!==0){s=f.anchorNode;var _=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{s.nodeType,v.nodeType}catch{s=null;break e}var T=0,u=-1,L=-1,q=0,ne=0,Q=t,V=null;t:for(;;){for(var pe;Q!==s||_!==0&&Q.nodeType!==3||(u=T+_),Q!==v||f!==0&&Q.nodeType!==3||(L=T+f),Q.nodeType===3&&(T+=Q.nodeValue.length),(pe=Q.firstChild)!==null;)V=Q,Q=pe;for(;;){if(Q===t)break t;if(V===s&&++q===_&&(u=T),V===v&&++ne===f&&(L=T),(pe=Q.nextSibling)!==null)break;Q=V,V=Q.parentNode}Q=pe}s=u===-1||L===-1?null:{start:u,end:L}}else s=null}s=s||{start:0,end:0}}else s=null;for(Qm={focusedElem:t,selectionRange:s},Jd=!1,it=i;it!==null;)if(i=it,t=i.child,(i.subtreeFlags&1028)!==0&&t!==null)t.return=i,it=t;else for(;it!==null;){i=it;try{var be=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(be!==null){var ye=be.memoizedProps,ze=be.memoizedState,ee=i.stateNode,X=ee.getSnapshotBeforeUpdate(i.elementType===i.type?ye:Oi(i.type,ye),ze);ee.__reactInternalSnapshotBeforeUpdate=X}break;case 3:var ie=i.stateNode.containerInfo;ie.nodeType===1?ie.textContent="":ie.nodeType===9&&ie.documentElement&&ie.removeChild(ie.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Me(163))}}catch(xe){Cn(i,i.return,xe)}if(t=i.sibling,t!==null){t.return=i.return,it=t;break}it=i.return}return be=h0,h0=!1,be}function mc(t,i,s){var f=i.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var _=f=f.next;do{if((_.tag&t)===t){var v=_.destroy;_.destroy=void 0,v!==void 0&&mg(i,s,v)}_=_.next}while(_!==f)}}function Pp(t,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&t)===t){var f=s.create;s.destroy=f()}s=s.next}while(s!==i)}}function gg(t){var i=t.ref;if(i!==null){var s=t.stateNode;switch(t.tag){case 5:t=s;break;default:t=s}typeof i=="function"?i(t):i.current=t}}function W1(t){var i=t.alternate;i!==null&&(t.alternate=null,W1(i)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(i=t.stateNode,i!==null&&(delete i[la],delete i[Pc],delete i[ng],delete i[yT],delete i[_T])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function H1(t){return t.tag===5||t.tag===3||t.tag===4}function d0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||H1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function yg(t,i,s){var f=t.tag;if(f===5||f===6)t=t.stateNode,i?s.nodeType===8?s.parentNode.insertBefore(t,i):s.insertBefore(t,i):(s.nodeType===8?(i=s.parentNode,i.insertBefore(t,s)):(i=s,i.appendChild(t)),s=s._reactRootContainer,s!=null||i.onclick!==null||(i.onclick=tp));else if(f!==4&&(t=t.child,t!==null))for(yg(t,i,s),t=t.sibling;t!==null;)yg(t,i,s),t=t.sibling}function _g(t,i,s){var f=t.tag;if(f===5||f===6)t=t.stateNode,i?s.insertBefore(t,i):s.appendChild(t);else if(f!==4&&(t=t.child,t!==null))for(_g(t,i,s),t=t.sibling;t!==null;)_g(t,i,s),t=t.sibling}var sr=null,Ni=!1;function go(t,i,s){for(s=s.child;s!==null;)X1(t,i,s),s=s.sibling}function X1(t,i,s){if(ca&&typeof ca.onCommitFiberUnmount=="function")try{ca.onCommitFiberUnmount(bp,s)}catch{}switch(s.tag){case 5:xr||Al(s,i);case 6:var f=sr,_=Ni;sr=null,go(t,i,s),sr=f,Ni=_,sr!==null&&(Ni?(t=sr,s=s.stateNode,t.nodeType===8?t.parentNode.removeChild(s):t.removeChild(s)):sr.removeChild(s.stateNode));break;case 18:sr!==null&&(Ni?(t=sr,s=s.stateNode,t.nodeType===8?dm(t.parentNode,s):t.nodeType===1&&dm(t,s),Ec(t)):dm(sr,s.stateNode));break;case 4:f=sr,_=Ni,sr=s.stateNode.containerInfo,Ni=!0,go(t,i,s),sr=f,Ni=_;break;case 0:case 11:case 14:case 15:if(!xr&&(f=s.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){_=f=f.next;do{var v=_,T=v.destroy;v=v.tag,T!==void 0&&((v&2)!==0||(v&4)!==0)&&mg(s,i,T),_=_.next}while(_!==f)}go(t,i,s);break;case 1:if(!xr&&(Al(s,i),f=s.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=s.memoizedProps,f.state=s.memoizedState,f.componentWillUnmount()}catch(u){Cn(s,i,u)}go(t,i,s);break;case 21:go(t,i,s);break;case 22:s.mode&1?(xr=(f=xr)||s.memoizedState!==null,go(t,i,s),xr=f):go(t,i,s);break;default:go(t,i,s)}}function p0(t){var i=t.updateQueue;if(i!==null){t.updateQueue=null;var s=t.stateNode;s===null&&(s=t.stateNode=new LT),i.forEach(function(f){var _=GT.bind(null,t,f);s.has(f)||(s.add(f),f.then(_,_))})}}function Fi(t,i){var s=i.deletions;if(s!==null)for(var f=0;f<s.length;f++){var _=s[f];try{var v=t,T=i,u=T;e:for(;u!==null;){switch(u.tag){case 5:sr=u.stateNode,Ni=!1;break e;case 3:sr=u.stateNode.containerInfo,Ni=!0;break e;case 4:sr=u.stateNode.containerInfo,Ni=!0;break e}u=u.return}if(sr===null)throw Error(Me(160));X1(v,T,_),sr=null,Ni=!1;var L=_.alternate;L!==null&&(L.return=null),_.return=null}catch(q){Cn(_,i,q)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Y1(i,t),i=i.sibling}function Y1(t,i){var s=t.alternate,f=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Fi(i,t),oa(t),f&4){try{mc(3,t,t.return),Pp(3,t)}catch(ye){Cn(t,t.return,ye)}try{mc(5,t,t.return)}catch(ye){Cn(t,t.return,ye)}}break;case 1:Fi(i,t),oa(t),f&512&&s!==null&&Al(s,s.return);break;case 5:if(Fi(i,t),oa(t),f&512&&s!==null&&Al(s,s.return),t.flags&32){var _=t.stateNode;try{wc(_,"")}catch(ye){Cn(t,t.return,ye)}}if(f&4&&(_=t.stateNode,_!=null)){var v=t.memoizedProps,T=s!==null?s.memoizedProps:v,u=t.type,L=t.updateQueue;if(t.updateQueue=null,L!==null)try{u==="input"&&v.type==="radio"&&v.name!=null&&yx(_,v),$m(u,T);var q=$m(u,v);for(T=0;T<L.length;T+=2){var ne=L[T],Q=L[T+1];ne==="style"?bx(_,Q):ne==="dangerouslySetInnerHTML"?xx(_,Q):ne==="children"?wc(_,Q):Gg(_,ne,Q,q)}switch(u){case"input":Fm(_,v);break;case"textarea":_x(_,v);break;case"select":var V=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!v.multiple;var pe=v.value;pe!=null?Ll(_,!!v.multiple,pe,!1):V!==!!v.multiple&&(v.defaultValue!=null?Ll(_,!!v.multiple,v.defaultValue,!0):Ll(_,!!v.multiple,v.multiple?[]:"",!1))}_[Pc]=v}catch(ye){Cn(t,t.return,ye)}}break;case 6:if(Fi(i,t),oa(t),f&4){if(t.stateNode===null)throw Error(Me(162));_=t.stateNode,v=t.memoizedProps;try{_.nodeValue=v}catch(ye){Cn(t,t.return,ye)}}break;case 3:if(Fi(i,t),oa(t),f&4&&s!==null&&s.memoizedState.isDehydrated)try{Ec(i.containerInfo)}catch(ye){Cn(t,t.return,ye)}break;case 4:Fi(i,t),oa(t);break;case 13:Fi(i,t),oa(t),_=t.child,_.flags&8192&&(v=_.memoizedState!==null,_.stateNode.isHidden=v,!v||_.alternate!==null&&_.alternate.memoizedState!==null||(Sy=Dn())),f&4&&p0(t);break;case 22:if(ne=s!==null&&s.memoizedState!==null,t.mode&1?(xr=(q=xr)||ne,Fi(i,t),xr=q):Fi(i,t),oa(t),f&8192){if(q=t.memoizedState!==null,(t.stateNode.isHidden=q)&&!ne&&(t.mode&1)!==0)for(it=t,ne=t.child;ne!==null;){for(Q=it=ne;it!==null;){switch(V=it,pe=V.child,V.tag){case 0:case 11:case 14:case 15:mc(4,V,V.return);break;case 1:Al(V,V.return);var be=V.stateNode;if(typeof be.componentWillUnmount=="function"){f=V,s=V.return;try{i=f,be.props=i.memoizedProps,be.state=i.memoizedState,be.componentWillUnmount()}catch(ye){Cn(f,s,ye)}}break;case 5:Al(V,V.return);break;case 22:if(V.memoizedState!==null){m0(Q);continue}}pe!==null?(pe.return=V,it=pe):m0(Q)}ne=ne.sibling}e:for(ne=null,Q=t;;){if(Q.tag===5){if(ne===null){ne=Q;try{_=Q.stateNode,q?(v=_.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(u=Q.stateNode,L=Q.memoizedProps.style,T=L!=null&&L.hasOwnProperty("display")?L.display:null,u.style.display=wx("display",T))}catch(ye){Cn(t,t.return,ye)}}}else if(Q.tag===6){if(ne===null)try{Q.stateNode.nodeValue=q?"":Q.memoizedProps}catch(ye){Cn(t,t.return,ye)}}else if((Q.tag!==22&&Q.tag!==23||Q.memoizedState===null||Q===t)&&Q.child!==null){Q.child.return=Q,Q=Q.child;continue}if(Q===t)break e;for(;Q.sibling===null;){if(Q.return===null||Q.return===t)break e;ne===Q&&(ne=null),Q=Q.return}ne===Q&&(ne=null),Q.sibling.return=Q.return,Q=Q.sibling}}break;case 19:Fi(i,t),oa(t),f&4&&p0(t);break;case 21:break;default:Fi(i,t),oa(t)}}function oa(t){var i=t.flags;if(i&2){try{e:{for(var s=t.return;s!==null;){if(H1(s)){var f=s;break e}s=s.return}throw Error(Me(160))}switch(f.tag){case 5:var _=f.stateNode;f.flags&32&&(wc(_,""),f.flags&=-33);var v=d0(t);_g(t,v,_);break;case 3:case 4:var T=f.stateNode.containerInfo,u=d0(t);yg(t,u,T);break;default:throw Error(Me(161))}}catch(L){Cn(t,t.return,L)}t.flags&=-3}i&4096&&(t.flags&=-4097)}function BT(t,i,s){it=t,K1(t)}function K1(t,i,s){for(var f=(t.mode&1)!==0;it!==null;){var _=it,v=_.child;if(_.tag===22&&f){var T=_.memoizedState!==null||yd;if(!T){var u=_.alternate,L=u!==null&&u.memoizedState!==null||xr;u=yd;var q=xr;if(yd=T,(xr=L)&&!q)for(it=_;it!==null;)T=it,L=T.child,T.tag===22&&T.memoizedState!==null?g0(_):L!==null?(L.return=T,it=L):g0(_);for(;v!==null;)it=v,K1(v),v=v.sibling;it=_,yd=u,xr=q}f0(t)}else(_.subtreeFlags&8772)!==0&&v!==null?(v.return=_,it=v):f0(t)}}function f0(t){for(;it!==null;){var i=it;if((i.flags&8772)!==0){var s=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:xr||Pp(5,i);break;case 1:var f=i.stateNode;if(i.flags&4&&!xr)if(s===null)f.componentDidMount();else{var _=i.elementType===i.type?s.memoizedProps:Oi(i.type,s.memoizedProps);f.componentDidUpdate(_,s.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var v=i.updateQueue;v!==null&&Kv(i,v,f);break;case 3:var T=i.updateQueue;if(T!==null){if(s=null,i.child!==null)switch(i.child.tag){case 5:s=i.child.stateNode;break;case 1:s=i.child.stateNode}Kv(i,T,s)}break;case 5:var u=i.stateNode;if(s===null&&i.flags&4){s=u;var L=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":L.autoFocus&&s.focus();break;case"img":L.src&&(s.src=L.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var q=i.alternate;if(q!==null){var ne=q.memoizedState;if(ne!==null){var Q=ne.dehydrated;Q!==null&&Ec(Q)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Me(163))}xr||i.flags&512&&gg(i)}catch(V){Cn(i,i.return,V)}}if(i===t){it=null;break}if(s=i.sibling,s!==null){s.return=i.return,it=s;break}it=i.return}}function m0(t){for(;it!==null;){var i=it;if(i===t){it=null;break}var s=i.sibling;if(s!==null){s.return=i.return,it=s;break}it=i.return}}function g0(t){for(;it!==null;){var i=it;try{switch(i.tag){case 0:case 11:case 15:var s=i.return;try{Pp(4,i)}catch(L){Cn(i,s,L)}break;case 1:var f=i.stateNode;if(typeof f.componentDidMount=="function"){var _=i.return;try{f.componentDidMount()}catch(L){Cn(i,_,L)}}var v=i.return;try{gg(i)}catch(L){Cn(i,v,L)}break;case 5:var T=i.return;try{gg(i)}catch(L){Cn(i,T,L)}}}catch(L){Cn(i,i.return,L)}if(i===t){it=null;break}var u=i.sibling;if(u!==null){u.return=i.return,it=u;break}it=i.return}}var FT=Math.ceil,dp=$a.ReactCurrentDispatcher,wy=$a.ReactCurrentOwner,bi=$a.ReactCurrentBatchConfig,Vt=0,nr=null,$n=null,lr=0,ri=0,Pl=Uo(0),Wn=0,Bc=null,Bs=0,zp=0,by=0,gc=null,Gr=null,Sy=0,Wl=1/0,Pa=null,pp=!1,vg=null,zo=null,_d=!1,So=null,fp=0,yc=0,xg=null,Ud=-1,Vd=0;function Br(){return(Vt&6)!==0?Dn():Ud!==-1?Ud:Ud=Dn()}function Mo(t){return(t.mode&1)===0?1:(Vt&2)!==0&&lr!==0?lr&-lr:xT.transition!==null?(Vd===0&&(Vd=Lx()),Vd):(t=Yt,t!==0||(t=window.event,t=t===void 0?16:Vx(t.type)),t)}function ji(t,i,s,f){if(50<yc)throw yc=0,xg=null,Error(Me(185));jc(t,s,f),((Vt&2)===0||t!==nr)&&(t===nr&&((Vt&2)===0&&(zp|=s),Wn===4&&wo(t,lr)),Hr(t,f),s===1&&Vt===0&&(i.mode&1)===0&&(Wl=Dn()+500,Ip&&Vo()))}function Hr(t,i){var s=t.callbackNode;xS(t,i);var f=Kd(t,t===nr?lr:0);if(f===0)s!==null&&Ev(s),t.callbackNode=null,t.callbackPriority=0;else if(i=f&-f,t.callbackPriority!==i){if(s!=null&&Ev(s),i===1)t.tag===0?vT(y0.bind(null,t)):o1(y0.bind(null,t)),mT(function(){(Vt&6)===0&&Vo()}),s=null;else{switch(Rx(f)){case 1:s=Xg;break;case 4:s=Mx;break;case 16:s=Yd;break;case 536870912:s=Dx;break;default:s=Yd}s=aw(s,J1.bind(null,t))}t.callbackPriority=i,t.callbackNode=s}}function J1(t,i){if(Ud=-1,Vd=0,(Vt&6)!==0)throw Error(Me(327));var s=t.callbackNode;if(Nl()&&t.callbackNode!==s)return null;var f=Kd(t,t===nr?lr:0);if(f===0)return null;if((f&30)!==0||(f&t.expiredLanes)!==0||i)i=mp(t,f);else{i=f;var _=Vt;Vt|=2;var v=ew();(nr!==t||lr!==i)&&(Pa=null,Wl=Dn()+500,As(t,i));do try{UT();break}catch(u){Q1(t,u)}while(1);ly(),dp.current=v,Vt=_,$n!==null?i=0:(nr=null,lr=0,i=Wn)}if(i!==0){if(i===2&&(_=Wm(t),_!==0&&(f=_,i=wg(t,_))),i===1)throw s=Bc,As(t,0),wo(t,f),Hr(t,Dn()),s;if(i===6)wo(t,f);else{if(_=t.current.alternate,(f&30)===0&&!OT(_)&&(i=mp(t,f),i===2&&(v=Wm(t),v!==0&&(f=v,i=wg(t,v))),i===1))throw s=Bc,As(t,0),wo(t,f),Hr(t,Dn()),s;switch(t.finishedWork=_,t.finishedLanes=f,i){case 0:case 1:throw Error(Me(345));case 2:bs(t,Gr,Pa);break;case 3:if(wo(t,f),(f&130023424)===f&&(i=Sy+500-Dn(),10<i)){if(Kd(t,0)!==0)break;if(_=t.suspendedLanes,(_&f)!==f){Br(),t.pingedLanes|=t.suspendedLanes&_;break}t.timeoutHandle=tg(bs.bind(null,t,Gr,Pa),i);break}bs(t,Gr,Pa);break;case 4:if(wo(t,f),(f&4194240)===f)break;for(i=t.eventTimes,_=-1;0<f;){var T=31-$i(f);v=1<<T,T=i[T],T>_&&(_=T),f&=~v}if(f=_,f=Dn()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*FT(f/1960))-f,10<f){t.timeoutHandle=tg(bs.bind(null,t,Gr,Pa),f);break}bs(t,Gr,Pa);break;case 5:bs(t,Gr,Pa);break;default:throw Error(Me(329))}}}return Hr(t,Dn()),t.callbackNode===s?J1.bind(null,t):null}function wg(t,i){var s=gc;return t.current.memoizedState.isDehydrated&&(As(t,i).flags|=256),t=mp(t,i),t!==2&&(i=Gr,Gr=s,i!==null&&bg(i)),t}function bg(t){Gr===null?Gr=t:Gr.push.apply(Gr,t)}function OT(t){for(var i=t;;){if(i.flags&16384){var s=i.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var f=0;f<s.length;f++){var _=s[f],v=_.getSnapshot;_=_.value;try{if(!Gi(v(),_))return!1}catch{return!1}}}if(s=i.child,i.subtreeFlags&16384&&s!==null)s.return=i,i=s;else{if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function wo(t,i){for(i&=~by,i&=~zp,t.suspendedLanes|=i,t.pingedLanes&=~i,t=t.expirationTimes;0<i;){var s=31-$i(i),f=1<<s;t[s]=-1,i&=~f}}function y0(t){if((Vt&6)!==0)throw Error(Me(327));Nl();var i=Kd(t,0);if((i&1)===0)return Hr(t,Dn()),null;var s=mp(t,i);if(t.tag!==0&&s===2){var f=Wm(t);f!==0&&(i=f,s=wg(t,f))}if(s===1)throw s=Bc,As(t,0),wo(t,i),Hr(t,Dn()),s;if(s===6)throw Error(Me(345));return t.finishedWork=t.current.alternate,t.finishedLanes=i,bs(t,Gr,Pa),Hr(t,Dn()),null}function Ty(t,i){var s=Vt;Vt|=1;try{return t(i)}finally{Vt=s,Vt===0&&(Wl=Dn()+500,Ip&&Vo())}}function Fs(t){So!==null&&So.tag===0&&(Vt&6)===0&&Nl();var i=Vt;Vt|=1;var s=bi.transition,f=Yt;try{if(bi.transition=null,Yt=1,t)return t()}finally{Yt=f,bi.transition=s,Vt=i,(Vt&6)===0&&Vo()}}function Ey(){ri=Pl.current,fn(Pl)}function As(t,i){t.finishedWork=null,t.finishedLanes=0;var s=t.timeoutHandle;if(s!==-1&&(t.timeoutHandle=-1,fT(s)),$n!==null)for(s=$n.return;s!==null;){var f=s;switch(ay(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&np();break;case 3:ql(),fn(Zr),fn(wr),fy();break;case 5:py(f);break;case 4:ql();break;case 13:fn(wn);break;case 19:fn(wn);break;case 10:uy(f.type._context);break;case 22:case 23:Ey()}s=s.return}if(nr=t,$n=t=Do(t.current,null),lr=ri=i,Wn=0,Bc=null,by=zp=Bs=0,Gr=gc=null,Ts!==null){for(i=0;i<Ts.length;i++)if(s=Ts[i],f=s.interleaved,f!==null){s.interleaved=null;var _=f.next,v=s.pending;if(v!==null){var T=v.next;v.next=_,f.next=T}s.pending=f}Ts=null}return t}function Q1(t,i){do{var s=$n;try{if(ly(),Fd.current=hp,cp){for(var f=bn.memoizedState;f!==null;){var _=f.queue;_!==null&&(_.pending=null),f=f.next}cp=!1}if(Rs=0,tr=Zn=bn=null,fc=!1,Dc=0,wy.current=null,s===null||s.return===null){Wn=1,Bc=i,$n=null;break}e:{var v=t,T=s.return,u=s,L=i;if(i=lr,u.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){var q=L,ne=u,Q=ne.tag;if((ne.mode&1)===0&&(Q===0||Q===11||Q===15)){var V=ne.alternate;V?(ne.updateQueue=V.updateQueue,ne.memoizedState=V.memoizedState,ne.lanes=V.lanes):(ne.updateQueue=null,ne.memoizedState=null)}var pe=i0(T);if(pe!==null){pe.flags&=-257,a0(pe,T,u,v,i),pe.mode&1&&r0(v,q,i),i=pe,L=q;var be=i.updateQueue;if(be===null){var ye=new Set;ye.add(L),i.updateQueue=ye}else be.add(L);break e}else{if((i&1)===0){r0(v,q,i),ky();break e}L=Error(Me(426))}}else if(_n&&u.mode&1){var ze=i0(T);if(ze!==null){(ze.flags&65536)===0&&(ze.flags|=256),a0(ze,T,u,v,i),oy(Zl(L,u));break e}}v=L=Zl(L,u),Wn!==4&&(Wn=2),gc===null?gc=[v]:gc.push(v),v=T;do{switch(v.tag){case 3:v.flags|=65536,i&=-i,v.lanes|=i;var ee=B1(v,L,i);Yv(v,ee);break e;case 1:u=L;var X=v.type,ie=v.stateNode;if((v.flags&128)===0&&(typeof X.getDerivedStateFromError=="function"||ie!==null&&typeof ie.componentDidCatch=="function"&&(zo===null||!zo.has(ie)))){v.flags|=65536,i&=-i,v.lanes|=i;var xe=F1(v,u,i);Yv(v,xe);break e}}v=v.return}while(v!==null)}nw(s)}catch(Ee){i=Ee,$n===s&&s!==null&&($n=s=s.return);continue}break}while(1)}function ew(){var t=dp.current;return dp.current=hp,t===null?hp:t}function ky(){(Wn===0||Wn===3||Wn===2)&&(Wn=4),nr===null||(Bs&268435455)===0&&(zp&268435455)===0||wo(nr,lr)}function mp(t,i){var s=Vt;Vt|=2;var f=ew();(nr!==t||lr!==i)&&(Pa=null,As(t,i));do try{NT();break}catch(_){Q1(t,_)}while(1);if(ly(),Vt=s,dp.current=f,$n!==null)throw Error(Me(261));return nr=null,lr=0,Wn}function NT(){for(;$n!==null;)tw($n)}function UT(){for(;$n!==null&&!hS();)tw($n)}function tw(t){var i=iw(t.alternate,t,ri);t.memoizedProps=t.pendingProps,i===null?nw(t):$n=i,wy.current=null}function nw(t){var i=t;do{var s=i.alternate;if(t=i.return,(i.flags&32768)===0){if(s=MT(s,i,ri),s!==null){$n=s;return}}else{if(s=DT(s,i),s!==null){s.flags&=32767,$n=s;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Wn=6,$n=null;return}}if(i=i.sibling,i!==null){$n=i;return}$n=i=t}while(i!==null);Wn===0&&(Wn=5)}function bs(t,i,s){var f=Yt,_=bi.transition;try{bi.transition=null,Yt=1,VT(t,i,s,f)}finally{bi.transition=_,Yt=f}return null}function VT(t,i,s,f){do Nl();while(So!==null);if((Vt&6)!==0)throw Error(Me(327));s=t.finishedWork;var _=t.finishedLanes;if(s===null)return null;if(t.finishedWork=null,t.finishedLanes=0,s===t.current)throw Error(Me(177));t.callbackNode=null,t.callbackPriority=0;var v=s.lanes|s.childLanes;if(wS(t,v),t===nr&&($n=nr=null,lr=0),(s.subtreeFlags&2064)===0&&(s.flags&2064)===0||_d||(_d=!0,aw(Yd,function(){return Nl(),null})),v=(s.flags&15990)!==0,(s.subtreeFlags&15990)!==0||v){v=bi.transition,bi.transition=null;var T=Yt;Yt=1;var u=Vt;Vt|=4,wy.current=null,RT(t,s),Y1(s,t),sT(Qm),Jd=!!Jm,Qm=Jm=null,t.current=s,BT(s),dS(),Vt=u,Yt=T,bi.transition=v}else t.current=s;if(_d&&(_d=!1,So=t,fp=_),v=t.pendingLanes,v===0&&(zo=null),mS(s.stateNode),Hr(t,Dn()),i!==null)for(f=t.onRecoverableError,s=0;s<i.length;s++)_=i[s],f(_.value,{componentStack:_.stack,digest:_.digest});if(pp)throw pp=!1,t=vg,vg=null,t;return(fp&1)!==0&&t.tag!==0&&Nl(),v=t.pendingLanes,(v&1)!==0?t===xg?yc++:(yc=0,xg=t):yc=0,Vo(),null}function Nl(){if(So!==null){var t=Rx(fp),i=bi.transition,s=Yt;try{if(bi.transition=null,Yt=16>t?16:t,So===null)var f=!1;else{if(t=So,So=null,fp=0,(Vt&6)!==0)throw Error(Me(331));var _=Vt;for(Vt|=4,it=t.current;it!==null;){var v=it,T=v.child;if((it.flags&16)!==0){var u=v.deletions;if(u!==null){for(var L=0;L<u.length;L++){var q=u[L];for(it=q;it!==null;){var ne=it;switch(ne.tag){case 0:case 11:case 15:mc(8,ne,v)}var Q=ne.child;if(Q!==null)Q.return=ne,it=Q;else for(;it!==null;){ne=it;var V=ne.sibling,pe=ne.return;if(W1(ne),ne===q){it=null;break}if(V!==null){V.return=pe,it=V;break}it=pe}}}var be=v.alternate;if(be!==null){var ye=be.child;if(ye!==null){be.child=null;do{var ze=ye.sibling;ye.sibling=null,ye=ze}while(ye!==null)}}it=v}}if((v.subtreeFlags&2064)!==0&&T!==null)T.return=v,it=T;else e:for(;it!==null;){if(v=it,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:mc(9,v,v.return)}var ee=v.sibling;if(ee!==null){ee.return=v.return,it=ee;break e}it=v.return}}var X=t.current;for(it=X;it!==null;){T=it;var ie=T.child;if((T.subtreeFlags&2064)!==0&&ie!==null)ie.return=T,it=ie;else e:for(T=X;it!==null;){if(u=it,(u.flags&2048)!==0)try{switch(u.tag){case 0:case 11:case 15:Pp(9,u)}}catch(Ee){Cn(u,u.return,Ee)}if(u===T){it=null;break e}var xe=u.sibling;if(xe!==null){xe.return=u.return,it=xe;break e}it=u.return}}if(Vt=_,Vo(),ca&&typeof ca.onPostCommitFiberRoot=="function")try{ca.onPostCommitFiberRoot(bp,t)}catch{}f=!0}return f}finally{Yt=s,bi.transition=i}}return!1}function _0(t,i,s){i=Zl(s,i),i=B1(t,i,1),t=Po(t,i,1),i=Br(),t!==null&&(jc(t,1,i),Hr(t,i))}function Cn(t,i,s){if(t.tag===3)_0(t,t,s);else for(;i!==null;){if(i.tag===3){_0(i,t,s);break}else if(i.tag===1){var f=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(zo===null||!zo.has(f))){t=Zl(s,t),t=F1(i,t,1),i=Po(i,t,1),t=Br(),i!==null&&(jc(i,1,t),Hr(i,t));break}}i=i.return}}function $T(t,i,s){var f=t.pingCache;f!==null&&f.delete(i),i=Br(),t.pingedLanes|=t.suspendedLanes&s,nr===t&&(lr&s)===s&&(Wn===4||Wn===3&&(lr&130023424)===lr&&500>Dn()-Sy?As(t,0):by|=s),Hr(t,i)}function rw(t,i){i===0&&((t.mode&1)===0?i=1:(i=ld,ld<<=1,(ld&130023424)===0&&(ld=4194304)));var s=Br();t=Fa(t,i),t!==null&&(jc(t,i,s),Hr(t,s))}function jT(t){var i=t.memoizedState,s=0;i!==null&&(s=i.retryLane),rw(t,s)}function GT(t,i){var s=0;switch(t.tag){case 13:var f=t.stateNode,_=t.memoizedState;_!==null&&(s=_.retryLane);break;case 19:f=t.stateNode;break;default:throw Error(Me(314))}f!==null&&f.delete(i),rw(t,s)}var iw;iw=function(t,i,s){if(t!==null)if(t.memoizedProps!==i.pendingProps||Zr.current)qr=!0;else{if((t.lanes&s)===0&&(i.flags&128)===0)return qr=!1,zT(t,i,s);qr=(t.flags&131072)!==0}else qr=!1,_n&&(i.flags&1048576)!==0&&s1(i,ap,i.index);switch(i.lanes=0,i.tag){case 2:var f=i.type;Nd(t,i),t=i.pendingProps;var _=$l(i,wr.current);Ol(i,s),_=gy(null,i,f,t,_,s);var v=yy();return i.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Wr(f)?(v=!0,rp(i)):v=!1,i.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,hy(i),_.updater=Cp,i.stateNode=_,_._reactInternals=i,lg(i,f,t,s),i=hg(null,i,f,!0,v,s)):(i.tag=0,_n&&v&&iy(i),Rr(null,i,_,s),i=i.child),i;case 16:f=i.elementType;e:{switch(Nd(t,i),t=i.pendingProps,_=f._init,f=_(f._payload),i.type=f,_=i.tag=ZT(f),t=Oi(f,t),_){case 0:i=cg(null,i,f,t,s);break e;case 1:i=l0(null,i,f,t,s);break e;case 11:i=o0(null,i,f,t,s);break e;case 14:i=s0(null,i,f,Oi(f.type,t),s);break e}throw Error(Me(306,f,""))}return i;case 0:return f=i.type,_=i.pendingProps,_=i.elementType===f?_:Oi(f,_),cg(t,i,f,_,s);case 1:return f=i.type,_=i.pendingProps,_=i.elementType===f?_:Oi(f,_),l0(t,i,f,_,s);case 3:e:{if(V1(i),t===null)throw Error(Me(387));f=i.pendingProps,v=i.memoizedState,_=v.element,h1(t,i),lp(i,f,null,s);var T=i.memoizedState;if(f=T.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:T.cache,pendingSuspenseBoundaries:T.pendingSuspenseBoundaries,transitions:T.transitions},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){_=Zl(Error(Me(423)),i),i=u0(t,i,f,s,_);break e}else if(f!==_){_=Zl(Error(Me(424)),i),i=u0(t,i,f,s,_);break e}else for(ii=Ao(i.stateNode.containerInfo.firstChild),oi=i,_n=!0,Ui=null,s=m1(i,null,f,s),i.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(jl(),f===_){i=Oa(t,i,s);break e}Rr(t,i,f,s)}i=i.child}return i;case 5:return g1(i),t===null&&ag(i),f=i.type,_=i.pendingProps,v=t!==null?t.memoizedProps:null,T=_.children,eg(f,_)?T=null:v!==null&&eg(f,v)&&(i.flags|=32),U1(t,i),Rr(t,i,T,s),i.child;case 6:return t===null&&ag(i),null;case 13:return $1(t,i,s);case 4:return dy(i,i.stateNode.containerInfo),f=i.pendingProps,t===null?i.child=Gl(i,null,f,s):Rr(t,i,f,s),i.child;case 11:return f=i.type,_=i.pendingProps,_=i.elementType===f?_:Oi(f,_),o0(t,i,f,_,s);case 7:return Rr(t,i,i.pendingProps,s),i.child;case 8:return Rr(t,i,i.pendingProps.children,s),i.child;case 12:return Rr(t,i,i.pendingProps.children,s),i.child;case 10:e:{if(f=i.type._context,_=i.pendingProps,v=i.memoizedProps,T=_.value,un(op,f._currentValue),f._currentValue=T,v!==null)if(Gi(v.value,T)){if(v.children===_.children&&!Zr.current){i=Oa(t,i,s);break e}}else for(v=i.child,v!==null&&(v.return=i);v!==null;){var u=v.dependencies;if(u!==null){T=v.child;for(var L=u.firstContext;L!==null;){if(L.context===f){if(v.tag===1){L=La(-1,s&-s),L.tag=2;var q=v.updateQueue;if(q!==null){q=q.shared;var ne=q.pending;ne===null?L.next=L:(L.next=ne.next,ne.next=L),q.pending=L}}v.lanes|=s,L=v.alternate,L!==null&&(L.lanes|=s),og(v.return,s,i),u.lanes|=s;break}L=L.next}}else if(v.tag===10)T=v.type===i.type?null:v.child;else if(v.tag===18){if(T=v.return,T===null)throw Error(Me(341));T.lanes|=s,u=T.alternate,u!==null&&(u.lanes|=s),og(T,s,i),T=v.sibling}else T=v.child;if(T!==null)T.return=v;else for(T=v;T!==null;){if(T===i){T=null;break}if(v=T.sibling,v!==null){v.return=T.return,T=v;break}T=T.return}v=T}Rr(t,i,_.children,s),i=i.child}return i;case 9:return _=i.type,f=i.pendingProps.children,Ol(i,s),_=Si(_),f=f(_),i.flags|=1,Rr(t,i,f,s),i.child;case 14:return f=i.type,_=Oi(f,i.pendingProps),_=Oi(f.type,_),s0(t,i,f,_,s);case 15:return O1(t,i,i.type,i.pendingProps,s);case 17:return f=i.type,_=i.pendingProps,_=i.elementType===f?_:Oi(f,_),Nd(t,i),i.tag=1,Wr(f)?(t=!0,rp(i)):t=!1,Ol(i,s),p1(i,f,_),lg(i,f,_,s),hg(null,i,f,!0,t,s);case 19:return j1(t,i,s);case 22:return N1(t,i,s)}throw Error(Me(156,i.tag))};function aw(t,i){return zx(t,i)}function qT(t,i,s,f){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wi(t,i,s,f){return new qT(t,i,s,f)}function Iy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ZT(t){if(typeof t=="function")return Iy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Zg)return 11;if(t===Wg)return 14}return 2}function Do(t,i){var s=t.alternate;return s===null?(s=wi(t.tag,i,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=i,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&14680064,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,i=t.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s}function $d(t,i,s,f,_,v){var T=2;if(f=t,typeof t=="function")Iy(t)&&(T=1);else if(typeof t=="string")T=5;else e:switch(t){case xl:return Ps(s.children,_,v,i);case qg:T=8,_|=8;break;case Mm:return t=wi(12,s,i,_|2),t.elementType=Mm,t.lanes=v,t;case Dm:return t=wi(13,s,i,_),t.elementType=Dm,t.lanes=v,t;case Lm:return t=wi(19,s,i,_),t.elementType=Lm,t.lanes=v,t;case fx:return Mp(s,_,v,i);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case dx:T=10;break e;case px:T=9;break e;case Zg:T=11;break e;case Wg:T=14;break e;case _o:T=16,f=null;break e}throw Error(Me(130,t==null?t:typeof t,""))}return i=wi(T,s,i,_),i.elementType=t,i.type=f,i.lanes=v,i}function Ps(t,i,s,f){return t=wi(7,t,f,i),t.lanes=s,t}function Mp(t,i,s,f){return t=wi(22,t,f,i),t.elementType=fx,t.lanes=s,t.stateNode={isHidden:!1},t}function xm(t,i,s){return t=wi(6,t,null,i),t.lanes=s,t}function wm(t,i,s){return i=wi(4,t.children!==null?t.children:[],t.key,i),i.lanes=s,i.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},i}function WT(t,i,s,f,_){this.tag=i,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tm(0),this.expirationTimes=tm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tm(0),this.identifierPrefix=f,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Cy(t,i,s,f,_,v,T,u,L){return t=new WT(t,i,s,u,L),i===1?(i=1,v===!0&&(i|=8)):i=0,v=wi(3,null,null,i),t.current=v,v.stateNode=t,v.memoizedState={element:f,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},hy(v),t}function HT(t,i,s){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:vl,key:f==null?null:""+f,children:t,containerInfo:i,implementation:s}}function ow(t){if(!t)return Ro;t=t._reactInternals;e:{if(Vs(t)!==t||t.tag!==1)throw Error(Me(170));var i=t;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Wr(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(Me(171))}if(t.tag===1){var s=t.type;if(Wr(s))return a1(t,s,i)}return i}function sw(t,i,s,f,_,v,T,u,L){return t=Cy(s,f,!0,t,_,v,T,u,L),t.context=ow(null),s=t.current,f=Br(),_=Mo(s),v=La(f,_),v.callback=i!=null?i:null,Po(s,v,_),t.current.lanes=_,jc(t,_,f),Hr(t,f),t}function Dp(t,i,s,f){var _=i.current,v=Br(),T=Mo(_);return s=ow(s),i.context===null?i.context=s:i.pendingContext=s,i=La(v,T),i.payload={element:t},f=f===void 0?null:f,f!==null&&(i.callback=f),t=Po(_,i,T),t!==null&&(ji(t,_,T,v),Bd(t,_,T)),T}function gp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function v0(t,i){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<i?s:i}}function Ay(t,i){v0(t,i),(t=t.alternate)&&v0(t,i)}function XT(){return null}var lw=typeof reportError=="function"?reportError:function(t){console.error(t)};function Py(t){this._internalRoot=t}Lp.prototype.render=Py.prototype.render=function(t){var i=this._internalRoot;if(i===null)throw Error(Me(409));Dp(t,i,null,null)};Lp.prototype.unmount=Py.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var i=t.containerInfo;Fs(function(){Dp(null,t,null,null)}),i[Ba]=null}};function Lp(t){this._internalRoot=t}Lp.prototype.unstable_scheduleHydration=function(t){if(t){var i=Ox();t={blockedOn:null,target:t,priority:i};for(var s=0;s<xo.length&&i!==0&&i<xo[s].priority;s++);xo.splice(s,0,t),s===0&&Ux(t)}};function zy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Rp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function x0(){}function YT(t,i,s,f,_){if(_){if(typeof f=="function"){var v=f;f=function(){var q=gp(T);v.call(q)}}var T=sw(i,f,t,0,null,!1,!1,"",x0);return t._reactRootContainer=T,t[Ba]=T.current,Cc(t.nodeType===8?t.parentNode:t),Fs(),T}for(;_=t.lastChild;)t.removeChild(_);if(typeof f=="function"){var u=f;f=function(){var q=gp(L);u.call(q)}}var L=Cy(t,0,!1,null,null,!1,!1,"",x0);return t._reactRootContainer=L,t[Ba]=L.current,Cc(t.nodeType===8?t.parentNode:t),Fs(function(){Dp(i,L,s,f)}),L}function Bp(t,i,s,f,_){var v=s._reactRootContainer;if(v){var T=v;if(typeof _=="function"){var u=_;_=function(){var L=gp(T);u.call(L)}}Dp(i,T,t,_)}else T=YT(s,i,t,_,f);return gp(T)}Bx=function(t){switch(t.tag){case 3:var i=t.stateNode;if(i.current.memoizedState.isDehydrated){var s=oc(i.pendingLanes);s!==0&&(Yg(i,s|1),Hr(i,Dn()),(Vt&6)===0&&(Wl=Dn()+500,Vo()))}break;case 13:Fs(function(){var f=Fa(t,1);if(f!==null){var _=Br();ji(f,t,1,_)}}),Ay(t,1)}};Kg=function(t){if(t.tag===13){var i=Fa(t,134217728);if(i!==null){var s=Br();ji(i,t,134217728,s)}Ay(t,134217728)}};Fx=function(t){if(t.tag===13){var i=Mo(t),s=Fa(t,i);if(s!==null){var f=Br();ji(s,t,i,f)}Ay(t,i)}};Ox=function(){return Yt};Nx=function(t,i){var s=Yt;try{return Yt=t,i()}finally{Yt=s}};Gm=function(t,i,s){switch(i){case"input":if(Fm(t,s),i=s.name,s.type==="radio"&&i!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<s.length;i++){var f=s[i];if(f!==t&&f.form===t.form){var _=kp(f);if(!_)throw Error(Me(90));gx(f),Fm(f,_)}}}break;case"textarea":_x(t,s);break;case"select":i=s.value,i!=null&&Ll(t,!!s.multiple,i,!1)}};Ex=Ty;kx=Fs;var KT={usingClientEntryPoint:!1,Events:[qc,Tl,kp,Sx,Tx,Ty]},rc={findFiberByHostInstance:Ss,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},JT={bundleType:rc.bundleType,version:rc.version,rendererPackageName:rc.rendererPackageName,rendererConfig:rc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$a.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ax(t),t===null?null:t.stateNode},findFiberByHostInstance:rc.findFiberByHostInstance||XT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vd.isDisabled&&vd.supportsFiber)try{bp=vd.inject(JT),ca=vd}catch{}}li.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KT;li.createPortal=function(t,i){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zy(i))throw Error(Me(200));return HT(t,i,null,s)};li.createRoot=function(t,i){if(!zy(t))throw Error(Me(299));var s=!1,f="",_=lw;return i!=null&&(i.unstable_strictMode===!0&&(s=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onRecoverableError!==void 0&&(_=i.onRecoverableError)),i=Cy(t,1,!1,null,null,s,!1,f,_),t[Ba]=i.current,Cc(t.nodeType===8?t.parentNode:t),new Py(i)};li.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var i=t._reactInternals;if(i===void 0)throw typeof t.render=="function"?Error(Me(188)):(t=Object.keys(t).join(","),Error(Me(268,t)));return t=Ax(i),t=t===null?null:t.stateNode,t};li.flushSync=function(t){return Fs(t)};li.hydrate=function(t,i,s){if(!Rp(i))throw Error(Me(200));return Bp(null,t,i,!0,s)};li.hydrateRoot=function(t,i,s){if(!zy(t))throw Error(Me(405));var f=s!=null&&s.hydratedSources||null,_=!1,v="",T=lw;if(s!=null&&(s.unstable_strictMode===!0&&(_=!0),s.identifierPrefix!==void 0&&(v=s.identifierPrefix),s.onRecoverableError!==void 0&&(T=s.onRecoverableError)),i=sw(i,null,t,1,s!=null?s:null,_,!1,v,T),t[Ba]=i.current,Cc(t),f)for(t=0;t<f.length;t++)s=f[t],_=s._getVersion,_=_(s._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[s,_]:i.mutableSourceEagerHydrationData.push(s,_);return new Lp(i)};li.render=function(t,i,s){if(!Rp(i))throw Error(Me(200));return Bp(null,t,i,!1,s)};li.unmountComponentAtNode=function(t){if(!Rp(t))throw Error(Me(40));return t._reactRootContainer?(Fs(function(){Bp(null,null,t,!1,function(){t._reactRootContainer=null,t[Ba]=null})}),!0):!1};li.unstable_batchedUpdates=Ty;li.unstable_renderSubtreeIntoContainer=function(t,i,s,f){if(!Rp(s))throw Error(Me(200));if(t==null||t._reactInternals===void 0)throw Error(Me(38));return Bp(t,i,s,!1,f)};li.version="18.2.0-next-9e3b772b8-20220608";(function(t){function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(s){console.error(s)}}i(),t.exports=li})(sx);var w0=sx.exports;Pm.createRoot=w0.createRoot,Pm.hydrateRoot=w0.hydrateRoot;function b0(t,i){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);i&&(f=f.filter(function(_){return Object.getOwnPropertyDescriptor(t,_).enumerable})),s.push.apply(s,f)}return s}function rt(t){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?b0(Object(s),!0).forEach(function(f){Hn(t,f,s[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):b0(Object(s)).forEach(function(f){Object.defineProperty(t,f,Object.getOwnPropertyDescriptor(s,f))})}return t}function yp(t){return yp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},yp(t)}function QT(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function S0(t,i){for(var s=0;s<i.length;s++){var f=i[s];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(t,f.key,f)}}function eE(t,i,s){return i&&S0(t.prototype,i),s&&S0(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function Hn(t,i,s){return i in t?Object.defineProperty(t,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[i]=s,t}function My(t,i){return nE(t)||iE(t,i)||uw(t,i)||oE()}function Wc(t){return tE(t)||rE(t)||uw(t)||aE()}function tE(t){if(Array.isArray(t))return Sg(t)}function nE(t){if(Array.isArray(t))return t}function rE(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function iE(t,i){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var f=[],_=!0,v=!1,T,u;try{for(s=s.call(t);!(_=(T=s.next()).done)&&(f.push(T.value),!(i&&f.length===i));_=!0);}catch(L){v=!0,u=L}finally{try{!_&&s.return!=null&&s.return()}finally{if(v)throw u}}return f}}function uw(t,i){if(!!t){if(typeof t=="string")return Sg(t,i);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Sg(t,i)}}function Sg(t,i){(i==null||i>t.length)&&(i=t.length);for(var s=0,f=new Array(i);s<i;s++)f[s]=t[s];return f}function aE(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oE(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var T0=function(){},Dy={},cw={},hw=null,dw={mark:T0,measure:T0};try{typeof window<"u"&&(Dy=window),typeof document<"u"&&(cw=document),typeof MutationObserver<"u"&&(hw=MutationObserver),typeof performance<"u"&&(dw=performance)}catch{}var sE=Dy.navigator||{},E0=sE.userAgent,k0=E0===void 0?"":E0,Bo=Dy,mn=cw,I0=hw,xd=dw;Bo.document;var ja=!!mn.documentElement&&!!mn.head&&typeof mn.addEventListener=="function"&&typeof mn.createElement=="function",pw=~k0.indexOf("MSIE")||~k0.indexOf("Trident/"),wd,bd,Sd,Td,Ed,Na="___FONT_AWESOME___",Tg=16,fw="fa",mw="svg-inline--fa",Os="data-fa-i2svg",Eg="data-fa-pseudo-element",lE="data-fa-pseudo-element-pending",Ly="data-prefix",Ry="data-icon",C0="fontawesome-i2svg",uE="async",cE=["HTML","HEAD","STYLE","SCRIPT"],gw=function(){try{return!0}catch{return!1}}(),pn="classic",An="sharp",By=[pn,An];function Hc(t){return new Proxy(t,{get:function(s,f){return f in s?s[f]:s[pn]}})}var Fc=Hc((wd={},Hn(wd,pn,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),Hn(wd,An,{fa:"solid",fass:"solid","fa-solid":"solid"}),wd)),Oc=Hc((bd={},Hn(bd,pn,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),Hn(bd,An,{solid:"fass"}),bd)),Nc=Hc((Sd={},Hn(Sd,pn,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),Hn(Sd,An,{fass:"fa-solid"}),Sd)),hE=Hc((Td={},Hn(Td,pn,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),Hn(Td,An,{"fa-solid":"fass"}),Td)),dE=/fa(s|r|l|t|d|b|k|ss)?[\-\ ]/,yw="fa-layers-text",pE=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,fE=Hc((Ed={},Hn(Ed,pn,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),Hn(Ed,An,{900:"fass"}),Ed)),_w=[1,2,3,4,5,6,7,8,9,10],mE=_w.concat([11,12,13,14,15,16,17,18,19,20]),gE=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],ks={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},Uc=new Set;Object.keys(Oc[pn]).map(Uc.add.bind(Uc));Object.keys(Oc[An]).map(Uc.add.bind(Uc));var yE=[].concat(By,Wc(Uc),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",ks.GROUP,ks.SWAP_OPACITY,ks.PRIMARY,ks.SECONDARY]).concat(_w.map(function(t){return"".concat(t,"x")})).concat(mE.map(function(t){return"w-".concat(t)})),_c=Bo.FontAwesomeConfig||{};function _E(t){var i=mn.querySelector("script["+t+"]");if(i)return i.getAttribute(t)}function vE(t){return t===""?!0:t==="false"?!1:t==="true"?!0:t}if(mn&&typeof mn.querySelector=="function"){var xE=[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]];xE.forEach(function(t){var i=My(t,2),s=i[0],f=i[1],_=vE(_E(s));_!=null&&(_c[f]=_)})}var vw={styleDefault:"solid",familyDefault:"classic",cssPrefix:fw,replacementClass:mw,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};_c.familyPrefix&&(_c.cssPrefix=_c.familyPrefix);var Hl=rt(rt({},vw),_c);Hl.autoReplaceSvg||(Hl.observeMutations=!1);var lt={};Object.keys(vw).forEach(function(t){Object.defineProperty(lt,t,{enumerable:!0,set:function(s){Hl[t]=s,vc.forEach(function(f){return f(lt)})},get:function(){return Hl[t]}})});Object.defineProperty(lt,"familyPrefix",{enumerable:!0,set:function(i){Hl.cssPrefix=i,vc.forEach(function(s){return s(lt)})},get:function(){return Hl.cssPrefix}});Bo.FontAwesomeConfig=lt;var vc=[];function wE(t){return vc.push(t),function(){vc.splice(vc.indexOf(t),1)}}var yo=Tg,ua={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function bE(t){if(!(!t||!ja)){var i=mn.createElement("style");i.setAttribute("type","text/css"),i.innerHTML=t;for(var s=mn.head.childNodes,f=null,_=s.length-1;_>-1;_--){var v=s[_],T=(v.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(T)>-1&&(f=v)}return mn.head.insertBefore(i,f),t}}var SE="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function Vc(){for(var t=12,i="";t-- >0;)i+=SE[Math.random()*62|0];return i}function Jl(t){for(var i=[],s=(t||[]).length>>>0;s--;)i[s]=t[s];return i}function Fy(t){return t.classList?Jl(t.classList):(t.getAttribute("class")||"").split(" ").filter(function(i){return i})}function xw(t){return"".concat(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function TE(t){return Object.keys(t||{}).reduce(function(i,s){return i+"".concat(s,'="').concat(xw(t[s]),'" ')},"").trim()}function Fp(t){return Object.keys(t||{}).reduce(function(i,s){return i+"".concat(s,": ").concat(t[s].trim(),";")},"")}function Oy(t){return t.size!==ua.size||t.x!==ua.x||t.y!==ua.y||t.rotate!==ua.rotate||t.flipX||t.flipY}function EE(t){var i=t.transform,s=t.containerWidth,f=t.iconWidth,_={transform:"translate(".concat(s/2," 256)")},v="translate(".concat(i.x*32,", ").concat(i.y*32,") "),T="scale(".concat(i.size/16*(i.flipX?-1:1),", ").concat(i.size/16*(i.flipY?-1:1),") "),u="rotate(".concat(i.rotate," 0 0)"),L={transform:"".concat(v," ").concat(T," ").concat(u)},q={transform:"translate(".concat(f/2*-1," -256)")};return{outer:_,inner:L,path:q}}function kE(t){var i=t.transform,s=t.width,f=s===void 0?Tg:s,_=t.height,v=_===void 0?Tg:_,T=t.startCentered,u=T===void 0?!1:T,L="";return u&&pw?L+="translate(".concat(i.x/yo-f/2,"em, ").concat(i.y/yo-v/2,"em) "):u?L+="translate(calc(-50% + ".concat(i.x/yo,"em), calc(-50% + ").concat(i.y/yo,"em)) "):L+="translate(".concat(i.x/yo,"em, ").concat(i.y/yo,"em) "),L+="scale(".concat(i.size/yo*(i.flipX?-1:1),", ").concat(i.size/yo*(i.flipY?-1:1),") "),L+="rotate(".concat(i.rotate,"deg) "),L}var IE=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-counter-scale, 0.25));
          transform: scale(var(--fa-counter-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom right;
          transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom left;
          transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top left;
          transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(var(--fa-li-width, 2em) * -1);
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  -webkit-animation-name: fa-beat;
          animation-name: fa-beat;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  -webkit-animation-name: fa-bounce;
          animation-name: fa-bounce;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  -webkit-animation-name: fa-fade;
          animation-name: fa-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  -webkit-animation-name: fa-beat-fade;
          animation-name: fa-beat-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  -webkit-animation-name: fa-flip;
          animation-name: fa-flip;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  -webkit-animation-name: fa-shake;
          animation-name: fa-shake;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 2s);
          animation-duration: var(--fa-animation-duration, 2s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));
          animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    -webkit-animation-delay: -1ms;
            animation-delay: -1ms;
    -webkit-animation-duration: 1ms;
            animation-duration: 1ms;
    -webkit-animation-iteration-count: 1;
            animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@-webkit-keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@-webkit-keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@-webkit-keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@-webkit-keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@-webkit-keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@-webkit-keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  -webkit-transform: rotate(90deg);
          transform: rotate(90deg);
}

.fa-rotate-180 {
  -webkit-transform: rotate(180deg);
          transform: rotate(180deg);
}

.fa-rotate-270 {
  -webkit-transform: rotate(270deg);
          transform: rotate(270deg);
}

.fa-flip-horizontal {
  -webkit-transform: scale(-1, 1);
          transform: scale(-1, 1);
}

.fa-flip-vertical {
  -webkit-transform: scale(1, -1);
          transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  -webkit-transform: scale(-1, -1);
          transform: scale(-1, -1);
}

.fa-rotate-by {
  -webkit-transform: rotate(var(--fa-rotate-angle, none));
          transform: rotate(var(--fa-rotate-angle, none));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}

.fad.fa-inverse,
.fa-duotone.fa-inverse {
  color: var(--fa-inverse, #fff);
}`;function ww(){var t=fw,i=mw,s=lt.cssPrefix,f=lt.replacementClass,_=IE;if(s!==t||f!==i){var v=new RegExp("\\.".concat(t,"\\-"),"g"),T=new RegExp("\\--".concat(t,"\\-"),"g"),u=new RegExp("\\.".concat(i),"g");_=_.replace(v,".".concat(s,"-")).replace(T,"--".concat(s,"-")).replace(u,".".concat(f))}return _}var A0=!1;function bm(){lt.autoAddCss&&!A0&&(bE(ww()),A0=!0)}var CE={mixout:function(){return{dom:{css:ww,insertCss:bm}}},hooks:function(){return{beforeDOMElementCreation:function(){bm()},beforeI2svg:function(){bm()}}}},Ua=Bo||{};Ua[Na]||(Ua[Na]={});Ua[Na].styles||(Ua[Na].styles={});Ua[Na].hooks||(Ua[Na].hooks={});Ua[Na].shims||(Ua[Na].shims=[]);var Vi=Ua[Na],bw=[],AE=function t(){mn.removeEventListener("DOMContentLoaded",t),_p=1,bw.map(function(i){return i()})},_p=!1;ja&&(_p=(mn.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(mn.readyState),_p||mn.addEventListener("DOMContentLoaded",AE));function PE(t){!ja||(_p?setTimeout(t,0):bw.push(t))}function Xc(t){var i=t.tag,s=t.attributes,f=s===void 0?{}:s,_=t.children,v=_===void 0?[]:_;return typeof t=="string"?xw(t):"<".concat(i," ").concat(TE(f),">").concat(v.map(Xc).join(""),"</").concat(i,">")}function P0(t,i,s){if(t&&t[i]&&t[i][s])return{prefix:i,iconName:s,icon:t[i][s]}}var zE=function(i,s){return function(f,_,v,T){return i.call(s,f,_,v,T)}},Sm=function(i,s,f,_){var v=Object.keys(i),T=v.length,u=_!==void 0?zE(s,_):s,L,q,ne;for(f===void 0?(L=1,ne=i[v[0]]):(L=0,ne=f);L<T;L++)q=v[L],ne=u(ne,i[q],q,i);return ne};function ME(t){for(var i=[],s=0,f=t.length;s<f;){var _=t.charCodeAt(s++);if(_>=55296&&_<=56319&&s<f){var v=t.charCodeAt(s++);(v&64512)==56320?i.push(((_&1023)<<10)+(v&1023)+65536):(i.push(_),s--)}else i.push(_)}return i}function kg(t){var i=ME(t);return i.length===1?i[0].toString(16):null}function DE(t,i){var s=t.length,f=t.charCodeAt(i),_;return f>=55296&&f<=56319&&s>i+1&&(_=t.charCodeAt(i+1),_>=56320&&_<=57343)?(f-55296)*1024+_-56320+65536:f}function z0(t){return Object.keys(t).reduce(function(i,s){var f=t[s],_=!!f.icon;return _?i[f.iconName]=f.icon:i[s]=f,i},{})}function Ig(t,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},f=s.skipHooks,_=f===void 0?!1:f,v=z0(i);typeof Vi.hooks.addPack=="function"&&!_?Vi.hooks.addPack(t,z0(i)):Vi.styles[t]=rt(rt({},Vi.styles[t]||{}),v),t==="fas"&&Ig("fa",i)}var kd,Id,Cd,zl=Vi.styles,LE=Vi.shims,RE=(kd={},Hn(kd,pn,Object.values(Nc[pn])),Hn(kd,An,Object.values(Nc[An])),kd),Ny=null,Sw={},Tw={},Ew={},kw={},Iw={},BE=(Id={},Hn(Id,pn,Object.keys(Fc[pn])),Hn(Id,An,Object.keys(Fc[An])),Id);function FE(t){return~yE.indexOf(t)}function OE(t,i){var s=i.split("-"),f=s[0],_=s.slice(1).join("-");return f===t&&_!==""&&!FE(_)?_:null}var Cw=function(){var i=function(v){return Sm(zl,function(T,u,L){return T[L]=Sm(u,v,{}),T},{})};Sw=i(function(_,v,T){if(v[3]&&(_[v[3]]=T),v[2]){var u=v[2].filter(function(L){return typeof L=="number"});u.forEach(function(L){_[L.toString(16)]=T})}return _}),Tw=i(function(_,v,T){if(_[T]=T,v[2]){var u=v[2].filter(function(L){return typeof L=="string"});u.forEach(function(L){_[L]=T})}return _}),Iw=i(function(_,v,T){var u=v[2];return _[T]=T,u.forEach(function(L){_[L]=T}),_});var s="far"in zl||lt.autoFetchSvg,f=Sm(LE,function(_,v){var T=v[0],u=v[1],L=v[2];return u==="far"&&!s&&(u="fas"),typeof T=="string"&&(_.names[T]={prefix:u,iconName:L}),typeof T=="number"&&(_.unicodes[T.toString(16)]={prefix:u,iconName:L}),_},{names:{},unicodes:{}});Ew=f.names,kw=f.unicodes,Ny=Op(lt.styleDefault,{family:lt.familyDefault})};wE(function(t){Ny=Op(t.styleDefault,{family:lt.familyDefault})});Cw();function Uy(t,i){return(Sw[t]||{})[i]}function NE(t,i){return(Tw[t]||{})[i]}function Is(t,i){return(Iw[t]||{})[i]}function Aw(t){return Ew[t]||{prefix:null,iconName:null}}function UE(t){var i=kw[t],s=Uy("fas",t);return i||(s?{prefix:"fas",iconName:s}:null)||{prefix:null,iconName:null}}function Fo(){return Ny}var Vy=function(){return{prefix:null,iconName:null,rest:[]}};function Op(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.family,f=s===void 0?pn:s,_=Fc[f][t],v=Oc[f][t]||Oc[f][_],T=t in Vi.styles?t:null;return v||T||null}var M0=(Cd={},Hn(Cd,pn,Object.keys(Nc[pn])),Hn(Cd,An,Object.keys(Nc[An])),Cd);function Np(t){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=s.skipLookups,_=f===void 0?!1:f,v=(i={},Hn(i,pn,"".concat(lt.cssPrefix,"-").concat(pn)),Hn(i,An,"".concat(lt.cssPrefix,"-").concat(An)),i),T=null,u=pn;(t.includes(v[pn])||t.some(function(q){return M0[pn].includes(q)}))&&(u=pn),(t.includes(v[An])||t.some(function(q){return M0[An].includes(q)}))&&(u=An);var L=t.reduce(function(q,ne){var Q=OE(lt.cssPrefix,ne);if(zl[ne]?(ne=RE[u].includes(ne)?hE[u][ne]:ne,T=ne,q.prefix=ne):BE[u].indexOf(ne)>-1?(T=ne,q.prefix=Op(ne,{family:u})):Q?q.iconName=Q:ne!==lt.replacementClass&&ne!==v[pn]&&ne!==v[An]&&q.rest.push(ne),!_&&q.prefix&&q.iconName){var V=T==="fa"?Aw(q.iconName):{},pe=Is(q.prefix,q.iconName);V.prefix&&(T=null),q.iconName=V.iconName||pe||q.iconName,q.prefix=V.prefix||q.prefix,q.prefix==="far"&&!zl.far&&zl.fas&&!lt.autoFetchSvg&&(q.prefix="fas")}return q},Vy());return(t.includes("fa-brands")||t.includes("fab"))&&(L.prefix="fab"),(t.includes("fa-duotone")||t.includes("fad"))&&(L.prefix="fad"),!L.prefix&&u===An&&(zl.fass||lt.autoFetchSvg)&&(L.prefix="fass",L.iconName=Is(L.prefix,L.iconName)||L.iconName),(L.prefix==="fa"||T==="fa")&&(L.prefix=Fo()||"fas"),L}var VE=function(){function t(){QT(this,t),this.definitions={}}return eE(t,[{key:"add",value:function(){for(var s=this,f=arguments.length,_=new Array(f),v=0;v<f;v++)_[v]=arguments[v];var T=_.reduce(this._pullDefinitions,{});Object.keys(T).forEach(function(u){s.definitions[u]=rt(rt({},s.definitions[u]||{}),T[u]),Ig(u,T[u]);var L=Nc[pn][u];L&&Ig(L,T[u]),Cw()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(s,f){var _=f.prefix&&f.iconName&&f.icon?{0:f}:f;return Object.keys(_).map(function(v){var T=_[v],u=T.prefix,L=T.iconName,q=T.icon,ne=q[2];s[u]||(s[u]={}),ne.length>0&&ne.forEach(function(Q){typeof Q=="string"&&(s[u][Q]=q)}),s[u][L]=q}),s}}]),t}(),D0=[],Ml={},Ul={},$E=Object.keys(Ul);function jE(t,i){var s=i.mixoutsTo;return D0=t,Ml={},Object.keys(Ul).forEach(function(f){$E.indexOf(f)===-1&&delete Ul[f]}),D0.forEach(function(f){var _=f.mixout?f.mixout():{};if(Object.keys(_).forEach(function(T){typeof _[T]=="function"&&(s[T]=_[T]),yp(_[T])==="object"&&Object.keys(_[T]).forEach(function(u){s[T]||(s[T]={}),s[T][u]=_[T][u]})}),f.hooks){var v=f.hooks();Object.keys(v).forEach(function(T){Ml[T]||(Ml[T]=[]),Ml[T].push(v[T])})}f.provides&&f.provides(Ul)}),s}function Cg(t,i){for(var s=arguments.length,f=new Array(s>2?s-2:0),_=2;_<s;_++)f[_-2]=arguments[_];var v=Ml[t]||[];return v.forEach(function(T){i=T.apply(null,[i].concat(f))}),i}function Ns(t){for(var i=arguments.length,s=new Array(i>1?i-1:0),f=1;f<i;f++)s[f-1]=arguments[f];var _=Ml[t]||[];_.forEach(function(v){v.apply(null,s)})}function Va(){var t=arguments[0],i=Array.prototype.slice.call(arguments,1);return Ul[t]?Ul[t].apply(null,i):void 0}function Ag(t){t.prefix==="fa"&&(t.prefix="fas");var i=t.iconName,s=t.prefix||Fo();if(!!i)return i=Is(s,i)||i,P0(Pw.definitions,s,i)||P0(Vi.styles,s,i)}var Pw=new VE,GE=function(){lt.autoReplaceSvg=!1,lt.observeMutations=!1,Ns("noAuto")},qE={i2svg:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ja?(Ns("beforeI2svg",i),Va("pseudoElements2svg",i),Va("i2svg",i)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=i.autoReplaceSvgRoot;lt.autoReplaceSvg===!1&&(lt.autoReplaceSvg=!0),lt.observeMutations=!0,PE(function(){WE({autoReplaceSvgRoot:s}),Ns("watch",i)})}},ZE={icon:function(i){if(i===null)return null;if(yp(i)==="object"&&i.prefix&&i.iconName)return{prefix:i.prefix,iconName:Is(i.prefix,i.iconName)||i.iconName};if(Array.isArray(i)&&i.length===2){var s=i[1].indexOf("fa-")===0?i[1].slice(3):i[1],f=Op(i[0]);return{prefix:f,iconName:Is(f,s)||s}}if(typeof i=="string"&&(i.indexOf("".concat(lt.cssPrefix,"-"))>-1||i.match(dE))){var _=Np(i.split(" "),{skipLookups:!0});return{prefix:_.prefix||Fo(),iconName:Is(_.prefix,_.iconName)||_.iconName}}if(typeof i=="string"){var v=Fo();return{prefix:v,iconName:Is(v,i)||i}}}},ci={noAuto:GE,config:lt,dom:qE,parse:ZE,library:Pw,findIconDefinition:Ag,toHtml:Xc},WE=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=i.autoReplaceSvgRoot,f=s===void 0?mn:s;(Object.keys(Vi.styles).length>0||lt.autoFetchSvg)&&ja&&lt.autoReplaceSvg&&ci.dom.i2svg({node:f})};function Up(t,i){return Object.defineProperty(t,"abstract",{get:i}),Object.defineProperty(t,"html",{get:function(){return t.abstract.map(function(f){return Xc(f)})}}),Object.defineProperty(t,"node",{get:function(){if(!!ja){var f=mn.createElement("div");return f.innerHTML=t.html,f.children}}}),t}function HE(t){var i=t.children,s=t.main,f=t.mask,_=t.attributes,v=t.styles,T=t.transform;if(Oy(T)&&s.found&&!f.found){var u=s.width,L=s.height,q={x:u/L/2,y:.5};_.style=Fp(rt(rt({},v),{},{"transform-origin":"".concat(q.x+T.x/16,"em ").concat(q.y+T.y/16,"em")}))}return[{tag:"svg",attributes:_,children:i}]}function XE(t){var i=t.prefix,s=t.iconName,f=t.children,_=t.attributes,v=t.symbol,T=v===!0?"".concat(i,"-").concat(lt.cssPrefix,"-").concat(s):v;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:rt(rt({},_),{},{id:T}),children:f}]}]}function $y(t){var i=t.icons,s=i.main,f=i.mask,_=t.prefix,v=t.iconName,T=t.transform,u=t.symbol,L=t.title,q=t.maskId,ne=t.titleId,Q=t.extra,V=t.watchable,pe=V===void 0?!1:V,be=f.found?f:s,ye=be.width,ze=be.height,ee=_==="fak",X=[lt.replacementClass,v?"".concat(lt.cssPrefix,"-").concat(v):""].filter(function(vt){return Q.classes.indexOf(vt)===-1}).filter(function(vt){return vt!==""||!!vt}).concat(Q.classes).join(" "),ie={children:[],attributes:rt(rt({},Q.attributes),{},{"data-prefix":_,"data-icon":v,class:X,role:Q.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(ye," ").concat(ze)})},xe=ee&&!~Q.classes.indexOf("fa-fw")?{width:"".concat(ye/ze*16*.0625,"em")}:{};pe&&(ie.attributes[Os]=""),L&&(ie.children.push({tag:"title",attributes:{id:ie.attributes["aria-labelledby"]||"title-".concat(ne||Vc())},children:[L]}),delete ie.attributes.title);var Ee=rt(rt({},ie),{},{prefix:_,iconName:v,main:s,mask:f,maskId:q,transform:T,symbol:u,styles:rt(rt({},xe),Q.styles)}),Oe=f.found&&s.found?Va("generateAbstractMask",Ee)||{children:[],attributes:{}}:Va("generateAbstractIcon",Ee)||{children:[],attributes:{}},Ve=Oe.children,Le=Oe.attributes;return Ee.children=Ve,Ee.attributes=Le,u?XE(Ee):HE(Ee)}function L0(t){var i=t.content,s=t.width,f=t.height,_=t.transform,v=t.title,T=t.extra,u=t.watchable,L=u===void 0?!1:u,q=rt(rt(rt({},T.attributes),v?{title:v}:{}),{},{class:T.classes.join(" ")});L&&(q[Os]="");var ne=rt({},T.styles);Oy(_)&&(ne.transform=kE({transform:_,startCentered:!0,width:s,height:f}),ne["-webkit-transform"]=ne.transform);var Q=Fp(ne);Q.length>0&&(q.style=Q);var V=[];return V.push({tag:"span",attributes:q,children:[i]}),v&&V.push({tag:"span",attributes:{class:"sr-only"},children:[v]}),V}function YE(t){var i=t.content,s=t.title,f=t.extra,_=rt(rt(rt({},f.attributes),s?{title:s}:{}),{},{class:f.classes.join(" ")}),v=Fp(f.styles);v.length>0&&(_.style=v);var T=[];return T.push({tag:"span",attributes:_,children:[i]}),s&&T.push({tag:"span",attributes:{class:"sr-only"},children:[s]}),T}var Tm=Vi.styles;function Pg(t){var i=t[0],s=t[1],f=t.slice(4),_=My(f,1),v=_[0],T=null;return Array.isArray(v)?T={tag:"g",attributes:{class:"".concat(lt.cssPrefix,"-").concat(ks.GROUP)},children:[{tag:"path",attributes:{class:"".concat(lt.cssPrefix,"-").concat(ks.SECONDARY),fill:"currentColor",d:v[0]}},{tag:"path",attributes:{class:"".concat(lt.cssPrefix,"-").concat(ks.PRIMARY),fill:"currentColor",d:v[1]}}]}:T={tag:"path",attributes:{fill:"currentColor",d:v}},{found:!0,width:i,height:s,icon:T}}var KE={found:!1,width:512,height:512};function JE(t,i){!gw&&!lt.showMissingIcons&&t&&console.error('Icon with name "'.concat(t,'" and prefix "').concat(i,'" is missing.'))}function zg(t,i){var s=i;return i==="fa"&&lt.styleDefault!==null&&(i=Fo()),new Promise(function(f,_){if(Va("missingIconAbstract"),s==="fa"){var v=Aw(t)||{};t=v.iconName||t,i=v.prefix||i}if(t&&i&&Tm[i]&&Tm[i][t]){var T=Tm[i][t];return f(Pg(T))}JE(t,i),f(rt(rt({},KE),{},{icon:lt.showMissingIcons&&t?Va("missingIconAbstract")||{}:{}}))})}var R0=function(){},Mg=lt.measurePerformance&&xd&&xd.mark&&xd.measure?xd:{mark:R0,measure:R0},lc='FA "6.2.1"',QE=function(i){return Mg.mark("".concat(lc," ").concat(i," begins")),function(){return zw(i)}},zw=function(i){Mg.mark("".concat(lc," ").concat(i," ends")),Mg.measure("".concat(lc," ").concat(i),"".concat(lc," ").concat(i," begins"),"".concat(lc," ").concat(i," ends"))},jy={begin:QE,end:zw},jd=function(){};function B0(t){var i=t.getAttribute?t.getAttribute(Os):null;return typeof i=="string"}function ek(t){var i=t.getAttribute?t.getAttribute(Ly):null,s=t.getAttribute?t.getAttribute(Ry):null;return i&&s}function tk(t){return t&&t.classList&&t.classList.contains&&t.classList.contains(lt.replacementClass)}function nk(){if(lt.autoReplaceSvg===!0)return Gd.replace;var t=Gd[lt.autoReplaceSvg];return t||Gd.replace}function rk(t){return mn.createElementNS("http://www.w3.org/2000/svg",t)}function ik(t){return mn.createElement(t)}function Mw(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.ceFn,f=s===void 0?t.tag==="svg"?rk:ik:s;if(typeof t=="string")return mn.createTextNode(t);var _=f(t.tag);Object.keys(t.attributes||[]).forEach(function(T){_.setAttribute(T,t.attributes[T])});var v=t.children||[];return v.forEach(function(T){_.appendChild(Mw(T,{ceFn:f}))}),_}function ak(t){var i=" ".concat(t.outerHTML," ");return i="".concat(i,"Font Awesome fontawesome.com "),i}var Gd={replace:function(i){var s=i[0];if(s.parentNode)if(i[1].forEach(function(_){s.parentNode.insertBefore(Mw(_),s)}),s.getAttribute(Os)===null&&lt.keepOriginalSource){var f=mn.createComment(ak(s));s.parentNode.replaceChild(f,s)}else s.remove()},nest:function(i){var s=i[0],f=i[1];if(~Fy(s).indexOf(lt.replacementClass))return Gd.replace(i);var _=new RegExp("".concat(lt.cssPrefix,"-.*"));if(delete f[0].attributes.id,f[0].attributes.class){var v=f[0].attributes.class.split(" ").reduce(function(u,L){return L===lt.replacementClass||L.match(_)?u.toSvg.push(L):u.toNode.push(L),u},{toNode:[],toSvg:[]});f[0].attributes.class=v.toSvg.join(" "),v.toNode.length===0?s.removeAttribute("class"):s.setAttribute("class",v.toNode.join(" "))}var T=f.map(function(u){return Xc(u)}).join(`
`);s.setAttribute(Os,""),s.innerHTML=T}};function F0(t){t()}function Dw(t,i){var s=typeof i=="function"?i:jd;if(t.length===0)s();else{var f=F0;lt.mutateApproach===uE&&(f=Bo.requestAnimationFrame||F0),f(function(){var _=nk(),v=jy.begin("mutate");t.map(_),v(),s()})}}var Gy=!1;function Lw(){Gy=!0}function Dg(){Gy=!1}var vp=null;function O0(t){if(!!I0&&!!lt.observeMutations){var i=t.treeCallback,s=i===void 0?jd:i,f=t.nodeCallback,_=f===void 0?jd:f,v=t.pseudoElementsCallback,T=v===void 0?jd:v,u=t.observeMutationsRoot,L=u===void 0?mn:u;vp=new I0(function(q){if(!Gy){var ne=Fo();Jl(q).forEach(function(Q){if(Q.type==="childList"&&Q.addedNodes.length>0&&!B0(Q.addedNodes[0])&&(lt.searchPseudoElements&&T(Q.target),s(Q.target)),Q.type==="attributes"&&Q.target.parentNode&&lt.searchPseudoElements&&T(Q.target.parentNode),Q.type==="attributes"&&B0(Q.target)&&~gE.indexOf(Q.attributeName))if(Q.attributeName==="class"&&ek(Q.target)){var V=Np(Fy(Q.target)),pe=V.prefix,be=V.iconName;Q.target.setAttribute(Ly,pe||ne),be&&Q.target.setAttribute(Ry,be)}else tk(Q.target)&&_(Q.target)})}}),ja&&vp.observe(L,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function ok(){!vp||vp.disconnect()}function sk(t){var i=t.getAttribute("style"),s=[];return i&&(s=i.split(";").reduce(function(f,_){var v=_.split(":"),T=v[0],u=v.slice(1);return T&&u.length>0&&(f[T]=u.join(":").trim()),f},{})),s}function lk(t){var i=t.getAttribute("data-prefix"),s=t.getAttribute("data-icon"),f=t.innerText!==void 0?t.innerText.trim():"",_=Np(Fy(t));return _.prefix||(_.prefix=Fo()),i&&s&&(_.prefix=i,_.iconName=s),_.iconName&&_.prefix||(_.prefix&&f.length>0&&(_.iconName=NE(_.prefix,t.innerText)||Uy(_.prefix,kg(t.innerText))),!_.iconName&&lt.autoFetchSvg&&t.firstChild&&t.firstChild.nodeType===Node.TEXT_NODE&&(_.iconName=t.firstChild.data)),_}function uk(t){var i=Jl(t.attributes).reduce(function(_,v){return _.name!=="class"&&_.name!=="style"&&(_[v.name]=v.value),_},{}),s=t.getAttribute("title"),f=t.getAttribute("data-fa-title-id");return lt.autoA11y&&(s?i["aria-labelledby"]="".concat(lt.replacementClass,"-title-").concat(f||Vc()):(i["aria-hidden"]="true",i.focusable="false")),i}function ck(){return{iconName:null,title:null,titleId:null,prefix:null,transform:ua,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function N0(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0},s=lk(t),f=s.iconName,_=s.prefix,v=s.rest,T=uk(t),u=Cg("parseNodeAttributes",{},t),L=i.styleParser?sk(t):[];return rt({iconName:f,title:t.getAttribute("title"),titleId:t.getAttribute("data-fa-title-id"),prefix:_,transform:ua,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:v,styles:L,attributes:T}},u)}var hk=Vi.styles;function Rw(t){var i=lt.autoReplaceSvg==="nest"?N0(t,{styleParser:!1}):N0(t);return~i.extra.classes.indexOf(yw)?Va("generateLayersText",t,i):Va("generateSvgReplacementMutation",t,i)}var Oo=new Set;By.map(function(t){Oo.add("fa-".concat(t))});Object.keys(Fc[pn]).map(Oo.add.bind(Oo));Object.keys(Fc[An]).map(Oo.add.bind(Oo));Oo=Wc(Oo);function U0(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!ja)return Promise.resolve();var s=mn.documentElement.classList,f=function(Q){return s.add("".concat(C0,"-").concat(Q))},_=function(Q){return s.remove("".concat(C0,"-").concat(Q))},v=lt.autoFetchSvg?Oo:By.map(function(ne){return"fa-".concat(ne)}).concat(Object.keys(hk));v.includes("fa")||v.push("fa");var T=[".".concat(yw,":not([").concat(Os,"])")].concat(v.map(function(ne){return".".concat(ne,":not([").concat(Os,"])")})).join(", ");if(T.length===0)return Promise.resolve();var u=[];try{u=Jl(t.querySelectorAll(T))}catch{}if(u.length>0)f("pending"),_("complete");else return Promise.resolve();var L=jy.begin("onTree"),q=u.reduce(function(ne,Q){try{var V=Rw(Q);V&&ne.push(V)}catch(pe){gw||pe.name==="MissingIcon"&&console.error(pe)}return ne},[]);return new Promise(function(ne,Q){Promise.all(q).then(function(V){Dw(V,function(){f("active"),f("complete"),_("pending"),typeof i=="function"&&i(),L(),ne()})}).catch(function(V){L(),Q(V)})})}function dk(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Rw(t).then(function(s){s&&Dw([s],i)})}function pk(t){return function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=(i||{}).icon?i:Ag(i||{}),_=s.mask;return _&&(_=(_||{}).icon?_:Ag(_||{})),t(f,rt(rt({},s),{},{mask:_}))}}var fk=function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=s.transform,_=f===void 0?ua:f,v=s.symbol,T=v===void 0?!1:v,u=s.mask,L=u===void 0?null:u,q=s.maskId,ne=q===void 0?null:q,Q=s.title,V=Q===void 0?null:Q,pe=s.titleId,be=pe===void 0?null:pe,ye=s.classes,ze=ye===void 0?[]:ye,ee=s.attributes,X=ee===void 0?{}:ee,ie=s.styles,xe=ie===void 0?{}:ie;if(!!i){var Ee=i.prefix,Oe=i.iconName,Ve=i.icon;return Up(rt({type:"icon"},i),function(){return Ns("beforeDOMElementCreation",{iconDefinition:i,params:s}),lt.autoA11y&&(V?X["aria-labelledby"]="".concat(lt.replacementClass,"-title-").concat(be||Vc()):(X["aria-hidden"]="true",X.focusable="false")),$y({icons:{main:Pg(Ve),mask:L?Pg(L.icon):{found:!1,width:null,height:null,icon:{}}},prefix:Ee,iconName:Oe,transform:rt(rt({},ua),_),symbol:T,title:V,maskId:ne,titleId:be,extra:{attributes:X,styles:xe,classes:ze}})})}},mk={mixout:function(){return{icon:pk(fk)}},hooks:function(){return{mutationObserverCallbacks:function(s){return s.treeCallback=U0,s.nodeCallback=dk,s}}},provides:function(i){i.i2svg=function(s){var f=s.node,_=f===void 0?mn:f,v=s.callback,T=v===void 0?function(){}:v;return U0(_,T)},i.generateSvgReplacementMutation=function(s,f){var _=f.iconName,v=f.title,T=f.titleId,u=f.prefix,L=f.transform,q=f.symbol,ne=f.mask,Q=f.maskId,V=f.extra;return new Promise(function(pe,be){Promise.all([zg(_,u),ne.iconName?zg(ne.iconName,ne.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(ye){var ze=My(ye,2),ee=ze[0],X=ze[1];pe([s,$y({icons:{main:ee,mask:X},prefix:u,iconName:_,transform:L,symbol:q,maskId:Q,title:v,titleId:T,extra:V,watchable:!0})])}).catch(be)})},i.generateAbstractIcon=function(s){var f=s.children,_=s.attributes,v=s.main,T=s.transform,u=s.styles,L=Fp(u);L.length>0&&(_.style=L);var q;return Oy(T)&&(q=Va("generateAbstractTransformGrouping",{main:v,transform:T,containerWidth:v.width,iconWidth:v.width})),f.push(q||v.icon),{children:f,attributes:_}}}},gk={mixout:function(){return{layer:function(s){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=f.classes,v=_===void 0?[]:_;return Up({type:"layer"},function(){Ns("beforeDOMElementCreation",{assembler:s,params:f});var T=[];return s(function(u){Array.isArray(u)?u.map(function(L){T=T.concat(L.abstract)}):T=T.concat(u.abstract)}),[{tag:"span",attributes:{class:["".concat(lt.cssPrefix,"-layers")].concat(Wc(v)).join(" ")},children:T}]})}}}},yk={mixout:function(){return{counter:function(s){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=f.title,v=_===void 0?null:_,T=f.classes,u=T===void 0?[]:T,L=f.attributes,q=L===void 0?{}:L,ne=f.styles,Q=ne===void 0?{}:ne;return Up({type:"counter",content:s},function(){return Ns("beforeDOMElementCreation",{content:s,params:f}),YE({content:s.toString(),title:v,extra:{attributes:q,styles:Q,classes:["".concat(lt.cssPrefix,"-layers-counter")].concat(Wc(u))}})})}}}},_k={mixout:function(){return{text:function(s){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=f.transform,v=_===void 0?ua:_,T=f.title,u=T===void 0?null:T,L=f.classes,q=L===void 0?[]:L,ne=f.attributes,Q=ne===void 0?{}:ne,V=f.styles,pe=V===void 0?{}:V;return Up({type:"text",content:s},function(){return Ns("beforeDOMElementCreation",{content:s,params:f}),L0({content:s,transform:rt(rt({},ua),v),title:u,extra:{attributes:Q,styles:pe,classes:["".concat(lt.cssPrefix,"-layers-text")].concat(Wc(q))}})})}}},provides:function(i){i.generateLayersText=function(s,f){var _=f.title,v=f.transform,T=f.extra,u=null,L=null;if(pw){var q=parseInt(getComputedStyle(s).fontSize,10),ne=s.getBoundingClientRect();u=ne.width/q,L=ne.height/q}return lt.autoA11y&&!_&&(T.attributes["aria-hidden"]="true"),Promise.resolve([s,L0({content:s.innerHTML,width:u,height:L,transform:v,title:_,extra:T,watchable:!0})])}}},vk=new RegExp('"',"ug"),V0=[1105920,1112319];function xk(t){var i=t.replace(vk,""),s=DE(i,0),f=s>=V0[0]&&s<=V0[1],_=i.length===2?i[0]===i[1]:!1;return{value:kg(_?i[0]:i),isSecondary:f||_}}function $0(t,i){var s="".concat(lE).concat(i.replace(":","-"));return new Promise(function(f,_){if(t.getAttribute(s)!==null)return f();var v=Jl(t.children),T=v.filter(function(Ve){return Ve.getAttribute(Eg)===i})[0],u=Bo.getComputedStyle(t,i),L=u.getPropertyValue("font-family").match(pE),q=u.getPropertyValue("font-weight"),ne=u.getPropertyValue("content");if(T&&!L)return t.removeChild(T),f();if(L&&ne!=="none"&&ne!==""){var Q=u.getPropertyValue("content"),V=~["Sharp"].indexOf(L[2])?An:pn,pe=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(L[2])?Oc[V][L[2].toLowerCase()]:fE[V][q],be=xk(Q),ye=be.value,ze=be.isSecondary,ee=L[0].startsWith("FontAwesome"),X=Uy(pe,ye),ie=X;if(ee){var xe=UE(ye);xe.iconName&&xe.prefix&&(X=xe.iconName,pe=xe.prefix)}if(X&&!ze&&(!T||T.getAttribute(Ly)!==pe||T.getAttribute(Ry)!==ie)){t.setAttribute(s,ie),T&&t.removeChild(T);var Ee=ck(),Oe=Ee.extra;Oe.attributes[Eg]=i,zg(X,pe).then(function(Ve){var Le=$y(rt(rt({},Ee),{},{icons:{main:Ve,mask:Vy()},prefix:pe,iconName:ie,extra:Oe,watchable:!0})),vt=mn.createElement("svg");i==="::before"?t.insertBefore(vt,t.firstChild):t.appendChild(vt),vt.outerHTML=Le.map(function(ht){return Xc(ht)}).join(`
`),t.removeAttribute(s),f()}).catch(_)}else f()}else f()})}function wk(t){return Promise.all([$0(t,"::before"),$0(t,"::after")])}function bk(t){return t.parentNode!==document.head&&!~cE.indexOf(t.tagName.toUpperCase())&&!t.getAttribute(Eg)&&(!t.parentNode||t.parentNode.tagName!=="svg")}function j0(t){if(!!ja)return new Promise(function(i,s){var f=Jl(t.querySelectorAll("*")).filter(bk).map(wk),_=jy.begin("searchPseudoElements");Lw(),Promise.all(f).then(function(){_(),Dg(),i()}).catch(function(){_(),Dg(),s()})})}var Sk={hooks:function(){return{mutationObserverCallbacks:function(s){return s.pseudoElementsCallback=j0,s}}},provides:function(i){i.pseudoElements2svg=function(s){var f=s.node,_=f===void 0?mn:f;lt.searchPseudoElements&&j0(_)}}},G0=!1,Tk={mixout:function(){return{dom:{unwatch:function(){Lw(),G0=!0}}}},hooks:function(){return{bootstrap:function(){O0(Cg("mutationObserverCallbacks",{}))},noAuto:function(){ok()},watch:function(s){var f=s.observeMutationsRoot;G0?Dg():O0(Cg("mutationObserverCallbacks",{observeMutationsRoot:f}))}}}},q0=function(i){var s={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return i.toLowerCase().split(" ").reduce(function(f,_){var v=_.toLowerCase().split("-"),T=v[0],u=v.slice(1).join("-");if(T&&u==="h")return f.flipX=!0,f;if(T&&u==="v")return f.flipY=!0,f;if(u=parseFloat(u),isNaN(u))return f;switch(T){case"grow":f.size=f.size+u;break;case"shrink":f.size=f.size-u;break;case"left":f.x=f.x-u;break;case"right":f.x=f.x+u;break;case"up":f.y=f.y-u;break;case"down":f.y=f.y+u;break;case"rotate":f.rotate=f.rotate+u;break}return f},s)},Ek={mixout:function(){return{parse:{transform:function(s){return q0(s)}}}},hooks:function(){return{parseNodeAttributes:function(s,f){var _=f.getAttribute("data-fa-transform");return _&&(s.transform=q0(_)),s}}},provides:function(i){i.generateAbstractTransformGrouping=function(s){var f=s.main,_=s.transform,v=s.containerWidth,T=s.iconWidth,u={transform:"translate(".concat(v/2," 256)")},L="translate(".concat(_.x*32,", ").concat(_.y*32,") "),q="scale(".concat(_.size/16*(_.flipX?-1:1),", ").concat(_.size/16*(_.flipY?-1:1),") "),ne="rotate(".concat(_.rotate," 0 0)"),Q={transform:"".concat(L," ").concat(q," ").concat(ne)},V={transform:"translate(".concat(T/2*-1," -256)")},pe={outer:u,inner:Q,path:V};return{tag:"g",attributes:rt({},pe.outer),children:[{tag:"g",attributes:rt({},pe.inner),children:[{tag:f.icon.tag,children:f.icon.children,attributes:rt(rt({},f.icon.attributes),pe.path)}]}]}}}},Em={x:0,y:0,width:"100%",height:"100%"};function Z0(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t.attributes&&(t.attributes.fill||i)&&(t.attributes.fill="black"),t}function kk(t){return t.tag==="g"?t.children:[t]}var Ik={hooks:function(){return{parseNodeAttributes:function(s,f){var _=f.getAttribute("data-fa-mask"),v=_?Np(_.split(" ").map(function(T){return T.trim()})):Vy();return v.prefix||(v.prefix=Fo()),s.mask=v,s.maskId=f.getAttribute("data-fa-mask-id"),s}}},provides:function(i){i.generateAbstractMask=function(s){var f=s.children,_=s.attributes,v=s.main,T=s.mask,u=s.maskId,L=s.transform,q=v.width,ne=v.icon,Q=T.width,V=T.icon,pe=EE({transform:L,containerWidth:Q,iconWidth:q}),be={tag:"rect",attributes:rt(rt({},Em),{},{fill:"white"})},ye=ne.children?{children:ne.children.map(Z0)}:{},ze={tag:"g",attributes:rt({},pe.inner),children:[Z0(rt({tag:ne.tag,attributes:rt(rt({},ne.attributes),pe.path)},ye))]},ee={tag:"g",attributes:rt({},pe.outer),children:[ze]},X="mask-".concat(u||Vc()),ie="clip-".concat(u||Vc()),xe={tag:"mask",attributes:rt(rt({},Em),{},{id:X,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[be,ee]},Ee={tag:"defs",children:[{tag:"clipPath",attributes:{id:ie},children:kk(V)},xe]};return f.push(Ee,{tag:"rect",attributes:rt({fill:"currentColor","clip-path":"url(#".concat(ie,")"),mask:"url(#".concat(X,")")},Em)}),{children:f,attributes:_}}}},Ck={provides:function(i){var s=!1;Bo.matchMedia&&(s=Bo.matchMedia("(prefers-reduced-motion: reduce)").matches),i.missingIconAbstract=function(){var f=[],_={fill:"currentColor"},v={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};f.push({tag:"path",attributes:rt(rt({},_),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var T=rt(rt({},v),{},{attributeName:"opacity"}),u={tag:"circle",attributes:rt(rt({},_),{},{cx:"256",cy:"364",r:"28"}),children:[]};return s||u.children.push({tag:"animate",attributes:rt(rt({},v),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:rt(rt({},T),{},{values:"1;0;1;1;0;1;"})}),f.push(u),f.push({tag:"path",attributes:rt(rt({},_),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:s?[]:[{tag:"animate",attributes:rt(rt({},T),{},{values:"1;0;0;0;0;1;"})}]}),s||f.push({tag:"path",attributes:rt(rt({},_),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:rt(rt({},T),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:f}}}},Ak={hooks:function(){return{parseNodeAttributes:function(s,f){var _=f.getAttribute("data-fa-symbol"),v=_===null?!1:_===""?!0:_;return s.symbol=v,s}}}},Pk=[CE,mk,gk,yk,_k,Sk,Tk,Ek,Ik,Ck,Ak];jE(Pk,{mixoutsTo:ci});ci.noAuto;ci.config;ci.library;ci.dom;var Lg=ci.parse;ci.findIconDefinition;ci.toHtml;var zk=ci.icon;ci.layer;ci.text;ci.counter;var Lt={exports:{}},Mk="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Dk=Mk,Lk=Dk;function Bw(){}function Fw(){}Fw.resetWarningCache=Bw;var Rk=function(){function t(f,_,v,T,u,L){if(L!==Lk){var q=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw q.name="Invariant Violation",q}}t.isRequired=t;function i(){return t}var s={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:i,element:t,elementType:t,instanceOf:i,node:t,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:Fw,resetWarningCache:Bw};return s.PropTypes=s,s};Lt.exports=Rk();function W0(t,i){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);i&&(f=f.filter(function(_){return Object.getOwnPropertyDescriptor(t,_).enumerable})),s.push.apply(s,f)}return s}function To(t){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?W0(Object(s),!0).forEach(function(f){Dl(t,f,s[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):W0(Object(s)).forEach(function(f){Object.defineProperty(t,f,Object.getOwnPropertyDescriptor(s,f))})}return t}function xp(t){return xp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},xp(t)}function Dl(t,i,s){return i in t?Object.defineProperty(t,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[i]=s,t}function Bk(t,i){if(t==null)return{};var s={},f=Object.keys(t),_,v;for(v=0;v<f.length;v++)_=f[v],!(i.indexOf(_)>=0)&&(s[_]=t[_]);return s}function Fk(t,i){if(t==null)return{};var s=Bk(t,i),f,_;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(t);for(_=0;_<v.length;_++)f=v[_],!(i.indexOf(f)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,f)||(s[f]=t[f]))}return s}function Rg(t){return Ok(t)||Nk(t)||Uk(t)||Vk()}function Ok(t){if(Array.isArray(t))return Bg(t)}function Nk(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Uk(t,i){if(!!t){if(typeof t=="string")return Bg(t,i);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Bg(t,i)}}function Bg(t,i){(i==null||i>t.length)&&(i=t.length);for(var s=0,f=new Array(i);s<i;s++)f[s]=t[s];return f}function Vk(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $k(t){var i,s=t.beat,f=t.fade,_=t.beatFade,v=t.bounce,T=t.shake,u=t.flash,L=t.spin,q=t.spinPulse,ne=t.spinReverse,Q=t.pulse,V=t.fixedWidth,pe=t.inverse,be=t.border,ye=t.listItem,ze=t.flip,ee=t.size,X=t.rotation,ie=t.pull,xe=(i={"fa-beat":s,"fa-fade":f,"fa-beat-fade":_,"fa-bounce":v,"fa-shake":T,"fa-flash":u,"fa-spin":L,"fa-spin-reverse":ne,"fa-spin-pulse":q,"fa-pulse":Q,"fa-fw":V,"fa-inverse":pe,"fa-border":be,"fa-li":ye,"fa-flip":ze===!0,"fa-flip-horizontal":ze==="horizontal"||ze==="both","fa-flip-vertical":ze==="vertical"||ze==="both"},Dl(i,"fa-".concat(ee),typeof ee<"u"&&ee!==null),Dl(i,"fa-rotate-".concat(X),typeof X<"u"&&X!==null&&X!==0),Dl(i,"fa-pull-".concat(ie),typeof ie<"u"&&ie!==null),Dl(i,"fa-swap-opacity",t.swapOpacity),i);return Object.keys(xe).map(function(Ee){return xe[Ee]?Ee:null}).filter(function(Ee){return Ee})}function jk(t){return t=t-0,t===t}function Ow(t){return jk(t)?t:(t=t.replace(/[\-_\s]+(.)?/g,function(i,s){return s?s.toUpperCase():""}),t.substr(0,1).toLowerCase()+t.substr(1))}var Gk=["style"];function qk(t){return t.charAt(0).toUpperCase()+t.slice(1)}function Zk(t){return t.split(";").map(function(i){return i.trim()}).filter(function(i){return i}).reduce(function(i,s){var f=s.indexOf(":"),_=Ow(s.slice(0,f)),v=s.slice(f+1).trim();return _.startsWith("webkit")?i[qk(_)]=v:i[_]=v,i},{})}function Nw(t,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof i=="string")return i;var f=(i.children||[]).map(function(L){return Nw(t,L)}),_=Object.keys(i.attributes||{}).reduce(function(L,q){var ne=i.attributes[q];switch(q){case"class":L.attrs.className=ne,delete i.attributes.class;break;case"style":L.attrs.style=Zk(ne);break;default:q.indexOf("aria-")===0||q.indexOf("data-")===0?L.attrs[q.toLowerCase()]=ne:L.attrs[Ow(q)]=ne}return L},{attrs:{}}),v=s.style,T=v===void 0?{}:v,u=Fk(s,Gk);return _.attrs.style=To(To({},_.attrs.style),T),t.apply(void 0,[i.tag,To(To({},_.attrs),u)].concat(Rg(f)))}var Uw=!1;try{Uw=!0}catch{}function Wk(){if(!Uw&&console&&typeof console.error=="function"){var t;(t=console).error.apply(t,arguments)}}function H0(t){if(t&&xp(t)==="object"&&t.prefix&&t.iconName&&t.icon)return t;if(Lg.icon)return Lg.icon(t);if(t===null)return null;if(t&&xp(t)==="object"&&t.prefix&&t.iconName)return t;if(Array.isArray(t)&&t.length===2)return{prefix:t[0],iconName:t[1]};if(typeof t=="string")return{prefix:"fas",iconName:t}}function km(t,i){return Array.isArray(i)&&i.length>0||!Array.isArray(i)&&i?Dl({},t,i):{}}var zs=Ms.forwardRef(function(t,i){var s=t.icon,f=t.mask,_=t.symbol,v=t.className,T=t.title,u=t.titleId,L=t.maskId,q=H0(s),ne=km("classes",[].concat(Rg($k(t)),Rg(v.split(" ")))),Q=km("transform",typeof t.transform=="string"?Lg.transform(t.transform):t.transform),V=km("mask",H0(f)),pe=zk(q,To(To(To(To({},ne),Q),V),{},{symbol:_,title:T,titleId:u,maskId:L}));if(!pe)return Wk("Could not find icon",q),null;var be=pe.abstract,ye={ref:i};return Object.keys(t).forEach(function(ze){zs.defaultProps.hasOwnProperty(ze)||(ye[ze]=t[ze])}),Hk(be[0],ye)});zs.displayName="FontAwesomeIcon";zs.propTypes={beat:Lt.exports.bool,border:Lt.exports.bool,beatFade:Lt.exports.bool,bounce:Lt.exports.bool,className:Lt.exports.string,fade:Lt.exports.bool,flash:Lt.exports.bool,mask:Lt.exports.oneOfType([Lt.exports.object,Lt.exports.array,Lt.exports.string]),maskId:Lt.exports.string,fixedWidth:Lt.exports.bool,inverse:Lt.exports.bool,flip:Lt.exports.oneOf([!0,!1,"horizontal","vertical","both"]),icon:Lt.exports.oneOfType([Lt.exports.object,Lt.exports.array,Lt.exports.string]),listItem:Lt.exports.bool,pull:Lt.exports.oneOf(["right","left"]),pulse:Lt.exports.bool,rotation:Lt.exports.oneOf([0,90,180,270]),shake:Lt.exports.bool,size:Lt.exports.oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:Lt.exports.bool,spinPulse:Lt.exports.bool,spinReverse:Lt.exports.bool,symbol:Lt.exports.oneOfType([Lt.exports.bool,Lt.exports.string]),title:Lt.exports.string,titleId:Lt.exports.string,transform:Lt.exports.oneOfType([Lt.exports.string,Lt.exports.object]),swapOpacity:Lt.exports.bool};zs.defaultProps={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1};var Hk=Nw.bind(null,Ms.createElement),Xk={prefix:"fas",iconName:"bars",icon:[448,512,["navicon"],"f0c9","M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"]},Yk={prefix:"fas",iconName:"user",icon:[448,512,[128100,62144],"f007","M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0S96 57.3 96 128s57.3 128 128 128zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"]},Kk={prefix:"fas",iconName:"location-crosshairs",icon:[512,512,["location"],"f601","M256 0c17.7 0 32 14.3 32 32V66.7C368.4 80.1 431.9 143.6 445.3 224H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H445.3C431.9 368.4 368.4 431.9 288 445.3V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V445.3C143.6 431.9 80.1 368.4 66.7 288H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H66.7C80.1 143.6 143.6 80.1 224 66.7V32c0-17.7 14.3-32 32-32zM128 256c0 70.7 57.3 128 128 128s128-57.3 128-128s-57.3-128-128-128s-128 57.3-128 128zm128 80c-44.2 0-80-35.8-80-80s35.8-80 80-80s80 35.8 80 80s-35.8 80-80 80z"]},Vw={exports:{}};(function(t,i){(function(s,f){t.exports=f()})(L2,function(){var s,f,_;function v(u,L){if(!s)s=L;else if(!f)f=L;else{var q="var sharedChunk = {}; ("+s+")(sharedChunk); ("+f+")(sharedChunk);",ne={};s(ne),_=L(ne),typeof window<"u"&&(_.workerUrl=window.URL.createObjectURL(new Blob([q],{type:"text/javascript"})))}}v(["exports"],function(u){var L=q;function q(r,e,a,l){this.cx=3*r,this.bx=3*(a-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(l-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=e,this.p2x=a,this.p2y=l}function ne(r,e,a,l){const d=new L(r,e,a,l);return function(m){return d.solve(m)}}q.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,e){if(e===void 0&&(e=1e-6),r<0)return 0;if(r>1)return 1;for(var a=r,l=0;l<8;l++){var d=this.sampleCurveX(a)-r;if(Math.abs(d)<e)return a;var m=this.sampleCurveDerivativeX(a);if(Math.abs(m)<1e-6)break;a-=d/m}var y=0,w=1;for(a=r,l=0;l<20&&(d=this.sampleCurveX(a),!(Math.abs(d-r)<e));l++)r>d?y=a:w=a,a=.5*(w-y)+y;return a},solve:function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))}};const Q=ne(.25,.1,.25,1);function V(r,e,a){return Math.min(a,Math.max(e,r))}function pe(r,e,a){const l=a-e,d=((r-e)%l+l)%l+e;return d===e?a:d}function be(r,...e){for(const a of e)for(const l in a)r[l]=a[l];return r}let ye=1;function ze(r,e){r.forEach(a=>{e[a]&&(e[a]=e[a].bind(e))})}function ee(r,e,a){const l={};for(const d in r)l[d]=e.call(a||this,r[d],d,r);return l}function X(r,e,a){const l={};for(const d in r)e.call(a||this,r[d],d,r)&&(l[d]=r[d]);return l}function ie(r){return Array.isArray(r)?r.map(ie):typeof r=="object"&&r?ee(r,ie):r}const xe={};function Ee(r){xe[r]||(typeof console<"u"&&console.warn(r),xe[r]=!0)}function Oe(r,e,a){return(a.y-r.y)*(e.x-r.x)>(e.y-r.y)*(a.x-r.x)}function Ve(r){let e=0;for(let a,l,d=0,m=r.length,y=m-1;d<m;y=d++)a=r[d],l=r[y],e+=(l.x-a.x)*(a.y+l.y);return e}function Le(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function vt(r){const e={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,l,d,m)=>{const y=d||m;return e[l]=!y||y.toLowerCase(),""}),e["max-age"]){const a=parseInt(e["max-age"],10);isNaN(a)?delete e["max-age"]:e["max-age"]=a}return e}let ht,Ht,Kt=null;function vn(r){if(Kt==null){const e=r.navigator?r.navigator.userAgent:null;Kt=!!r.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Kt}function cn(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const Ln={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(r){const e=requestAnimationFrame(r);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(r,e=0){const a=window.document.createElement("canvas"),l=a.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return a.width=r.width,a.height=r.height,l.drawImage(r,0,0,r.width,r.height),l.getImageData(-e,-e,r.width+2*e,r.height+2*e)},resolveURL:r=>(ht||(ht=document.createElement("a")),ht.href=r,ht.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Ht==null&&(Ht=matchMedia("(prefers-reduced-motion: reduce)")),Ht.matches)}};var Ke=hn;function hn(r,e){this.x=r,this.y=e}hn.prototype={clone:function(){return new hn(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,e){return this.clone()._rotateAround(r,e)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var e=r.x-this.x,a=r.y-this.y;return e*e+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,e){return Math.atan2(this.x*e-this.y*r,this.x*r+this.y*e)},_matMult:function(r){var e=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=e,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var e=Math.cos(r),a=Math.sin(r),l=a*this.x+e*this.y;return this.x=e*this.x-a*this.y,this.y=l,this},_rotateAround:function(r,e){var a=Math.cos(r),l=Math.sin(r),d=e.y+l*(this.x-e.x)+a*(this.y-e.y);return this.x=e.x+a*(this.x-e.x)-l*(this.y-e.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},hn.convert=function(r){return r instanceof hn?r:Array.isArray(r)?new hn(r[0],r[1]):r};const $e={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},st="mapbox-tiles";let pt,Gt,en=500,Xr=50;function cr(){typeof caches>"u"||pt||(pt=caches.open(st))}let hr=1/0;const Xn={supported:!1,testSupport:function(r){!dr&&qi&&(Ga?$o(r):br=r)}};let br,qi,dr=!1,Ga=!1;function $o(r){const e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,qi),r.isContextLost())return;Xn.supported=!0}catch{}r.deleteTexture(e),dr=!0}typeof document<"u"&&(qi=document.createElement("img"),qi.onload=function(){br&&$o(br),br=null,Ga=!0},qi.onerror=function(){dr=!0,br=null},qi.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Ei={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Ei);class Sr extends Error{constructor(e,a,l,d){super(`AJAXError: ${a} (${e}): ${l}`),this.status=e,this.statusText=a,this.url=l,this.body=d}}const jo=Le()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function Zi(r,e){const a=new AbortController,l=new Request(r.url,{method:r.method||"GET",body:r.body,credentials:r.credentials,headers:r.headers,referrer:jo(),signal:a.signal});let d=!1,m=!1;return r.type==="json"&&l.headers.set("Accept","application/json"),((y,w,b)=>{if(m)return;const k=Date.now();fetch(l).then(A=>A.ok?((z,R,F)=>{(r.type==="arrayBuffer"?z.arrayBuffer():r.type==="json"?z.json():z.text()).then(O=>{m||(R&&F&&function(Y,H,ue){if(cr(),!pt)return;const me={status:H.status,statusText:H.statusText,headers:new Headers};H.headers.forEach((de,Ie)=>me.headers.set(Ie,de));const le=vt(H.headers.get("Cache-Control")||"");le["no-store"]||(le["max-age"]&&me.headers.set("Expires",new Date(ue+1e3*le["max-age"]).toUTCString()),new Date(me.headers.get("Expires")).getTime()-ue<42e4||function(de,Ie){if(Gt===void 0)try{new Response(new ReadableStream),Gt=!0}catch{Gt=!1}Gt?Ie(de.body):de.blob().then(Ie)}(H,de=>{const Ie=new Response(de,me);cr(),pt&&pt.then(ke=>ke.put(function(Xe){const Qe=Xe.indexOf("?");return Qe<0?Xe:Xe.slice(0,Qe)}(Y.url),Ie)).catch(ke=>Ee(ke.message))}))}(l,R,F),d=!0,e(null,O,z.headers.get("Cache-Control"),z.headers.get("Expires")))}).catch(O=>{m||e(new Error(O.message))})})(A,null,k):A.blob().then(z=>e(new Sr(A.status,A.statusText,r.url,z)))).catch(A=>{A.code!==20&&e(new Error(A.message))})})(),{cancel:()=>{m=!0,d||a.abort()}}}const qa=function(r,e){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){if(Le()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e);if(!Le()){const l=r.url.substring(0,r.url.indexOf("://"));return($e.REGISTERED_PROTOCOLS[l]||Zi)(r,e)}}if(!(/^file:/.test(a=r.url)||/^file:/.test(jo())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Zi(r,e);if(Le()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e,void 0,!0)}var a;return function(l,d){const m=new XMLHttpRequest;m.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const y in l.headers)m.setRequestHeader(y,l.headers[y]);return l.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=l.credentials==="include",m.onerror=()=>{d(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let y=m.response;if(l.type==="json")try{y=JSON.parse(m.response)}catch(w){return d(w)}d(null,y,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else{const y=new Blob([m.response],{type:m.getResponseHeader("Content-Type")});d(new Sr(m.status,m.statusText,l.url,y))}},m.send(l.body),{cancel:()=>m.abort()}}(r,e)},Za=function(r,e){return qa(be(r,{type:"arrayBuffer"}),e)};function Go(r){const e=window.document.createElement("a");return e.href=r,e.protocol===window.document.location.protocol&&e.host===window.document.location.host}const At="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let hi,Wi;hi=[],Wi=0;const Hi=function(r,e){if(Xn.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),Wi>=$e.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:r,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return hi.push(m),m}Wi++;let a=!1;const l=()=>{if(!a)for(a=!0,Wi--;hi.length&&Wi<$e.MAX_PARALLEL_IMAGE_REQUESTS;){const m=hi.shift(),{requestParameters:y,callback:w,cancelled:b}=m;b||(m.cancel=Hi(y,w).cancel)}},d=Za(r,(m,y,w,b)=>{l(),m?e(m):y&&function(k,A){typeof createImageBitmap=="function"?function(z,R){const F=new Blob([new Uint8Array(z)],{type:"image/png"});createImageBitmap(F).then(O=>{R(null,O)}).catch(O=>{R(new Error(`Could not load image because of ${O.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(k,A):function(z,R){const F=new Image;F.onload=()=>{R(null,F),URL.revokeObjectURL(F.src),F.onload=null,window.requestAnimationFrame(()=>{F.src=At})},F.onerror=()=>R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const O=new Blob([new Uint8Array(z)],{type:"image/png"});F.src=z.byteLength?URL.createObjectURL(O):At}(k,A)}(y,(k,A)=>{k!=null?e(k):A!=null&&e(null,A,{cacheControl:w,expires:b})})});return{cancel:()=>{d.cancel(),l()}}};function qo(r,e,a){a[r]&&a[r].indexOf(e)!==-1||(a[r]=a[r]||[],a[r].push(e))}function ki(r,e,a){if(a&&a[r]){const l=a[r].indexOf(e);l!==-1&&a[r].splice(l,1)}}class Ii{constructor(e,a={}){be(this,a),this.type=e}}class Wa extends Ii{constructor(e,a={}){super("error",be({error:e},a))}}class Ci{on(e,a){return this._listeners=this._listeners||{},qo(e,a,this._listeners),this}off(e,a){return ki(e,a,this._listeners),ki(e,a,this._oneTimeListeners),this}once(e,a){return this._oneTimeListeners=this._oneTimeListeners||{},qo(e,a,this._oneTimeListeners),this}fire(e,a){typeof e=="string"&&(e=new Ii(e,a||{}));const l=e.type;if(this.listens(l)){e.target=this;const d=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const w of d)w.call(this,e);const m=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const w of m)ki(l,w,this._oneTimeListeners),w.call(this,e);const y=this._eventedParent;y&&(be(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(e))}else e instanceof Wa&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,a){return this._eventedParent=e,this._eventedParentData=a,this}}var Te={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Ne{constructor(e,a,l,d){this.message=(e?`${e}: `:"")+l,d&&(this.identifier=d),a!=null&&a.__line__&&(this.line=a.__line__)}}function da(r){const e=r.value;return e?[new Ne(r.key,e,"constants have been deprecated as of v8")]:[]}function Yr(r,...e){for(const a of e)for(const l in a)r[l]=a[l];return r}function Pt(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Nr(r){if(Array.isArray(r))return r.map(Nr);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const a in r)e[a]=Nr(r[a]);return e}return Pt(r)}class Tr extends Error{constructor(e,a){super(a),this.message=a,this.key=e}}class Er{constructor(e,a=[]){this.parent=e,this.bindings={};for(const[l,d]of a)this.bindings[l]=d}concat(e){return new Er(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Xi={kind:"null"},Re={kind:"number"},xt={kind:"string"},gt={kind:"boolean"},jn={kind:"color"},Yi={kind:"object"},mt={kind:"value"},Ai={kind:"collator"},Rn={kind:"formatted"},Ha={kind:"padding"},Tn={kind:"resolvedImage"};function rr(r,e){return{kind:"array",itemType:r,N:e}}function $t(r){if(r.kind==="array"){const e=$t(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}return r.kind}const Xa=[Xi,Re,xt,gt,jn,Rn,Yi,rr(mt),Ha,Tn];function di(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!di(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const a of Xa)if(!di(a,e))return null}}return`Expected ${$t(r)} but found ${$t(e)} instead.`}function pa(r,e){return e.some(a=>a.kind===r.kind)}function fa(r,e){return e.some(a=>a==="null"?r===null:a==="array"?Array.isArray(r):a==="object"?r&&!Array.isArray(r)&&typeof r=="object":a===typeof r)}var Ya,ma={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function $(r){return(r=Math.round(r))<0?0:r>255?255:r}function C(r){return $(r[r.length-1]==="%"?parseFloat(r)/100*255:parseInt(r))}function M(r){return(e=r[r.length-1]==="%"?parseFloat(r)/100:parseFloat(r))<0?0:e>1?1:e;var e}function N(r,e,a){return a<0?a+=1:a>1&&(a-=1),6*a<1?r+(e-r)*a*6:2*a<1?e:3*a<2?r+(e-r)*(2/3-a)*6:r}try{Ya={}.parseCSSColor=function(r){var e,a=r.replace(/ /g,"").toLowerCase();if(a in ma)return ma[a].slice();if(a[0]==="#")return a.length===4?(e=parseInt(a.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:a.length===7&&(e=parseInt(a.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=a.indexOf("("),d=a.indexOf(")");if(l!==-1&&d+1===a.length){var m=a.substr(0,l),y=a.substr(l+1,d-(l+1)).split(","),w=1;switch(m){case"rgba":if(y.length!==4)return null;w=M(y.pop());case"rgb":return y.length!==3?null:[C(y[0]),C(y[1]),C(y[2]),w];case"hsla":if(y.length!==4)return null;w=M(y.pop());case"hsl":if(y.length!==3)return null;var b=(parseFloat(y[0])%360+360)%360/360,k=M(y[1]),A=M(y[2]),z=A<=.5?A*(k+1):A+k-A*k,R=2*A-z;return[$(255*N(R,z,b+1/3)),$(255*N(R,z,b)),$(255*N(R,z,b-1/3)),w];default:return null}}return null}}catch{}class U{constructor(e,a,l,d=1){this.r=e,this.g=a,this.b=l,this.a=d}static parse(e){if(!e)return;if(e instanceof U)return e;if(typeof e!="string")return;const a=Ya(e);return a?new U(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toString(){const[e,a,l,d]=this.toArray();return`rgba(${Math.round(e)},${Math.round(a)},${Math.round(l)},${d})`}toArray(){const{r:e,g:a,b:l,a:d}=this;return d===0?[0,0,0,0]:[255*e/d,255*a/d,255*l/d,d]}}U.black=new U(0,0,0,1),U.white=new U(1,1,1,1),U.transparent=new U(0,0,0,0),U.red=new U(1,0,0,1);class K{constructor(e,a,l){this.sensitivity=e?a?"variant":"case":a?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,a){return this.collator.compare(e,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ae{constructor(e,a,l,d,m){this.text=e,this.image=a,this.scale=l,this.fontStack=d,this.textColor=m}}class te{constructor(e){this.sections=e}static fromString(e){return new te([new ae(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof te?e:te.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class J{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof J)return e;if(typeof e=="number")return new J([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const a of e)if(typeof a!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new J(e)}}toString(){return JSON.stringify(this.values)}}class oe{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new oe({name:e,available:!1}):null}}function _e(r,e,a,l){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof a=="number"&&a>=0&&a<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[r,e,a,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[r,e,a,l]:[r,e,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ce(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof U||r instanceof K||r instanceof te||r instanceof J||r instanceof oe)return!0;if(Array.isArray(r)){for(const e of r)if(!Ce(e))return!1;return!0}if(typeof r=="object"){for(const e in r)if(!Ce(r[e]))return!1;return!0}return!1}function ge(r){if(r===null)return Xi;if(typeof r=="string")return xt;if(typeof r=="boolean")return gt;if(typeof r=="number")return Re;if(r instanceof U)return jn;if(r instanceof K)return Ai;if(r instanceof te)return Rn;if(r instanceof J)return Ha;if(r instanceof oe)return Tn;if(Array.isArray(r)){const e=r.length;let a;for(const l of r){const d=ge(l);if(a){if(a===d)continue;a=mt;break}a=d}return rr(a||mt,e)}return Yi}function Je(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof U||r instanceof te||r instanceof J||r instanceof oe?r.toString():JSON.stringify(r)}class et{constructor(e,a){this.type=e,this.value=a}static parse(e,a){if(e.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ce(e[1]))return a.error("invalid value");const l=e[1];let d=ge(l);const m=a.expectedType;return d.kind!=="array"||d.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(d=m),new et(d,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Ze{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const ut={string:xt,number:Re,boolean:gt,object:Yi};class dt{constructor(e,a){this.type=e,this.args=a}static parse(e,a){if(e.length<2)return a.error("Expected at least one argument.");let l,d=1;const m=e[0];if(m==="array"){let w,b;if(e.length>2){const k=e[1];if(typeof k!="string"||!(k in ut)||k==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);w=ut[k],d++}else w=mt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return a.error('The length argument to "array" must be a positive integer literal',2);b=e[2],d++}l=rr(w,b)}else{if(!ut[m])throw new Error(`Types doesn't contain name = ${m}`);l=ut[m]}const y=[];for(;d<e.length;d++){const w=a.parse(e[d],d,mt);if(!w)return null;y.push(w)}return new dt(l,y)}evaluate(e){for(let a=0;a<this.args.length;a++){const l=this.args[a].evaluate(e);if(!di(this.type,ge(l)))return l;if(a===this.args.length-1)throw new Ze(`Expected value to be of type ${$t(this.type)}, but found ${$t(ge(l))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const zt={"to-boolean":gt,"to-color":jn,"to-number":Re,"to-string":xt};class ft{constructor(e,a){this.type=e,this.args=a}static parse(e,a){if(e.length<2)return a.error("Expected at least one argument.");const l=e[0];if(!zt[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&e.length!==2)return a.error("Expected one argument.");const d=zt[l],m=[];for(let y=1;y<e.length;y++){const w=a.parse(e[y],y,mt);if(!w)return null;m.push(w)}return new ft(d,m)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let a,l;for(const d of this.args){if(a=d.evaluate(e),l=null,a instanceof U)return a;if(typeof a=="string"){const m=e.parseColor(a);if(m)return m}else if(Array.isArray(a)&&(l=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:_e(a[0],a[1],a[2],a[3]),!l))return new U(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Ze(l||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}if(this.type.kind==="padding"){let a;for(const l of this.args){a=l.evaluate(e);const d=J.parse(a);if(d)return d}throw new Ze(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}if(this.type.kind==="number"){let a=null;for(const l of this.args){if(a=l.evaluate(e),a===null)return 0;const d=Number(a);if(!isNaN(d))return d}throw new Ze(`Could not convert ${JSON.stringify(a)} to number.`)}return this.type.kind==="formatted"?te.fromString(Je(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?oe.fromString(Je(this.args[0].evaluate(e))):Je(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const wt=["Unknown","Point","LineString","Polygon"];class Mt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?wt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let a=this._parseColorCache[e];return a||(a=this._parseColorCache[e]=U.parse(e)),a}}class qt{constructor(e,a,l,d){this.name=e,this.type=a,this._evaluate=l,this.args=d}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,a){const l=e[0],d=qt.definitions[l];if(!d)return a.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(d)?d[0]:d.type,y=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,w=y.filter(([k])=>!Array.isArray(k)||k.length===e.length-1);let b=null;for(const[k,A]of w){b=new Qa(a.registry,a.path,null,a.scope);const z=[];let R=!1;for(let F=1;F<e.length;F++){const O=e[F],Y=Array.isArray(k)?k[F-1]:k.type,H=b.parse(O,1+z.length,Y);if(!H){R=!0;break}z.push(H)}if(!R)if(Array.isArray(k)&&k.length!==z.length)b.error(`Expected ${k.length} arguments, but found ${z.length} instead.`);else{for(let F=0;F<z.length;F++){const O=Array.isArray(k)?k[F]:k.type,Y=z[F];b.concat(F+1).checkSubtype(O,Y.type)}if(b.errors.length===0)return new qt(l,m,A,z)}}if(w.length===1)a.errors.push(...b.errors);else{const k=(w.length?w:y).map(([z])=>{return R=z,Array.isArray(R)?`(${R.map($t).join(", ")})`:`(${$t(R.type)}...)`;var R}).join(" | "),A=[];for(let z=1;z<e.length;z++){const R=a.parse(e[z],1+A.length);if(!R)return null;A.push($t(R.type))}a.error(`Expected arguments of type ${k}, but found (${A.join(", ")}) instead.`)}return null}static register(e,a){qt.definitions=a;for(const l in a)e[l]=qt}}class Bn{constructor(e,a,l){this.type=Ai,this.locale=l,this.caseSensitive=e,this.diacriticSensitive=a}static parse(e,a){if(e.length!==2)return a.error("Expected one argument.");const l=e[1];if(typeof l!="object"||Array.isArray(l))return a.error("Collator options argument must be an object.");const d=a.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,gt);if(!d)return null;const m=a.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,gt);if(!m)return null;let y=null;return l.locale&&(y=a.parse(l.locale,1,xt),!y)?null:new Bn(d,m,y)}evaluate(e){return new K(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const tn=8192;function Yn(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function Ka(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function Zo(r,e){const a=(180+r[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,d=Math.pow(2,e.z);return[Math.round(a*d*tn),Math.round(l*d*tn)]}function Zt(r,e,a){const l=r[0]-e[0],d=r[1]-e[1],m=r[0]-a[0],y=r[1]-a[1];return l*y-m*d==0&&l*m<=0&&d*y<=0}function Ql(r,e){let a=!1;for(let y=0,w=e.length;y<w;y++){const b=e[y];for(let k=0,A=b.length;k<A-1;k++){if(Zt(r,b[k],b[k+1]))return!1;(d=b[k])[1]>(l=r)[1]!=(m=b[k+1])[1]>l[1]&&l[0]<(m[0]-d[0])*(l[1]-d[1])/(m[1]-d[1])+d[0]&&(a=!a)}}var l,d,m;return a}function eu(r,e){for(let a=0;a<e.length;a++)if(Ql(r,e[a]))return!0;return!1}function Yc(r,e,a,l){const d=l[0]-a[0],m=l[1]-a[1],y=(r[0]-a[0])*m-d*(r[1]-a[1]),w=(e[0]-a[0])*m-d*(e[1]-a[1]);return y>0&&w<0||y<0&&w>0}function Kc(r,e,a){for(const k of a)for(let A=0;A<k.length-1;++A)if((w=[(y=k[A+1])[0]-(m=k[A])[0],y[1]-m[1]])[0]*(b=[(d=e)[0]-(l=r)[0],d[1]-l[1]])[1]-w[1]*b[0]!=0&&Yc(l,d,m,y)&&Yc(m,y,l,d))return!0;var l,d,m,y,w,b;return!1}function tu(r,e){for(let a=0;a<r.length;++a)if(!Ql(r[a],e))return!1;for(let a=0;a<r.length-1;++a)if(Kc(r[a],r[a+1],e))return!1;return!0}function qp(r,e){for(let a=0;a<e.length;a++)if(tu(r,e[a]))return!0;return!1}function $s(r,e,a){const l=[];for(let d=0;d<r.length;d++){const m=[];for(let y=0;y<r[d].length;y++){const w=Zo(r[d][y],a);Yn(e,w),m.push(w)}l.push(m)}return l}function nu(r,e,a){const l=[];for(let d=0;d<r.length;d++){const m=$s(r[d],e,a);l.push(m)}return l}function Jc(r,e,a,l){if(r[0]<a[0]||r[0]>a[2]){const d=.5*l;let m=r[0]-a[0]>d?-l:a[0]-r[0]>d?l:0;m===0&&(m=r[0]-a[2]>d?-l:a[2]-r[0]>d?l:0),r[0]+=m}Yn(e,r)}function Qc(r,e,a,l){const d=Math.pow(2,l.z)*tn,m=[l.x*tn,l.y*tn],y=[];for(const w of r)for(const b of w){const k=[b.x+m[0],b.y+m[1]];Jc(k,e,a,d),y.push(k)}return y}function eh(r,e,a,l){const d=Math.pow(2,l.z)*tn,m=[l.x*tn,l.y*tn],y=[];for(const b of r){const k=[];for(const A of b){const z=[A.x+m[0],A.y+m[1]];Yn(e,z),k.push(z)}y.push(k)}if(e[2]-e[0]<=d/2){(w=e)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const b of y)for(const k of b)Jc(k,e,a,d)}var w;return y}class ga{constructor(e,a){this.type=gt,this.geojson=e,this.geometries=a}static parse(e,a){if(e.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ce(e[1])){const l=e[1];if(l.type==="FeatureCollection")for(let d=0;d<l.features.length;++d){const m=l.features[d].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new ga(l,l.features[d].geometry)}else if(l.type==="Feature"){const d=l.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new ga(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new ga(l,l)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(a,l){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=a.canonicalID();if(l.type==="Polygon"){const w=$s(l.coordinates,m,y),b=Qc(a.geometry(),d,m,y);if(!Ka(d,m))return!1;for(const k of b)if(!Ql(k,w))return!1}if(l.type==="MultiPolygon"){const w=nu(l.coordinates,m,y),b=Qc(a.geometry(),d,m,y);if(!Ka(d,m))return!1;for(const k of b)if(!eu(k,w))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(a,l){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=a.canonicalID();if(l.type==="Polygon"){const w=$s(l.coordinates,m,y),b=eh(a.geometry(),d,m,y);if(!Ka(d,m))return!1;for(const k of b)if(!tu(k,w))return!1}if(l.type==="MultiPolygon"){const w=nu(l.coordinates,m,y),b=eh(a.geometry(),d,m,y);if(!Ka(d,m))return!1;for(const k of b)if(!qp(k,w))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function Wo(r){if(r instanceof qt&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof ga)return!1;let e=!0;return r.eachChild(a=>{e&&!Wo(a)&&(e=!1)}),e}function Ja(r){if(r instanceof qt&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(a=>{e&&!Ja(a)&&(e=!1)}),e}function js(r,e){if(r instanceof qt&&e.indexOf(r.name)>=0)return!1;let a=!0;return r.eachChild(l=>{a&&!js(l,e)&&(a=!1)}),a}class Gs{constructor(e,a){this.type=a.type,this.name=e,this.boundExpression=a}static parse(e,a){if(e.length!==2||typeof e[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const l=e[1];return a.scope.has(l)?new Gs(l,a.scope.get(l)):a.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Qa{constructor(e,a=[],l,d=new Er,m=[]){this.registry=e,this.path=a,this.key=a.map(y=>`[${y}]`).join(""),this.scope=d,this.errors=m,this.expectedType=l}parse(e,a,l,d,m={}){return a?this.concat(a,l,d)._parse(e,m):this._parse(e,m)}_parse(e,a){function l(d,m,y){return y==="assert"?new dt(m,[d]):y==="coerce"?new ft(m,[d]):d}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=e[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[d];if(m){let y=m.parse(e,this);if(!y)return null;if(this.expectedType){const w=this.expectedType,b=y.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||b.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string")if(w.kind!=="padding"||b.kind!=="value"&&b.kind!=="number"&&b.kind!=="array"){if(this.checkSubtype(w,b))return null}else y=l(y,w,a.typeAnnotation||"coerce");else y=l(y,w,a.typeAnnotation||"coerce");else y=l(y,w,a.typeAnnotation||"assert")}if(!(y instanceof et)&&y.type.kind!=="resolvedImage"&&ru(y)){const w=new Mt;try{y=new et(y.type,y.evaluate(w))}catch(b){return this.error(b.message),null}}return y}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,a,l){const d=typeof e=="number"?this.path.concat(e):this.path,m=l?this.scope.concat(l):this.scope;return new Qa(this.registry,d,a||null,m,this.errors)}error(e,...a){const l=`${this.key}${a.map(d=>`[${d}]`).join("")}`;this.errors.push(new Tr(l,e))}checkSubtype(e,a){const l=di(e,a);return l&&this.error(l),l}}function ru(r){if(r instanceof Gs)return ru(r.boundExpression);if(r instanceof qt&&r.name==="error"||r instanceof Bn||r instanceof ga)return!1;const e=r instanceof ft||r instanceof dt;let a=!0;return r.eachChild(l=>{a=e?a&&ru(l):a&&l instanceof et}),!!a&&Wo(r)&&js(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function qs(r,e){const a=r.length-1;let l,d,m=0,y=a,w=0;for(;m<=y;)if(w=Math.floor((m+y)/2),l=r[w],d=r[w+1],l<=e){if(w===a||e<d)return w;m=w+1}else{if(!(l>e))throw new Ze("Input is not a number.");y=w-1}return 0}class Ho{constructor(e,a,l){this.type=e,this.input=a,this.labels=[],this.outputs=[];for(const[d,m]of l)this.labels.push(d),this.outputs.push(m)}static parse(e,a){if(e.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return a.error("Expected an even number of arguments.");const l=a.parse(e[1],1,Re);if(!l)return null;const d=[];let m=null;a.expectedType&&a.expectedType.kind!=="value"&&(m=a.expectedType);for(let y=1;y<e.length;y+=2){const w=y===1?-1/0:e[y],b=e[y+1],k=y,A=y+1;if(typeof w!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(d.length&&d[d.length-1][0]>=w)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const z=a.parse(b,A,m);if(!z)return null;m=m||z.type,d.push([w,z])}return new Ho(m,l,d)}evaluate(e){const a=this.labels,l=this.outputs;if(a.length===1)return l[0].evaluate(e);const d=this.input.evaluate(e);if(d<=a[0])return l[0].evaluate(e);const m=a.length;return d>=a[m-1]?l[m-1].evaluate(e):l[qs(a,d)].evaluate(e)}eachChild(e){e(this.input);for(const a of this.outputs)e(a)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function nn(r,e,a){return r*(1-a)+e*a}var Xo=Object.freeze({__proto__:null,number:nn,color:function(r,e,a){return new U(nn(r.r,e.r,a),nn(r.g,e.g,a),nn(r.b,e.b,a),nn(r.a,e.a,a))},array:function(r,e,a){return r.map((l,d)=>nn(l,e[d],a))},padding:function(r,e,a){const l=r.values,d=e.values;return new J([nn(l[0],d[0],a),nn(l[1],d[1],a),nn(l[2],d[2],a),nn(l[3],d[3],a)])}});const th=.95047,nh=1.08883,iu=4/29,Zs=6/29,rh=3*Zs*Zs,Zp=Math.PI/180,Wp=180/Math.PI;function au(r){return r>.008856451679035631?Math.pow(r,1/3):r/rh+iu}function ou(r){return r>Zs?r*r*r:rh*(r-iu)}function su(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function lu(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Bt(r){const e=lu(r.r),a=lu(r.g),l=lu(r.b),d=au((.4124564*e+.3575761*a+.1804375*l)/th),m=au((.2126729*e+.7151522*a+.072175*l)/1);return{l:116*m-16,a:500*(d-m),b:200*(m-au((.0193339*e+.119192*a+.9503041*l)/nh)),alpha:r.a}}function ih(r){let e=(r.l+16)/116,a=isNaN(r.a)?e:e+r.a/500,l=isNaN(r.b)?e:e-r.b/200;return e=1*ou(e),a=th*ou(a),l=nh*ou(l),new U(su(3.2404542*a-1.5371385*e-.4985314*l),su(-.969266*a+1.8760108*e+.041556*l),su(.0556434*a-.2040259*e+1.0572252*l),r.alpha)}function Hp(r,e,a){const l=e-r;return r+a*(l>180||l<-180?l-360*Math.round(l/360):l)}const Yo={forward:Bt,reverse:ih,interpolate:function(r,e,a){return{l:nn(r.l,e.l,a),a:nn(r.a,e.a,a),b:nn(r.b,e.b,a),alpha:nn(r.alpha,e.alpha,a)}}},Ko={forward:function(r){const{l:e,a,b:l}=Bt(r),d=Math.atan2(l,a)*Wp;return{h:d<0?d+360:d,c:Math.sqrt(a*a+l*l),l:e,alpha:r.a}},reverse:function(r){const e=r.h*Zp,a=r.c;return ih({l:r.l,a:Math.cos(e)*a,b:Math.sin(e)*a,alpha:r.alpha})},interpolate:function(r,e,a){return{h:Hp(r.h,e.h,a),c:nn(r.c,e.c,a),l:nn(r.l,e.l,a),alpha:nn(r.alpha,e.alpha,a)}}};var ah=Object.freeze({__proto__:null,lab:Yo,hcl:Ko});class kr{constructor(e,a,l,d,m){this.type=e,this.operator=a,this.interpolation=l,this.input=d,this.labels=[],this.outputs=[];for(const[y,w]of m)this.labels.push(y),this.outputs.push(w)}static interpolationFactor(e,a,l,d){let m=0;if(e.name==="exponential")m=uu(a,e.base,l,d);else if(e.name==="linear")m=uu(a,1,l,d);else if(e.name==="cubic-bezier"){const y=e.controlPoints;m=new L(y[0],y[1],y[2],y[3]).solve(uu(a,1,l,d))}return m}static parse(e,a){let[l,d,m,...y]=e;if(!Array.isArray(d)||d.length===0)return a.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const k=d[1];if(typeof k!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:k}}else{if(d[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const k=d.slice(1);if(k.length!==4||k.some(A=>typeof A!="number"||A<0||A>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:k}}}if(e.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(m=a.parse(m,2,Re),!m)return null;const w=[];let b=null;l==="interpolate-hcl"||l==="interpolate-lab"?b=jn:a.expectedType&&a.expectedType.kind!=="value"&&(b=a.expectedType);for(let k=0;k<y.length;k+=2){const A=y[k],z=y[k+1],R=k+3,F=k+4;if(typeof A!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(w.length&&w[w.length-1][0]>=A)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',R);const O=a.parse(z,F,b);if(!O)return null;b=b||O.type,w.push([A,O])}return b.kind==="number"||b.kind==="color"||b.kind==="padding"||b.kind==="array"&&b.itemType.kind==="number"&&typeof b.N=="number"?new kr(b,l,d,m,w):a.error(`Type ${$t(b)} is not interpolatable.`)}evaluate(e){const a=this.labels,l=this.outputs;if(a.length===1)return l[0].evaluate(e);const d=this.input.evaluate(e);if(d<=a[0])return l[0].evaluate(e);const m=a.length;if(d>=a[m-1])return l[m-1].evaluate(e);const y=qs(a,d),w=kr.interpolationFactor(this.interpolation,d,a[y],a[y+1]),b=l[y].evaluate(e),k=l[y+1].evaluate(e);return this.operator==="interpolate"?Xo[this.type.kind.toLowerCase()](b,k,w):this.operator==="interpolate-hcl"?Ko.reverse(Ko.interpolate(Ko.forward(b),Ko.forward(k),w)):Yo.reverse(Yo.interpolate(Yo.forward(b),Yo.forward(k),w))}eachChild(e){e(this.input);for(const a of this.outputs)e(a)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function uu(r,e,a,l){const d=l-a,m=r-a;return d===0?0:e===1?m/d:(Math.pow(e,m)-1)/(Math.pow(e,d)-1)}class Ws{constructor(e,a){this.type=e,this.args=a}static parse(e,a){if(e.length<2)return a.error("Expectected at least one argument.");let l=null;const d=a.expectedType;d&&d.kind!=="value"&&(l=d);const m=[];for(const w of e.slice(1)){const b=a.parse(w,1+m.length,l,void 0,{typeAnnotation:"omit"});if(!b)return null;l=l||b.type,m.push(b)}if(!l)throw new Error("No output type");const y=d&&m.some(w=>di(d,w.type));return new Ws(y?mt:l,m)}evaluate(e){let a,l=null,d=0;for(const m of this.args)if(d++,l=m.evaluate(e),l&&l instanceof oe&&!l.available&&(a||(a=l.name),l=null,d===this.args.length&&(l=a)),l!==null)break;return l}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}class Hs{constructor(e,a){this.type=a.type,this.bindings=[].concat(e),this.result=a}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const a of this.bindings)e(a[1]);e(this.result)}static parse(e,a){if(e.length<4)return a.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const l=[];for(let m=1;m<e.length-1;m+=2){const y=e[m];if(typeof y!="string")return a.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return a.error("Variable names must contain only alphanumeric characters or '_'.",m);const w=a.parse(e[m+1],m+1);if(!w)return null;l.push([y,w])}const d=a.parse(e[e.length-1],e.length-1,a.expectedType,l);return d?new Hs(l,d):null}outputDefined(){return this.result.outputDefined()}}class cu{constructor(e,a,l){this.type=e,this.index=a,this.input=l}static parse(e,a){if(e.length!==3)return a.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=a.parse(e[1],1,Re),d=a.parse(e[2],2,rr(a.expectedType||mt));return l&&d?new cu(d.type.itemType,l,d):null}evaluate(e){const a=this.index.evaluate(e),l=this.input.evaluate(e);if(a<0)throw new Ze(`Array index out of bounds: ${a} < 0.`);if(a>=l.length)throw new Ze(`Array index out of bounds: ${a} > ${l.length-1}.`);if(a!==Math.floor(a))throw new Ze(`Array index must be an integer, but found ${a} instead.`);return l[a]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class hu{constructor(e,a){this.type=gt,this.needle=e,this.haystack=a}static parse(e,a){if(e.length!==3)return a.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=a.parse(e[1],1,mt),d=a.parse(e[2],2,mt);return l&&d?pa(l.type,[gt,xt,Re,Xi,mt])?new hu(l,d):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${$t(l.type)} instead`):null}evaluate(e){const a=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!l)return!1;if(!fa(a,["boolean","string","number","null"]))throw new Ze(`Expected first argument to be of type boolean, string, number or null, but found ${$t(ge(a))} instead.`);if(!fa(l,["string","array"]))throw new Ze(`Expected second argument to be of type array or string, but found ${$t(ge(l))} instead.`);return l.indexOf(a)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class Xs{constructor(e,a,l){this.type=Re,this.needle=e,this.haystack=a,this.fromIndex=l}static parse(e,a){if(e.length<=2||e.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=a.parse(e[1],1,mt),d=a.parse(e[2],2,mt);if(!l||!d)return null;if(!pa(l.type,[gt,xt,Re,Xi,mt]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${$t(l.type)} instead`);if(e.length===4){const m=a.parse(e[3],3,Re);return m?new Xs(l,d,m):null}return new Xs(l,d)}evaluate(e){const a=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!fa(a,["boolean","string","number","null"]))throw new Ze(`Expected first argument to be of type boolean, string, number or null, but found ${$t(ge(a))} instead.`);if(!fa(l,["string","array"]))throw new Ze(`Expected second argument to be of type array or string, but found ${$t(ge(l))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(e);return l.indexOf(a,d)}return l.indexOf(a)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class du{constructor(e,a,l,d,m,y){this.inputType=e,this.type=a,this.input=l,this.cases=d,this.outputs=m,this.otherwise=y}static parse(e,a){if(e.length<5)return a.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return a.error("Expected an even number of arguments.");let l,d;a.expectedType&&a.expectedType.kind!=="value"&&(d=a.expectedType);const m={},y=[];for(let k=2;k<e.length-1;k+=2){let A=e[k];const z=e[k+1];Array.isArray(A)||(A=[A]);const R=a.concat(k);if(A.length===0)return R.error("Expected at least one branch label.");for(const O of A){if(typeof O!="number"&&typeof O!="string")return R.error("Branch labels must be numbers or strings.");if(typeof O=="number"&&Math.abs(O)>Number.MAX_SAFE_INTEGER)return R.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof O=="number"&&Math.floor(O)!==O)return R.error("Numeric branch labels must be integer values.");if(l){if(R.checkSubtype(l,ge(O)))return null}else l=ge(O);if(m[String(O)]!==void 0)return R.error("Branch labels must be unique.");m[String(O)]=y.length}const F=a.parse(z,k,d);if(!F)return null;d=d||F.type,y.push(F)}const w=a.parse(e[1],1,mt);if(!w)return null;const b=a.parse(e[e.length-1],e.length-1,d);return b?w.type.kind!=="value"&&a.concat(1).checkSubtype(l,w.type)?null:new du(l,d,w,m,y,b):null}evaluate(e){const a=this.input.evaluate(e);return(ge(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class pu{constructor(e,a,l){this.type=e,this.branches=a,this.otherwise=l}static parse(e,a){if(e.length<4)return a.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return a.error("Expected an odd number of arguments.");let l;a.expectedType&&a.expectedType.kind!=="value"&&(l=a.expectedType);const d=[];for(let y=1;y<e.length-1;y+=2){const w=a.parse(e[y],y,gt);if(!w)return null;const b=a.parse(e[y+1],y+1,l);if(!b)return null;d.push([w,b]),l=l||b.type}const m=a.parse(e[e.length-1],e.length-1,l);if(!m)return null;if(!l)throw new Error("Can't infer output type");return new pu(l,d,m)}evaluate(e){for(const[a,l]of this.branches)if(a.evaluate(e))return l.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[a,l]of this.branches)e(a),e(l);e(this.otherwise)}outputDefined(){return this.branches.every(([e,a])=>a.outputDefined())&&this.otherwise.outputDefined()}}class Ys{constructor(e,a,l,d){this.type=e,this.input=a,this.beginIndex=l,this.endIndex=d}static parse(e,a){if(e.length<=2||e.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=a.parse(e[1],1,mt),d=a.parse(e[2],2,Re);if(!l||!d)return null;if(!pa(l.type,[rr(mt),xt,mt]))return a.error(`Expected first argument to be of type array or string, but found ${$t(l.type)} instead`);if(e.length===4){const m=a.parse(e[3],3,Re);return m?new Ys(l.type,l,d,m):null}return new Ys(l.type,l,d)}evaluate(e){const a=this.input.evaluate(e),l=this.beginIndex.evaluate(e);if(!fa(a,["string","array"]))throw new Ze(`Expected first argument to be of type array or string, but found ${$t(ge(a))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(e);return a.slice(l,d)}return a.slice(l)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function oh(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function sh(r,e,a,l){return l.compare(e,a)===0}function eo(r,e,a){const l=r!=="=="&&r!=="!=";return class $w{constructor(m,y,w){this.type=gt,this.lhs=m,this.rhs=y,this.collator=w,this.hasUntypedArgument=m.type.kind==="value"||y.type.kind==="value"}static parse(m,y){if(m.length!==3&&m.length!==4)return y.error("Expected two or three arguments.");const w=m[0];let b=y.parse(m[1],1,mt);if(!b)return null;if(!oh(w,b.type))return y.concat(1).error(`"${w}" comparisons are not supported for type '${$t(b.type)}'.`);let k=y.parse(m[2],2,mt);if(!k)return null;if(!oh(w,k.type))return y.concat(2).error(`"${w}" comparisons are not supported for type '${$t(k.type)}'.`);if(b.type.kind!==k.type.kind&&b.type.kind!=="value"&&k.type.kind!=="value")return y.error(`Cannot compare types '${$t(b.type)}' and '${$t(k.type)}'.`);l&&(b.type.kind==="value"&&k.type.kind!=="value"?b=new dt(k.type,[b]):b.type.kind!=="value"&&k.type.kind==="value"&&(k=new dt(b.type,[k])));let A=null;if(m.length===4){if(b.type.kind!=="string"&&k.type.kind!=="string"&&b.type.kind!=="value"&&k.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(A=y.parse(m[3],3,Ai),!A)return null}return new $w(b,k,A)}evaluate(m){const y=this.lhs.evaluate(m),w=this.rhs.evaluate(m);if(l&&this.hasUntypedArgument){const b=ge(y),k=ge(w);if(b.kind!==k.kind||b.kind!=="string"&&b.kind!=="number")throw new Ze(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${b.kind}, ${k.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const b=ge(y),k=ge(w);if(b.kind!=="string"||k.kind!=="string")return e(m,y,w)}return this.collator?a(m,y,w,this.collator.evaluate(m)):e(m,y,w)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const Xp=eo("==",function(r,e,a){return e===a},sh),Yp=eo("!=",function(r,e,a){return e!==a},function(r,e,a,l){return!sh(0,e,a,l)}),Kp=eo("<",function(r,e,a){return e<a},function(r,e,a,l){return l.compare(e,a)<0}),Jp=eo(">",function(r,e,a){return e>a},function(r,e,a,l){return l.compare(e,a)>0}),Qp=eo("<=",function(r,e,a){return e<=a},function(r,e,a,l){return l.compare(e,a)<=0}),ef=eo(">=",function(r,e,a){return e>=a},function(r,e,a,l){return l.compare(e,a)>=0});class fu{constructor(e,a,l,d,m){this.type=xt,this.number=e,this.locale=a,this.currency=l,this.minFractionDigits=d,this.maxFractionDigits=m}static parse(e,a){if(e.length!==3)return a.error("Expected two arguments.");const l=a.parse(e[1],1,Re);if(!l)return null;const d=e[2];if(typeof d!="object"||Array.isArray(d))return a.error("NumberFormat options argument must be an object.");let m=null;if(d.locale&&(m=a.parse(d.locale,1,xt),!m))return null;let y=null;if(d.currency&&(y=a.parse(d.currency,1,xt),!y))return null;let w=null;if(d["min-fraction-digits"]&&(w=a.parse(d["min-fraction-digits"],1,Re),!w))return null;let b=null;return d["max-fraction-digits"]&&(b=a.parse(d["max-fraction-digits"],1,Re),!b)?null:new fu(l,m,y,w,b)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Ks{constructor(e){this.type=Rn,this.sections=e}static parse(e,a){if(e.length<2)return a.error("Expected at least one argument.");const l=e[1];if(!Array.isArray(l)&&typeof l=="object")return a.error("First argument must be an image or text section.");const d=[];let m=!1;for(let y=1;y<=e.length-1;++y){const w=e[y];if(m&&typeof w=="object"&&!Array.isArray(w)){m=!1;let b=null;if(w["font-scale"]&&(b=a.parse(w["font-scale"],1,Re),!b))return null;let k=null;if(w["text-font"]&&(k=a.parse(w["text-font"],1,rr(xt)),!k))return null;let A=null;if(w["text-color"]&&(A=a.parse(w["text-color"],1,jn),!A))return null;const z=d[d.length-1];z.scale=b,z.font=k,z.textColor=A}else{const b=a.parse(e[y],1,mt);if(!b)return null;const k=b.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,d.push({content:b,scale:null,font:null,textColor:null})}}return new Ks(d)}evaluate(e){return new te(this.sections.map(a=>{const l=a.content.evaluate(e);return ge(l)===Tn?new ae("",l,null,null,null):new ae(Je(l),null,a.scale?a.scale.evaluate(e):null,a.font?a.font.evaluate(e).join(","):null,a.textColor?a.textColor.evaluate(e):null)}))}eachChild(e){for(const a of this.sections)e(a.content),a.scale&&e(a.scale),a.font&&e(a.font),a.textColor&&e(a.textColor)}outputDefined(){return!1}}class mu{constructor(e){this.type=Tn,this.input=e}static parse(e,a){if(e.length!==2)return a.error("Expected two arguments.");const l=a.parse(e[1],1,xt);return l?new mu(l):a.error("No image name provided.")}evaluate(e){const a=this.input.evaluate(e),l=oe.fromString(a);return l&&e.availableImages&&(l.available=e.availableImages.indexOf(a)>-1),l}eachChild(e){e(this.input)}outputDefined(){return!1}}class gu{constructor(e){this.type=Re,this.input=e}static parse(e,a){if(e.length!==2)return a.error(`Expected 1 argument, but found ${e.length-1} instead.`);const l=a.parse(e[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${$t(l.type)} instead.`):new gu(l):null}evaluate(e){const a=this.input.evaluate(e);if(typeof a=="string"||Array.isArray(a))return a.length;throw new Ze(`Expected value to be of type string or array, but found ${$t(ge(a))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const to={"==":Xp,"!=":Yp,">":Jp,"<":Kp,">=":ef,"<=":Qp,array:dt,at:cu,boolean:dt,case:pu,coalesce:Ws,collator:Bn,format:Ks,image:mu,in:hu,"index-of":Xs,interpolate:kr,"interpolate-hcl":kr,"interpolate-lab":kr,length:gu,let:Hs,literal:et,match:du,number:dt,"number-format":fu,object:dt,slice:Ys,step:Ho,string:dt,"to-boolean":ft,"to-color":ft,"to-number":ft,"to-string":ft,var:Gs,within:ga};function lh(r,[e,a,l,d]){e=e.evaluate(r),a=a.evaluate(r),l=l.evaluate(r);const m=d?d.evaluate(r):1,y=_e(e,a,l,m);if(y)throw new Ze(y);return new U(e/255*m,a/255*m,l/255*m,m)}function uh(r,e){return r in e}function Js(r,e){const a=e[r];return a===void 0?null:a}function ya(r){return{type:r}}function ch(r){return{result:"success",value:r}}function no(r){return{result:"error",value:r}}function Jt(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function hh(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function It(r){return!!r.expression&&r.expression.interpolated}function Ft(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function Xt(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function rn(r){return r}function Jo(r,e){const a=e.type==="color",l=r.stops&&typeof r.stops[0][0]=="object",d=l||!(l||r.property!==void 0),m=r.type||(It(e)?"exponential":"interval");if(a||e.type==="padding"){const k=a?U.parse:J.parse;(r=Yr({},r)).stops&&(r.stops=r.stops.map(A=>[A[0],k(A[1])])),r.default=k(r.default?r.default:e.default)}if(r.colorSpace&&r.colorSpace!=="rgb"&&!ah[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let y,w,b;if(m==="exponential")y=dh;else if(m==="interval")y=nf;else if(m==="categorical"){y=tf,w=Object.create(null);for(const k of r.stops)w[k[0]]=k[1];b=typeof r.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);y=rf}if(l){const k={},A=[];for(let F=0;F<r.stops.length;F++){const O=r.stops[F],Y=O[0].zoom;k[Y]===void 0&&(k[Y]={zoom:Y,type:r.type,property:r.property,default:r.default,stops:[]},A.push(Y)),k[Y].stops.push([O[0].value,O[1]])}const z=[];for(const F of A)z.push([k[F].zoom,Jo(k[F],e)]);const R={name:"linear"};return{kind:"composite",interpolationType:R,interpolationFactor:kr.interpolationFactor.bind(void 0,R),zoomStops:z.map(F=>F[0]),evaluate:({zoom:F},O)=>dh({stops:z,base:r.base},e,F).evaluate(F,O)}}if(d){const k=m==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:kr.interpolationFactor.bind(void 0,k),zoomStops:r.stops.map(A=>A[0]),evaluate:({zoom:A})=>y(r,e,A,w,b)}}return{kind:"source",evaluate(k,A){const z=A&&A.properties?A.properties[r.property]:void 0;return z===void 0?ro(r.default,e.default):y(r,e,z,w,b)}}}function ro(r,e,a){return r!==void 0?r:e!==void 0?e:a!==void 0?a:void 0}function tf(r,e,a,l,d){return ro(typeof a===d?l[a]:void 0,r.default,e.default)}function nf(r,e,a){if(Ft(a)!=="number")return ro(r.default,e.default);const l=r.stops.length;if(l===1||a<=r.stops[0][0])return r.stops[0][1];if(a>=r.stops[l-1][0])return r.stops[l-1][1];const d=qs(r.stops.map(m=>m[0]),a);return r.stops[d][1]}function dh(r,e,a){const l=r.base!==void 0?r.base:1;if(Ft(a)!=="number")return ro(r.default,e.default);const d=r.stops.length;if(d===1||a<=r.stops[0][0])return r.stops[0][1];if(a>=r.stops[d-1][0])return r.stops[d-1][1];const m=qs(r.stops.map(A=>A[0]),a),y=function(A,z,R,F){const O=F-R,Y=A-R;return O===0?0:z===1?Y/O:(Math.pow(z,Y)-1)/(Math.pow(z,O)-1)}(a,l,r.stops[m][0],r.stops[m+1][0]),w=r.stops[m][1],b=r.stops[m+1][1];let k=Xo[e.type]||rn;if(r.colorSpace&&r.colorSpace!=="rgb"){const A=ah[r.colorSpace];k=(z,R)=>A.reverse(A.interpolate(A.forward(z),A.forward(R),y))}return typeof w.evaluate=="function"?{evaluate(...A){const z=w.evaluate.apply(void 0,A),R=b.evaluate.apply(void 0,A);if(z!==void 0&&R!==void 0)return k(z,R,y)}}:k(w,b,y)}function rf(r,e,a){switch(e.type){case"color":a=U.parse(a);break;case"formatted":a=te.fromString(a.toString());break;case"resolvedImage":a=oe.fromString(a.toString());break;case"padding":a=J.parse(a);break;default:Ft(a)===e.type||e.type==="enum"&&e.values[a]||(a=void 0)}return ro(a,r.default,e.default)}qt.register(to,{error:[{kind:"error"},[xt],(r,[e])=>{throw new Ze(e.evaluate(r))}],typeof:[xt,[mt],(r,[e])=>$t(ge(e.evaluate(r)))],"to-rgba":[rr(Re,4),[jn],(r,[e])=>e.evaluate(r).toArray()],rgb:[jn,[Re,Re,Re],lh],rgba:[jn,[Re,Re,Re,Re],lh],has:{type:gt,overloads:[[[xt],(r,[e])=>uh(e.evaluate(r),r.properties())],[[xt,Yi],(r,[e,a])=>uh(e.evaluate(r),a.evaluate(r))]]},get:{type:mt,overloads:[[[xt],(r,[e])=>Js(e.evaluate(r),r.properties())],[[xt,Yi],(r,[e,a])=>Js(e.evaluate(r),a.evaluate(r))]]},"feature-state":[mt,[xt],(r,[e])=>Js(e.evaluate(r),r.featureState||{})],properties:[Yi,[],r=>r.properties()],"geometry-type":[xt,[],r=>r.geometryType()],id:[mt,[],r=>r.id()],zoom:[Re,[],r=>r.globals.zoom],"heatmap-density":[Re,[],r=>r.globals.heatmapDensity||0],"line-progress":[Re,[],r=>r.globals.lineProgress||0],accumulated:[mt,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Re,ya(Re),(r,e)=>{let a=0;for(const l of e)a+=l.evaluate(r);return a}],"*":[Re,ya(Re),(r,e)=>{let a=1;for(const l of e)a*=l.evaluate(r);return a}],"-":{type:Re,overloads:[[[Re,Re],(r,[e,a])=>e.evaluate(r)-a.evaluate(r)],[[Re],(r,[e])=>-e.evaluate(r)]]},"/":[Re,[Re,Re],(r,[e,a])=>e.evaluate(r)/a.evaluate(r)],"%":[Re,[Re,Re],(r,[e,a])=>e.evaluate(r)%a.evaluate(r)],ln2:[Re,[],()=>Math.LN2],pi:[Re,[],()=>Math.PI],e:[Re,[],()=>Math.E],"^":[Re,[Re,Re],(r,[e,a])=>Math.pow(e.evaluate(r),a.evaluate(r))],sqrt:[Re,[Re],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[Re,[Re],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[Re,[Re],(r,[e])=>Math.log(e.evaluate(r))],log2:[Re,[Re],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[Re,[Re],(r,[e])=>Math.sin(e.evaluate(r))],cos:[Re,[Re],(r,[e])=>Math.cos(e.evaluate(r))],tan:[Re,[Re],(r,[e])=>Math.tan(e.evaluate(r))],asin:[Re,[Re],(r,[e])=>Math.asin(e.evaluate(r))],acos:[Re,[Re],(r,[e])=>Math.acos(e.evaluate(r))],atan:[Re,[Re],(r,[e])=>Math.atan(e.evaluate(r))],min:[Re,ya(Re),(r,e)=>Math.min(...e.map(a=>a.evaluate(r)))],max:[Re,ya(Re),(r,e)=>Math.max(...e.map(a=>a.evaluate(r)))],abs:[Re,[Re],(r,[e])=>Math.abs(e.evaluate(r))],round:[Re,[Re],(r,[e])=>{const a=e.evaluate(r);return a<0?-Math.round(-a):Math.round(a)}],floor:[Re,[Re],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[Re,[Re],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[gt,[xt,mt],(r,[e,a])=>r.properties()[e.value]===a.value],"filter-id-==":[gt,[mt],(r,[e])=>r.id()===e.value],"filter-type-==":[gt,[xt],(r,[e])=>r.geometryType()===e.value],"filter-<":[gt,[xt,mt],(r,[e,a])=>{const l=r.properties()[e.value],d=a.value;return typeof l==typeof d&&l<d}],"filter-id-<":[gt,[mt],(r,[e])=>{const a=r.id(),l=e.value;return typeof a==typeof l&&a<l}],"filter->":[gt,[xt,mt],(r,[e,a])=>{const l=r.properties()[e.value],d=a.value;return typeof l==typeof d&&l>d}],"filter-id->":[gt,[mt],(r,[e])=>{const a=r.id(),l=e.value;return typeof a==typeof l&&a>l}],"filter-<=":[gt,[xt,mt],(r,[e,a])=>{const l=r.properties()[e.value],d=a.value;return typeof l==typeof d&&l<=d}],"filter-id-<=":[gt,[mt],(r,[e])=>{const a=r.id(),l=e.value;return typeof a==typeof l&&a<=l}],"filter->=":[gt,[xt,mt],(r,[e,a])=>{const l=r.properties()[e.value],d=a.value;return typeof l==typeof d&&l>=d}],"filter-id->=":[gt,[mt],(r,[e])=>{const a=r.id(),l=e.value;return typeof a==typeof l&&a>=l}],"filter-has":[gt,[mt],(r,[e])=>e.value in r.properties()],"filter-has-id":[gt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[gt,[rr(xt)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[gt,[rr(mt)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[gt,[xt,rr(mt)],(r,[e,a])=>a.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[gt,[xt,rr(mt)],(r,[e,a])=>function(l,d,m,y){for(;m<=y;){const w=m+y>>1;if(d[w]===l)return!0;d[w]>l?y=w-1:m=w+1}return!1}(r.properties()[e.value],a.value,0,a.value.length-1)],all:{type:gt,overloads:[[[gt,gt],(r,[e,a])=>e.evaluate(r)&&a.evaluate(r)],[ya(gt),(r,e)=>{for(const a of e)if(!a.evaluate(r))return!1;return!0}]]},any:{type:gt,overloads:[[[gt,gt],(r,[e,a])=>e.evaluate(r)||a.evaluate(r)],[ya(gt),(r,e)=>{for(const a of e)if(a.evaluate(r))return!0;return!1}]]},"!":[gt,[gt],(r,[e])=>!e.evaluate(r)],"is-supported-script":[gt,[xt],(r,[e])=>{const a=r.globals&&r.globals.isSupportedScript;return!a||a(e.evaluate(r))}],upcase:[xt,[xt],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[xt,[xt],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[xt,ya(mt),(r,e)=>e.map(a=>Je(a.evaluate(r))).join("")],"resolved-locale":[xt,[Ai],(r,[e])=>e.evaluate(r).resolvedLocale()]});class Qs{constructor(e,a){this.expression=e,this._warningHistory={},this._evaluator=new Mt,this._defaultValue=a?function(l){return l.type==="color"&&Xt(l.default)?new U(0,0,0,0):l.type==="color"?U.parse(l.default)||null:l.type==="padding"?J.parse(l.default)||null:l.default===void 0?null:l.default}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(e,a,l,d,m,y){return this._evaluator.globals=e,this._evaluator.feature=a,this._evaluator.featureState=l,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(e,a,l,d,m,y){this._evaluator.globals=e,this._evaluator.feature=a||null,this._evaluator.featureState=l||null,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new Ze(`Expected value to be one of ${Object.keys(this._enumValues).map(b=>JSON.stringify(b)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function Qo(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in to}function es(r,e){const a=new Qa(to,[],e?function(d){const m={color:jn,string:xt,number:Re,enum:xt,boolean:gt,formatted:Rn,padding:Ha,resolvedImage:Tn};return d.type==="array"?rr(m[d.value]||mt,d.length):m[d.type]}(e):void 0),l=a.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?ch(new Qs(l,e)):no(a.errors)}class ts{constructor(e,a){this.kind=e,this._styleExpression=a,this.isStateDependent=e!=="constant"&&!Ja(a.expression)}evaluateWithoutErrorHandling(e,a,l,d,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,a,l,d,m,y)}evaluate(e,a,l,d,m,y){return this._styleExpression.evaluate(e,a,l,d,m,y)}}class yu{constructor(e,a,l,d){this.kind=e,this.zoomStops=l,this._styleExpression=a,this.isStateDependent=e!=="camera"&&!Ja(a.expression),this.interpolationType=d}evaluateWithoutErrorHandling(e,a,l,d,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,a,l,d,m,y)}evaluate(e,a,l,d,m,y){return this._styleExpression.evaluate(e,a,l,d,m,y)}interpolationFactor(e,a,l){return this.interpolationType?kr.interpolationFactor(this.interpolationType,e,a,l):0}}function ph(r,e){const a=es(r,e);if(a.result==="error")return a;const l=a.value.expression,d=Wo(l);if(!d&&!Jt(e))return no([new Tr("","data expressions not supported")]);const m=js(l,["zoom"]);if(!m&&!hh(e))return no([new Tr("","zoom expressions not supported")]);const y=tl(l);return y||m?y instanceof Tr?no([y]):y instanceof kr&&!It(e)?no([new Tr("",'"interpolate" expressions cannot be used with this property')]):ch(y?new yu(d?"camera":"composite",a.value,y.labels,y instanceof kr?y.interpolation:void 0):new ts(d?"constant":"source",a.value)):no([new Tr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class el{constructor(e,a){this._parameters=e,this._specification=a,Yr(this,Jo(this._parameters,this._specification))}static deserialize(e){return new el(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function tl(r){let e=null;if(r instanceof Hs)e=tl(r.result);else if(r instanceof Ws){for(const a of r.args)if(e=tl(a),e)break}else(r instanceof Ho||r instanceof kr)&&r.input instanceof qt&&r.input.name==="zoom"&&(e=r);return e instanceof Tr||r.eachChild(a=>{const l=tl(a);l instanceof Tr?e=l:!e&&l?e=new Tr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&l&&e!==l&&(e=new Tr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function Kr(r){const e=r.key,a=r.value,l=r.valueSpec||{},d=r.objectElementValidators||{},m=r.style,y=r.styleSpec;let w=[];const b=Ft(a);if(b!=="object")return[new Ne(e,a,`object expected, ${b} found`)];for(const k in a){const A=k.split(".")[0],z=l[A]||l["*"];let R;if(d[A])R=d[A];else if(l[A])R=Cr;else if(d["*"])R=d["*"];else{if(!l["*"]){w.push(new Ne(e,a[k],`unknown property "${k}"`));continue}R=Cr}w=w.concat(R({key:(e&&`${e}.`)+k,value:a[k],valueSpec:z,style:m,styleSpec:y,object:a,objectKey:k},a))}for(const k in l)d[k]||l[k].required&&l[k].default===void 0&&a[k]===void 0&&w.push(new Ne(e,a,`missing required property "${k}"`));return w}function fh(r){const e=r.value,a=r.valueSpec,l=r.style,d=r.styleSpec,m=r.key,y=r.arrayElementValidator||Cr;if(Ft(e)!=="array")return[new Ne(m,e,`array expected, ${Ft(e)} found`)];if(a.length&&e.length!==a.length)return[new Ne(m,e,`array length ${a.length} expected, length ${e.length} found`)];if(a["min-length"]&&e.length<a["min-length"])return[new Ne(m,e,`array length at least ${a["min-length"]} expected, length ${e.length} found`)];let w={type:a.value,values:a.values};d.$version<7&&(w.function=a.function),Ft(a.value)==="object"&&(w=a.value);let b=[];for(let k=0;k<e.length;k++)b=b.concat(y({array:e,arrayIndex:k,value:e[k],valueSpec:w,style:l,styleSpec:d,key:`${m}[${k}]`}));return b}function _u(r){const e=r.key,a=r.value,l=r.valueSpec;let d=Ft(a);return d==="number"&&a!=a&&(d="NaN"),d!=="number"?[new Ne(e,a,`number expected, ${d} found`)]:"minimum"in l&&a<l.minimum?[new Ne(e,a,`${a} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&a>l.maximum?[new Ne(e,a,`${a} is greater than the maximum value ${l.maximum}`)]:[]}function mh(r){const e=r.valueSpec,a=Pt(r.value.type);let l,d,m,y={};const w=a!=="categorical"&&r.value.property===void 0,b=!w,k=Ft(r.value.stops)==="array"&&Ft(r.value.stops[0])==="array"&&Ft(r.value.stops[0][0])==="object",A=Kr({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(F){if(a==="identity")return[new Ne(F.key,F.value,'identity function may not have a "stops" property')];let O=[];const Y=F.value;return O=O.concat(fh({key:F.key,value:Y,valueSpec:F.valueSpec,style:F.style,styleSpec:F.styleSpec,arrayElementValidator:z})),Ft(Y)==="array"&&Y.length===0&&O.push(new Ne(F.key,Y,"array must have at least one stop")),O},default:function(F){return Cr({key:F.key,value:F.value,valueSpec:e,style:F.style,styleSpec:F.styleSpec})}}});return a==="identity"&&w&&A.push(new Ne(r.key,r.value,'missing required property "property"')),a==="identity"||r.value.stops||A.push(new Ne(r.key,r.value,'missing required property "stops"')),a==="exponential"&&r.valueSpec.expression&&!It(r.valueSpec)&&A.push(new Ne(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(b&&!Jt(r.valueSpec)?A.push(new Ne(r.key,r.value,"property functions not supported")):w&&!hh(r.valueSpec)&&A.push(new Ne(r.key,r.value,"zoom functions not supported"))),a!=="categorical"&&!k||r.value.property!==void 0||A.push(new Ne(r.key,r.value,'"property" property is required')),A;function z(F){let O=[];const Y=F.value,H=F.key;if(Ft(Y)!=="array")return[new Ne(H,Y,`array expected, ${Ft(Y)} found`)];if(Y.length!==2)return[new Ne(H,Y,`array length 2 expected, length ${Y.length} found`)];if(k){if(Ft(Y[0])!=="object")return[new Ne(H,Y,`object expected, ${Ft(Y[0])} found`)];if(Y[0].zoom===void 0)return[new Ne(H,Y,"object stop key must have zoom")];if(Y[0].value===void 0)return[new Ne(H,Y,"object stop key must have value")];if(m&&m>Pt(Y[0].zoom))return[new Ne(H,Y[0].zoom,"stop zoom values must appear in ascending order")];Pt(Y[0].zoom)!==m&&(m=Pt(Y[0].zoom),d=void 0,y={}),O=O.concat(Kr({key:`${H}[0]`,value:Y[0],valueSpec:{zoom:{}},style:F.style,styleSpec:F.styleSpec,objectElementValidators:{zoom:_u,value:R}}))}else O=O.concat(R({key:`${H}[0]`,value:Y[0],valueSpec:{},style:F.style,styleSpec:F.styleSpec},Y));return Qo(Nr(Y[1]))?O.concat([new Ne(`${H}[1]`,Y[1],"expressions are not allowed in function stops.")]):O.concat(Cr({key:`${H}[1]`,value:Y[1],valueSpec:e,style:F.style,styleSpec:F.styleSpec}))}function R(F,O){const Y=Ft(F.value),H=Pt(F.value),ue=F.value!==null?F.value:O;if(l){if(Y!==l)return[new Ne(F.key,ue,`${Y} stop domain type must match previous stop domain type ${l}`)]}else l=Y;if(Y!=="number"&&Y!=="string"&&Y!=="boolean")return[new Ne(F.key,ue,"stop domain value must be a number, string, or boolean")];if(Y!=="number"&&a!=="categorical"){let me=`number expected, ${Y} found`;return Jt(e)&&a===void 0&&(me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ne(F.key,ue,me)]}return a!=="categorical"||Y!=="number"||isFinite(H)&&Math.floor(H)===H?a!=="categorical"&&Y==="number"&&d!==void 0&&H<d?[new Ne(F.key,ue,"stop domain values must appear in ascending order")]:(d=H,a==="categorical"&&H in y?[new Ne(F.key,ue,"stop domain values must be unique")]:(y[H]=!0,[])):[new Ne(F.key,ue,`integer expected, found ${H}`)]}}function _a(r){const e=(r.expressionContext==="property"?ph:es)(Nr(r.value),r.valueSpec);if(e.result==="error")return e.value.map(l=>new Ne(`${r.key}${l.key}`,r.value,l.message));const a=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!a.outputDefined())return[new Ne(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Ja(a))return[new Ne(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!Ja(a))return[new Ne(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!js(a,["zoom","feature-state"]))return[new Ne(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!Wo(a))return[new Ne(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ns(r){const e=r.key,a=r.value,l=r.valueSpec,d=[];return Array.isArray(l.values)?l.values.indexOf(Pt(a))===-1&&d.push(new Ne(e,a,`expected one of [${l.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(l.values).indexOf(Pt(a))===-1&&d.push(new Ne(e,a,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(a)} found`)),d}function io(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!io(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const af={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function nl(r){if(r==null)return{filter:()=>!0,needGeometry:!1};io(r)||(r=rs(r));const e=es(r,af);if(e.result==="error")throw new Error(e.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,l,d)=>e.value.evaluate(a,l,{},d),needGeometry:yh(r)}}function gh(r,e){return r<e?-1:r>e?1:0}function yh(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let e=1;e<r.length;e++)if(yh(r[e]))return!0;return!1}function rs(r){if(!r)return!0;const e=r[0];return r.length<=1?e!=="any":e==="=="?vu(r[1],r[2],"=="):e==="!="?ao(vu(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?vu(r[1],r[2],e):e==="any"?(a=r.slice(1),["any"].concat(a.map(rs))):e==="all"?["all"].concat(r.slice(1).map(rs)):e==="none"?["all"].concat(r.slice(1).map(rs).map(ao)):e==="in"?rl(r[1],r.slice(2)):e==="!in"?ao(rl(r[1],r.slice(2))):e==="has"?is(r[1]):e==="!has"?ao(is(r[1])):e!=="within"||r;var a}function vu(r,e,a){switch(r){case"$type":return[`filter-type-${a}`,e];case"$id":return[`filter-id-${a}`,e];default:return[`filter-${a}`,r,e]}}function rl(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(a=>typeof a!=typeof e[0])?["filter-in-large",r,["literal",e.sort(gh)]]:["filter-in-small",r,["literal",e]]}}function is(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function ao(r){return["!",r]}function as(r){return io(Nr(r.value))?_a(Yr({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):_h(r)}function _h(r){const e=r.value,a=r.key;if(Ft(e)!=="array")return[new Ne(a,e,`array expected, ${Ft(e)} found`)];const l=r.styleSpec;let d,m=[];if(e.length<1)return[new Ne(a,e,"filter array must have at least 1 element")];switch(m=m.concat(ns({key:`${a}[0]`,value:e[0],valueSpec:l.filter_operator,style:r.style,styleSpec:r.styleSpec})),Pt(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Pt(e[1])==="$type"&&m.push(new Ne(a,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&m.push(new Ne(a,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(d=Ft(e[1]),d!=="string"&&m.push(new Ne(`${a}[1]`,e[1],`string expected, ${d} found`)));for(let y=2;y<e.length;y++)d=Ft(e[y]),Pt(e[1])==="$type"?m=m.concat(ns({key:`${a}[${y}]`,value:e[y],valueSpec:l.geometry_type,style:r.style,styleSpec:r.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&m.push(new Ne(`${a}[${y}]`,e[y],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)m=m.concat(_h({key:`${a}[${y}]`,value:e[y],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":d=Ft(e[1]),e.length!==2?m.push(new Ne(a,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="string"&&m.push(new Ne(`${a}[1]`,e[1],`string expected, ${d} found`));break;case"within":d=Ft(e[1]),e.length!==2?m.push(new Ne(a,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="object"&&m.push(new Ne(`${a}[1]`,e[1],`object expected, ${d} found`))}return m}function os(r,e){const a=r.key,l=r.style,d=r.styleSpec,m=r.value,y=r.objectKey,w=d[`${e}_${r.layerType}`];if(!w)return[];const b=y.match(/^(.*)-transition$/);if(e==="paint"&&b&&w[b[1]]&&w[b[1]].transition)return Cr({key:a,value:m,valueSpec:d.transition,style:l,styleSpec:d});const k=r.valueSpec||w[y];if(!k)return[new Ne(a,m,`unknown property "${y}"`)];let A;if(Ft(m)==="string"&&Jt(k)&&!k.tokens&&(A=/^{([^}]+)}$/.exec(m)))return[new Ne(a,m,`"${y}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(A[1])} }\`.`)];const z=[];return r.layerType==="symbol"&&(y==="text-field"&&l&&!l.glyphs&&z.push(new Ne(a,m,'use of "text-field" requires a style "glyphs" property')),y==="text-font"&&Xt(Nr(m))&&Pt(m.type)==="identity"&&z.push(new Ne(a,m,'"text-font" does not support identity functions'))),z.concat(Cr({key:r.key,value:m,valueSpec:k,style:l,styleSpec:d,expressionContext:"property",propertyType:e,propertyKey:y}))}function vh(r){return os(r,"paint")}function xh(r){return os(r,"layout")}function wh(r){let e=[];const a=r.value,l=r.key,d=r.style,m=r.styleSpec;a.type||a.ref||e.push(new Ne(l,a,'either "type" or "ref" is required'));let y=Pt(a.type);const w=Pt(a.ref);if(a.id){const b=Pt(a.id);for(let k=0;k<r.arrayIndex;k++){const A=d.layers[k];Pt(A.id)===b&&e.push(new Ne(l,a.id,`duplicate layer id "${a.id}", previously used at line ${A.id.__line__}`))}}if("ref"in a){let b;["type","source","source-layer","filter","layout"].forEach(k=>{k in a&&e.push(new Ne(l,a[k],`"${k}" is prohibited for ref layers`))}),d.layers.forEach(k=>{Pt(k.id)===w&&(b=k)}),b?b.ref?e.push(new Ne(l,a.ref,"ref cannot reference another ref layer")):y=Pt(b.type):e.push(new Ne(l,a.ref,`ref layer "${w}" not found`))}else if(y!=="background")if(a.source){const b=d.sources&&d.sources[a.source],k=b&&Pt(b.type);b?k==="vector"&&y==="raster"?e.push(new Ne(l,a.source,`layer "${a.id}" requires a raster source`)):k==="raster"&&y!=="raster"?e.push(new Ne(l,a.source,`layer "${a.id}" requires a vector source`)):k!=="vector"||a["source-layer"]?k==="raster-dem"&&y!=="hillshade"?e.push(new Ne(l,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!a.paint||!a.paint["line-gradient"]||k==="geojson"&&b.lineMetrics||e.push(new Ne(l,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Ne(l,a,`layer "${a.id}" must specify a "source-layer"`)):e.push(new Ne(l,a.source,`source "${a.source}" not found`))}else e.push(new Ne(l,a,'missing required property "source"'));return e=e.concat(Kr({key:l,value:a,valueSpec:m.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Cr({key:`${l}.type`,value:a.type,valueSpec:m.layer.type,style:r.style,styleSpec:r.styleSpec,object:a,objectKey:"type"}),filter:as,layout:b=>Kr({layer:a,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":k=>xh(Yr({layerType:y},k))}}),paint:b=>Kr({layer:a,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":k=>vh(Yr({layerType:y},k))}})}})),e}function oo(r){const e=r.value,a=r.key,l=Ft(e);return l!=="string"?[new Ne(a,e,`string expected, ${l} found`)]:[]}const bh={promoteId:function({key:r,value:e}){if(Ft(e)==="string")return oo({key:r,value:e});{const a=[];for(const l in e)a.push(...oo({key:`${r}.${l}`,value:e[l]}));return a}}};function ss(r){const e=r.value,a=r.key,l=r.styleSpec,d=r.style;if(!e.type)return[new Ne(a,e,'"type" is required')];const m=Pt(e.type);let y;switch(m){case"vector":case"raster":case"raster-dem":return y=Kr({key:a,value:e,valueSpec:l[`source_${m.replace("-","_")}`],style:r.style,styleSpec:l,objectElementValidators:bh}),y;case"geojson":if(y=Kr({key:a,value:e,valueSpec:l.source_geojson,style:d,styleSpec:l,objectElementValidators:bh}),e.cluster)for(const w in e.clusterProperties){const[b,k]=e.clusterProperties[w],A=typeof b=="string"?[b,["accumulated"],["get",w]]:b;y.push(..._a({key:`${a}.${w}.map`,value:k,expressionContext:"cluster-map"})),y.push(..._a({key:`${a}.${w}.reduce`,value:A,expressionContext:"cluster-reduce"}))}return y;case"video":return Kr({key:a,value:e,valueSpec:l.source_video,style:d,styleSpec:l});case"image":return Kr({key:a,value:e,valueSpec:l.source_image,style:d,styleSpec:l});case"canvas":return[new Ne(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ns({key:`${a}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:d,styleSpec:l})}}function ls(r){const e=r.value,a=r.styleSpec,l=a.light,d=r.style;let m=[];const y=Ft(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new Ne("light",e,`object expected, ${y} found`)]),m;for(const w in e){const b=w.match(/^(.*)-transition$/);m=m.concat(b&&l[b[1]]&&l[b[1]].transition?Cr({key:w,value:e[w],valueSpec:a.transition,style:d,styleSpec:a}):l[w]?Cr({key:w,value:e[w],valueSpec:l[w],style:d,styleSpec:a}):[new Ne(w,e[w],`unknown property "${w}"`)])}return m}function Ir(r){const e=r.value,a=r.styleSpec,l=a.terrain,d=r.style;let m=[];const y=Ft(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new Ne("terrain",e,`object expected, ${y} found`)]),m;for(const w in e)m=m.concat(l[w]?Cr({key:w,value:e[w],valueSpec:l[w],style:d,styleSpec:a}):[new Ne(w,e[w],`unknown property "${w}"`)]);return m}const us={"*":()=>[],array:fh,boolean:function(r){const e=r.value,a=r.key,l=Ft(e);return l!=="boolean"?[new Ne(a,e,`boolean expected, ${l} found`)]:[]},number:_u,color:function(r){const e=r.key,a=r.value,l=Ft(a);return l!=="string"?[new Ne(e,a,`color expected, ${l} found`)]:Ya(a)===null?[new Ne(e,a,`color expected, "${a}" found`)]:[]},constants:da,enum:ns,filter:as,function:mh,layer:wh,object:Kr,source:ss,light:ls,terrain:Ir,string:oo,formatted:function(r){return oo(r).length===0?[]:_a(r)},resolvedImage:function(r){return oo(r).length===0?[]:_a(r)},padding:function(r){const e=r.key,a=r.value;if(Ft(a)==="array"){if(a.length<1||a.length>4)return[new Ne(e,a,`padding requires 1 to 4 values; ${a.length} values found`)];const l={type:"number"};let d=[];for(let m=0;m<a.length;m++)d=d.concat(Cr({key:`${e}[${m}]`,value:a[m],valueSpec:l}));return d}return _u({key:e,value:a,valueSpec:{}})}};function Cr(r){const e=r.value,a=r.valueSpec,l=r.styleSpec;return a.expression&&Xt(Pt(e))?mh(r):a.expression&&Qo(Nr(e))?_a(r):a.type&&us[a.type]?us[a.type](r):Kr(Yr({},r,{valueSpec:a.type?l[a.type]:a}))}function of(r){const e=r.value,a=r.key,l=oo(r);return l.length||(e.indexOf("{fontstack}")===-1&&l.push(new Ne(a,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&l.push(new Ne(a,e,'"glyphs" url must include a "{range}" token'))),l}function Ki(r,e=Te){let a=[];return a=a.concat(Cr({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,objectElementValidators:{glyphs:of,"*":()=>[]}})),r.constants&&(a=a.concat(da({key:"constants",value:r.constants,style:r,styleSpec:e}))),Sh(a)}function Sh(r){return[].concat(r).sort((e,a)=>e.line-a.line)}function Pi(r){return function(...e){return Sh(r.apply(this,e))}}Ki.source=Pi(ss),Ki.light=Pi(ls),Ki.terrain=Pi(Ir),Ki.layer=Pi(wh),Ki.filter=Pi(as),Ki.paintProperty=Pi(vh),Ki.layoutProperty=Pi(xh);const cs=Ki,xu=cs.light,sf=cs.paintProperty,lf=cs.layoutProperty;function il(r,e){let a=!1;if(e&&e.length)for(const l of e)r.fire(new Wa(new Error(l.message))),a=!0;return a}class hs{constructor(e,a,l){const d=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const y=new Int32Array(this.arrayBuffer);e=y[0],this.d=(a=y[1])+2*(l=y[2]);for(let b=0;b<this.d*this.d;b++){const k=y[3+b],A=y[3+b+1];d.push(k===A?null:y.subarray(k,A))}const w=y[3+d.length+1];this.keys=y.subarray(y[3+d.length],w),this.bboxes=y.subarray(w),this.insert=this._insertReadonly}else{this.d=a+2*l;for(let y=0;y<this.d*this.d;y++)d.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=e,this.padding=l,this.scale=a/e,this.uid=0;const m=l/a*e;this.min=-m,this.max=e+m}insert(e,a,l,d,m){this._forEachCell(a,l,d,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(a),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,a,l,d,m,y){this.cells[m].push(y)}query(e,a,l,d,m){const y=this.min,w=this.max;if(e<=y&&a<=y&&w<=l&&w<=d&&!m)return Array.prototype.slice.call(this.keys);{const b=[];return this._forEachCell(e,a,l,d,this._queryCell,b,{},m),b}}_queryCell(e,a,l,d,m,y,w,b){const k=this.cells[m];if(k!==null){const A=this.keys,z=this.bboxes;for(let R=0;R<k.length;R++){const F=k[R];if(w[F]===void 0){const O=4*F;(b?b(z[O+0],z[O+1],z[O+2],z[O+3]):e<=z[O+2]&&a<=z[O+3]&&l>=z[O+0]&&d>=z[O+1])?(w[F]=!0,y.push(A[F])):w[F]=!1}}}}_forEachCell(e,a,l,d,m,y,w,b){const k=this._convertToCellCoord(e),A=this._convertToCellCoord(a),z=this._convertToCellCoord(l),R=this._convertToCellCoord(d);for(let F=k;F<=z;F++)for(let O=A;O<=R;O++){const Y=this.d*O+F;if((!b||b(this._convertFromCellCoord(F),this._convertFromCellCoord(O),this._convertFromCellCoord(F+1),this._convertFromCellCoord(O+1)))&&m.call(this,e,a,l,d,Y,y,w,b))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,a=3+this.cells.length+1+1;let l=0;for(let y=0;y<this.cells.length;y++)l+=this.cells[y].length;const d=new Int32Array(a+l+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let m=a;for(let y=0;y<e.length;y++){const w=e[y];d[3+y]=m,d.set(w,m),m+=w.length}return d[3+e.length]=m,d.set(this.keys,m),m+=this.keys.length,d[3+e.length+1]=m,d.set(this.bboxes,m),m+=this.bboxes.length,d.buffer}static serialize(e,a){const l=e.toArrayBuffer();return a&&a.push(l),{buffer:l}}static deserialize(e){return new hs(e.buffer)}}const zi={};function Ye(r,e,a={}){if(zi[r])throw new Error(`${r} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:r,writeable:!1}),zi[r]={klass:e,omit:a.omit||[],shallow:a.shallow||[]}}Ye("Object",Object),Ye("TransferableGridIndex",hs),Ye("Color",U),Ye("Error",Error),Ye("AJAXError",Sr),Ye("ResolvedImage",oe),Ye("StylePropertyFunction",el),Ye("StyleExpression",Qs,{omit:["_evaluator"]}),Ye("ZoomDependentExpression",yu),Ye("ZoomConstantExpression",ts),Ye("CompoundExpression",qt,{omit:["_evaluate"]});for(const r in to)to[r]._classRegistryKey||Ye(`Expression_${r}`,to[r]);function Th(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function va(r,e){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob)return r;if(Th(r)||cn(r))return e&&e.push(r),r;if(ArrayBuffer.isView(r)){const a=r;return e&&e.push(a.buffer),a}if(r instanceof ImageData)return e&&e.push(r.data.buffer),r;if(Array.isArray(r)){const a=[];for(const l of r)a.push(va(l,e));return a}if(typeof r=="object"){const a=r.constructor,l=a._classRegistryKey;if(!l)throw new Error("can't serialize object of unregistered class");if(!zi[l])throw new Error(`${l} is not registered.`);const d=a.serialize?a.serialize(r,e):{};if(a.serialize){if(e&&d===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in r){if(!r.hasOwnProperty(m)||zi[l].omit.indexOf(m)>=0)continue;const y=r[m];d[m]=zi[l].shallow.indexOf(m)>=0?y:va(y,e)}r instanceof Error&&(d.message=r.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(d.$name=l),d}throw new Error("can't serialize object of type "+typeof r)}function Ji(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||Th(r)||cn(r)||ArrayBuffer.isView(r)||r instanceof ImageData)return r;if(Array.isArray(r))return r.map(Ji);if(typeof r=="object"){const e=r.$name||"Object";if(!zi[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:a}=zi[e];if(!a)throw new Error(`can't deserialize unregistered class ${e}`);if(a.deserialize)return a.deserialize(r);const l=Object.create(a.prototype);for(const d of Object.keys(r)){if(d==="$name")continue;const m=r[d];l[d]=zi[e].shallow.indexOf(d)>=0?m:Ji(m)}return l}throw new Error("can't deserialize object of type "+typeof r)}class wu{constructor(){this.first=!0}update(e,a){const l=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=a),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=l,!0))}}const je={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function al(r){for(const e of r)if(Su(e.charCodeAt(0)))return!0;return!1}function uf(r){for(const e of r)if(!bu(e.charCodeAt(0)))return!1;return!0}function bu(r){return!(je.Arabic(r)||je["Arabic Supplement"](r)||je["Arabic Extended-A"](r)||je["Arabic Presentation Forms-A"](r)||je["Arabic Presentation Forms-B"](r))}function Su(r){return!(r!==746&&r!==747&&(r<4352||!(je["Bopomofo Extended"](r)||je.Bopomofo(r)||je["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||je["CJK Compatibility Ideographs"](r)||je["CJK Compatibility"](r)||je["CJK Radicals Supplement"](r)||je["CJK Strokes"](r)||!(!je["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||je["CJK Unified Ideographs Extension A"](r)||je["CJK Unified Ideographs"](r)||je["Enclosed CJK Letters and Months"](r)||je["Hangul Compatibility Jamo"](r)||je["Hangul Jamo Extended-A"](r)||je["Hangul Jamo Extended-B"](r)||je["Hangul Jamo"](r)||je["Hangul Syllables"](r)||je.Hiragana(r)||je["Ideographic Description Characters"](r)||je.Kanbun(r)||je["Kangxi Radicals"](r)||je["Katakana Phonetic Extensions"](r)||je.Katakana(r)&&r!==12540||!(!je["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!je["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||je["Unified Canadian Aboriginal Syllabics"](r)||je["Unified Canadian Aboriginal Syllabics Extended"](r)||je["Vertical Forms"](r)||je["Yijing Hexagram Symbols"](r)||je["Yi Syllables"](r)||je["Yi Radicals"](r))))}function Eh(r){return!(Su(r)||function(e){return!!(je["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||je["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||je["Letterlike Symbols"](e)||je["Number Forms"](e)||je["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||je["Control Pictures"](e)&&e!==9251||je["Optical Character Recognition"](e)||je["Enclosed Alphanumerics"](e)||je["Geometric Shapes"](e)||je["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||je["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||je["CJK Symbols and Punctuation"](e)||je.Katakana(e)||je["Private Use Area"](e)||je["CJK Compatibility Forms"](e)||je["Small Form Variants"](e)||je["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(r))}function kh(r){return r>=1424&&r<=2303||je["Arabic Presentation Forms-A"](r)||je["Arabic Presentation Forms-B"](r)}function cf(r,e){return!(!e&&kh(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||je.Khmer(r))}function Ih(r){for(const e of r)if(kh(e.charCodeAt(0)))return!0;return!1}const Tu="deferred",Eu="loading",ku="loaded";let Iu=null,pr="unavailable",Qi=null;const Ch=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(pr="error"),Iu&&Iu(r)};function so(){Cu.fire(new Ii("pluginStateChange",{pluginStatus:pr,pluginURL:Qi}))}const Cu=new Ci,ds=function(){return pr},Ah=function(){if(pr!==Tu||!Qi)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");pr=Eu,so(),Qi&&Za({url:Qi},r=>{r?Ch(r):(pr=ku,so())})},Ur={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>pr===ku||Ur.applyArabicShaping!=null,isLoading:()=>pr===Eu,setState(r){if(!Le())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");pr=r.pluginStatus,Qi=r.pluginURL},isParsed(){if(!Le())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Ur.applyArabicShaping!=null&&Ur.processBidirectionalText!=null&&Ur.processStyledBidirectionalText!=null},getPluginURL(){if(!Le())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Qi}};class an{constructor(e,a){this.zoom=e,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new wu,this.transition={})}isSupportedScript(e){return function(a,l){for(const d of a)if(!cf(d.charCodeAt(0),l))return!1;return!0}(e,Ur.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,a=e-Math.floor(e),l=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*a}}}class ps{constructor(e,a){this.property=e,this.value=a,this.expression=function(l,d){if(Xt(l))return new el(l,d);if(Qo(l)){const m=ph(l,d);if(m.result==="error")throw new Error(m.value.map(y=>`${y.key}: ${y.message}`).join(", "));return m.value}{let m=l;return d.type==="color"&&typeof l=="string"?m=U.parse(l):d.type!=="padding"||typeof l!="number"&&!Array.isArray(l)||(m=J.parse(l)),{kind:"constant",evaluate:()=>m}}}(a===void 0?e.specification.default:a,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,a,l){return this.property.possiblyEvaluate(this,e,a,l)}}class ol{constructor(e){this.property=e,this.value=new ps(e,void 0)}transitioned(e,a){return new zh(this.property,this.value,a,be({},e.transition,this.transition),e.now)}untransitioned(){return new zh(this.property,this.value,null,{},0)}}class Ph{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return ie(this._values[e].value.value)}setValue(e,a){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new ol(this._values[e].property)),this._values[e].value=new ps(this._values[e].property,a===null?void 0:ie(a))}getTransition(e){return ie(this._values[e].transition)}setTransition(e,a){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new ol(this._values[e].property)),this._values[e].transition=ie(a)||void 0}serialize(){const e={};for(const a of Object.keys(this._values)){const l=this.getValue(a);l!==void 0&&(e[a]=l);const d=this.getTransition(a);d!==void 0&&(e[`${a}-transition`]=d)}return e}transitioned(e,a){const l=new Mh(this._properties);for(const d of Object.keys(this._values))l._values[d]=this._values[d].transitioned(e,a._values[d]);return l}untransitioned(){const e=new Mh(this._properties);for(const a of Object.keys(this._values))e._values[a]=this._values[a].untransitioned();return e}}class zh{constructor(e,a,l,d,m){this.property=e,this.value=a,this.begin=m+d.delay||0,this.end=this.begin+d.duration||0,e.specification.transition&&(d.delay||d.duration)&&(this.prior=l)}possiblyEvaluate(e,a,l){const d=e.now||0,m=this.value.possiblyEvaluate(e,a,l),y=this.prior;if(y){if(d>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(d<this.begin)return y.possiblyEvaluate(e,a,l);{const w=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(e,a,l),m,function(b){if(b<=0)return 0;if(b>=1)return 1;const k=b*b,A=k*b;return 4*(b<.5?A:3*(b-k)+A-.75)}(w))}}return m}}class Mh{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,a,l){const d=new fs(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(e,a,l);return d}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class hf{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return ie(this._values[e].value)}setValue(e,a){this._values[e]=new ps(this._values[e].property,a===null?void 0:ie(a))}serialize(){const e={};for(const a of Object.keys(this._values)){const l=this.getValue(a);l!==void 0&&(e[a]=l)}return e}possiblyEvaluate(e,a,l){const d=new fs(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(e,a,l);return d}}class pi{constructor(e,a,l){this.property=e,this.value=a,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,a,l,d){return this.property.evaluate(this.value,this.parameters,e,a,l,d)}}class fs{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class tt{constructor(e){this.specification=e}possiblyEvaluate(e,a){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(a)}interpolate(e,a,l){const d=Xo[this.specification.type];return d?d(e,a,l):e}}class ct{constructor(e,a){this.specification=e,this.overrides=a}possiblyEvaluate(e,a,l,d){return new pi(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(a,null,{},l,d)}:e.expression,a)}interpolate(e,a,l){if(e.value.kind!=="constant"||a.value.kind!=="constant")return e;if(e.value.value===void 0||a.value.value===void 0)return new pi(this,{kind:"constant",value:void 0},e.parameters);const d=Xo[this.specification.type];return d?new pi(this,{kind:"constant",value:d(e.value.value,a.value.value,l)},e.parameters):e}evaluate(e,a,l,d,m,y){return e.kind==="constant"?e.value:e.evaluate(a,l,d,m,y)}}class lo extends ct{possiblyEvaluate(e,a,l,d){if(e.value===void 0)return new pi(this,{kind:"constant",value:void 0},a);if(e.expression.kind==="constant"){const m=e.expression.evaluate(a,null,{},l,d),y=e.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,w=this._calculate(y,y,y,a);return new pi(this,{kind:"constant",value:w},a)}if(e.expression.kind==="camera"){const m=this._calculate(e.expression.evaluate({zoom:a.zoom-1}),e.expression.evaluate({zoom:a.zoom}),e.expression.evaluate({zoom:a.zoom+1}),a);return new pi(this,{kind:"constant",value:m},a)}return new pi(this,e.expression,a)}evaluate(e,a,l,d,m,y){if(e.kind==="source"){const w=e.evaluate(a,l,d,m,y);return this._calculate(w,w,w,a)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(a.zoom)-1},l,d),e.evaluate({zoom:Math.floor(a.zoom)},l,d),e.evaluate({zoom:Math.floor(a.zoom)+1},l,d),a):e.value}_calculate(e,a,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:a}:{from:l,to:a}}interpolate(e){return e}}class Au{constructor(e){this.specification=e}possiblyEvaluate(e,a,l,d){if(e.value!==void 0){if(e.expression.kind==="constant"){const m=e.expression.evaluate(a,null,{},l,d);return this._calculate(m,m,m,a)}return this._calculate(e.expression.evaluate(new an(Math.floor(a.zoom-1),a)),e.expression.evaluate(new an(Math.floor(a.zoom),a)),e.expression.evaluate(new an(Math.floor(a.zoom+1),a)),a)}}_calculate(e,a,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:a}:{from:l,to:a}}interpolate(e){return e}}class ea{constructor(e){this.specification=e}possiblyEvaluate(e,a,l,d){return!!e.expression.evaluate(a,null,{},l,d)}interpolate(){return!1}}class Gn{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in e){const l=e[a];l.specification.overridable&&this.overridableProperties.push(a);const d=this.defaultPropertyValues[a]=new ps(l,void 0),m=this.defaultTransitionablePropertyValues[a]=new ol(l);this.defaultTransitioningPropertyValues[a]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=d.possiblyEvaluate({})}}}Ye("DataDrivenProperty",ct),Ye("DataConstantProperty",tt),Ye("CrossFadedDataDrivenProperty",lo),Ye("CrossFadedProperty",Au),Ye("ColorRampProperty",ea);const ta="-transition";class fi extends Ci{constructor(e,a){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),a.layout&&(this._unevaluatedLayout=new hf(a.layout)),a.paint)){this._transitionablePaint=new Ph(a.paint);for(const l in e.paint)this.setPaintProperty(l,e.paint[l],{validate:!1});for(const l in e.layout)this.setLayoutProperty(l,e.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new fs(a.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,a,l={}){a!=null&&this._validate(lf,`layers.${this.id}.layout.${e}`,e,a,l)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,a):this.visibility=a)}getPaintProperty(e){return e.endsWith(ta)?this._transitionablePaint.getTransition(e.slice(0,-ta.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,a,l={}){if(a!=null&&this._validate(sf,`layers.${this.id}.paint.${e}`,e,a,l))return!1;if(e.endsWith(ta))return this._transitionablePaint.setTransition(e.slice(0,-ta.length),a||void 0),!1;{const d=this._transitionablePaint._values[e],m=d.property.specification["property-type"]==="cross-faded-data-driven",y=d.value.isDataDriven(),w=d.value;this._transitionablePaint.setValue(e,a),this._handleSpecialPaintPropertyUpdate(e);const b=this._transitionablePaint._values[e].value;return b.isDataDriven()||y||m||this._handleOverridablePaintPropertyUpdate(e,w,b)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,a,l){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,a){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,a)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),X(e,(a,l)=>!(a===void 0||l==="layout"&&!Object.keys(a).length||l==="paint"&&!Object.keys(a).length))}_validate(e,a,l,d,m={}){return(!m||m.validate!==!1)&&il(this,e.call(cs,{key:a,layerType:this.type,objectKey:l,value:d,styleSpec:Te,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const a=this.paint.get(e);if(a instanceof pi&&Jt(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const Dh={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class na{constructor(e,a){this._structArray=e,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class gn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,a){return e._trim(),a&&(e.isTransferred=!0,a.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const a=Object.create(this.prototype);return a.arrayBuffer=e.arrayBuffer,a.length=e.length,a.capacity=e.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function En(r,e=1){let a=0,l=0;return{members:r.map(d=>{const m=Dh[d.type].BYTES_PER_ELEMENT,y=a=Pu(a,Math.max(e,m)),w=d.components||1;return l=Math.max(l,m),a+=m*w,{name:d.name,type:d.type,components:w,offset:y}}),size:Pu(a,Math.max(l,e)),alignment:e}}function Pu(r,e){return Math.ceil(r/e)*e}class xa extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,a){const l=this.length;return this.resize(l+1),this.emplace(l,e,a)}emplace(e,a,l){const d=2*e;return this.int16[d+0]=a,this.int16[d+1]=l,e}}xa.prototype.bytesPerElement=4,Ye("StructArrayLayout2i4",xa);class h extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,a,l,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,a,l,d)}emplace(e,a,l,d,m){const y=4*e;return this.int16[y+0]=a,this.int16[y+1]=l,this.int16[y+2]=d,this.int16[y+3]=m,e}}h.prototype.bytesPerElement=8,Ye("StructArrayLayout4i8",h);class n extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,a,l,d,m,y){const w=this.length;return this.resize(w+1),this.emplace(w,e,a,l,d,m,y)}emplace(e,a,l,d,m,y,w){const b=6*e;return this.int16[b+0]=a,this.int16[b+1]=l,this.int16[b+2]=d,this.int16[b+3]=m,this.int16[b+4]=y,this.int16[b+5]=w,e}}n.prototype.bytesPerElement=12,Ye("StructArrayLayout2i4i12",n);class o extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,a,l,d,m,y){const w=this.length;return this.resize(w+1),this.emplace(w,e,a,l,d,m,y)}emplace(e,a,l,d,m,y,w){const b=4*e,k=8*e;return this.int16[b+0]=a,this.int16[b+1]=l,this.uint8[k+4]=d,this.uint8[k+5]=m,this.uint8[k+6]=y,this.uint8[k+7]=w,e}}o.prototype.bytesPerElement=8,Ye("StructArrayLayout2i4ub8",o);class c extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,a){const l=this.length;return this.resize(l+1),this.emplace(l,e,a)}emplace(e,a,l){const d=2*e;return this.float32[d+0]=a,this.float32[d+1]=l,e}}c.prototype.bytesPerElement=8,Ye("StructArrayLayout2f8",c);class p extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,a,l,d,m,y,w,b,k,A){const z=this.length;return this.resize(z+1),this.emplace(z,e,a,l,d,m,y,w,b,k,A)}emplace(e,a,l,d,m,y,w,b,k,A,z){const R=10*e;return this.uint16[R+0]=a,this.uint16[R+1]=l,this.uint16[R+2]=d,this.uint16[R+3]=m,this.uint16[R+4]=y,this.uint16[R+5]=w,this.uint16[R+6]=b,this.uint16[R+7]=k,this.uint16[R+8]=A,this.uint16[R+9]=z,e}}p.prototype.bytesPerElement=20,Ye("StructArrayLayout10ui20",p);class g extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,a,l,d,m,y,w,b,k,A,z,R){const F=this.length;return this.resize(F+1),this.emplace(F,e,a,l,d,m,y,w,b,k,A,z,R)}emplace(e,a,l,d,m,y,w,b,k,A,z,R,F){const O=12*e;return this.int16[O+0]=a,this.int16[O+1]=l,this.int16[O+2]=d,this.int16[O+3]=m,this.uint16[O+4]=y,this.uint16[O+5]=w,this.uint16[O+6]=b,this.uint16[O+7]=k,this.int16[O+8]=A,this.int16[O+9]=z,this.int16[O+10]=R,this.int16[O+11]=F,e}}g.prototype.bytesPerElement=24,Ye("StructArrayLayout4i4ui4i24",g);class x extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,a,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,a,l)}emplace(e,a,l,d){const m=3*e;return this.float32[m+0]=a,this.float32[m+1]=l,this.float32[m+2]=d,e}}x.prototype.bytesPerElement=12,Ye("StructArrayLayout3f12",x);class S extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const a=this.length;return this.resize(a+1),this.emplace(a,e)}emplace(e,a){return this.uint32[1*e+0]=a,e}}S.prototype.bytesPerElement=4,Ye("StructArrayLayout1ul4",S);class E extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,a,l,d,m,y,w,b,k){const A=this.length;return this.resize(A+1),this.emplace(A,e,a,l,d,m,y,w,b,k)}emplace(e,a,l,d,m,y,w,b,k,A){const z=10*e,R=5*e;return this.int16[z+0]=a,this.int16[z+1]=l,this.int16[z+2]=d,this.int16[z+3]=m,this.int16[z+4]=y,this.int16[z+5]=w,this.uint32[R+3]=b,this.uint16[z+8]=k,this.uint16[z+9]=A,e}}E.prototype.bytesPerElement=20,Ye("StructArrayLayout6i1ul2ui20",E);class I extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,a,l,d,m,y){const w=this.length;return this.resize(w+1),this.emplace(w,e,a,l,d,m,y)}emplace(e,a,l,d,m,y,w){const b=6*e;return this.int16[b+0]=a,this.int16[b+1]=l,this.int16[b+2]=d,this.int16[b+3]=m,this.int16[b+4]=y,this.int16[b+5]=w,e}}I.prototype.bytesPerElement=12,Ye("StructArrayLayout2i2i2i12",I);class P extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,a,l,d,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,a,l,d,m)}emplace(e,a,l,d,m,y){const w=4*e,b=8*e;return this.float32[w+0]=a,this.float32[w+1]=l,this.float32[w+2]=d,this.int16[b+6]=m,this.int16[b+7]=y,e}}P.prototype.bytesPerElement=16,Ye("StructArrayLayout2f1f2i16",P);class D extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,a,l,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,a,l,d)}emplace(e,a,l,d,m){const y=12*e,w=3*e;return this.uint8[y+0]=a,this.uint8[y+1]=l,this.float32[w+1]=d,this.float32[w+2]=m,e}}D.prototype.bytesPerElement=12,Ye("StructArrayLayout2ub2f12",D);class B extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,a,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,a,l)}emplace(e,a,l,d){const m=3*e;return this.uint16[m+0]=a,this.uint16[m+1]=l,this.uint16[m+2]=d,e}}B.prototype.bytesPerElement=6,Ye("StructArrayLayout3ui6",B);class Z extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,a,l,d,m,y,w,b,k,A,z,R,F,O,Y,H,ue){const me=this.length;return this.resize(me+1),this.emplace(me,e,a,l,d,m,y,w,b,k,A,z,R,F,O,Y,H,ue)}emplace(e,a,l,d,m,y,w,b,k,A,z,R,F,O,Y,H,ue,me){const le=24*e,de=12*e,Ie=48*e;return this.int16[le+0]=a,this.int16[le+1]=l,this.uint16[le+2]=d,this.uint16[le+3]=m,this.uint32[de+2]=y,this.uint32[de+3]=w,this.uint32[de+4]=b,this.uint16[le+10]=k,this.uint16[le+11]=A,this.uint16[le+12]=z,this.float32[de+7]=R,this.float32[de+8]=F,this.uint8[Ie+36]=O,this.uint8[Ie+37]=Y,this.uint8[Ie+38]=H,this.uint32[de+10]=ue,this.int16[le+22]=me,e}}Z.prototype.bytesPerElement=48,Ye("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Z);class j extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,a,l,d,m,y,w,b,k,A,z,R,F,O,Y,H,ue,me,le,de,Ie,ke,Xe,Qe,Ge,Fe,De,qe){const Ue=this.length;return this.resize(Ue+1),this.emplace(Ue,e,a,l,d,m,y,w,b,k,A,z,R,F,O,Y,H,ue,me,le,de,Ie,ke,Xe,Qe,Ge,Fe,De,qe)}emplace(e,a,l,d,m,y,w,b,k,A,z,R,F,O,Y,H,ue,me,le,de,Ie,ke,Xe,Qe,Ge,Fe,De,qe,Ue){const Pe=34*e,ot=17*e;return this.int16[Pe+0]=a,this.int16[Pe+1]=l,this.int16[Pe+2]=d,this.int16[Pe+3]=m,this.int16[Pe+4]=y,this.int16[Pe+5]=w,this.int16[Pe+6]=b,this.int16[Pe+7]=k,this.uint16[Pe+8]=A,this.uint16[Pe+9]=z,this.uint16[Pe+10]=R,this.uint16[Pe+11]=F,this.uint16[Pe+12]=O,this.uint16[Pe+13]=Y,this.uint16[Pe+14]=H,this.uint16[Pe+15]=ue,this.uint16[Pe+16]=me,this.uint16[Pe+17]=le,this.uint16[Pe+18]=de,this.uint16[Pe+19]=Ie,this.uint16[Pe+20]=ke,this.uint16[Pe+21]=Xe,this.uint16[Pe+22]=Qe,this.uint32[ot+12]=Ge,this.float32[ot+13]=Fe,this.float32[ot+14]=De,this.float32[ot+15]=qe,this.float32[ot+16]=Ue,e}}j.prototype.bytesPerElement=68,Ye("StructArrayLayout8i15ui1ul4f68",j);class G extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const a=this.length;return this.resize(a+1),this.emplace(a,e)}emplace(e,a){return this.float32[1*e+0]=a,e}}G.prototype.bytesPerElement=4,Ye("StructArrayLayout1f4",G);class re extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,a,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,a,l)}emplace(e,a,l,d){const m=3*e;return this.int16[m+0]=a,this.int16[m+1]=l,this.int16[m+2]=d,e}}re.prototype.bytesPerElement=6,Ye("StructArrayLayout3i6",re);class se extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,a,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,a,l)}emplace(e,a,l,d){const m=4*e;return this.uint32[2*e+0]=a,this.uint16[m+2]=l,this.uint16[m+3]=d,e}}se.prototype.bytesPerElement=8,Ye("StructArrayLayout1ul2ui8",se);class ce extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,a){const l=this.length;return this.resize(l+1),this.emplace(l,e,a)}emplace(e,a,l){const d=2*e;return this.uint16[d+0]=a,this.uint16[d+1]=l,e}}ce.prototype.bytesPerElement=4,Ye("StructArrayLayout2ui4",ce);class W extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const a=this.length;return this.resize(a+1),this.emplace(a,e)}emplace(e,a){return this.uint16[1*e+0]=a,e}}W.prototype.bytesPerElement=2,Ye("StructArrayLayout1ui2",W);class fe extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,a,l,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,a,l,d)}emplace(e,a,l,d,m){const y=4*e;return this.float32[y+0]=a,this.float32[y+1]=l,this.float32[y+2]=d,this.float32[y+3]=m,e}}fe.prototype.bytesPerElement=16,Ye("StructArrayLayout4f16",fe);class he extends na{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Ke(this.anchorPointX,this.anchorPointY)}}he.prototype.size=20;class we extends E{get(e){return new he(this,e)}}Ye("CollisionBoxArray",we);class Se extends na{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Se.prototype.size=48;class Ae extends Z{get(e){return new Se(this,e)}}Ye("PlacedSymbolArray",Ae);class ve extends na{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}ve.prototype.size=68;class We extends j{get(e){return new ve(this,e)}}Ye("SymbolInstanceArray",We);class Be extends G{getoffsetX(e){return this.float32[1*e+0]}}Ye("GlyphOffsetArray",Be);class He extends re{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Ye("SymbolLineVertexArray",He);class yt extends na{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}yt.prototype.size=8;class bt extends se{get(e){return new yt(this,e)}}Ye("FeatureIndexArray",bt);class at extends xa{}class Nt extends xa{}class Ut extends xa{}class Ct extends n{}class Dt extends o{}class jt extends c{}class Fn extends p{}class mi extends g{}class Jr extends x{}class gi extends S{}class ra extends I{}class Vr extends D{}class fr extends B{}class Mi extends ce{}const sl=En([{name:"a_pos",components:2,type:"Int16"}],4),{members:Pn}=sl;class Et{constructor(e=[]){this.segments=e}prepareSegment(e,a,l,d){let m=this.segments[this.segments.length-1];return e>Et.MAX_VERTEX_ARRAY_LENGTH&&Ee(`Max vertices per segment is ${Et.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!m||m.vertexLength+e>Et.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==d)&&(m={vertexOffset:a.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},d!==void 0&&(m.sortKey=d),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const e of this.segments)for(const a in e.vaos)e.vaos[a].destroy()}static simpleSegment(e,a,l,d){return new Et([{vertexOffset:e,primitiveOffset:a,vertexLength:l,primitiveLength:d,vaos:{},sortKey:0}])}}function Ot(r,e){return 256*(r=V(Math.floor(r),0,255))+V(Math.floor(e),0,255)}Et.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ye("SegmentVector",Et);const On=En([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Nn={exports:{}},on={exports:{}};on.exports=function(r,e){var a,l,d,m,y,w,b,k;for(l=r.length-(a=3&r.length),d=e,y=3432918353,w=461845907,k=0;k<l;)b=255&r.charCodeAt(k)|(255&r.charCodeAt(++k))<<8|(255&r.charCodeAt(++k))<<16|(255&r.charCodeAt(++k))<<24,++k,d=27492+(65535&(m=5*(65535&(d=(d^=b=(65535&(b=(b=(65535&b)*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*w+(((b>>>16)*w&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(b=0,a){case 3:b^=(255&r.charCodeAt(k+2))<<16;case 2:b^=(255&r.charCodeAt(k+1))<<8;case 1:d^=b=(65535&(b=(b=(65535&(b^=255&r.charCodeAt(k)))*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*w+(((b>>>16)*w&65535)<<16)&4294967295}return d^=r.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0};var $r={exports:{}};$r.exports=function(r,e){for(var a,l=r.length,d=e^l,m=0;l>=4;)a=1540483477*(65535&(a=255&r.charCodeAt(m)|(255&r.charCodeAt(++m))<<8|(255&r.charCodeAt(++m))<<16|(255&r.charCodeAt(++m))<<24))+((1540483477*(a>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),l-=4,++m;switch(l){case 3:d^=(255&r.charCodeAt(m+2))<<16;case 2:d^=(255&r.charCodeAt(m+1))<<8;case 1:d=1540483477*(65535&(d^=255&r.charCodeAt(m)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};var wa=on.exports,zu=$r.exports;Nn.exports=wa,Nn.exports.murmur3=wa,Nn.exports.murmur2=zu;class uo{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,a,l,d){this.ids.push(Lh(e)),this.positions.push(a,l,d)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=Lh(e);let l=0,d=this.ids.length-1;for(;l<d;){const y=l+d>>1;this.ids[y]>=a?d=y:l=y+1}const m=[];for(;this.ids[l]===a;)m.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return m}static serialize(e,a){const l=new Float64Array(e.ids),d=new Uint32Array(e.positions);return Mu(l,d,0,l.length-1),a&&a.push(l.buffer,d.buffer),{ids:l,positions:d}}static deserialize(e){const a=new uo;return a.ids=e.ids,a.positions=e.positions,a.indexed=!0,a}}function Lh(r){const e=+r;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Nn.exports(String(r))}function Mu(r,e,a,l){for(;a<l;){const d=r[a+l>>1];let m=a-1,y=l+1;for(;;){do m++;while(r[m]<d);do y--;while(r[y]>d);if(m>=y)break;ia(r,m,y),ia(e,3*m,3*y),ia(e,3*m+1,3*y+1),ia(e,3*m+2,3*y+2)}y-a<l-y?(Mu(r,e,a,y),a=y+1):(Mu(r,e,y+1,l),l=y)}}function ia(r,e,a){const l=r[e];r[e]=r[a],r[a]=l}Ye("FeaturePositionMap",uo);class ba{constructor(e,a){this.gl=e.gl,this.location=a}}class Sa extends ba{constructor(e,a){super(e,a),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class ll extends ba{constructor(e,a){super(e,a),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class qy extends ba{constructor(e,a){super(e,a),this.current=U.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Zw=new Float32Array(16);function df(r){return[Ot(255*r.r,255*r.g),Ot(255*r.b,255*r.a)]}class Du{constructor(e,a,l){this.value=e,this.uniformNames=a.map(d=>`u_${d}`),this.type=l}setUniform(e,a,l){e.set(l.constantOr(this.value))}getBinding(e,a,l){return this.type==="color"?new qy(e,a):new Sa(e,a)}}class ul{constructor(e,a){this.uniformNames=a.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=e.tlbr}setUniform(e,a,l,d){const m=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&e.set(m)}getBinding(e,a,l){return l.substr(0,9)==="u_pattern"?new ll(e,a):new Sa(e,a)}}class Ta{constructor(e,a,l,d){this.expression=e,this.type=l,this.maxValue=0,this.paintVertexAttributes=a.map(m=>({name:`a_${m}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(e,a,l,d,m){const y=this.paintVertexArray.length,w=this.expression.evaluate(new an(0),a,{},d,[],m);this.paintVertexArray.resize(e),this._setPaintValue(y,e,w)}updatePaintArray(e,a,l,d){const m=this.expression.evaluate({zoom:0},l,d);this._setPaintValue(e,a,m)}_setPaintValue(e,a,l){if(this.type==="color"){const d=df(l);for(let m=e;m<a;m++)this.paintVertexArray.emplace(m,d[0],d[1])}else{for(let d=e;d<a;d++)this.paintVertexArray.emplace(d,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Di{constructor(e,a,l,d,m,y){this.expression=e,this.uniformNames=a.map(w=>`u_${w}_t`),this.type=l,this.useIntegerZoom=d,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=a.map(w=>({name:`a_${w}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(e,a,l,d,m){const y=this.expression.evaluate(new an(this.zoom),a,{},d,[],m),w=this.expression.evaluate(new an(this.zoom+1),a,{},d,[],m),b=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(b,e,y,w)}updatePaintArray(e,a,l,d){const m=this.expression.evaluate({zoom:this.zoom},l,d),y=this.expression.evaluate({zoom:this.zoom+1},l,d);this._setPaintValue(e,a,m,y)}_setPaintValue(e,a,l,d){if(this.type==="color"){const m=df(l),y=df(d);for(let w=e;w<a;w++)this.paintVertexArray.emplace(w,m[0],m[1],y[0],y[1])}else{for(let m=e;m<a;m++)this.paintVertexArray.emplace(m,l,d);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(d))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,a){const l=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,d=V(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);e.set(d)}getBinding(e,a,l){return new Sa(e,a)}}class co{constructor(e,a,l,d,m,y){this.expression=e,this.type=a,this.useIntegerZoom=l,this.zoom=d,this.layerId=y,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(e,a,l){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(d,e,a.patterns&&a.patterns[this.layerId],l)}updatePaintArray(e,a,l,d,m){this._setPaintValues(e,a,l.patterns&&l.patterns[this.layerId],m)}_setPaintValues(e,a,l,d){if(!d||!l)return;const{min:m,mid:y,max:w}=l,b=d[m],k=d[y],A=d[w];if(b&&k&&A)for(let z=e;z<a;z++)this.zoomInPaintVertexArray.emplace(z,k.tl[0],k.tl[1],k.br[0],k.br[1],b.tl[0],b.tl[1],b.br[0],b.br[1],k.pixelRatio,b.pixelRatio),this.zoomOutPaintVertexArray.emplace(z,k.tl[0],k.tl[1],k.br[0],k.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],k.pixelRatio,A.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,On.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,On.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Zy{constructor(e,a,l){this.binders={},this._buffers=[];const d=[];for(const m in e.paint._values){if(!l(m))continue;const y=e.paint.get(m);if(!(y instanceof pi&&Jt(y.property.specification)))continue;const w=Ww(m,e.type),b=y.value,k=y.property.specification.type,A=y.property.useIntegerZoom,z=y.property.specification["property-type"],R=z==="cross-faded"||z==="cross-faded-data-driven";if(b.kind==="constant")this.binders[m]=R?new ul(b.value,w):new Du(b.value,w,k),d.push(`/u_${m}`);else if(b.kind==="source"||R){const F=Wy(m,k,"source");this.binders[m]=R?new co(b,k,A,a,F,e.id):new Ta(b,w,k,F),d.push(`/a_${m}`)}else{const F=Wy(m,k,"composite");this.binders[m]=new Di(b,w,k,A,a,F),d.push(`/z_${m}`)}}this.cacheKey=d.sort().join("")}getMaxValue(e){const a=this.binders[e];return a instanceof Ta||a instanceof Di?a.maxValue:0}populatePaintArrays(e,a,l,d,m){for(const y in this.binders){const w=this.binders[y];(w instanceof Ta||w instanceof Di||w instanceof co)&&w.populatePaintArray(e,a,l,d,m)}}setConstantPatternPositions(e,a){for(const l in this.binders){const d=this.binders[l];d instanceof ul&&d.setConstantPatternPositions(e,a)}}updatePaintArrays(e,a,l,d,m){let y=!1;for(const w in e){const b=a.getPositions(w);for(const k of b){const A=l.feature(k.index);for(const z in this.binders){const R=this.binders[z];if((R instanceof Ta||R instanceof Di||R instanceof co)&&R.expression.isStateDependent===!0){const F=d.paint.get(z);R.expression=F.value,R.updatePaintArray(k.start,k.end,A,e[w],m),y=!0}}}}return y}defines(){const e=[];for(const a in this.binders){const l=this.binders[a];(l instanceof Du||l instanceof ul)&&e.push(...l.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return e}getBinderAttributes(){const e=[];for(const a in this.binders){const l=this.binders[a];if(l instanceof Ta||l instanceof Di)for(let d=0;d<l.paintVertexAttributes.length;d++)e.push(l.paintVertexAttributes[d].name);else if(l instanceof co)for(let d=0;d<On.members.length;d++)e.push(On.members[d].name)}return e}getBinderUniforms(){const e=[];for(const a in this.binders){const l=this.binders[a];if(l instanceof Du||l instanceof ul||l instanceof Di)for(const d of l.uniformNames)e.push(d)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,a){const l=[];for(const d in this.binders){const m=this.binders[d];if(m instanceof Du||m instanceof ul||m instanceof Di){for(const y of m.uniformNames)if(a[y]){const w=m.getBinding(e,a[y],y);l.push({name:y,property:d,binding:w})}}}return l}setUniforms(e,a,l,d){for(const{name:m,property:y,binding:w}of a)this.binders[y].setUniform(w,d,l.get(y),m)}updatePaintBuffers(e){this._buffers=[];for(const a in this.binders){const l=this.binders[a];if(e&&l instanceof co){const d=e.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(l instanceof Ta||l instanceof Di)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(e){for(const a in this.binders){const l=this.binders[a];(l instanceof Ta||l instanceof Di||l instanceof co)&&l.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const a=this.binders[e];(a instanceof Ta||a instanceof Di||a instanceof co)&&a.destroy()}}}class ms{constructor(e,a,l=()=>!0){this.programConfigurations={};for(const d of e)this.programConfigurations[d.id]=new Zy(d,a,l);this.needsUpload=!1,this._featureMap=new uo,this._bufferOffset=0}populatePaintArrays(e,a,l,d,m,y){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(e,a,d,m,y);a.id!==void 0&&this._featureMap.add(a.id,l,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,a,l,d){for(const m of l)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,a,m,d)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Ww(r,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${e}-`,"").replace(/-/g,"_")]}function Wy(r,e,a){const l={color:{source:c,composite:fe},number:{source:G,composite:c}},d=function(m){return{"line-pattern":{source:Fn,composite:Fn},"fill-pattern":{source:Fn,composite:Fn},"fill-extrusion-pattern":{source:Fn,composite:Fn}}[m]}(r);return d&&d[a]||l[e][a]}Ye("ConstantBinder",Du),Ye("CrossFadedConstantBinder",ul),Ye("SourceExpressionBinder",Ta),Ye("CrossFadedCompositeBinder",co),Ye("CompositeExpressionBinder",Di),Ye("ProgramConfiguration",Zy,{omit:["_buffers"]}),Ye("ProgramConfigurationSet",ms);var zn=8192;const pf=Math.pow(2,14)-1,Hy=-pf-1;function gs(r){const e=zn/r.extent,a=r.loadGeometry();for(let l=0;l<a.length;l++){const d=a[l];for(let m=0;m<d.length;m++){const y=d[m],w=Math.round(y.x*e),b=Math.round(y.y*e);y.x=V(w,Hy,pf),y.y=V(b,Hy,pf),(w<y.x||w>y.x+1||b<y.y||b>y.y+1)&&Ee("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function ys(r,e){return{type:r.type,id:r.id,properties:r.properties,geometry:e?gs(r):[]}}function Rh(r,e,a,l,d){r.emplaceBack(2*e+(l+1)/2,2*a+(d+1)/2)}class ff{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(a=>a.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Nt,this.indexArray=new fr,this.segments=new Et,this.programConfigurations=new ms(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(e,a,l){const d=this.layers[0],m=[];let y=null,w=!1;d.type==="circle"&&(y=d.layout.get("circle-sort-key"),w=!y.isConstant());for(const{feature:b,id:k,index:A,sourceLayerIndex:z}of e){const R=this.layers[0]._featureFilter.needGeometry,F=ys(b,R);if(!this.layers[0]._featureFilter.filter(new an(this.zoom),F,l))continue;const O=w?y.evaluate(F,{},l):void 0,Y={id:k,properties:b.properties,type:b.type,sourceLayerIndex:z,index:A,geometry:R?F.geometry:gs(b),patterns:{},sortKey:O};m.push(Y)}w&&m.sort((b,k)=>b.sortKey-k.sortKey);for(const b of m){const{geometry:k,index:A,sourceLayerIndex:z}=b,R=e[A].feature;this.addFeature(b,k,A,l),a.featureIndex.insert(R,k,A,z,this.index)}}update(e,a,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,a,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Pn),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,a,l,d){for(const m of a)for(const y of m){const w=y.x,b=y.y;if(w<0||w>=zn||b<0||b>=zn)continue;const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),A=k.vertexLength;Rh(this.layoutVertexArray,w,b,-1,-1),Rh(this.layoutVertexArray,w,b,1,-1),Rh(this.layoutVertexArray,w,b,1,1),Rh(this.layoutVertexArray,w,b,-1,1),this.indexArray.emplaceBack(A,A+1,A+2),this.indexArray.emplaceBack(A,A+3,A+2),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,{},d)}}function Xy(r,e){for(let a=0;a<r.length;a++)if(cl(e,r[a]))return!0;for(let a=0;a<e.length;a++)if(cl(r,e[a]))return!0;return!!mf(r,e)}function Hw(r,e,a){return!!cl(r,e)||!!gf(e,r,a)}function Yy(r,e){if(r.length===1)return Jy(e,r[0]);for(let a=0;a<e.length;a++){const l=e[a];for(let d=0;d<l.length;d++)if(cl(r,l[d]))return!0}for(let a=0;a<r.length;a++)if(Jy(e,r[a]))return!0;for(let a=0;a<e.length;a++)if(mf(r,e[a]))return!0;return!1}function Xw(r,e,a){if(r.length>1){if(mf(r,e))return!0;for(let l=0;l<e.length;l++)if(gf(e[l],r,a))return!0}for(let l=0;l<r.length;l++)if(gf(r[l],e,a))return!0;return!1}function mf(r,e){if(r.length===0||e.length===0)return!1;for(let a=0;a<r.length-1;a++){const l=r[a],d=r[a+1];for(let m=0;m<e.length-1;m++)if(Yw(l,d,e[m],e[m+1]))return!0}return!1}function Yw(r,e,a,l){return Oe(r,a,l)!==Oe(e,a,l)&&Oe(r,e,a)!==Oe(r,e,l)}function gf(r,e,a){const l=a*a;if(e.length===1)return r.distSqr(e[0])<l;for(let d=1;d<e.length;d++)if(Ky(r,e[d-1],e[d])<l)return!0;return!1}function Ky(r,e,a){const l=e.distSqr(a);if(l===0)return r.distSqr(e);const d=((r.x-e.x)*(a.x-e.x)+(r.y-e.y)*(a.y-e.y))/l;return r.distSqr(d<0?e:d>1?a:a.sub(e)._mult(d)._add(e))}function Jy(r,e){let a,l,d,m=!1;for(let y=0;y<r.length;y++){a=r[y];for(let w=0,b=a.length-1;w<a.length;b=w++)l=a[w],d=a[b],l.y>e.y!=d.y>e.y&&e.x<(d.x-l.x)*(e.y-l.y)/(d.y-l.y)+l.x&&(m=!m)}return m}function cl(r,e){let a=!1;for(let l=0,d=r.length-1;l<r.length;d=l++){const m=r[l],y=r[d];m.y>e.y!=y.y>e.y&&e.x<(y.x-m.x)*(e.y-m.y)/(y.y-m.y)+m.x&&(a=!a)}return a}function Kw(r,e,a){const l=a[0],d=a[2];if(r.x<l.x&&e.x<l.x||r.x>d.x&&e.x>d.x||r.y<l.y&&e.y<l.y||r.y>d.y&&e.y>d.y)return!1;const m=Oe(r,e,a[0]);return m!==Oe(r,e,a[1])||m!==Oe(r,e,a[2])||m!==Oe(r,e,a[3])}function Lu(r,e,a){const l=e.paint.get(r).value;return l.kind==="constant"?l.value:a.programConfigurations.get(e.id).getMaxValue(r)}function Bh(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Fh(r,e,a,l,d){if(!e[0]&&!e[1])return r;const m=Ke.convert(e)._mult(d);a==="viewport"&&m._rotate(-l);const y=[];for(let w=0;w<r.length;w++)y.push(r[w].sub(m));return y}Ye("CircleBucket",ff,{omit:["layers"]});const Jw=new Gn({"circle-sort-key":new ct(Te.layout_circle["circle-sort-key"])});var Qw={paint:new Gn({"circle-radius":new ct(Te.paint_circle["circle-radius"]),"circle-color":new ct(Te.paint_circle["circle-color"]),"circle-blur":new ct(Te.paint_circle["circle-blur"]),"circle-opacity":new ct(Te.paint_circle["circle-opacity"]),"circle-translate":new tt(Te.paint_circle["circle-translate"]),"circle-translate-anchor":new tt(Te.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new tt(Te.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new tt(Te.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ct(Te.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ct(Te.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ct(Te.paint_circle["circle-stroke-opacity"])}),layout:Jw},mr=1e-6,gr=typeof Float32Array<"u"?Float32Array:Array;function Qy(){var r=new gr(9);return gr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function yf(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function e_(r,e,a){var l=e[0],d=e[1],m=e[2],y=e[3],w=e[4],b=e[5],k=e[6],A=e[7],z=e[8],R=e[9],F=e[10],O=e[11],Y=e[12],H=e[13],ue=e[14],me=e[15],le=a[0],de=a[1],Ie=a[2],ke=a[3];return r[0]=le*l+de*w+Ie*z+ke*Y,r[1]=le*d+de*b+Ie*R+ke*H,r[2]=le*m+de*k+Ie*F+ke*ue,r[3]=le*y+de*A+Ie*O+ke*me,r[4]=(le=a[4])*l+(de=a[5])*w+(Ie=a[6])*z+(ke=a[7])*Y,r[5]=le*d+de*b+Ie*R+ke*H,r[6]=le*m+de*k+Ie*F+ke*ue,r[7]=le*y+de*A+Ie*O+ke*me,r[8]=(le=a[8])*l+(de=a[9])*w+(Ie=a[10])*z+(ke=a[11])*Y,r[9]=le*d+de*b+Ie*R+ke*H,r[10]=le*m+de*k+Ie*F+ke*ue,r[11]=le*y+de*A+Ie*O+ke*me,r[12]=(le=a[12])*l+(de=a[13])*w+(Ie=a[14])*z+(ke=a[15])*Y,r[13]=le*d+de*b+Ie*R+ke*H,r[14]=le*m+de*k+Ie*F+ke*ue,r[15]=le*y+de*A+Ie*O+ke*me,r}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var Ru,eb=e_;function t_(){var r=new gr(3);return gr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function n_(r,e,a){var l=new gr(3);return l[0]=r,l[1]=e,l[2]=a,l}function Oh(r,e,a){var l=e[0],d=e[1],m=e[2],y=e[3];return r[0]=a[0]*l+a[4]*d+a[8]*m+a[12]*y,r[1]=a[1]*l+a[5]*d+a[9]*m+a[13]*y,r[2]=a[2]*l+a[6]*d+a[10]*m+a[14]*y,r[3]=a[3]*l+a[7]*d+a[11]*m+a[15]*y,r}function r_(){var r=new gr(4);return gr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function i_(r,e){const a=Oh([],[r.x,r.y,0,1],e);return new Ke(a[0]/a[3],a[1]/a[3])}t_(),Ru=new gr(4),gr!=Float32Array&&(Ru[0]=0,Ru[1]=0,Ru[2]=0,Ru[3]=0),t_(),n_(1,0,0),n_(0,1,0),r_(),r_(),Qy(),function(){var r;r=new gr(2),gr!=Float32Array&&(r[0]=0,r[1]=0)}();class a_ extends ff{}Ye("HeatmapBucket",a_,{omit:["layers"]});var tb={paint:new Gn({"heatmap-radius":new ct(Te.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ct(Te.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new tt(Te.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ea(Te.paint_heatmap["heatmap-color"]),"heatmap-opacity":new tt(Te.paint_heatmap["heatmap-opacity"])})};function _f(r,{width:e,height:a},l,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==e*a*l)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${e*a*l}`)}else d=new Uint8Array(e*a*l);return r.width=e,r.height=a,r.data=d,r}function o_(r,{width:e,height:a},l){if(e===r.width&&a===r.height)return;const d=_f({},{width:e,height:a},l);vf(r,d,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,e),height:Math.min(r.height,a)},l),r.width=e,r.height=a,r.data=d.data}function vf(r,e,a,l,d,m){if(d.width===0||d.height===0)return e;if(d.width>r.width||d.height>r.height||a.x>r.width-d.width||a.y>r.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>e.width||d.height>e.height||l.x>e.width-d.width||l.y>e.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const y=r.data,w=e.data;if(y===w)throw new Error("srcData equals dstData, so image is already copied");for(let b=0;b<d.height;b++){const k=((a.y+b)*r.width+a.x)*m,A=((l.y+b)*e.width+l.x)*m;for(let z=0;z<d.width*m;z++)w[A+z]=y[k+z]}return e}class Bu{constructor(e,a){_f(this,e,1,a)}resize(e){o_(this,e,1)}clone(){return new Bu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,a,l,d,m){vf(e,a,l,d,m,1)}}class Qr{constructor(e,a){_f(this,e,4,a)}resize(e){o_(this,e,4)}replace(e,a){a?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Qr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,a,l,d,m){vf(e,a,l,d,m,4)}}function s_(r){const e={},a=r.resolution||256,l=r.clips?r.clips.length:1,d=r.image||new Qr({width:a,height:l});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const m=(y,w,b)=>{e[r.evaluationKey]=b;const k=r.expression.evaluate(e);d.data[y+w+0]=Math.floor(255*k.r/k.a),d.data[y+w+1]=Math.floor(255*k.g/k.a),d.data[y+w+2]=Math.floor(255*k.b/k.a),d.data[y+w+3]=Math.floor(255*k.a)};if(r.clips)for(let y=0,w=0;y<l;++y,w+=4*a)for(let b=0,k=0;b<a;b++,k+=4){const A=b/(a-1),{start:z,end:R}=r.clips[y];m(w,k,z*(1-A)+R*A)}else for(let y=0,w=0;y<a;y++,w+=4)m(0,w,y/(a-1));return d}Ye("AlphaImage",Bu),Ye("RGBAImage",Qr);var nb={paint:new Gn({"hillshade-illumination-direction":new tt(Te.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new tt(Te.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new tt(Te.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new tt(Te.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new tt(Te.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new tt(Te.paint_hillshade["hillshade-accent-color"])})};const rb=En([{name:"a_pos",components:2,type:"Int16"}],4),{members:ib}=rb;var Nh={exports:{}};function Uh(r,e,a){a=a||2;var l,d,m,y,w,b,k,A=e&&e.length,z=A?e[0]*a:r.length,R=l_(r,0,z,a,!0),F=[];if(!R||R.next===R.prev)return F;if(A&&(R=function(Y,H,ue,me){var le,de,Ie,ke=[];for(le=0,de=H.length;le<de;le++)(Ie=l_(Y,H[le]*me,le<de-1?H[le+1]*me:Y.length,me,!1))===Ie.next&&(Ie.steiner=!0),ke.push(db(Ie));for(ke.sort(ub),le=0;le<ke.length;le++)ue=cb(ke[le],ue);return ue}(r,e,R,a)),r.length>80*a){l=m=r[0],d=y=r[1];for(var O=a;O<z;O+=a)(w=r[O])<l&&(l=w),(b=r[O+1])<d&&(d=b),w>m&&(m=w),b>y&&(y=b);k=(k=Math.max(m-l,y-d))!==0?32767/k:0}return Fu(R,F,a,l,d,k,0),F}function l_(r,e,a,l,d){var m,y;if(d===bf(r,e,a,l)>0)for(m=e;m<a;m+=l)y=h_(m,r[m],r[m+1],y);else for(m=a-l;m>=e;m-=l)y=h_(m,r[m],r[m+1],y);return y&&Vh(y,y.next)&&(Nu(y),y=y.next),y}function _s(r,e){if(!r)return r;e||(e=r);var a,l=r;do if(a=!1,l.steiner||!Vh(l,l.next)&&xn(l.prev,l,l.next)!==0)l=l.next;else{if(Nu(l),(l=e=l.prev)===l.next)break;a=!0}while(a||l!==e);return e}function Fu(r,e,a,l,d,m,y){if(r){!y&&m&&function(A,z,R,F){var O=A;do O.z===0&&(O.z=xf(O.x,O.y,z,R,F)),O.prevZ=O.prev,O.nextZ=O.next,O=O.next;while(O!==A);O.prevZ.nextZ=null,O.prevZ=null,function(Y){var H,ue,me,le,de,Ie,ke,Xe,Qe=1;do{for(ue=Y,Y=null,de=null,Ie=0;ue;){for(Ie++,me=ue,ke=0,H=0;H<Qe&&(ke++,me=me.nextZ);H++);for(Xe=Qe;ke>0||Xe>0&&me;)ke!==0&&(Xe===0||!me||ue.z<=me.z)?(le=ue,ue=ue.nextZ,ke--):(le=me,me=me.nextZ,Xe--),de?de.nextZ=le:Y=le,le.prevZ=de,de=le;ue=me}de.nextZ=null,Qe*=2}while(Ie>1)}(O)}(r,l,d,m);for(var w,b,k=r;r.prev!==r.next;)if(w=r.prev,b=r.next,m?ob(r,l,d,m):ab(r))e.push(w.i/a|0),e.push(r.i/a|0),e.push(b.i/a|0),Nu(r),r=b.next,k=b.next;else if((r=b)===k){y?y===1?Fu(r=sb(_s(r),e,a),e,a,l,d,m,2):y===2&&lb(r,e,a,l,d,m):Fu(_s(r),e,a,l,d,m,1);break}}}function ab(r){var e=r.prev,a=r,l=r.next;if(xn(e,a,l)>=0)return!1;for(var d=e.x,m=a.x,y=l.x,w=e.y,b=a.y,k=l.y,A=d<m?d<y?d:y:m<y?m:y,z=w<b?w<k?w:k:b<k?b:k,R=d>m?d>y?d:y:m>y?m:y,F=w>b?w>k?w:k:b>k?b:k,O=l.next;O!==e;){if(O.x>=A&&O.x<=R&&O.y>=z&&O.y<=F&&hl(d,w,m,b,y,k,O.x,O.y)&&xn(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function ob(r,e,a,l){var d=r.prev,m=r,y=r.next;if(xn(d,m,y)>=0)return!1;for(var w=d.x,b=m.x,k=y.x,A=d.y,z=m.y,R=y.y,F=w<b?w<k?w:k:b<k?b:k,O=A<z?A<R?A:R:z<R?z:R,Y=w>b?w>k?w:k:b>k?b:k,H=A>z?A>R?A:R:z>R?z:R,ue=xf(F,O,e,a,l),me=xf(Y,H,e,a,l),le=r.prevZ,de=r.nextZ;le&&le.z>=ue&&de&&de.z<=me;){if(le.x>=F&&le.x<=Y&&le.y>=O&&le.y<=H&&le!==d&&le!==y&&hl(w,A,b,z,k,R,le.x,le.y)&&xn(le.prev,le,le.next)>=0||(le=le.prevZ,de.x>=F&&de.x<=Y&&de.y>=O&&de.y<=H&&de!==d&&de!==y&&hl(w,A,b,z,k,R,de.x,de.y)&&xn(de.prev,de,de.next)>=0))return!1;de=de.nextZ}for(;le&&le.z>=ue;){if(le.x>=F&&le.x<=Y&&le.y>=O&&le.y<=H&&le!==d&&le!==y&&hl(w,A,b,z,k,R,le.x,le.y)&&xn(le.prev,le,le.next)>=0)return!1;le=le.prevZ}for(;de&&de.z<=me;){if(de.x>=F&&de.x<=Y&&de.y>=O&&de.y<=H&&de!==d&&de!==y&&hl(w,A,b,z,k,R,de.x,de.y)&&xn(de.prev,de,de.next)>=0)return!1;de=de.nextZ}return!0}function sb(r,e,a){var l=r;do{var d=l.prev,m=l.next.next;!Vh(d,m)&&u_(d,l,l.next,m)&&Ou(d,m)&&Ou(m,d)&&(e.push(d.i/a|0),e.push(l.i/a|0),e.push(m.i/a|0),Nu(l),Nu(l.next),l=r=m),l=l.next}while(l!==r);return _s(l)}function lb(r,e,a,l,d,m){var y=r;do{for(var w=y.next.next;w!==y.prev;){if(y.i!==w.i&&pb(y,w)){var b=c_(y,w);return y=_s(y,y.next),b=_s(b,b.next),Fu(y,e,a,l,d,m,0),void Fu(b,e,a,l,d,m,0)}w=w.next}y=y.next}while(y!==r)}function ub(r,e){return r.x-e.x}function cb(r,e){var a=function(d,m){var y,w=m,b=d.x,k=d.y,A=-1/0;do{if(k<=w.y&&k>=w.next.y&&w.next.y!==w.y){var z=w.x+(k-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(z<=b&&z>A&&(A=z,y=w.x<w.next.x?w:w.next,z===b))return y}w=w.next}while(w!==m);if(!y)return null;var R,F=y,O=y.x,Y=y.y,H=1/0;w=y;do b>=w.x&&w.x>=O&&b!==w.x&&hl(k<Y?b:A,k,O,Y,k<Y?A:b,k,w.x,w.y)&&(R=Math.abs(k-w.y)/(b-w.x),Ou(w,d)&&(R<H||R===H&&(w.x>y.x||w.x===y.x&&hb(y,w)))&&(y=w,H=R)),w=w.next;while(w!==F);return y}(r,e);if(!a)return e;var l=c_(a,r);return _s(l,l.next),_s(a,a.next)}function hb(r,e){return xn(r.prev,r,e.prev)<0&&xn(e.next,r,r.next)<0}function xf(r,e,a,l,d){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-a)*d|0)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-l)*d|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function db(r){var e=r,a=r;do(e.x<a.x||e.x===a.x&&e.y<a.y)&&(a=e),e=e.next;while(e!==r);return a}function hl(r,e,a,l,d,m,y,w){return(d-y)*(e-w)>=(r-y)*(m-w)&&(r-y)*(l-w)>=(a-y)*(e-w)&&(a-y)*(m-w)>=(d-y)*(l-w)}function pb(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!function(a,l){var d=a;do{if(d.i!==a.i&&d.next.i!==a.i&&d.i!==l.i&&d.next.i!==l.i&&u_(d,d.next,a,l))return!0;d=d.next}while(d!==a);return!1}(r,e)&&(Ou(r,e)&&Ou(e,r)&&function(a,l){var d=a,m=!1,y=(a.x+l.x)/2,w=(a.y+l.y)/2;do d.y>w!=d.next.y>w&&d.next.y!==d.y&&y<(d.next.x-d.x)*(w-d.y)/(d.next.y-d.y)+d.x&&(m=!m),d=d.next;while(d!==a);return m}(r,e)&&(xn(r.prev,r,e.prev)||xn(r,e.prev,e))||Vh(r,e)&&xn(r.prev,r,r.next)>0&&xn(e.prev,e,e.next)>0)}function xn(r,e,a){return(e.y-r.y)*(a.x-e.x)-(e.x-r.x)*(a.y-e.y)}function Vh(r,e){return r.x===e.x&&r.y===e.y}function u_(r,e,a,l){var d=jh(xn(r,e,a)),m=jh(xn(r,e,l)),y=jh(xn(a,l,r)),w=jh(xn(a,l,e));return d!==m&&y!==w||!(d!==0||!$h(r,a,e))||!(m!==0||!$h(r,l,e))||!(y!==0||!$h(a,r,l))||!(w!==0||!$h(a,e,l))}function $h(r,e,a){return e.x<=Math.max(r.x,a.x)&&e.x>=Math.min(r.x,a.x)&&e.y<=Math.max(r.y,a.y)&&e.y>=Math.min(r.y,a.y)}function jh(r){return r>0?1:r<0?-1:0}function Ou(r,e){return xn(r.prev,r,r.next)<0?xn(r,e,r.next)>=0&&xn(r,r.prev,e)>=0:xn(r,e,r.prev)<0||xn(r,r.next,e)<0}function c_(r,e){var a=new wf(r.i,r.x,r.y),l=new wf(e.i,e.x,e.y),d=r.next,m=e.prev;return r.next=e,e.prev=r,a.next=d,d.prev=a,l.next=a,a.prev=l,m.next=l,l.prev=m,l}function h_(r,e,a,l){var d=new wf(r,e,a);return l?(d.next=l.next,d.prev=l,l.next.prev=d,l.next=d):(d.prev=d,d.next=d),d}function Nu(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function wf(r,e,a){this.i=r,this.x=e,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function bf(r,e,a,l){for(var d=0,m=e,y=a-l;m<a;m+=l)d+=(r[y]-r[m])*(r[m+1]+r[y+1]),y=m;return d}function fb(r,e,a,l,d){d_(r,e,a||0,l||r.length-1,d||mb)}function d_(r,e,a,l,d){for(;l>a;){if(l-a>600){var m=l-a+1,y=e-a+1,w=Math.log(m),b=.5*Math.exp(2*w/3),k=.5*Math.sqrt(w*b*(m-b)/m)*(y-m/2<0?-1:1);d_(r,e,Math.max(a,Math.floor(e-y*b/m+k)),Math.min(l,Math.floor(e+(m-y)*b/m+k)),d)}var A=r[e],z=a,R=l;for(Uu(r,a,e),d(r[l],A)>0&&Uu(r,a,l);z<R;){for(Uu(r,z,R),z++,R--;d(r[z],A)<0;)z++;for(;d(r[R],A)>0;)R--}d(r[a],A)===0?Uu(r,a,R):Uu(r,++R,l),R<=e&&(a=R+1),e<=R&&(l=R-1)}}function Uu(r,e,a){var l=r[e];r[e]=r[a],r[a]=l}function mb(r,e){return r<e?-1:r>e?1:0}function Sf(r,e){const a=r.length;if(a<=1)return[r];const l=[];let d,m;for(let y=0;y<a;y++){const w=Ve(r[y]);w!==0&&(r[y].area=Math.abs(w),m===void 0&&(m=w<0),m===w<0?(d&&l.push(d),d=[r[y]]):d.push(r[y]))}if(d&&l.push(d),e>1)for(let y=0;y<l.length;y++)l[y].length<=e||(fb(l[y],e,1,l[y].length-1,gb),l[y]=l[y].slice(0,e));return l}function gb(r,e){return e.area-r.area}function Tf(r,e,a){const l=a.patternDependencies;let d=!1;for(const m of e){const y=m.paint.get(`${r}-pattern`);y.isConstant()||(d=!0);const w=y.constantOr(null);w&&(d=!0,l[w.to]=!0,l[w.from]=!0)}return d}function Ef(r,e,a,l,d){const m=d.patternDependencies;for(const y of e){const w=y.paint.get(`${r}-pattern`).value;if(w.kind!=="constant"){let b=w.evaluate({zoom:l-1},a,{},d.availableImages),k=w.evaluate({zoom:l},a,{},d.availableImages),A=w.evaluate({zoom:l+1},a,{},d.availableImages);b=b&&b.name?b.name:b,k=k&&k.name?k.name:k,A=A&&A.name?A.name:A,m[b]=!0,m[k]=!0,m[A]=!0,a.patterns[y.id]={min:b,mid:k,max:A}}}return a}Nh.exports=Uh,Nh.exports.default=Uh,Uh.deviation=function(r,e,a,l){var d=e&&e.length,m=Math.abs(bf(r,0,d?e[0]*a:r.length,a));if(d)for(var y=0,w=e.length;y<w;y++)m-=Math.abs(bf(r,e[y]*a,y<w-1?e[y+1]*a:r.length,a));var b=0;for(y=0;y<l.length;y+=3){var k=l[y]*a,A=l[y+1]*a,z=l[y+2]*a;b+=Math.abs((r[k]-r[z])*(r[A+1]-r[k+1])-(r[k]-r[A])*(r[z+1]-r[k+1]))}return m===0&&b===0?0:Math.abs((b-m)/m)},Uh.flatten=function(r){for(var e=r[0][0].length,a={vertices:[],holes:[],dimensions:e},l=0,d=0;d<r.length;d++){for(var m=0;m<r[d].length;m++)for(var y=0;y<e;y++)a.vertices.push(r[d][m][y]);d>0&&a.holes.push(l+=r[d-1].length)}return a};class kf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(a=>a.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ut,this.indexArray=new fr,this.indexArray2=new Mi,this.programConfigurations=new ms(e.layers,e.zoom),this.segments=new Et,this.segments2=new Et,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(e,a,l){this.hasPattern=Tf("fill",this.layers,a);const d=this.layers[0].layout.get("fill-sort-key"),m=!d.isConstant(),y=[];for(const{feature:w,id:b,index:k,sourceLayerIndex:A}of e){const z=this.layers[0]._featureFilter.needGeometry,R=ys(w,z);if(!this.layers[0]._featureFilter.filter(new an(this.zoom),R,l))continue;const F=m?d.evaluate(R,{},l,a.availableImages):void 0,O={id:b,properties:w.properties,type:w.type,sourceLayerIndex:A,index:k,geometry:z?R.geometry:gs(w),patterns:{},sortKey:F};y.push(O)}m&&y.sort((w,b)=>w.sortKey-b.sortKey);for(const w of y){const{geometry:b,index:k,sourceLayerIndex:A}=w;if(this.hasPattern){const z=Ef("fill",this.layers,w,this.zoom,a);this.patternFeatures.push(z)}else this.addFeature(w,b,k,l,{});a.featureIndex.insert(e[k].feature,b,k,A,this.index)}}update(e,a,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,a,this.stateDependentLayers,l)}addFeatures(e,a,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,a,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ib),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,a,l,d,m){for(const y of Sf(a,500)){let w=0;for(const F of y)w+=F.length;const b=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),k=b.vertexLength,A=[],z=[];for(const F of y){if(F.length===0)continue;F!==y[0]&&z.push(A.length/2);const O=this.segments2.prepareSegment(F.length,this.layoutVertexArray,this.indexArray2),Y=O.vertexLength;this.layoutVertexArray.emplaceBack(F[0].x,F[0].y),this.indexArray2.emplaceBack(Y+F.length-1,Y),A.push(F[0].x),A.push(F[0].y);for(let H=1;H<F.length;H++)this.layoutVertexArray.emplaceBack(F[H].x,F[H].y),this.indexArray2.emplaceBack(Y+H-1,Y+H),A.push(F[H].x),A.push(F[H].y);O.vertexLength+=F.length,O.primitiveLength+=F.length}const R=Nh.exports(A,z);for(let F=0;F<R.length;F+=3)this.indexArray.emplaceBack(k+R[F],k+R[F+1],k+R[F+2]);b.vertexLength+=w,b.primitiveLength+=R.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,m,d)}}Ye("FillBucket",kf,{omit:["layers","patternFeatures"]});const yb=new Gn({"fill-sort-key":new ct(Te.layout_fill["fill-sort-key"])});var _b={paint:new Gn({"fill-antialias":new tt(Te.paint_fill["fill-antialias"]),"fill-opacity":new ct(Te.paint_fill["fill-opacity"]),"fill-color":new ct(Te.paint_fill["fill-color"]),"fill-outline-color":new ct(Te.paint_fill["fill-outline-color"]),"fill-translate":new tt(Te.paint_fill["fill-translate"]),"fill-translate-anchor":new tt(Te.paint_fill["fill-translate-anchor"]),"fill-pattern":new lo(Te.paint_fill["fill-pattern"])}),layout:yb};const vb=En([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),xb=En([{name:"a_centroid",components:2,type:"Int16"}],4),{members:wb}=vb;var ho={},bb=Ke,p_=dl;function dl(r,e,a,l,d){this.properties={},this.extent=a,this.type=0,this._pbf=r,this._geometry=-1,this._keys=l,this._values=d,r.readFields(Sb,this,e)}function Sb(r,e,a){r==1?e.id=a.readVarint():r==2?function(l,d){for(var m=l.readVarint()+l.pos;l.pos<m;){var y=d._keys[l.readVarint()],w=d._values[l.readVarint()];d.properties[y]=w}}(a,e):r==3?e.type=a.readVarint():r==4&&(e._geometry=a.pos)}function Tb(r){for(var e,a,l=0,d=0,m=r.length,y=m-1;d<m;y=d++)l+=((a=r[y]).x-(e=r[d]).x)*(e.y+a.y);return l}dl.types=["Unknown","Point","LineString","Polygon"],dl.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var e,a=r.readVarint()+r.pos,l=1,d=0,m=0,y=0,w=[];r.pos<a;){if(d<=0){var b=r.readVarint();l=7&b,d=b>>3}if(d--,l===1||l===2)m+=r.readSVarint(),y+=r.readSVarint(),l===1&&(e&&w.push(e),e=[]),e.push(new bb(m,y));else{if(l!==7)throw new Error("unknown command "+l);e&&e.push(e[0].clone())}}return e&&w.push(e),w},dl.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var e=r.readVarint()+r.pos,a=1,l=0,d=0,m=0,y=1/0,w=-1/0,b=1/0,k=-1/0;r.pos<e;){if(l<=0){var A=r.readVarint();a=7&A,l=A>>3}if(l--,a===1||a===2)(d+=r.readSVarint())<y&&(y=d),d>w&&(w=d),(m+=r.readSVarint())<b&&(b=m),m>k&&(k=m);else if(a!==7)throw new Error("unknown command "+a)}return[y,b,w,k]},dl.prototype.toGeoJSON=function(r,e,a){var l,d,m=this.extent*Math.pow(2,a),y=this.extent*r,w=this.extent*e,b=this.loadGeometry(),k=dl.types[this.type];function A(F){for(var O=0;O<F.length;O++){var Y=F[O];F[O]=[360*(Y.x+y)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(Y.y+w)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var z=[];for(l=0;l<b.length;l++)z[l]=b[l][0];A(b=z);break;case 2:for(l=0;l<b.length;l++)A(b[l]);break;case 3:for(b=function(F){var O=F.length;if(O<=1)return[F];for(var Y,H,ue=[],me=0;me<O;me++){var le=Tb(F[me]);le!==0&&(H===void 0&&(H=le<0),H===le<0?(Y&&ue.push(Y),Y=[F[me]]):Y.push(F[me]))}return Y&&ue.push(Y),ue}(b),l=0;l<b.length;l++)for(d=0;d<b[l].length;d++)A(b[l][d])}b.length===1?b=b[0]:k="Multi"+k;var R={type:"Feature",geometry:{type:k,coordinates:b},properties:this.properties};return"id"in this&&(R.id=this.id),R};var Eb=p_,f_=m_;function m_(r,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(kb,this,e),this.length=this._features.length}function kb(r,e,a){r===15?e.version=a.readVarint():r===1?e.name=a.readString():r===5?e.extent=a.readVarint():r===2?e._features.push(a.pos):r===3?e._keys.push(a.readString()):r===4&&e._values.push(function(l){for(var d=null,m=l.readVarint()+l.pos;l.pos<m;){var y=l.readVarint()>>3;d=y===1?l.readString():y===2?l.readFloat():y===3?l.readDouble():y===4?l.readVarint64():y===5?l.readVarint():y===6?l.readSVarint():y===7?l.readBoolean():null}return d}(a))}m_.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var e=this._pbf.readVarint()+this._pbf.pos;return new Eb(this._pbf,e,this.extent,this._keys,this._values)};var Ib=f_;function Cb(r,e,a){if(r===3){var l=new Ib(a,a.readVarint()+a.pos);l.length&&(e[l.name]=l)}}ho.VectorTile=function(r,e){this.layers=r.readFields(Cb,{},e)},ho.VectorTileFeature=p_,ho.VectorTileLayer=f_;const Ab=ho.VectorTileFeature.types,If=Math.pow(2,13);function Vu(r,e,a,l,d,m,y,w){r.emplaceBack(e,a,2*Math.floor(l*If)+y,d*If*2,m*If*2,Math.round(w))}class Cf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(a=>a.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ct,this.centroidVertexArray=new at,this.indexArray=new fr,this.programConfigurations=new ms(e.layers,e.zoom),this.segments=new Et,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(e,a,l){this.features=[],this.hasPattern=Tf("fill-extrusion",this.layers,a);for(const{feature:d,id:m,index:y,sourceLayerIndex:w}of e){const b=this.layers[0]._featureFilter.needGeometry,k=ys(d,b);if(!this.layers[0]._featureFilter.filter(new an(this.zoom),k,l))continue;const A={id:m,sourceLayerIndex:w,index:y,geometry:b?k.geometry:gs(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(Ef("fill-extrusion",this.layers,A,this.zoom,a)):this.addFeature(A,A.geometry,y,l,{}),a.featureIndex.insert(d,A.geometry,y,w,this.index,!0)}}addFeatures(e,a,l){for(const d of this.features){const{geometry:m}=d;this.addFeature(d,m,d.index,a,l)}}update(e,a,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,a,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,wb),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,xb.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,a,l,d,m){const y={x:0,y:0,vertexCount:0};for(const w of Sf(a,500)){let b=0;for(const O of w)b+=O.length;let k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const O of w){if(O.length===0||zb(O))continue;let Y=0;for(let H=0;H<O.length;H++){const ue=O[H];if(H>=1){const me=O[H-1];if(!Pb(ue,me)){k.vertexLength+4>Et.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const le=ue.sub(me)._perp()._unit(),de=me.dist(ue);Y+de>32768&&(Y=0),Vu(this.layoutVertexArray,ue.x,ue.y,le.x,le.y,0,0,Y),Vu(this.layoutVertexArray,ue.x,ue.y,le.x,le.y,0,1,Y),y.x+=2*ue.x,y.y+=2*ue.y,y.vertexCount+=2,Y+=de,Vu(this.layoutVertexArray,me.x,me.y,le.x,le.y,0,0,Y),Vu(this.layoutVertexArray,me.x,me.y,le.x,le.y,0,1,Y),y.x+=2*me.x,y.y+=2*me.y,y.vertexCount+=2;const Ie=k.vertexLength;this.indexArray.emplaceBack(Ie,Ie+2,Ie+1),this.indexArray.emplaceBack(Ie+1,Ie+2,Ie+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+b>Et.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray)),Ab[e.type]!=="Polygon")continue;const A=[],z=[],R=k.vertexLength;for(const O of w)if(O.length!==0){O!==w[0]&&z.push(A.length/2);for(let Y=0;Y<O.length;Y++){const H=O[Y];Vu(this.layoutVertexArray,H.x,H.y,0,0,1,1,0),y.x+=H.x,y.y+=H.y,y.vertexCount+=1,A.push(H.x),A.push(H.y)}}const F=Nh.exports(A,z);for(let O=0;O<F.length;O+=3)this.indexArray.emplaceBack(R+F[O],R+F[O+2],R+F[O+1]);k.primitiveLength+=F.length/3,k.vertexLength+=b}for(let w=0;w<y.vertexCount;w++)this.centroidVertexArray.emplaceBack(Math.floor(y.x/y.vertexCount),Math.floor(y.y/y.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,m,d)}}function Pb(r,e){return r.x===e.x&&(r.x<0||r.x>zn)||r.y===e.y&&(r.y<0||r.y>zn)}function zb(r){return r.every(e=>e.x<0)||r.every(e=>e.x>zn)||r.every(e=>e.y<0)||r.every(e=>e.y>zn)}Ye("FillExtrusionBucket",Cf,{omit:["layers","features"]});var Mb={paint:new Gn({"fill-extrusion-opacity":new tt(Te["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ct(Te["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new tt(Te["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new tt(Te["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new lo(Te["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ct(Te["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ct(Te["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new tt(Te["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function $u(r,e){return r.x*e.x+r.y*e.y}function g_(r,e){if(r.length===1){let a=0;const l=e[a++];let d;for(;!d||l.equals(d);)if(d=e[a++],!d)return 1/0;for(;a<e.length;a++){const m=e[a],y=r[0],w=d.sub(l),b=m.sub(l),k=y.sub(l),A=$u(w,w),z=$u(w,b),R=$u(b,b),F=$u(k,w),O=$u(k,b),Y=A*R-z*z,H=(R*F-z*O)/Y,ue=(A*O-z*F)/Y,me=l.z*(1-H-ue)+d.z*H+m.z*ue;if(isFinite(me))return me}return 1/0}{let a=1/0;for(const l of e)a=Math.min(a,l.z);return a}}const Db=En([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Lb}=Db,Rb=En([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Bb}=Rb,Fb=ho.VectorTileFeature.types,Ob=Math.cos(Math.PI/180*37.5),y_=Math.pow(2,14)/.5;class Af{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(a=>a.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Dt,this.layoutVertexArray2=new jt,this.indexArray=new fr,this.programConfigurations=new ms(e.layers,e.zoom),this.segments=new Et,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(e,a,l){this.hasPattern=Tf("line",this.layers,a);const d=this.layers[0].layout.get("line-sort-key"),m=!d.isConstant(),y=[];for(const{feature:w,id:b,index:k,sourceLayerIndex:A}of e){const z=this.layers[0]._featureFilter.needGeometry,R=ys(w,z);if(!this.layers[0]._featureFilter.filter(new an(this.zoom),R,l))continue;const F=m?d.evaluate(R,{},l):void 0,O={id:b,properties:w.properties,type:w.type,sourceLayerIndex:A,index:k,geometry:z?R.geometry:gs(w),patterns:{},sortKey:F};y.push(O)}m&&y.sort((w,b)=>w.sortKey-b.sortKey);for(const w of y){const{geometry:b,index:k,sourceLayerIndex:A}=w;if(this.hasPattern){const z=Ef("line",this.layers,w,this.zoom,a);this.patternFeatures.push(z)}else this.addFeature(w,b,k,l,{});a.featureIndex.insert(e[k].feature,b,k,A,this.index)}}update(e,a,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,a,this.stateDependentLayers,l)}addFeatures(e,a,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,a,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Bb)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Lb),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,a,l,d,m){const y=this.layers[0].layout,w=y.get("line-join").evaluate(e,{}),b=y.get("line-cap"),k=y.get("line-miter-limit"),A=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const z of a)this.addLine(z,e,w,b,k,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,m,d)}addLine(e,a,l,d,m,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ue=0;ue<e.length-1;ue++)this.totalDistance+=e[ue].dist(e[ue+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w=Fb[a.type]==="Polygon";let b=e.length;for(;b>=2&&e[b-1].equals(e[b-2]);)b--;let k=0;for(;k<b-1&&e[k].equals(e[k+1]);)k++;if(b<(w?3:2))return;l==="bevel"&&(m=1.05);const A=this.overscaling<=16?122880/(512*this.overscaling):0,z=this.segments.prepareSegment(10*b,this.layoutVertexArray,this.indexArray);let R,F,O,Y,H;this.e1=this.e2=-1,w&&(R=e[b-2],H=e[k].sub(R)._unit()._perp());for(let ue=k;ue<b;ue++){if(O=ue===b-1?w?e[k+1]:void 0:e[ue+1],O&&e[ue].equals(O))continue;H&&(Y=H),R&&(F=R),R=e[ue],H=O?O.sub(R)._unit()._perp():Y,Y=Y||H;let me=Y.add(H);me.x===0&&me.y===0||me._unit();const le=Y.x*H.x+Y.y*H.y,de=me.x*H.x+me.y*H.y,Ie=de!==0?1/de:1/0,ke=2*Math.sqrt(2-2*de),Xe=de<Ob&&F&&O,Qe=Y.x*H.y-Y.y*H.x>0;if(Xe&&ue>k){const De=R.dist(F);if(De>2*A){const qe=R.sub(R.sub(F)._mult(A/De)._round());this.updateDistance(F,qe),this.addCurrentVertex(qe,Y,0,0,z),F=qe}}const Ge=F&&O;let Fe=Ge?l:w?"butt":d;if(Ge&&Fe==="round"&&(Ie<y?Fe="miter":Ie<=2&&(Fe="fakeround")),Fe==="miter"&&Ie>m&&(Fe="bevel"),Fe==="bevel"&&(Ie>2&&(Fe="flipbevel"),Ie<m&&(Fe="miter")),F&&this.updateDistance(F,R),Fe==="miter")me._mult(Ie),this.addCurrentVertex(R,me,0,0,z);else if(Fe==="flipbevel"){if(Ie>100)me=H.mult(-1);else{const De=Ie*Y.add(H).mag()/Y.sub(H).mag();me._perp()._mult(De*(Qe?-1:1))}this.addCurrentVertex(R,me,0,0,z),this.addCurrentVertex(R,me.mult(-1),0,0,z)}else if(Fe==="bevel"||Fe==="fakeround"){const De=-Math.sqrt(Ie*Ie-1),qe=Qe?De:0,Ue=Qe?0:De;if(F&&this.addCurrentVertex(R,Y,qe,Ue,z),Fe==="fakeround"){const Pe=Math.round(180*ke/Math.PI/20);for(let ot=1;ot<Pe;ot++){let nt=ot/Pe;if(nt!==.5){const Qt=nt-.5;nt+=nt*Qt*(nt-1)*((1.0904+le*(le*(3.55645-1.43519*le)-3.2452))*Qt*Qt+(.848013+le*(.215638*le-1.06021)))}const St=H.sub(Y)._mult(nt)._add(Y)._unit()._mult(Qe?-1:1);this.addHalfVertex(R,St.x,St.y,!1,Qe,0,z)}}O&&this.addCurrentVertex(R,H,-qe,-Ue,z)}else if(Fe==="butt")this.addCurrentVertex(R,me,0,0,z);else if(Fe==="square"){const De=F?1:-1;this.addCurrentVertex(R,me,De,De,z)}else Fe==="round"&&(F&&(this.addCurrentVertex(R,Y,0,0,z),this.addCurrentVertex(R,Y,1,1,z,!0)),O&&(this.addCurrentVertex(R,H,-1,-1,z,!0),this.addCurrentVertex(R,H,0,0,z)));if(Xe&&ue<b-1){const De=R.dist(O);if(De>2*A){const qe=R.add(O.sub(R)._mult(A/De)._round());this.updateDistance(R,qe),this.addCurrentVertex(qe,H,0,0,z),R=qe}}}}addCurrentVertex(e,a,l,d,m,y=!1){const w=a.y*d-a.x,b=-a.y-a.x*d;this.addHalfVertex(e,a.x+a.y*l,a.y-a.x*l,y,!1,l,m),this.addHalfVertex(e,w,b,y,!0,-d,m),this.distance>y_/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,a,l,d,m,y))}addHalfVertex({x:e,y:a},l,d,m,y,w,b){const k=.5*(this.lineClips?this.scaledDistance*(y_-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(m?1:0),(a<<1)+(y?1:0),Math.round(63*l)+128,Math.round(63*d)+128,1+(w===0?0:w<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const A=b.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,A),b.primitiveLength++),y?this.e2=A:this.e1=A}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,a){this.distance+=e.dist(a),this.updateScaledDistance()}}Ye("LineBucket",Af,{omit:["layers","patternFeatures"]});const Nb=new Gn({"line-cap":new tt(Te.layout_line["line-cap"]),"line-join":new ct(Te.layout_line["line-join"]),"line-miter-limit":new tt(Te.layout_line["line-miter-limit"]),"line-round-limit":new tt(Te.layout_line["line-round-limit"]),"line-sort-key":new ct(Te.layout_line["line-sort-key"])});var __={paint:new Gn({"line-opacity":new ct(Te.paint_line["line-opacity"]),"line-color":new ct(Te.paint_line["line-color"]),"line-translate":new tt(Te.paint_line["line-translate"]),"line-translate-anchor":new tt(Te.paint_line["line-translate-anchor"]),"line-width":new ct(Te.paint_line["line-width"]),"line-gap-width":new ct(Te.paint_line["line-gap-width"]),"line-offset":new ct(Te.paint_line["line-offset"]),"line-blur":new ct(Te.paint_line["line-blur"]),"line-dasharray":new Au(Te.paint_line["line-dasharray"]),"line-pattern":new lo(Te.paint_line["line-pattern"]),"line-gradient":new ea(Te.paint_line["line-gradient"])}),layout:Nb};const v_=new class extends ct{possiblyEvaluate(r,e){return e=new an(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(r,e)}evaluate(r,e,a,l){return e=be({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(r,e,a,l)}}(__.paint.properties["line-width"].specification);function x_(r,e){return e>0?e+2*r:r}v_.useIntegerZoom=!0;const Ub=En([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Vb=En([{name:"a_projected_pos",components:3,type:"Float32"}],4);En([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const $b=En([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);En([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const w_=En([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),jb=En([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Gb(r,e,a){return r.sections.forEach(l=>{l.text=function(d,m,y){const w=m.layout.get("text-transform").evaluate(y,{});return w==="uppercase"?d=d.toLocaleUpperCase():w==="lowercase"&&(d=d.toLocaleLowerCase()),Ur.applyArabicShaping&&(d=Ur.applyArabicShaping(d)),d}(l.text,e,a)}),r}En([{name:"triangle",components:3,type:"Uint16"}]),En([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),En([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),En([{type:"Float32",name:"offsetX"}]),En([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const ju={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var qn=24,Pf=Wt,b_=function(r,e,a,l,d){var m,y,w=8*d-l-1,b=(1<<w)-1,k=b>>1,A=-7,z=a?d-1:0,R=a?-1:1,F=r[e+z];for(z+=R,m=F&(1<<-A)-1,F>>=-A,A+=w;A>0;m=256*m+r[e+z],z+=R,A-=8);for(y=m&(1<<-A)-1,m>>=-A,A+=l;A>0;y=256*y+r[e+z],z+=R,A-=8);if(m===0)m=1-k;else{if(m===b)return y?NaN:1/0*(F?-1:1);y+=Math.pow(2,l),m-=k}return(F?-1:1)*y*Math.pow(2,m-l)},S_=function(r,e,a,l,d,m){var y,w,b,k=8*m-d-1,A=(1<<k)-1,z=A>>1,R=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=l?0:m-1,O=l?1:-1,Y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(w=isNaN(e)?1:0,y=A):(y=Math.floor(Math.log(e)/Math.LN2),e*(b=Math.pow(2,-y))<1&&(y--,b*=2),(e+=y+z>=1?R/b:R*Math.pow(2,1-z))*b>=2&&(y++,b/=2),y+z>=A?(w=0,y=A):y+z>=1?(w=(e*b-1)*Math.pow(2,d),y+=z):(w=e*Math.pow(2,z-1)*Math.pow(2,d),y=0));d>=8;r[a+F]=255&w,F+=O,w/=256,d-=8);for(y=y<<d|w,k+=d;k>0;r[a+F]=255&y,F+=O,y/=256,k-=8);r[a+F-O]|=128*Y};function Wt(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Wt.Varint=0,Wt.Fixed64=1,Wt.Bytes=2,Wt.Fixed32=5;var po,zf=4294967296,T_=1/zf,E_=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ea(r){return r.type===Wt.Bytes?r.readVarint()+r.pos:r.pos+1}function pl(r,e,a){return a?4294967296*e+(r>>>0):4294967296*(e>>>0)+(r>>>0)}function k_(r,e,a){var l=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));a.realloc(l);for(var d=a.pos-1;d>=r;d--)a.buf[d+l]=a.buf[d]}function qb(r,e){for(var a=0;a<r.length;a++)e.writeVarint(r[a])}function Zb(r,e){for(var a=0;a<r.length;a++)e.writeSVarint(r[a])}function Wb(r,e){for(var a=0;a<r.length;a++)e.writeFloat(r[a])}function Hb(r,e){for(var a=0;a<r.length;a++)e.writeDouble(r[a])}function Xb(r,e){for(var a=0;a<r.length;a++)e.writeBoolean(r[a])}function Yb(r,e){for(var a=0;a<r.length;a++)e.writeFixed32(r[a])}function Kb(r,e){for(var a=0;a<r.length;a++)e.writeSFixed32(r[a])}function Jb(r,e){for(var a=0;a<r.length;a++)e.writeFixed64(r[a])}function Qb(r,e){for(var a=0;a<r.length;a++)e.writeSFixed64(r[a])}function Gh(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+16777216*r[e+3]}function fl(r,e,a){r[a]=e,r[a+1]=e>>>8,r[a+2]=e>>>16,r[a+3]=e>>>24}function I_(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+(r[e+3]<<24)}function e2(r,e,a){r===1&&a.readMessage(t2,e)}function t2(r,e,a){if(r===3){const{id:l,bitmap:d,width:m,height:y,left:w,top:b,advance:k}=a.readMessage(n2,{});e.push({id:l,bitmap:new Bu({width:m+6,height:y+6},d),metrics:{width:m,height:y,left:w,top:b,advance:k}})}}function n2(r,e,a){r===1?e.id=a.readVarint():r===2?e.bitmap=a.readBytes():r===3?e.width=a.readVarint():r===4?e.height=a.readVarint():r===5?e.left=a.readSVarint():r===6?e.top=a.readSVarint():r===7&&(e.advance=a.readVarint())}function C_(r){let e=0,a=0;for(const y of r)e+=y.w*y.h,a=Math.max(a,y.w);r.sort((y,w)=>w.h-y.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),a),h:1/0}];let d=0,m=0;for(const y of r)for(let w=l.length-1;w>=0;w--){const b=l[w];if(!(y.w>b.w||y.h>b.h)){if(y.x=b.x,y.y=b.y,m=Math.max(m,y.y+y.h),d=Math.max(d,y.x+y.w),y.w===b.w&&y.h===b.h){const k=l.pop();w<l.length&&(l[w]=k)}else y.h===b.h?(b.x+=y.w,b.w-=y.w):y.w===b.w?(b.y+=y.h,b.h-=y.h):(l.push({x:b.x+y.w,y:b.y,w:b.w-y.w,h:y.h}),b.y+=y.h,b.h-=y.h);break}}return{w:d,h:m,fill:e/(d*m)||0}}Wt.prototype={destroy:function(){this.buf=null},readFields:function(r,e,a){for(a=a||this.length;this.pos<a;){var l=this.readVarint(),d=l>>3,m=this.pos;this.type=7&l,r(d,e,this),this.pos===m&&this.skip(l)}return e},readMessage:function(r,e){return this.readFields(r,e,this.readVarint()+this.pos)},readFixed32:function(){var r=Gh(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=I_(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=Gh(this.buf,this.pos)+Gh(this.buf,this.pos+4)*zf;return this.pos+=8,r},readSFixed64:function(){var r=Gh(this.buf,this.pos)+I_(this.buf,this.pos+4)*zf;return this.pos+=8,r},readFloat:function(){var r=b_(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=b_(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var e,a,l=this.buf;return e=127&(a=l[this.pos++]),a<128?e:(e|=(127&(a=l[this.pos++]))<<7,a<128?e:(e|=(127&(a=l[this.pos++]))<<14,a<128?e:(e|=(127&(a=l[this.pos++]))<<21,a<128?e:function(d,m,y){var w,b,k=y.buf;if(w=(112&(b=k[y.pos++]))>>4,b<128||(w|=(127&(b=k[y.pos++]))<<3,b<128)||(w|=(127&(b=k[y.pos++]))<<10,b<128)||(w|=(127&(b=k[y.pos++]))<<17,b<128)||(w|=(127&(b=k[y.pos++]))<<24,b<128)||(w|=(1&(b=k[y.pos++]))<<31,b<128))return pl(d,w,m);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(a=l[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var r=this.readVarint()+this.pos,e=this.pos;return this.pos=r,r-e>=12&&E_?function(a,l,d){return E_.decode(a.subarray(l,d))}(this.buf,e,r):function(a,l,d){for(var m="",y=l;y<d;){var w,b,k,A=a[y],z=null,R=A>239?4:A>223?3:A>191?2:1;if(y+R>d)break;R===1?A<128&&(z=A):R===2?(192&(w=a[y+1]))==128&&(z=(31&A)<<6|63&w)<=127&&(z=null):R===3?(b=a[y+2],(192&(w=a[y+1]))==128&&(192&b)==128&&((z=(15&A)<<12|(63&w)<<6|63&b)<=2047||z>=55296&&z<=57343)&&(z=null)):R===4&&(b=a[y+2],k=a[y+3],(192&(w=a[y+1]))==128&&(192&b)==128&&(192&k)==128&&((z=(15&A)<<18|(63&w)<<12|(63&b)<<6|63&k)<=65535||z>=1114112)&&(z=null)),z===null?(z=65533,R=1):z>65535&&(z-=65536,m+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),m+=String.fromCharCode(z),y+=R}return m}(this.buf,e,r)},readBytes:function(){var r=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,r);return this.pos=r,e},readPackedVarint:function(r,e){if(this.type!==Wt.Bytes)return r.push(this.readVarint(e));var a=Ea(this);for(r=r||[];this.pos<a;)r.push(this.readVarint(e));return r},readPackedSVarint:function(r){if(this.type!==Wt.Bytes)return r.push(this.readSVarint());var e=Ea(this);for(r=r||[];this.pos<e;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Wt.Bytes)return r.push(this.readBoolean());var e=Ea(this);for(r=r||[];this.pos<e;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Wt.Bytes)return r.push(this.readFloat());var e=Ea(this);for(r=r||[];this.pos<e;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Wt.Bytes)return r.push(this.readDouble());var e=Ea(this);for(r=r||[];this.pos<e;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Wt.Bytes)return r.push(this.readFixed32());var e=Ea(this);for(r=r||[];this.pos<e;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Wt.Bytes)return r.push(this.readSFixed32());var e=Ea(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Wt.Bytes)return r.push(this.readFixed64());var e=Ea(this);for(r=r||[];this.pos<e;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Wt.Bytes)return r.push(this.readSFixed64());var e=Ea(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed64());return r},skip:function(r){var e=7&r;if(e===Wt.Varint)for(;this.buf[this.pos++]>127;);else if(e===Wt.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Wt.Fixed32)this.pos+=4;else{if(e!==Wt.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(r,e){this.writeVarint(r<<3|e)},realloc:function(r){for(var e=this.length||16;e<this.pos+r;)e*=2;if(e!==this.length){var a=new Uint8Array(e);a.set(this.buf),this.buf=a,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),fl(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),fl(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),fl(this.buf,-1&r,this.pos),fl(this.buf,Math.floor(r*T_),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),fl(this.buf,-1&r,this.pos),fl(this.buf,Math.floor(r*T_),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(e,a){var l,d;if(e>=0?(l=e%4294967296|0,d=e/4294967296|0):(d=~(-e/4294967296),4294967295^(l=~(-e%4294967296))?l=l+1|0:(l=0,d=d+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),function(m,y,w){w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,w.buf[w.pos]=127&(m>>>=7)}(l,0,a),function(m,y){var w=(7&m)<<4;y.buf[y.pos++]|=w|((m>>>=3)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m)))))}(d,a)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(Boolean(r))},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var e=this.pos;this.pos=function(l,d,m){for(var y,w,b=0;b<d.length;b++){if((y=d.charCodeAt(b))>55295&&y<57344){if(!w){y>56319||b+1===d.length?(l[m++]=239,l[m++]=191,l[m++]=189):w=y;continue}if(y<56320){l[m++]=239,l[m++]=191,l[m++]=189,w=y;continue}y=w-55296<<10|y-56320|65536,w=null}else w&&(l[m++]=239,l[m++]=191,l[m++]=189,w=null);y<128?l[m++]=y:(y<2048?l[m++]=y>>6|192:(y<65536?l[m++]=y>>12|224:(l[m++]=y>>18|240,l[m++]=y>>12&63|128),l[m++]=y>>6&63|128),l[m++]=63&y|128)}return m}(this.buf,r,this.pos);var a=this.pos-e;a>=128&&k_(e,a,this),this.pos=e-1,this.writeVarint(a),this.pos+=a},writeFloat:function(r){this.realloc(4),S_(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),S_(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var e=r.length;this.writeVarint(e),this.realloc(e);for(var a=0;a<e;a++)this.buf[this.pos++]=r[a]},writeRawMessage:function(r,e){this.pos++;var a=this.pos;r(e,this);var l=this.pos-a;l>=128&&k_(a,l,this),this.pos=a-1,this.writeVarint(l),this.pos+=l},writeMessage:function(r,e,a){this.writeTag(r,Wt.Bytes),this.writeRawMessage(e,a)},writePackedVarint:function(r,e){e.length&&this.writeMessage(r,qb,e)},writePackedSVarint:function(r,e){e.length&&this.writeMessage(r,Zb,e)},writePackedBoolean:function(r,e){e.length&&this.writeMessage(r,Xb,e)},writePackedFloat:function(r,e){e.length&&this.writeMessage(r,Wb,e)},writePackedDouble:function(r,e){e.length&&this.writeMessage(r,Hb,e)},writePackedFixed32:function(r,e){e.length&&this.writeMessage(r,Yb,e)},writePackedSFixed32:function(r,e){e.length&&this.writeMessage(r,Kb,e)},writePackedFixed64:function(r,e){e.length&&this.writeMessage(r,Jb,e)},writePackedSFixed64:function(r,e){e.length&&this.writeMessage(r,Qb,e)},writeBytesField:function(r,e){this.writeTag(r,Wt.Bytes),this.writeBytes(e)},writeFixed32Field:function(r,e){this.writeTag(r,Wt.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(r,e){this.writeTag(r,Wt.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(r,e){this.writeTag(r,Wt.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(r,e){this.writeTag(r,Wt.Fixed64),this.writeSFixed64(e)},writeVarintField:function(r,e){this.writeTag(r,Wt.Varint),this.writeVarint(e)},writeSVarintField:function(r,e){this.writeTag(r,Wt.Varint),this.writeSVarint(e)},writeStringField:function(r,e){this.writeTag(r,Wt.Bytes),this.writeString(e)},writeFloatField:function(r,e){this.writeTag(r,Wt.Fixed32),this.writeFloat(e)},writeDoubleField:function(r,e){this.writeTag(r,Wt.Fixed64),this.writeDouble(e)},writeBooleanField:function(r,e){this.writeVarintField(r,Boolean(e))}};class Mf{constructor(e,{pixelRatio:a,version:l,stretchX:d,stretchY:m,content:y}){this.paddedRect=e,this.pixelRatio=a,this.stretchX=d,this.stretchY=m,this.content=y,this.version=l}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class A_{constructor(e,a){const l={},d={};this.haveRenderCallbacks=[];const m=[];this.addImages(e,l,m),this.addImages(a,d,m);const{w:y,h:w}=C_(m),b=new Qr({width:y||1,height:w||1});for(const k in e){const A=e[k],z=l[k].paddedRect;Qr.copy(A.data,b,{x:0,y:0},{x:z.x+1,y:z.y+1},A.data)}for(const k in a){const A=a[k],z=d[k].paddedRect,R=z.x+1,F=z.y+1,O=A.data.width,Y=A.data.height;Qr.copy(A.data,b,{x:0,y:0},{x:R,y:F},A.data),Qr.copy(A.data,b,{x:0,y:Y-1},{x:R,y:F-1},{width:O,height:1}),Qr.copy(A.data,b,{x:0,y:0},{x:R,y:F+Y},{width:O,height:1}),Qr.copy(A.data,b,{x:O-1,y:0},{x:R-1,y:F},{width:1,height:Y}),Qr.copy(A.data,b,{x:0,y:0},{x:R+O,y:F},{width:1,height:Y})}this.image=b,this.iconPositions=l,this.patternPositions=d}addImages(e,a,l){for(const d in e){const m=e[d],y={x:0,y:0,w:m.data.width+2,h:m.data.height+2};l.push(y),a[d]=new Mf(y,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(e,a){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in e.updatedImages)this.patchUpdatedImage(this.iconPositions[l],e.getImage(l),a),this.patchUpdatedImage(this.patternPositions[l],e.getImage(l),a)}patchUpdatedImage(e,a,l){if(!e||!a||e.version===a.version)return;e.version=a.version;const[d,m]=e.tl;l.update(a.data,void 0,{x:d,y:m})}}Ye("ImagePosition",Mf),Ye("ImageAtlas",A_),u.WritingMode=void 0,(po=u.WritingMode||(u.WritingMode={}))[po.none=0]="none",po[po.horizontal=1]="horizontal",po[po.vertical=2]="vertical",po[po.horizontalOnly=3]="horizontalOnly";const qh=-17;class Gu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,a){const l=new Gu;return l.scale=e||1,l.fontStack=a,l}static forImage(e){const a=new Gu;return a.imageName=e,a}}class ml{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,a){const l=new ml;for(let d=0;d<e.sections.length;d++){const m=e.sections[d];m.image?l.addImageSection(m):l.addTextSection(m,a)}return l}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let a="";for(let l=0;l<e.length;l++){const d=e.charCodeAt(l+1)||null,m=e.charCodeAt(l-1)||null;a+=d&&Eh(d)&&!ju[e[l+1]]||m&&Eh(m)&&!ju[e[l-1]]||!ju[e[l]]?e[l]:ju[e[l]]}return a}(this.text)}trim(){let e=0;for(let l=0;l<this.text.length&&Wh[this.text.charCodeAt(l)];l++)e++;let a=this.text.length;for(let l=this.text.length-1;l>=0&&l>=e&&Wh[this.text.charCodeAt(l)];l--)a--;this.text=this.text.substring(e,a),this.sectionIndex=this.sectionIndex.slice(e,a)}substring(e,a){const l=new ml;return l.text=this.text.substring(e,a),l.sectionIndex=this.sectionIndex.slice(e,a),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,a)=>Math.max(e,this.sections[a].scale),0)}addTextSection(e,a){this.text+=e.text,this.sections.push(Gu.forText(e.scale,e.fontStack||a));const l=this.sections.length-1;for(let d=0;d<e.text.length;++d)this.sectionIndex.push(l)}addImageSection(e){const a=e.image?e.image.name:"";if(a.length===0)return void Ee("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Gu.forImage(a)),this.sectionIndex.push(this.sections.length-1)):Ee("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Zh(r,e,a,l,d,m,y,w,b,k,A,z,R,F,O,Y){const H=ml.fromFeature(r,d);let ue;z===u.WritingMode.vertical&&H.verticalizePunctuation();const{processBidirectionalText:me,processStyledBidirectionalText:le}=Ur;if(me&&H.sections.length===1){ue=[];const ke=me(H.toString(),Df(H,k,m,e,l,F,O));for(const Xe of ke){const Qe=new ml;Qe.text=Xe,Qe.sections=H.sections;for(let Ge=0;Ge<Xe.length;Ge++)Qe.sectionIndex.push(0);ue.push(Qe)}}else if(le){ue=[];const ke=le(H.text,H.sectionIndex,Df(H,k,m,e,l,F,O));for(const Xe of ke){const Qe=new ml;Qe.text=Xe[0],Qe.sectionIndex=Xe[1],Qe.sections=H.sections,ue.push(Qe)}}else ue=function(ke,Xe){const Qe=[],Ge=ke.text;let Fe=0;for(const De of Xe)Qe.push(ke.substring(Fe,De)),Fe=De;return Fe<Ge.length&&Qe.push(ke.substring(Fe,Ge.length)),Qe}(H,Df(H,k,m,e,l,F,O));const de=[],Ie={positionedLines:de,text:H.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:z,iconsInText:!1,verticalizable:!1};return function(ke,Xe,Qe,Ge,Fe,De,qe,Ue,Pe,ot,nt,St){let Qt=0,sn=qh,Mn=0,ti=0;const Kn=Ue==="right"?1:Ue==="left"?0:.5;let kn=0;for(const In of Fe){In.trim();const Qn=In.getMaxScale(),ar=(Qn-1)*qn,yr={positionedGlyphs:[],lineOffset:0};ke.positionedLines[kn]=yr;const Pr=yr.positionedGlyphs;let zr=0;if(!In.length()){sn+=De,++kn;continue}for(let Vn=0;Vn<In.length();Vn++){const kt=In.getSection(Vn),jr=In.getSectionIndex(Vn),er=In.getCharCode(Vn);let or=0,yi=null,Li=null,Ri=null,Ia=qn;const _i=!(Pe===u.WritingMode.horizontal||!nt&&!Su(er)||nt&&(Wh[er]||(Un=er,je.Arabic(Un)||je["Arabic Supplement"](Un)||je["Arabic Extended-A"](Un)||je["Arabic Presentation Forms-A"](Un)||je["Arabic Presentation Forms-B"](Un))));if(kt.imageName){const ni=Ge[kt.imageName];if(!ni)continue;Ri=kt.imageName,ke.iconsInText=ke.iconsInText||!0,Li=ni.paddedRect;const Mr=ni.displaySize;kt.scale=kt.scale*qn/St,yi={width:Mr[0],height:Mr[1],left:1,top:-3,advance:_i?Mr[1]:Mr[0]},or=ar+(qn-Mr[1]*kt.scale),Ia=yi.advance;const Ca=_i?Mr[0]*kt.scale-qn*Qn:Mr[1]*kt.scale-qn*Qn;Ca>0&&Ca>zr&&(zr=Ca)}else{const ni=Qe[kt.fontStack],Mr=ni&&ni[er];if(Mr&&Mr.rect)Li=Mr.rect,yi=Mr.metrics;else{const Ca=Xe[kt.fontStack],Wu=Ca&&Ca[er];if(!Wu)continue;yi=Wu.metrics}or=(Qn-kt.scale)*qn}_i?(ke.verticalizable=!0,Pr.push({glyph:er,imageName:Ri,x:Qt,y:sn+or,vertical:_i,scale:kt.scale,fontStack:kt.fontStack,sectionIndex:jr,metrics:yi,rect:Li}),Qt+=Ia*kt.scale+ot):(Pr.push({glyph:er,imageName:Ri,x:Qt,y:sn+or,vertical:_i,scale:kt.scale,fontStack:kt.fontStack,sectionIndex:jr,metrics:yi,rect:Li}),Qt+=yi.advance*kt.scale+ot)}Pr.length!==0&&(Mn=Math.max(Qt-ot,Mn),a2(Pr,0,Pr.length-1,Kn,zr)),Qt=0;const ln=De*Qn+zr;yr.lineOffset=Math.max(zr,ar),sn+=ln,ti=Math.max(ln,ti),++kn}var Un;const Jn=sn-qh,{horizontalAlign:ir,verticalAlign:Ar}=Lf(qe);(function(In,Qn,ar,yr,Pr,zr,ln,Vn,kt){const jr=(Qn-ar)*Pr;let er=0;er=zr!==ln?-Vn*yr-qh:(-yr*kt+.5)*ln;for(const or of In)for(const yi of or.positionedGlyphs)yi.x+=jr,yi.y+=er})(ke.positionedLines,Kn,ir,Ar,Mn,ti,De,Jn,Fe.length),ke.top+=-Ar*Jn,ke.bottom=ke.top+Jn,ke.left+=-ir*Mn,ke.right=ke.left+Mn}(Ie,e,a,l,ue,y,w,b,z,k,R,Y),!function(ke){for(const Xe of ke)if(Xe.positionedGlyphs.length!==0)return!1;return!0}(de)&&Ie}const Wh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},r2={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function P_(r,e,a,l,d,m){if(e.imageName){const y=l[e.imageName];return y?y.displaySize[0]*e.scale*qn/m+d:0}{const y=a[e.fontStack],w=y&&y[r];return w?w.metrics.advance*e.scale+d:0}}function z_(r,e,a,l){const d=Math.pow(r-e,2);return l?r<e?d/2:2*d:d+Math.abs(a)*a}function i2(r,e,a){let l=0;return r===10&&(l-=1e4),a&&(l+=150),r!==40&&r!==65288||(l+=50),e!==41&&e!==65289||(l+=50),l}function M_(r,e,a,l,d,m){let y=null,w=z_(e,a,d,m);for(const b of l){const k=z_(e-b.x,a,d,m)+b.badness;k<=w&&(y=b,w=k)}return{index:r,x:e,priorBreak:y,badness:w}}function D_(r){return r?D_(r.priorBreak).concat(r.index):[]}function Df(r,e,a,l,d,m,y){if(m!=="point")return[];if(!r)return[];const w=[],b=function(R,F,O,Y,H,ue){let me=0;for(let le=0;le<R.length();le++){const de=R.getSection(le);me+=P_(R.getCharCode(le),de,Y,H,F,ue)}return me/Math.max(1,Math.ceil(me/O))}(r,e,a,l,d,y),k=r.text.indexOf("\u200B")>=0;let A=0;for(let R=0;R<r.length();R++){const F=r.getSection(R),O=r.getCharCode(R);if(Wh[O]||(A+=P_(O,F,l,d,e,y)),R<r.length()-1){const Y=!((z=O)<11904||!(je["Bopomofo Extended"](z)||je.Bopomofo(z)||je["CJK Compatibility Forms"](z)||je["CJK Compatibility Ideographs"](z)||je["CJK Compatibility"](z)||je["CJK Radicals Supplement"](z)||je["CJK Strokes"](z)||je["CJK Symbols and Punctuation"](z)||je["CJK Unified Ideographs Extension A"](z)||je["CJK Unified Ideographs"](z)||je["Enclosed CJK Letters and Months"](z)||je["Halfwidth and Fullwidth Forms"](z)||je.Hiragana(z)||je["Ideographic Description Characters"](z)||je["Kangxi Radicals"](z)||je["Katakana Phonetic Extensions"](z)||je.Katakana(z)||je["Vertical Forms"](z)||je["Yi Radicals"](z)||je["Yi Syllables"](z)));(r2[O]||Y||F.imageName)&&w.push(M_(R+1,A,b,w,i2(O,r.getCharCode(R+1),Y&&k),!1))}}var z;return D_(M_(r.length(),A,b,w,0,!0))}function Lf(r){let e=.5,a=.5;switch(r){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:e,verticalAlign:a}}function a2(r,e,a,l,d){if(!l&&!d)return;const m=r[a],y=(r[a].x+m.metrics.advance*m.scale)*l;for(let w=e;w<=a;w++)r[w].x-=y,r[w].y+=d}function o2(r,e,a){const{horizontalAlign:l,verticalAlign:d}=Lf(a),m=e[0]-r.displaySize[0]*l,y=e[1]-r.displaySize[1]*d;return{image:r,top:y,bottom:y+r.displaySize[1],left:m,right:m+r.displaySize[0]}}function L_(r,e,a,l,d,m){const y=r.image;let w;if(y.content){const H=y.content,ue=y.pixelRatio||1;w=[H[0]/ue,H[1]/ue,y.displaySize[0]-H[2]/ue,y.displaySize[1]-H[3]/ue]}const b=e.left*m,k=e.right*m;let A,z,R,F;a==="width"||a==="both"?(F=d[0]+b-l[3],z=d[0]+k+l[1]):(F=d[0]+(b+k-y.displaySize[0])/2,z=F+y.displaySize[0]);const O=e.top*m,Y=e.bottom*m;return a==="height"||a==="both"?(A=d[1]+O-l[0],R=d[1]+Y+l[2]):(A=d[1]+(O+Y-y.displaySize[1])/2,R=A+y.displaySize[1]),{image:y,top:A,right:z,bottom:R,left:F,collisionPadding:w}}const ka=128;function R_(r,e){const{expression:a}=e;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new an(r+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:d}=a;let m=0;for(;m<l.length&&l[m]<=r;)m++;m=Math.max(0,m-1);let y=m;for(;y<l.length&&l[y]<r+1;)y++;y=Math.min(l.length-1,y);const w=l[m],b=l[y];return a.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:b,interpolationType:d}:{kind:"camera",minZoom:w,maxZoom:b,minSize:a.evaluate(new an(w)),maxSize:a.evaluate(new an(b)),interpolationType:d}}}class fo extends Ke{constructor(e,a,l,d){super(e,a),this.angle=l,d!==void 0&&(this.segment=d)}clone(){return new fo(this.x,this.y,this.angle,this.segment)}}function B_(r,e,a,l,d){if(e.segment===void 0)return!0;let m=e,y=e.segment+1,w=0;for(;w>-a/2;){if(y--,y<0)return!1;w-=r[y].dist(m),m=r[y]}w+=r[y].dist(r[y+1]),y++;const b=[];let k=0;for(;w<a/2;){const A=r[y],z=r[y+1];if(!z)return!1;let R=r[y-1].angleTo(A)-A.angleTo(z);for(R=Math.abs((R+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:w,angleDelta:R}),k+=R;w-b[0].distance>l;)k-=b.shift().angleDelta;if(k>d)return!1;y++,w+=A.dist(z)}return!0}function F_(r){let e=0;for(let a=0;a<r.length-1;a++)e+=r[a].dist(r[a+1]);return e}function O_(r,e,a){return r?.6*e*a:0}function N_(r,e){return Math.max(r?r.right-r.left:0,e?e.right-e.left:0)}function s2(r,e,a,l,d,m){const y=O_(a,d,m),w=N_(a,l)*m;let b=0;const k=F_(r)/2;for(let A=0;A<r.length-1;A++){const z=r[A],R=r[A+1],F=z.dist(R);if(b+F>k){const O=(k-b)/F,Y=nn(z.x,R.x,O),H=nn(z.y,R.y,O),ue=new fo(Y,H,R.angleTo(z),A);return ue._round(),!y||B_(r,ue,w,y,e)?ue:void 0}b+=F}}function l2(r,e,a,l,d,m,y,w,b){const k=O_(l,m,y),A=N_(l,d),z=A*y,R=r[0].x===0||r[0].x===b||r[0].y===0||r[0].y===b;return e-z<e/4&&(e=z+e/4),U_(r,R?e/2*w%e:(A/2+2*m)*y*w%e,e,k,a,z,R,!1,b)}function U_(r,e,a,l,d,m,y,w,b){const k=m/2,A=F_(r);let z=0,R=e-a,F=[];for(let O=0;O<r.length-1;O++){const Y=r[O],H=r[O+1],ue=Y.dist(H),me=H.angleTo(Y);for(;R+a<z+ue;){R+=a;const le=(R-z)/ue,de=nn(Y.x,H.x,le),Ie=nn(Y.y,H.y,le);if(de>=0&&de<b&&Ie>=0&&Ie<b&&R-k>=0&&R+k<=A){const ke=new fo(de,Ie,me,O);ke._round(),l&&!B_(r,ke,m,l,d)||F.push(ke)}}z+=ue}return w||F.length||y||(F=U_(r,z/2,a,l,d,m,y,!0,b)),F}function V_(r,e,a,l,d){const m=[];for(let y=0;y<r.length;y++){const w=r[y];let b;for(let k=0;k<w.length-1;k++){let A=w[k],z=w[k+1];A.x<e&&z.x<e||(A.x<e?A=new Ke(e,A.y+(e-A.x)/(z.x-A.x)*(z.y-A.y))._round():z.x<e&&(z=new Ke(e,A.y+(e-A.x)/(z.x-A.x)*(z.y-A.y))._round()),A.y<a&&z.y<a||(A.y<a?A=new Ke(A.x+(a-A.y)/(z.y-A.y)*(z.x-A.x),a)._round():z.y<a&&(z=new Ke(A.x+(a-A.y)/(z.y-A.y)*(z.x-A.x),a)._round()),A.x>=l&&z.x>=l||(A.x>=l?A=new Ke(l,A.y+(l-A.x)/(z.x-A.x)*(z.y-A.y))._round():z.x>=l&&(z=new Ke(l,A.y+(l-A.x)/(z.x-A.x)*(z.y-A.y))._round()),A.y>=d&&z.y>=d||(A.y>=d?A=new Ke(A.x+(d-A.y)/(z.y-A.y)*(z.x-A.x),d)._round():z.y>=d&&(z=new Ke(A.x+(d-A.y)/(z.y-A.y)*(z.x-A.x),d)._round()),b&&A.equals(b[b.length-1])||(b=[A],m.push(b)),b.push(z)))))}}return m}function $_(r,e,a,l){const d=[],m=r.image,y=m.pixelRatio,w=m.paddedRect.w-2,b=m.paddedRect.h-2,k=r.right-r.left,A=r.bottom-r.top,z=m.stretchX||[[0,w]],R=m.stretchY||[[0,b]],F=(De,qe)=>De+qe[1]-qe[0],O=z.reduce(F,0),Y=R.reduce(F,0),H=w-O,ue=b-Y;let me=0,le=O,de=0,Ie=Y,ke=0,Xe=H,Qe=0,Ge=ue;if(m.content&&l){const De=m.content;me=Hh(z,0,De[0]),de=Hh(R,0,De[1]),le=Hh(z,De[0],De[2]),Ie=Hh(R,De[1],De[3]),ke=De[0]-me,Qe=De[1]-de,Xe=De[2]-De[0]-le,Ge=De[3]-De[1]-Ie}const Fe=(De,qe,Ue,Pe)=>{const ot=Xh(De.stretch-me,le,k,r.left),nt=Yh(De.fixed-ke,Xe,De.stretch,O),St=Xh(qe.stretch-de,Ie,A,r.top),Qt=Yh(qe.fixed-Qe,Ge,qe.stretch,Y),sn=Xh(Ue.stretch-me,le,k,r.left),Mn=Yh(Ue.fixed-ke,Xe,Ue.stretch,O),ti=Xh(Pe.stretch-de,Ie,A,r.top),Kn=Yh(Pe.fixed-Qe,Ge,Pe.stretch,Y),kn=new Ke(ot,St),Un=new Ke(sn,St),Jn=new Ke(sn,ti),ir=new Ke(ot,ti),Ar=new Ke(nt/y,Qt/y),In=new Ke(Mn/y,Kn/y),Qn=e*Math.PI/180;if(Qn){const Pr=Math.sin(Qn),zr=Math.cos(Qn),ln=[zr,-Pr,Pr,zr];kn._matMult(ln),Un._matMult(ln),ir._matMult(ln),Jn._matMult(ln)}const ar=De.stretch+De.fixed,yr=qe.stretch+qe.fixed;return{tl:kn,tr:Un,bl:ir,br:Jn,tex:{x:m.paddedRect.x+1+ar,y:m.paddedRect.y+1+yr,w:Ue.stretch+Ue.fixed-ar,h:Pe.stretch+Pe.fixed-yr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ar,pixelOffsetBR:In,minFontScaleX:Xe/y/k,minFontScaleY:Ge/y/A,isSDF:a}};if(l&&(m.stretchX||m.stretchY)){const De=j_(z,H,O),qe=j_(R,ue,Y);for(let Ue=0;Ue<De.length-1;Ue++){const Pe=De[Ue],ot=De[Ue+1];for(let nt=0;nt<qe.length-1;nt++)d.push(Fe(Pe,qe[nt],ot,qe[nt+1]))}}else d.push(Fe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:b+1}));return d}function Hh(r,e,a){let l=0;for(const d of r)l+=Math.max(e,Math.min(a,d[1]))-Math.max(e,Math.min(a,d[0]));return l}function j_(r,e,a){const l=[{fixed:-1,stretch:0}];for(const[d,m]of r){const y=l[l.length-1];l.push({fixed:d-y.stretch,stretch:y.stretch}),l.push({fixed:d-y.stretch,stretch:y.stretch+(m-d)})}return l.push({fixed:e+1,stretch:a}),l}function Xh(r,e,a,l){return r/e*a+l}function Yh(r,e,a,l){return r-e*a/l}Ye("Anchor",fo);class Kh{constructor(e,a,l,d,m,y,w,b,k,A){if(this.boxStartIndex=e.length,k){let z=y.top,R=y.bottom;const F=y.collisionPadding;F&&(z-=F[1],R+=F[3]);let O=R-z;O>0&&(O=Math.max(10,O),this.circleDiameter=O)}else{let z=y.top*w-b[0],R=y.bottom*w+b[2],F=y.left*w-b[3],O=y.right*w+b[1];const Y=y.collisionPadding;if(Y&&(F-=Y[0]*w,z-=Y[1]*w,O+=Y[2]*w,R+=Y[3]*w),A){const H=new Ke(F,z),ue=new Ke(O,z),me=new Ke(F,R),le=new Ke(O,R),de=A*Math.PI/180;H._rotate(de),ue._rotate(de),me._rotate(de),le._rotate(de),F=Math.min(H.x,ue.x,me.x,le.x),O=Math.max(H.x,ue.x,me.x,le.x),z=Math.min(H.y,ue.y,me.y,le.y),R=Math.max(H.y,ue.y,me.y,le.y)}e.emplaceBack(a.x,a.y,F,z,O,R,l,d,m)}this.boxEndIndex=e.length}}class u2{constructor(e=[],a=c2){if(this.data=e,this.length=this.data.length,this.compare=a,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:a,compare:l}=this,d=a[e];for(;e>0;){const m=e-1>>1,y=a[m];if(l(d,y)>=0)break;a[e]=y,e=m}a[e]=d}_down(e){const{data:a,compare:l}=this,d=this.length>>1,m=a[e];for(;e<d;){let y=1+(e<<1),w=a[y];const b=y+1;if(b<this.length&&l(a[b],w)<0&&(y=b,w=a[b]),l(w,m)>=0)break;a[e]=w,e=y}a[e]=m}}function c2(r,e){return r<e?-1:r>e?1:0}function h2(r,e=1,a=!1){let l=1/0,d=1/0,m=-1/0,y=-1/0;const w=r[0];for(let F=0;F<w.length;F++){const O=w[F];(!F||O.x<l)&&(l=O.x),(!F||O.y<d)&&(d=O.y),(!F||O.x>m)&&(m=O.x),(!F||O.y>y)&&(y=O.y)}const b=Math.min(m-l,y-d);let k=b/2;const A=new u2([],d2);if(b===0)return new Ke(l,d);for(let F=l;F<m;F+=b)for(let O=d;O<y;O+=b)A.push(new gl(F+k,O+k,k,r));let z=function(F){let O=0,Y=0,H=0;const ue=F[0];for(let me=0,le=ue.length,de=le-1;me<le;de=me++){const Ie=ue[me],ke=ue[de],Xe=Ie.x*ke.y-ke.x*Ie.y;Y+=(Ie.x+ke.x)*Xe,H+=(Ie.y+ke.y)*Xe,O+=3*Xe}return new gl(Y/O,H/O,0,F)}(r),R=A.length;for(;A.length;){const F=A.pop();(F.d>z.d||!z.d)&&(z=F,a&&console.log("found best %d after %d probes",Math.round(1e4*F.d)/1e4,R)),F.max-z.d<=e||(k=F.h/2,A.push(new gl(F.p.x-k,F.p.y-k,k,r)),A.push(new gl(F.p.x+k,F.p.y-k,k,r)),A.push(new gl(F.p.x-k,F.p.y+k,k,r)),A.push(new gl(F.p.x+k,F.p.y+k,k,r)),R+=4)}return a&&(console.log(`num probes: ${R}`),console.log(`best distance: ${z.d}`)),z.p}function d2(r,e){return e.max-r.max}function gl(r,e,a,l){this.p=new Ke(r,e),this.h=a,this.d=function(d,m){let y=!1,w=1/0;for(let b=0;b<m.length;b++){const k=m[b];for(let A=0,z=k.length,R=z-1;A<z;R=A++){const F=k[A],O=k[R];F.y>d.y!=O.y>d.y&&d.x<(O.x-F.x)*(d.y-F.y)/(O.y-F.y)+F.x&&(y=!y),w=Math.min(w,Ky(d,F,O))}}return(y?1:-1)*Math.sqrt(w)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}const Rf=Number.POSITIVE_INFINITY;function G_(r,e){return e[1]!==Rf?function(a,l,d){let m=0,y=0;switch(l=Math.abs(l),d=Math.abs(d),a){case"top-right":case"top-left":case"top":y=d-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-d}switch(a){case"top-right":case"bottom-right":case"right":m=-l;break;case"top-left":case"bottom-left":case"left":m=l}return[m,y]}(r,e[0],e[1]):function(a,l){let d=0,m=0;l<0&&(l=0);const y=l/Math.sqrt(2);switch(a){case"top-right":case"top-left":m=y-7;break;case"bottom-right":case"bottom-left":m=7-y;break;case"bottom":m=7-l;break;case"top":m=l-7}switch(a){case"top-right":case"bottom-right":d=-y;break;case"top-left":case"bottom-left":d=y;break;case"left":d=l;break;case"right":d=-l}return[d,m]}(r,e[0])}function Bf(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function p2(r,e,a,l,d,m,y,w,b,k,A){let z=m.textMaxSize.evaluate(e,{});z===void 0&&(z=y);const R=r.layers[0].layout,F=R.get("icon-offset").evaluate(e,{},A),O=Z_(a.horizontal),Y=y/24,H=r.tilePixelRatio*Y,ue=r.tilePixelRatio*z/24,me=r.tilePixelRatio*w,le=r.tilePixelRatio*R.get("symbol-spacing"),de=R.get("text-padding")*r.tilePixelRatio,Ie=function(Pe,ot,nt,St=1){const Qt=Pe.get("icon-padding").evaluate(ot,{},nt),sn=Qt&&Qt.values;return[sn[0]*St,sn[1]*St,sn[2]*St,sn[3]*St]}(R,e,A,r.tilePixelRatio),ke=R.get("text-max-angle")/180*Math.PI,Xe=R.get("text-rotation-alignment")!=="viewport"&&R.get("symbol-placement")!=="point",Qe=R.get("icon-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",Ge=R.get("symbol-placement"),Fe=le/2,De=R.get("icon-text-fit");let qe;l&&De!=="none"&&(r.allowVerticalPlacement&&a.vertical&&(qe=L_(l,a.vertical,De,R.get("icon-text-fit-padding"),F,Y)),O&&(l=L_(l,O,De,R.get("icon-text-fit-padding"),F,Y)));const Ue=(Pe,ot)=>{ot.x<0||ot.x>=zn||ot.y<0||ot.y>=zn||function(nt,St,Qt,sn,Mn,ti,Kn,kn,Un,Jn,ir,Ar,In,Qn,ar,yr,Pr,zr,ln,Vn,kt,jr,er,or,yi){const Li=nt.addToLineVertexArray(St,Qt);let Ri,Ia,_i,ni,Mr=0,Ca=0,Wu=0,lv=0,Zf=-1,Wf=-1;const Aa={};let uv=Nn.exports(""),Hf=0,Xf=0;if(kn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Hf,Xf]=kn.layout.get("text-offset").evaluate(kt,{},or).map(Dr=>Dr*qn):(Hf=kn.layout.get("text-radial-offset").evaluate(kt,{},or)*qn,Xf=Rf),nt.allowVerticalPlacement&&sn.vertical){const Dr=kn.layout.get("text-rotate").evaluate(kt,{},or)+90;_i=new Kh(Un,St,Jn,ir,Ar,sn.vertical,In,Qn,ar,Dr),Kn&&(ni=new Kh(Un,St,Jn,ir,Ar,Kn,Pr,zr,ar,Dr))}if(Mn){const Dr=kn.layout.get("icon-rotate").evaluate(kt,{}),aa=kn.layout.get("icon-text-fit")!=="none",Hu=$_(Mn,Dr,er,aa),Xu=Kn?$_(Kn,Dr,er,aa):void 0;Ia=new Kh(Un,St,Jn,ir,Ar,Mn,Pr,zr,!1,Dr),Mr=4*Hu.length;const dv=nt.iconSizeData;let xs=null;dv.kind==="source"?(xs=[ka*kn.layout.get("icon-size").evaluate(kt,{})],xs[0]>mo&&Ee(`${nt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):dv.kind==="composite"&&(xs=[ka*jr.compositeIconSizes[0].evaluate(kt,{},or),ka*jr.compositeIconSizes[1].evaluate(kt,{},or)],(xs[0]>mo||xs[1]>mo)&&Ee(`${nt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),nt.addSymbols(nt.icon,Hu,xs,Vn,ln,kt,u.WritingMode.none,St,Li.lineStartIndex,Li.lineLength,-1,or),Zf=nt.icon.placedSymbolArray.length-1,Xu&&(Ca=4*Xu.length,nt.addSymbols(nt.icon,Xu,xs,Vn,ln,kt,u.WritingMode.vertical,St,Li.lineStartIndex,Li.lineLength,-1,or),Wf=nt.icon.placedSymbolArray.length-1)}const cv=Object.keys(sn.horizontal);for(const Dr of cv){const aa=sn.horizontal[Dr];if(!Ri){uv=Nn.exports(aa.text);const Xu=kn.layout.get("text-rotate").evaluate(kt,{},or);Ri=new Kh(Un,St,Jn,ir,Ar,aa,In,Qn,ar,Xu)}const Hu=aa.positionedLines.length===1;if(Wu+=q_(nt,St,aa,ti,kn,ar,kt,yr,Li,sn.vertical?u.WritingMode.horizontal:u.WritingMode.horizontalOnly,Hu?cv:[Dr],Aa,Zf,jr,or),Hu)break}sn.vertical&&(lv+=q_(nt,St,sn.vertical,ti,kn,ar,kt,yr,Li,u.WritingMode.vertical,["vertical"],Aa,Wf,jr,or));const k2=Ri?Ri.boxStartIndex:nt.collisionBoxArray.length,I2=Ri?Ri.boxEndIndex:nt.collisionBoxArray.length,C2=_i?_i.boxStartIndex:nt.collisionBoxArray.length,A2=_i?_i.boxEndIndex:nt.collisionBoxArray.length,P2=Ia?Ia.boxStartIndex:nt.collisionBoxArray.length,z2=Ia?Ia.boxEndIndex:nt.collisionBoxArray.length,M2=ni?ni.boxStartIndex:nt.collisionBoxArray.length,D2=ni?ni.boxEndIndex:nt.collisionBoxArray.length;let Bi=-1;const nd=(Dr,aa)=>Dr&&Dr.circleDiameter?Math.max(Dr.circleDiameter,aa):aa;Bi=nd(Ri,Bi),Bi=nd(_i,Bi),Bi=nd(Ia,Bi),Bi=nd(ni,Bi);const hv=Bi>-1?1:0;hv&&(Bi*=yi/qn),nt.glyphOffsetArray.length>=yl.MAX_GLYPHS&&Ee("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),kt.sortKey!==void 0&&nt.addToSortKeyRanges(nt.symbolInstances.length,kt.sortKey),nt.symbolInstances.emplaceBack(St.x,St.y,Aa.right>=0?Aa.right:-1,Aa.center>=0?Aa.center:-1,Aa.left>=0?Aa.left:-1,Aa.vertical||-1,Zf,Wf,uv,k2,I2,C2,A2,P2,z2,M2,D2,Jn,Wu,lv,Mr,Ca,hv,0,In,Hf,Xf,Bi)}(r,ot,Pe,a,l,d,qe,r.layers[0],r.collisionBoxArray,e.index,e.sourceLayerIndex,r.index,H,[de,de,de,de],Xe,b,me,Ie,Qe,F,e,m,k,A,y)};if(Ge==="line")for(const Pe of V_(e.geometry,0,0,zn,zn)){const ot=l2(Pe,le,ke,a.vertical||O,l,24,ue,r.overscaling,zn);for(const nt of ot){const St=O;St&&f2(r,St.text,Fe,nt)||Ue(Pe,nt)}}else if(Ge==="line-center"){for(const Pe of e.geometry)if(Pe.length>1){const ot=s2(Pe,ke,a.vertical||O,l,24,ue);ot&&Ue(Pe,ot)}}else if(e.type==="Polygon")for(const Pe of Sf(e.geometry,0)){const ot=h2(Pe,16);Ue(Pe[0],new fo(ot.x,ot.y,0))}else if(e.type==="LineString")for(const Pe of e.geometry)Ue(Pe,new fo(Pe[0].x,Pe[0].y,0));else if(e.type==="Point")for(const Pe of e.geometry)for(const ot of Pe)Ue([ot],new fo(ot.x,ot.y,0))}const mo=32640;function q_(r,e,a,l,d,m,y,w,b,k,A,z,R,F,O){const Y=function(me,le,de,Ie,ke,Xe,Qe,Ge){const Fe=Ie.layout.get("text-rotate").evaluate(Xe,{})*Math.PI/180,De=[];for(const qe of le.positionedLines)for(const Ue of qe.positionedGlyphs){if(!Ue.rect)continue;const Pe=Ue.rect||{};let ot=4,nt=!0,St=1,Qt=0;const sn=(ke||Ge)&&Ue.vertical,Mn=Ue.metrics.advance*Ue.scale/2;if(Ge&&le.verticalizable){const ln=(Ue.scale-1)*qn,Vn=(qn-Ue.metrics.width*Ue.scale)/2;Qt=qe.lineOffset/2-(Ue.imageName?-Vn:ln)}if(Ue.imageName){const ln=Qe[Ue.imageName];nt=ln.sdf,St=ln.pixelRatio,ot=1/St}const ti=ke?[Ue.x+Mn,Ue.y]:[0,0];let Kn=ke?[0,0]:[Ue.x+Mn+de[0],Ue.y+de[1]-Qt],kn=[0,0];sn&&(kn=Kn,Kn=[0,0]);const Un=(Ue.metrics.left-ot)*Ue.scale-Mn+Kn[0],Jn=(-Ue.metrics.top-ot)*Ue.scale+Kn[1],ir=Un+Pe.w*Ue.scale/St,Ar=Jn+Pe.h*Ue.scale/St,In=new Ke(Un,Jn),Qn=new Ke(ir,Jn),ar=new Ke(Un,Ar),yr=new Ke(ir,Ar);if(sn){const ln=new Ke(-Mn,Mn-qh),Vn=-Math.PI/2,kt=12-Mn,jr=new Ke(22-kt,-(Ue.imageName?kt:0)),er=new Ke(...kn);In._rotateAround(Vn,ln)._add(jr)._add(er),Qn._rotateAround(Vn,ln)._add(jr)._add(er),ar._rotateAround(Vn,ln)._add(jr)._add(er),yr._rotateAround(Vn,ln)._add(jr)._add(er)}if(Fe){const ln=Math.sin(Fe),Vn=Math.cos(Fe),kt=[Vn,-ln,ln,Vn];In._matMult(kt),Qn._matMult(kt),ar._matMult(kt),yr._matMult(kt)}const Pr=new Ke(0,0),zr=new Ke(0,0);De.push({tl:In,tr:Qn,bl:ar,br:yr,tex:Pe,writingMode:le.writingMode,glyphOffset:ti,sectionIndex:Ue.sectionIndex,isSDF:nt,pixelOffsetTL:Pr,pixelOffsetBR:zr,minFontScaleX:0,minFontScaleY:0})}return De}(0,a,w,d,m,y,l,r.allowVerticalPlacement),H=r.textSizeData;let ue=null;H.kind==="source"?(ue=[ka*d.layout.get("text-size").evaluate(y,{})],ue[0]>mo&&Ee(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):H.kind==="composite"&&(ue=[ka*F.compositeTextSizes[0].evaluate(y,{},O),ka*F.compositeTextSizes[1].evaluate(y,{},O)],(ue[0]>mo||ue[1]>mo)&&Ee(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),r.addSymbols(r.text,Y,ue,w,m,y,k,e,b.lineStartIndex,b.lineLength,R,O);for(const me of A)z[me]=r.text.placedSymbolArray.length-1;return 4*Y.length}function Z_(r){for(const e in r)return r[e];return null}function f2(r,e,a,l){const d=r.compareText;if(e in d){const m=d[e];for(let y=m.length-1;y>=0;y--)if(l.dist(m[y])<a)return!0}else d[e]=[];return d[e].push(l),!1}const m2=ho.VectorTileFeature.types,g2=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Jh(r,e,a,l,d,m,y,w,b,k,A,z,R){const F=w?Math.min(mo,Math.round(w[0])):0,O=w?Math.min(mo,Math.round(w[1])):0;r.emplaceBack(e,a,Math.round(32*l),Math.round(32*d),m,y,(F<<1)+(b?1:0),O,16*k,16*A,256*z,256*R)}function Ff(r,e,a){r.emplaceBack(e.x,e.y,a),r.emplaceBack(e.x,e.y,a),r.emplaceBack(e.x,e.y,a),r.emplaceBack(e.x,e.y,a)}function y2(r){for(const e of r.sections)if(Ih(e.text))return!0;return!1}class Of{constructor(e){this.layoutVertexArray=new mi,this.indexArray=new fr,this.programConfigurations=e,this.segments=new Et,this.dynamicLayoutVertexArray=new Jr,this.opacityVertexArray=new gi,this.placedSymbolArray=new Ae}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,a,l,d){this.isEmpty()||(l&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ub.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Vb.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,g2,!0),this.opacityVertexBuffer.itemSize=1),(l||d)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ye("SymbolBuffers",Of);class Nf{constructor(e,a,l){this.layoutVertexArray=new e,this.layoutAttributes=a,this.indexArray=new l,this.segments=new Et,this.collisionVertexArray=new Vr}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,$b.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ye("CollisionBuffers",Nf);class yl{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(y=>y.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=yf([]),this.placementViewportMatrix=yf([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=R_(this.zoom,a["text-size"]),this.iconSizeData=R_(this.zoom,a["icon-size"]);const l=this.layers[0].layout,d=l.get("symbol-sort-key"),m=l.get("symbol-z-order");this.canOverlap=Vf(l,"text-overlap","text-allow-overlap")!=="never"||Vf(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(y=>u.WritingMode[y])),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=e.sourceID}createArrays(){this.text=new Of(new ms(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Of(new ms(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Be,this.lineVertexArray=new He,this.symbolInstances=new We}calculateGlyphDependencies(e,a,l,d,m){for(let y=0;y<e.length;y++)if(a[e.charCodeAt(y)]=!0,(l||d)&&m){const w=ju[e.charAt(y)];w&&(a[w.charCodeAt(0)]=!0)}}populate(e,a,l){const d=this.layers[0],m=d.layout,y=m.get("text-font"),w=m.get("text-field"),b=m.get("icon-image"),k=(w.value.kind!=="constant"||w.value.value instanceof te&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),A=b.value.kind!=="constant"||!!b.value.value||Object.keys(b.parameters).length>0,z=m.get("symbol-sort-key");if(this.features=[],!k&&!A)return;const R=a.iconDependencies,F=a.glyphDependencies,O=a.availableImages,Y=new an(this.zoom);for(const{feature:H,id:ue,index:me,sourceLayerIndex:le}of e){const de=d._featureFilter.needGeometry,Ie=ys(H,de);if(!d._featureFilter.filter(Y,Ie,l))continue;let ke,Xe;if(de||(Ie.geometry=gs(H)),k){const Ge=d.getValueAndResolveTokens("text-field",Ie,l,O),Fe=te.factory(Ge);y2(Fe)&&(this.hasRTLText=!0),(!this.hasRTLText||ds()==="unavailable"||this.hasRTLText&&Ur.isParsed())&&(ke=Gb(Fe,d,Ie))}if(A){const Ge=d.getValueAndResolveTokens("icon-image",Ie,l,O);Xe=Ge instanceof oe?Ge:oe.fromString(Ge)}if(!ke&&!Xe)continue;const Qe=this.sortFeaturesByKey?z.evaluate(Ie,{},l):void 0;if(this.features.push({id:ue,text:ke,icon:Xe,index:me,sourceLayerIndex:le,geometry:Ie.geometry,properties:H.properties,type:m2[H.type],sortKey:Qe}),Xe&&(R[Xe.name]=!0),ke){const Ge=y.evaluate(Ie,{},l).join(","),Fe=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(u.WritingMode.vertical)>=0;for(const De of ke.sections)if(De.image)R[De.image.name]=!0;else{const qe=al(ke.toString()),Ue=De.fontStack||Ge,Pe=F[Ue]=F[Ue]||{};this.calculateGlyphDependencies(De.text,Pe,Fe,this.allowVerticalPlacement,qe)}}}m.get("symbol-placement")==="line"&&(this.features=function(H){const ue={},me={},le=[];let de=0;function Ie(Ge){le.push(H[Ge]),de++}function ke(Ge,Fe,De){const qe=me[Ge];return delete me[Ge],me[Fe]=qe,le[qe].geometry[0].pop(),le[qe].geometry[0]=le[qe].geometry[0].concat(De[0]),qe}function Xe(Ge,Fe,De){const qe=ue[Fe];return delete ue[Fe],ue[Ge]=qe,le[qe].geometry[0].shift(),le[qe].geometry[0]=De[0].concat(le[qe].geometry[0]),qe}function Qe(Ge,Fe,De){const qe=De?Fe[0][Fe[0].length-1]:Fe[0][0];return`${Ge}:${qe.x}:${qe.y}`}for(let Ge=0;Ge<H.length;Ge++){const Fe=H[Ge],De=Fe.geometry,qe=Fe.text?Fe.text.toString():null;if(!qe){Ie(Ge);continue}const Ue=Qe(qe,De),Pe=Qe(qe,De,!0);if(Ue in me&&Pe in ue&&me[Ue]!==ue[Pe]){const ot=Xe(Ue,Pe,De),nt=ke(Ue,Pe,le[ot].geometry);delete ue[Ue],delete me[Pe],me[Qe(qe,le[nt].geometry,!0)]=nt,le[ot].geometry=null}else Ue in me?ke(Ue,Pe,De):Pe in ue?Xe(Ue,Pe,De):(Ie(Ge),ue[Ue]=de-1,me[Pe]=de-1)}return le.filter(Ge=>Ge.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((H,ue)=>H.sortKey-ue.sortKey)}update(e,a,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,a,this.layers,l),this.icon.programConfigurations.updatePaintArrays(e,a,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,a){const l=this.lineVertexArray.length;if(e.segment!==void 0){let d=e.dist(a[e.segment+1]),m=e.dist(a[e.segment]);const y={};for(let w=e.segment+1;w<a.length;w++)y[w]={x:a[w].x,y:a[w].y,tileUnitDistanceFromAnchor:d},w<a.length-1&&(d+=a[w+1].dist(a[w]));for(let w=e.segment||0;w>=0;w--)y[w]={x:a[w].x,y:a[w].y,tileUnitDistanceFromAnchor:m},w>0&&(m+=a[w-1].dist(a[w]));for(let w=0;w<a.length;w++){const b=y[w];this.lineVertexArray.emplaceBack(b.x,b.y,b.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(e,a,l,d,m,y,w,b,k,A,z,R){const F=e.indexArray,O=e.layoutVertexArray,Y=e.segments.prepareSegment(4*a.length,O,F,this.canOverlap?y.sortKey:void 0),H=this.glyphOffsetArray.length,ue=Y.vertexLength,me=this.allowVerticalPlacement&&w===u.WritingMode.vertical?Math.PI/2:0,le=y.text&&y.text.sections;for(let de=0;de<a.length;de++){const{tl:Ie,tr:ke,bl:Xe,br:Qe,tex:Ge,pixelOffsetTL:Fe,pixelOffsetBR:De,minFontScaleX:qe,minFontScaleY:Ue,glyphOffset:Pe,isSDF:ot,sectionIndex:nt}=a[de],St=Y.vertexLength,Qt=Pe[1];Jh(O,b.x,b.y,Ie.x,Qt+Ie.y,Ge.x,Ge.y,l,ot,Fe.x,Fe.y,qe,Ue),Jh(O,b.x,b.y,ke.x,Qt+ke.y,Ge.x+Ge.w,Ge.y,l,ot,De.x,Fe.y,qe,Ue),Jh(O,b.x,b.y,Xe.x,Qt+Xe.y,Ge.x,Ge.y+Ge.h,l,ot,Fe.x,De.y,qe,Ue),Jh(O,b.x,b.y,Qe.x,Qt+Qe.y,Ge.x+Ge.w,Ge.y+Ge.h,l,ot,De.x,De.y,qe,Ue),Ff(e.dynamicLayoutVertexArray,b,me),F.emplaceBack(St,St+1,St+2),F.emplaceBack(St+1,St+2,St+3),Y.vertexLength+=4,Y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Pe[0]),de!==a.length-1&&nt===a[de+1].sectionIndex||e.programConfigurations.populatePaintArrays(O.length,y,y.index,{},R,le&&le[nt])}e.placedSymbolArray.emplaceBack(b.x,b.y,H,this.glyphOffsetArray.length-H,ue,k,A,b.segment,l?l[0]:0,l?l[1]:0,d[0],d[1],w,0,!1,0,z)}_addCollisionDebugVertex(e,a,l,d,m,y){return a.emplaceBack(0,0),e.emplaceBack(l.x,l.y,d,m,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(e,a,l,d,m,y,w){const b=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),k=b.vertexLength,A=m.layoutVertexArray,z=m.collisionVertexArray,R=w.anchorX,F=w.anchorY;this._addCollisionDebugVertex(A,z,y,R,F,new Ke(e,a)),this._addCollisionDebugVertex(A,z,y,R,F,new Ke(l,a)),this._addCollisionDebugVertex(A,z,y,R,F,new Ke(l,d)),this._addCollisionDebugVertex(A,z,y,R,F,new Ke(e,d)),b.vertexLength+=4;const O=m.indexArray;O.emplaceBack(k,k+1),O.emplaceBack(k+1,k+2),O.emplaceBack(k+2,k+3),O.emplaceBack(k+3,k),b.primitiveLength+=4}addDebugCollisionBoxes(e,a,l,d){for(let m=e;m<a;m++){const y=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,d?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Nf(ra,w_.members,Mi),this.iconCollisionBox=new Nf(ra,w_.members,Mi);for(let e=0;e<this.symbolInstances.length;e++){const a=this.symbolInstances.get(e);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(e,a,l,d,m,y,w,b,k){const A={};for(let z=a;z<l;z++){const R=e.get(z);A.textBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},A.textFeatureIndex=R.featureIndex;break}for(let z=d;z<m;z++){const R=e.get(z);A.verticalTextBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},A.verticalTextFeatureIndex=R.featureIndex;break}for(let z=y;z<w;z++){const R=e.get(z);A.iconBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},A.iconFeatureIndex=R.featureIndex;break}for(let z=b;z<k;z++){const R=e.get(z);A.verticalIconBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},A.verticalIconFeatureIndex=R.featureIndex;break}return A}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const l=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,a){const l=e.placedSymbolArray.get(a),d=l.vertexStartIndex+4*l.numGlyphs;for(let m=l.vertexStartIndex;m<d;m+=4)e.indexArray.emplaceBack(m,m+1,m+2),e.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(e),l=Math.cos(e),d=[],m=[],y=[];for(let w=0;w<this.symbolInstances.length;++w){y.push(w);const b=this.symbolInstances.get(w);d.push(0|Math.round(a*b.anchorX+l*b.anchorY)),m.push(b.featureIndex)}return y.sort((w,b)=>d[w]-d[b]||m[b]-m[w]),y}addToSortKeyRanges(e,a){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===a?l.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const l=this.symbolInstances.get(a);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((d,m,y)=>{d>=0&&y.indexOf(d)===m&&this.addIndicesForPlacedSymbol(this.text,d)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ye("SymbolBucket",yl,{omit:["layers","collisionBoxArray","features","compareText"]}),yl.MAX_GLYPHS=65535,yl.addDynamicAttributes=Ff;const _2=new Gn({"symbol-placement":new tt(Te.layout_symbol["symbol-placement"]),"symbol-spacing":new tt(Te.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new tt(Te.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ct(Te.layout_symbol["symbol-sort-key"]),"symbol-z-order":new tt(Te.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new tt(Te.layout_symbol["icon-allow-overlap"]),"icon-overlap":new tt(Te.layout_symbol["icon-overlap"]),"icon-ignore-placement":new tt(Te.layout_symbol["icon-ignore-placement"]),"icon-optional":new tt(Te.layout_symbol["icon-optional"]),"icon-rotation-alignment":new tt(Te.layout_symbol["icon-rotation-alignment"]),"icon-size":new ct(Te.layout_symbol["icon-size"]),"icon-text-fit":new tt(Te.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new tt(Te.layout_symbol["icon-text-fit-padding"]),"icon-image":new ct(Te.layout_symbol["icon-image"]),"icon-rotate":new ct(Te.layout_symbol["icon-rotate"]),"icon-padding":new ct(Te.layout_symbol["icon-padding"]),"icon-keep-upright":new tt(Te.layout_symbol["icon-keep-upright"]),"icon-offset":new ct(Te.layout_symbol["icon-offset"]),"icon-anchor":new ct(Te.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new tt(Te.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new tt(Te.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new tt(Te.layout_symbol["text-rotation-alignment"]),"text-field":new ct(Te.layout_symbol["text-field"]),"text-font":new ct(Te.layout_symbol["text-font"]),"text-size":new ct(Te.layout_symbol["text-size"]),"text-max-width":new ct(Te.layout_symbol["text-max-width"]),"text-line-height":new tt(Te.layout_symbol["text-line-height"]),"text-letter-spacing":new ct(Te.layout_symbol["text-letter-spacing"]),"text-justify":new ct(Te.layout_symbol["text-justify"]),"text-radial-offset":new ct(Te.layout_symbol["text-radial-offset"]),"text-variable-anchor":new tt(Te.layout_symbol["text-variable-anchor"]),"text-anchor":new ct(Te.layout_symbol["text-anchor"]),"text-max-angle":new tt(Te.layout_symbol["text-max-angle"]),"text-writing-mode":new tt(Te.layout_symbol["text-writing-mode"]),"text-rotate":new ct(Te.layout_symbol["text-rotate"]),"text-padding":new tt(Te.layout_symbol["text-padding"]),"text-keep-upright":new tt(Te.layout_symbol["text-keep-upright"]),"text-transform":new ct(Te.layout_symbol["text-transform"]),"text-offset":new ct(Te.layout_symbol["text-offset"]),"text-allow-overlap":new tt(Te.layout_symbol["text-allow-overlap"]),"text-overlap":new tt(Te.layout_symbol["text-overlap"]),"text-ignore-placement":new tt(Te.layout_symbol["text-ignore-placement"]),"text-optional":new tt(Te.layout_symbol["text-optional"])});var Uf={paint:new Gn({"icon-opacity":new ct(Te.paint_symbol["icon-opacity"]),"icon-color":new ct(Te.paint_symbol["icon-color"]),"icon-halo-color":new ct(Te.paint_symbol["icon-halo-color"]),"icon-halo-width":new ct(Te.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ct(Te.paint_symbol["icon-halo-blur"]),"icon-translate":new tt(Te.paint_symbol["icon-translate"]),"icon-translate-anchor":new tt(Te.paint_symbol["icon-translate-anchor"]),"text-opacity":new ct(Te.paint_symbol["text-opacity"]),"text-color":new ct(Te.paint_symbol["text-color"],{runtimeType:jn,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new ct(Te.paint_symbol["text-halo-color"]),"text-halo-width":new ct(Te.paint_symbol["text-halo-width"]),"text-halo-blur":new ct(Te.paint_symbol["text-halo-blur"]),"text-translate":new tt(Te.paint_symbol["text-translate"]),"text-translate-anchor":new tt(Te.paint_symbol["text-translate-anchor"])}),layout:_2};class W_{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Xi,this.defaultValue=e}evaluate(e){if(e.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(e.formattedSection))return a.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ye("FormatSectionOverride",W_,{omit:["defaultValue"]});class Qh extends fi{constructor(e){super(e,Uf)}recalculate(e,a){if(super.recalculate(e,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const d=[];for(const m of l)d.indexOf(m)<0&&d.push(m);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,a,l,d){const m=this.layout.get(e).evaluate(a,{},l,d),y=this._unevaluatedLayout._values[e];return y.isDataDriven()||Qo(y.value)||!m?m:function(w,b){return b.replace(/{([^{}]+)}/g,(k,A)=>A in w?String(w[A]):"")}(a.properties,m)}createBucket(e){return new yl(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of Uf.paint.overridableProperties){if(!Qh.hasPaintOverride(this.layout,e))continue;const a=this.paint.get(e),l=new W_(a),d=new Qs(l,a.property.specification);let m=null;m=a.value.kind==="constant"||a.value.kind==="source"?new ts("source",d):new yu("composite",d,a.value.zoomStops),this.paint._values[e]=new pi(a.property,m,a.parameters)}}_handleOverridablePaintPropertyUpdate(e,a,l){return!(!this.layout||a.isDataDriven()||l.isDataDriven())&&Qh.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,a){const l=e.get("text-field"),d=Uf.paint.properties[a];let m=!1;const y=w=>{for(const b of w)if(d.overrides&&d.overrides.hasOverride(b))return void(m=!0)};if(l.value.kind==="constant"&&l.value.value instanceof te)y(l.value.value.sections);else if(l.value.kind==="source"){const w=k=>{m||(k instanceof et&&ge(k.value)===Rn?y(k.value.sections):k instanceof Ks?y(k.sections):k.eachChild(w))},b=l.value;b._styleExpression&&w(b._styleExpression.expression)}return m}}function Vf(r,e,a){let l="never";const d=r.get(e);return d?l=d:r.get(a)&&(l="always"),l}var v2={paint:new Gn({"background-color":new tt(Te.paint_background["background-color"]),"background-pattern":new Au(Te.paint_background["background-pattern"]),"background-opacity":new tt(Te.paint_background["background-opacity"])})},x2={paint:new Gn({"raster-opacity":new tt(Te.paint_raster["raster-opacity"]),"raster-hue-rotate":new tt(Te.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new tt(Te.paint_raster["raster-brightness-min"]),"raster-brightness-max":new tt(Te.paint_raster["raster-brightness-max"]),"raster-saturation":new tt(Te.paint_raster["raster-saturation"]),"raster-contrast":new tt(Te.paint_raster["raster-contrast"]),"raster-resampling":new tt(Te.paint_raster["raster-resampling"]),"raster-fade-duration":new tt(Te.paint_raster["raster-fade-duration"])})};class w2 extends fi{constructor(e){super(e,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const b2={circle:class extends fi{constructor(r){super(r,Qw)}createBucket(r){return new ff(r)}queryRadius(r){const e=r;return Lu("circle-radius",this,e)+Lu("circle-stroke-width",this,e)+Bh(this.paint.get("circle-translate"))}queryIntersectsFeature(r,e,a,l,d,m,y,w){const b=Fh(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,y),k=this.paint.get("circle-radius").evaluate(e,a)+this.paint.get("circle-stroke-width").evaluate(e,a),A=this.paint.get("circle-pitch-alignment")==="map",z=A?b:function(F,O){return F.map(Y=>i_(Y,O))}(b,w),R=A?k*y:k;for(const F of l)for(const O of F){const Y=A?O:i_(O,w);let H=R;const ue=Oh([],[O.x,O.y,0,1],w);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?H*=ue[3]/m.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(H*=m.cameraToCenterDistance/ue[3]),Hw(z,Y,H))return!0}return!1}},heatmap:class extends fi{constructor(r){super(r,tb),this._updateColorRamp()}createBucket(r){return new a_(r)}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=s_({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends fi{constructor(r){super(r,nb)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends fi{constructor(r){super(r,_b)}recalculate(r,e){super.recalculate(r,e);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new kf(r)}queryRadius(){return Bh(this.paint.get("fill-translate"))}queryIntersectsFeature(r,e,a,l,d,m,y){return Yy(Fh(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,y),l)}isTileClipped(){return!0}},"fill-extrusion":class extends fi{constructor(r){super(r,Mb)}createBucket(r){return new Cf(r)}queryRadius(){return Bh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(r,e,a,l,d,m,y,w){const b=Fh(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,y),k=this.paint.get("fill-extrusion-height").evaluate(e,a),A=this.paint.get("fill-extrusion-base").evaluate(e,a),z=function(F,O,Y,H){const ue=[];for(const me of F){const le=[me.x,me.y,0,1];Oh(le,le,O),ue.push(new Ke(le[0]/le[3],le[1]/le[3]))}return ue}(b,w),R=function(F,O,Y,H){const ue=[],me=[],le=H[8]*O,de=H[9]*O,Ie=H[10]*O,ke=H[11]*O,Xe=H[8]*Y,Qe=H[9]*Y,Ge=H[10]*Y,Fe=H[11]*Y;for(const De of F){const qe=[],Ue=[];for(const Pe of De){const ot=Pe.x,nt=Pe.y,St=H[0]*ot+H[4]*nt+H[12],Qt=H[1]*ot+H[5]*nt+H[13],sn=H[2]*ot+H[6]*nt+H[14],Mn=H[3]*ot+H[7]*nt+H[15],ti=sn+Ie,Kn=Mn+ke,kn=St+Xe,Un=Qt+Qe,Jn=sn+Ge,ir=Mn+Fe,Ar=new Ke((St+le)/Kn,(Qt+de)/Kn);Ar.z=ti/Kn,qe.push(Ar);const In=new Ke(kn/ir,Un/ir);In.z=Jn/ir,Ue.push(In)}ue.push(qe),me.push(Ue)}return[ue,me]}(l,A,k,w);return function(F,O,Y){let H=1/0;Yy(Y,O)&&(H=g_(Y,O[0]));for(let ue=0;ue<O.length;ue++){const me=O[ue],le=F[ue];for(let de=0;de<me.length-1;de++){const Ie=me[de],ke=[Ie,me[de+1],le[de+1],le[de],Ie];Xy(Y,ke)&&(H=Math.min(H,g_(Y,ke)))}}return H!==1/0&&H}(R[0],R[1],z)}},line:class extends fi{constructor(r){super(r,__),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ho,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,e){super.recalculate(r,e),this.paint._values["line-floorwidth"]=v_.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new Af(r)}queryRadius(r){const e=r,a=x_(Lu("line-width",this,e),Lu("line-gap-width",this,e)),l=Lu("line-offset",this,e);return a/2+Math.abs(l)+Bh(this.paint.get("line-translate"))}queryIntersectsFeature(r,e,a,l,d,m,y){const w=Fh(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,y),b=y/2*x_(this.paint.get("line-width").evaluate(e,a),this.paint.get("line-gap-width").evaluate(e,a)),k=this.paint.get("line-offset").evaluate(e,a);return k&&(l=function(A,z){const R=[];for(let F=0;F<A.length;F++){const O=A[F],Y=[];for(let H=0;H<O.length;H++){const ue=O[H-1],me=O[H],le=O[H+1],de=H===0?new Ke(0,0):me.sub(ue)._unit()._perp(),Ie=H===O.length-1?new Ke(0,0):le.sub(me)._unit()._perp(),ke=de._add(Ie)._unit(),Xe=ke.x*Ie.x+ke.y*Ie.y;Xe!==0&&ke._mult(1/Xe),Y.push(ke._mult(z)._add(me))}R.push(Y)}return R}(l,k*y)),function(A,z,R){for(let F=0;F<z.length;F++){const O=z[F];if(A.length>=3){for(let Y=0;Y<O.length;Y++)if(cl(A,O[Y]))return!0}if(Xw(A,O,R))return!0}return!1}(w,l,b)}isTileClipped(){return!0}},symbol:Qh,background:class extends fi{constructor(r){super(r,v2)}},raster:class extends fi{constructor(r){super(r,x2)}}};class S2{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const H_=63710088e-1;class yn{constructor(e,a){if(isNaN(e)||isNaN(a))throw new Error(`Invalid LngLat object: (${e}, ${a})`);if(this.lng=+e,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new yn(pe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const a=Math.PI/180,l=this.lat*a,d=e.lat*a,m=Math.sin(l)*Math.sin(d)+Math.cos(l)*Math.cos(d)*Math.cos((e.lng-this.lng)*a);return H_*Math.acos(Math.min(m,1))}toBounds(e=0){const a=360*e/40075017,l=a/Math.cos(Math.PI/180*this.lat);return new vs(new yn(this.lng-l,this.lat-a),new yn(this.lng+l,this.lat+a))}static convert(e){if(e instanceof yn)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new yn(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new yn(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class vs{constructor(e,a){e&&(a?this.setSouthWest(e).setNorthEast(a):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof yn?new yn(e.lng,e.lat):yn.convert(e),this}setSouthWest(e){return this._sw=e instanceof yn?new yn(e.lng,e.lat):yn.convert(e),this}extend(e){const a=this._sw,l=this._ne;let d,m;if(e instanceof yn)d=e,m=e;else{if(!(e instanceof vs))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(vs.convert(e)):this.extend(yn.convert(e)):this;if(d=e._sw,m=e._ne,!d||!m)return this}return a||l?(a.lng=Math.min(d.lng,a.lng),a.lat=Math.min(d.lat,a.lat),l.lng=Math.max(m.lng,l.lng),l.lat=Math.max(m.lat,l.lat)):(this._sw=new yn(d.lng,d.lat),this._ne=new yn(m.lng,m.lat)),this}getCenter(){return new yn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new yn(this.getWest(),this.getNorth())}getSouthEast(){return new yn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:a,lat:l}=yn.convert(e);let d=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&d}static convert(e){return e instanceof vs?e:e&&new vs(e)}}const X_=2*Math.PI*H_;function Y_(r){return X_*Math.cos(r*Math.PI/180)}function K_(r){return(180+r)/360}function J_(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Q_(r,e){return r/Y_(e)}function $f(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class ed{constructor(e,a,l=0){this.x=+e,this.y=+a,this.z=+l}static fromLngLat(e,a=0){const l=yn.convert(e);return new ed(K_(l.lng),J_(l.lat),Q_(a,l.lat))}toLngLat(){return new yn(360*this.x-180,$f(this.y))}toAltitude(){return this.z*Y_($f(this.y))}meterInMercatorCoordinateUnits(){return 1/X_*(e=$f(this.y),1/Math.cos(e*Math.PI/180));var e}}function ev(r,e,a){var l=2*Math.PI*6378137/256/Math.pow(2,a);return[r*l-2*Math.PI*6378137/2,e*l-2*Math.PI*6378137/2]}class jf{constructor(e,a,l){if(e<0||e>25||l<0||l>=Math.pow(2,e)||a<0||a>=Math.pow(2,e))throw new Error(`x=${a}, y=${l}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=a,this.y=l,this.key=qu(0,e,e,a,l)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,a,l){const d=(y=this.y,w=this.z,b=ev(256*(m=this.x),256*(y=Math.pow(2,w)-y-1),w),k=ev(256*(m+1),256*(y+1),w),b[0]+","+b[1]+","+k[0]+","+k[1]);var m,y,w,b,k;const A=function(z,R,F){let O,Y="";for(let H=z;H>0;H--)O=1<<H-1,Y+=(R&O?1:0)+(F&O?2:0);return Y}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,A).replace(/{bbox-epsg-3857}/g,d)}isChildOf(e){const a=this.z-e.z;return a>0&&e.x===this.x>>a&&e.y===this.y>>a}getTilePoint(e){const a=Math.pow(2,this.z);return new Ke((e.x*a-this.x)*zn,(e.y*a-this.y)*zn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class tv{constructor(e,a){this.wrap=e,this.canonical=a,this.key=qu(e,a.z,a.z,a.x,a.y)}}class ei{constructor(e,a,l,d,m){if(e<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${l}`);this.overscaledZ=e,this.wrap=a,this.canonical=new jf(l,+d,+m),this.key=qu(a,e,l,d,m)}clone(){return new ei(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-e;return e>this.canonical.z?new ei(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ei(e,this.wrap,e,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(e,a){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-e;return e>this.canonical.z?qu(this.wrap*+a,e,this.canonical.z,this.canonical.x,this.canonical.y):qu(this.wrap*+a,e,e,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const a=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>a&&e.canonical.y===this.canonical.y>>a}children(e){if(this.overscaledZ>=e)return[new ei(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,l=2*this.canonical.x,d=2*this.canonical.y;return[new ei(a,this.wrap,a,l,d),new ei(a,this.wrap,a,l+1,d),new ei(a,this.wrap,a,l,d+1),new ei(a,this.wrap,a,l+1,d+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new ei(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new ei(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new tv(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new ed(e.x-this.wrap,e.y))}}function qu(r,e,a,l,d){(r*=2)<0&&(r=-1*r-1);const m=1<<a;return(m*m*r+m*d+l).toString(36)+a.toString(36)+e.toString(36)}Ye("CanonicalTileID",jf),Ye("OverscaledTileID",ei,{omit:["posMatrix"]});class nv{constructor(e,a,l){if(this.uid=e,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return void Ee(`"${l}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const d=this.dim=a.height-2;this.data=new Uint32Array(a.data.buffer),this.encoding=l||"mapbox";for(let m=0;m<d;m++)this.data[this._idx(-1,m)]=this.data[this._idx(0,m)],this.data[this._idx(d,m)]=this.data[this._idx(d-1,m)],this.data[this._idx(m,-1)]=this.data[this._idx(m,0)],this.data[this._idx(m,d)]=this.data[this._idx(m,d-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(d,-1)]=this.data[this._idx(d-1,0)],this.data[this._idx(-1,d)]=this.data[this._idx(0,d-1)],this.data[this._idx(d,d)]=this.data[this._idx(d-1,d-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let m=0;m<d;m++)for(let y=0;y<d;y++){const w=this.get(m,y);w>this.max&&(this.max=w),w<this.min&&(this.min=w)}}get(e,a){const l=new Uint8Array(this.data.buffer),d=4*this._idx(e,a);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(l[d],l[d+1],l[d+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(e,a){if(e<-1||e>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(e+1)}_unpackMapbox(e,a,l){return(256*e*256+256*a+l)/10-1e4}_unpackTerrarium(e,a,l){return 256*e+a+l/256-32768}getPixels(){return new Qr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,a,l){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let d=a*this.dim,m=a*this.dim+this.dim,y=l*this.dim,w=l*this.dim+this.dim;switch(a){case-1:d=m-1;break;case 1:m=d+1}switch(l){case-1:y=w-1;break;case 1:w=y+1}const b=-a*this.dim,k=-l*this.dim;for(let A=y;A<w;A++)for(let z=d;z<m;z++)this.data[this._idx(z,A)]=e.data[this._idx(z+b,A+k)]}}Ye("DEMData",nv);class rv{constructor(e){this._stringToNumber={},this._numberToString=[];for(let a=0;a<e.length;a++){const l=e[a];this._stringToNumber[l]=a,this._numberToString[a]=l}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class iv{constructor(e,a,l,d,m){this.type="Feature",this._vectorTileFeature=e,e._z=a,e._x=l,e._y=d,this.properties=e.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(e[a]=this[a]);return e}}class av{constructor(e,a){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new hs(zn,16,0),this.grid3D=new hs(zn,16,0),this.featureIndexArray=new bt,this.promoteId=a}insert(e,a,l,d,m,y){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,d,m);const b=y?this.grid3D:this.grid;for(let k=0;k<a.length;k++){const A=a[k],z=[1/0,1/0,-1/0,-1/0];for(let R=0;R<A.length;R++){const F=A[R];z[0]=Math.min(z[0],F.x),z[1]=Math.min(z[1],F.y),z[2]=Math.max(z[2],F.x),z[3]=Math.max(z[3],F.y)}z[0]<zn&&z[1]<zn&&z[2]>=0&&z[3]>=0&&b.insert(w,z[0],z[1],z[2],z[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new ho.VectorTile(new Pf(this.rawTileData)).layers,this.sourceLayerCoder=new rv(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,a,l,d){this.loadVTLayers();const m=e.params||{},y=zn/e.tileSize/e.scale,w=nl(m.filter),b=e.queryGeometry,k=e.queryPadding*y,A=sv(b),z=this.grid.query(A.minX-k,A.minY-k,A.maxX+k,A.maxY+k),R=sv(e.cameraQueryGeometry),F=this.grid3D.query(R.minX-k,R.minY-k,R.maxX+k,R.maxY+k,(H,ue,me,le)=>function(de,Ie,ke,Xe,Qe){for(const Fe of de)if(Ie<=Fe.x&&ke<=Fe.y&&Xe>=Fe.x&&Qe>=Fe.y)return!0;const Ge=[new Ke(Ie,ke),new Ke(Ie,Qe),new Ke(Xe,Qe),new Ke(Xe,ke)];if(de.length>2){for(const Fe of Ge)if(cl(de,Fe))return!0}for(let Fe=0;Fe<de.length-1;Fe++)if(Kw(de[Fe],de[Fe+1],Ge))return!0;return!1}(e.cameraQueryGeometry,H-k,ue-k,me+k,le+k));for(const H of F)z.push(H);z.sort(T2);const O={};let Y;for(let H=0;H<z.length;H++){const ue=z[H];if(ue===Y)continue;Y=ue;const me=this.featureIndexArray.get(ue);let le=null;this.loadMatchingFeature(O,me.bucketIndex,me.sourceLayerIndex,me.featureIndex,w,m.layers,m.availableImages,a,l,d,(de,Ie,ke)=>(le||(le=gs(de)),Ie.queryIntersectsFeature(b,de,ke,le,this.z,e.transform,y,e.pixelPosMatrix)))}return O}loadMatchingFeature(e,a,l,d,m,y,w,b,k,A,z){const R=this.bucketLayerIDs[a];if(y&&!function(H,ue){for(let me=0;me<H.length;me++)if(ue.indexOf(H[me])>=0)return!0;return!1}(y,R))return;const F=this.sourceLayerCoder.decode(l),O=this.vtLayers[F].feature(d);if(m.needGeometry){const H=ys(O,!0);if(!m.filter(new an(this.tileID.overscaledZ),H,this.tileID.canonical))return}else if(!m.filter(new an(this.tileID.overscaledZ),O))return;const Y=this.getId(O,F);for(let H=0;H<R.length;H++){const ue=R[H];if(y&&y.indexOf(ue)<0)continue;const me=b[ue];if(!me)continue;let le={};Y&&A&&(le=A.getState(me.sourceLayer||"_geojsonTileLayer",Y));const de=be({},k[ue]);de.paint=ov(de.paint,me.paint,O,le,w),de.layout=ov(de.layout,me.layout,O,le,w);const Ie=!z||z(O,me,le);if(!Ie)continue;const ke=new iv(O,this.z,this.x,this.y,Y);ke.layer=de;let Xe=e[ue];Xe===void 0&&(Xe=e[ue]=[]),Xe.push({featureIndex:d,feature:ke,intersectionZ:Ie})}}lookupSymbolFeatures(e,a,l,d,m,y,w,b){const k={};this.loadVTLayers();const A=nl(m);for(const z of e)this.loadMatchingFeature(k,l,d,z,A,y,w,b,a);return k}hasLayer(e){for(const a of this.bucketLayerIDs)for(const l of a)if(e===l)return!0;return!1}getId(e,a){let l=e.id;return this.promoteId&&(l=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof l=="boolean"&&(l=Number(l))),l}}function ov(r,e,a,l,d){return ee(r,(m,y)=>{const w=e instanceof fs?e.get(y):null;return w&&w.evaluate?w.evaluate(a,l,d):w})}function sv(r){let e=1/0,a=1/0,l=-1/0,d=-1/0;for(const m of r)e=Math.min(e,m.x),a=Math.min(a,m.y),l=Math.max(l,m.x),d=Math.max(d,m.y);return{minX:e,minY:a,maxX:l,maxY:d}}function T2(r,e){return e-r}var Gf;Ye("FeatureIndex",av,{omit:["rawTileData","sourceLayerCoder"]}),u.PerformanceMarkers=void 0,(Gf=u.PerformanceMarkers||(u.PerformanceMarkers={})).create="create",Gf.load="load",Gf.fullLoad="fullLoad";let td=null,Zu=[];const qf=1e3/30,E2={mark(r){performance.mark(r)},frame(r){const e=r;td!=null&&Zu.push(e-td),td=e},clearMetrics(){td=null,Zu=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const r in u.PerformanceMarkers)performance.clearMarks(u.PerformanceMarkers[r])},getPerformanceMetrics(){performance.measure("loadTime",u.PerformanceMarkers.create,u.PerformanceMarkers.load),performance.measure("fullLoadTime",u.PerformanceMarkers.create,u.PerformanceMarkers.fullLoad);const r=performance.getEntriesByName("loadTime")[0].duration,e=performance.getEntriesByName("fullLoadTime")[0].duration,a=Zu.length,l=1/(Zu.reduce((m,y)=>m+y,0)/a/1e3),d=Zu.filter(m=>m>qf).reduce((m,y)=>m+(y-qf)/qf,0);return{loadTime:r,fullLoadTime:e,fps:l,percentDroppedFrames:d/(a+d)*100}}};u.AJAXError=Sr,u.ARRAY_TYPE=gr,u.Actor=class{constructor(r,e,a){this.target=r,this.parent=e,this.mapId=a,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},ze(["receive","process"],this),this.invoker=new S2(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Le()?r:window}send(r,e,a,l,d=!1){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);a&&(this.callbacks[m]=a);const y=vn(this.globalScope)?void 0:[];return this.target.postMessage({id:m,type:r,hasCallback:!!a,targetMapId:l,mustQueue:d,sourceMapId:this.mapId,data:va(e,y)},y),{cancel:()=>{a&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:l,sourceMapId:this.mapId})}}}receive(r){const e=r.data,a=e.id;if(a&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){delete this.tasks[a];const l=this.cancelCallbacks[a];delete this.cancelCallbacks[a],l&&l()}else Le()||e.mustQueue?(this.tasks[a]=e,this.taskQueue.push(a),this.invoker.trigger()):this.processTask(a,e)}process(){if(!this.taskQueue.length)return;const r=this.taskQueue.shift(),e=this.tasks[r];delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(r,e)}processTask(r,e){if(e.type==="<response>"){const a=this.callbacks[r];delete this.callbacks[r],a&&(e.error?a(Ji(e.error)):a(null,Ji(e.data)))}else{let a=!1;const l=vn(this.globalScope)?void 0:[],d=e.hasCallback?(w,b)=>{a=!0,delete this.cancelCallbacks[r],this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:w?va(w):null,data:va(b,l)},l)}:w=>{a=!0};let m=null;const y=Ji(e.data);if(this.parent[e.type])m=this.parent[e.type](e.sourceMapId,y,d);else if(this.parent.getWorkerSource){const w=e.type.split(".");m=this.parent.getWorkerSource(e.sourceMapId,w[0],y.source)[w[1]](y,d)}else d(new Error(`Could not find function ${e.type}`));!a&&m&&m.cancel&&(this.cancelCallbacks[r]=m.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},u.AlphaImage=Bu,u.CanonicalTileID=jf,u.CollisionBoxArray=we,u.CollisionCircleLayoutArray=class extends P{},u.Color=U,u.DEMData=nv,u.DataConstantProperty=tt,u.DictionaryCoder=rv,u.EXTENT=zn,u.ErrorEvent=Wa,u.EvaluationParameters=an,u.Event=Ii,u.Evented=Ci,u.FeatureIndex=av,u.FillBucket=kf,u.FillExtrusionBucket=Cf,u.GeoJSONFeature=iv,u.ImageAtlas=A_,u.ImagePosition=Mf,u.LineBucket=Af,u.LineStripIndexArray=class extends W{},u.LngLat=yn,u.LngLatBounds=vs,u.MercatorCoordinate=ed,u.ONE_EM=qn,u.OverscaledTileID=ei,u.PerformanceUtils=E2,u.PosArray=at,u.Properties=Gn,u.QuadTriangleArray=class extends B{},u.RGBAImage=Qr,u.RasterBoundsArray=class extends h{},u.RequestPerformance=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},u.ResourceType=Ei,u.SegmentVector=Et,u.SymbolBucket=yl,u.Transitionable=Ph,u.TriangleIndexArray=fr,u.Uniform1f=Sa,u.Uniform1i=class extends ba{constructor(r,e){super(r,e),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},u.Uniform2f=class extends ba{constructor(r,e){super(r,e),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},u.Uniform3f=class extends ba{constructor(r,e){super(r,e),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},u.Uniform4f=ll,u.UniformColor=qy,u.UniformMatrix4f=class extends ba{constructor(r,e){super(r,e),this.current=Zw}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let e=1;e<16;e++)if(r[e]!==this.current[e]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},u.UnwrappedTileID=tv,u.ValidationError=Ne,u.ZoomHistory=wu,u.add=function(r,e,a){return r[0]=e[0]+a[0],r[1]=e[1]+a[1],r[2]=e[2]+a[2],r},u.addDynamicAttributes=Ff,u.asyncAll=function(r,e,a){if(!r.length)return a(null,[]);let l=r.length;const d=new Array(r.length);let m=null;r.forEach((y,w)=>{e(y,(b,k)=>{b&&(m=b),d[w]=k,--l==0&&a(m,d)})})},u.bezier=ne,u.bindAll=ze,u.cacheEntryPossiblyAdded=function(r){hr++,hr>Xr&&(r.getActor().send("enforceCacheSizeLimit",en),hr=0)},u.clamp=V,u.clearTileCache=function(r){const e=caches.delete(st);r&&e.catch(r).then(()=>r())},u.clipLine=V_,u.clone=function(r){var e=new gr(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},u.clone$1=ie,u.clone$2=function(r){var e=new gr(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e},u.collisionCircleLayout=jb,u.config=$e,u.copy=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},u.create=function(){var r=new gr(16);return gr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},u.create$1=Qy,u.createExpression=es,u.createFilter=nl,u.createLayout=En,u.createStyleLayer=function(r){return r.type==="custom"?new w2(r):new b2[r.type](r)},u.cross=function(r,e,a){var l=e[0],d=e[1],m=e[2],y=a[0],w=a[1],b=a[2];return r[0]=d*b-m*w,r[1]=m*y-l*b,r[2]=l*w-d*y,r},u.dot=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]},u.dot$1=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]},u.ease=Q,u.emitValidationErrors=il,u.enforceCacheSizeLimit=function(r){cr(),pt&&pt.then(e=>{e.keys().then(a=>{for(let l=0;l<a.length-r;l++)e.delete(a[l])})})},u.equals=function(r,e){var a=r[0],l=r[1],d=r[2],m=r[3],y=r[4],w=r[5],b=r[6],k=r[7],A=r[8],z=r[9],R=r[10],F=r[11],O=r[12],Y=r[13],H=r[14],ue=r[15],me=e[0],le=e[1],de=e[2],Ie=e[3],ke=e[4],Xe=e[5],Qe=e[6],Ge=e[7],Fe=e[8],De=e[9],qe=e[10],Ue=e[11],Pe=e[12],ot=e[13],nt=e[14],St=e[15];return Math.abs(a-me)<=mr*Math.max(1,Math.abs(a),Math.abs(me))&&Math.abs(l-le)<=mr*Math.max(1,Math.abs(l),Math.abs(le))&&Math.abs(d-de)<=mr*Math.max(1,Math.abs(d),Math.abs(de))&&Math.abs(m-Ie)<=mr*Math.max(1,Math.abs(m),Math.abs(Ie))&&Math.abs(y-ke)<=mr*Math.max(1,Math.abs(y),Math.abs(ke))&&Math.abs(w-Xe)<=mr*Math.max(1,Math.abs(w),Math.abs(Xe))&&Math.abs(b-Qe)<=mr*Math.max(1,Math.abs(b),Math.abs(Qe))&&Math.abs(k-Ge)<=mr*Math.max(1,Math.abs(k),Math.abs(Ge))&&Math.abs(A-Fe)<=mr*Math.max(1,Math.abs(A),Math.abs(Fe))&&Math.abs(z-De)<=mr*Math.max(1,Math.abs(z),Math.abs(De))&&Math.abs(R-qe)<=mr*Math.max(1,Math.abs(R),Math.abs(qe))&&Math.abs(F-Ue)<=mr*Math.max(1,Math.abs(F),Math.abs(Ue))&&Math.abs(O-Pe)<=mr*Math.max(1,Math.abs(O),Math.abs(Pe))&&Math.abs(Y-ot)<=mr*Math.max(1,Math.abs(Y),Math.abs(ot))&&Math.abs(H-nt)<=mr*Math.max(1,Math.abs(H),Math.abs(nt))&&Math.abs(ue-St)<=mr*Math.max(1,Math.abs(ue),Math.abs(St))},u.evaluateSizeForFeature=function(r,{uSize:e,uSizeT:a},{lowerSize:l,upperSize:d}){return r.kind==="source"?l/ka:r.kind==="composite"?nn(l/ka,d/ka,a):e},u.evaluateSizeForZoom=function(r,e){let a=0,l=0;if(r.kind==="constant")l=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:d,minZoom:m,maxZoom:y}=r,w=d?V(kr.interpolationFactor(d,e,m,y),0,1):0;r.kind==="camera"?l=nn(r.minSize,r.maxSize,w):a=w}return{uSizeT:a,uSize:l}},u.evaluateVariableOffset=G_,u.evented=Cu,u.exported=Ln,u.exported$1=Xn,u.extend=be,u.filterObject=X,u.fromRotation=function(r,e){var a=Math.sin(e),l=Math.cos(e);return r[0]=l,r[1]=a,r[2]=0,r[3]=-a,r[4]=l,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},u.fromScaling=function(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},u.getAnchorAlignment=Lf,u.getAnchorJustification=Bf,u.getArrayBuffer=Za,u.getImage=Hi,u.getJSON=function(r,e){return qa(be(r,{type:"json"}),e)},u.getOverlapMode=Vf,u.getRTLTextPluginStatus=ds,u.getReferrer=jo,u.getVideo=function(r,e){const a=window.document.createElement("video");a.muted=!0,a.onloadstart=function(){e(null,a)};for(let l=0;l<r.length;l++){const d=window.document.createElement("source");Go(r[l])||(a.crossOrigin="Anonymous"),d.src=r[l],a.appendChild(d)}return{cancel:()=>{}}},u.identity=yf,u.invert=function(r,e){var a=e[0],l=e[1],d=e[2],m=e[3],y=e[4],w=e[5],b=e[6],k=e[7],A=e[8],z=e[9],R=e[10],F=e[11],O=e[12],Y=e[13],H=e[14],ue=e[15],me=a*w-l*y,le=a*b-d*y,de=a*k-m*y,Ie=l*b-d*w,ke=l*k-m*w,Xe=d*k-m*b,Qe=A*Y-z*O,Ge=A*H-R*O,Fe=A*ue-F*O,De=z*H-R*Y,qe=z*ue-F*Y,Ue=R*ue-F*H,Pe=me*Ue-le*qe+de*De+Ie*Fe-ke*Ge+Xe*Qe;return Pe?(r[0]=(w*Ue-b*qe+k*De)*(Pe=1/Pe),r[1]=(d*qe-l*Ue-m*De)*Pe,r[2]=(Y*Xe-H*ke+ue*Ie)*Pe,r[3]=(R*ke-z*Xe-F*Ie)*Pe,r[4]=(b*Fe-y*Ue-k*Ge)*Pe,r[5]=(a*Ue-d*Fe+m*Ge)*Pe,r[6]=(H*de-O*Xe-ue*le)*Pe,r[7]=(A*Xe-R*de+F*le)*Pe,r[8]=(y*qe-w*Fe+k*Qe)*Pe,r[9]=(l*Fe-a*qe-m*Qe)*Pe,r[10]=(O*ke-Y*de+ue*me)*Pe,r[11]=(z*de-A*ke-F*me)*Pe,r[12]=(w*Ge-y*De-b*Qe)*Pe,r[13]=(a*De-l*Ge+d*Qe)*Pe,r[14]=(Y*le-O*Ie-H*me)*Pe,r[15]=(A*Ie-z*le+R*me)*Pe,r):null},u.isImageBitmap=cn,u.isSafari=vn,u.isWorker=Le,u.keysDifference=function(r,e){const a=[];for(const l in r)l in e||a.push(l);return a},u.lazyLoadRTLTextPlugin=function(){Ur.isLoading()||Ur.isLoaded()||ds()!=="deferred"||Ah()},u.makeRequest=qa,u.mapObject=ee,u.mercatorXfromLng=K_,u.mercatorYfromLat=J_,u.mercatorZfromAltitude=Q_,u.mul=eb,u.mul$1=function(r,e,a){return r[0]=e[0]*a[0],r[1]=e[1]*a[1],r[2]=e[2]*a[2],r[3]=e[3]*a[3],r},u.multiply=e_,u.nextPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},u.normalize=function(r,e){var a=e[0],l=e[1],d=e[2],m=a*a+l*l+d*d;return m>0&&(m=1/Math.sqrt(m)),r[0]=e[0]*m,r[1]=e[1]*m,r[2]=e[2]*m,r},u.number=nn,u.ortho=function(r,e,a,l,d,m,y){var w=1/(e-a),b=1/(l-d),k=1/(m-y);return r[0]=-2*w,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*b,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*k,r[11]=0,r[12]=(e+a)*w,r[13]=(d+l)*b,r[14]=(y+m)*k,r[15]=1,r},u.parseCacheControl=vt,u.parseGlyphPbf=function(r){return new Pf(r).readFields(e2,[])},u.pbf=Pf,u.performSymbolLayout=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=zn/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const e=r.bucket.layers[0].layout,a=r.bucket.layers[0]._unevaluatedLayout._values,l={layoutIconSize:a["icon-size"].possiblyEvaluate(new an(r.bucket.zoom+1),r.canonical),layoutTextSize:a["text-size"].possiblyEvaluate(new an(r.bucket.zoom+1),r.canonical),textMaxSize:a["text-size"].possiblyEvaluate(new an(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:b,maxZoom:k}=r.bucket.textSizeData;l.compositeTextSizes=[a["text-size"].possiblyEvaluate(new an(b),r.canonical),a["text-size"].possiblyEvaluate(new an(k),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:b,maxZoom:k}=r.bucket.iconSizeData;l.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new an(b),r.canonical),a["icon-size"].possiblyEvaluate(new an(k),r.canonical)]}const d=e.get("text-line-height")*qn,m=e.get("text-rotation-alignment")!=="viewport"&&e.get("symbol-placement")!=="point",y=e.get("text-keep-upright"),w=e.get("text-size");for(const b of r.bucket.features){const k=e.get("text-font").evaluate(b,{},r.canonical).join(","),A=w.evaluate(b,{},r.canonical),z=l.layoutTextSize.evaluate(b,{},r.canonical),R=l.layoutIconSize.evaluate(b,{},r.canonical),F={horizontal:{},vertical:void 0},O=b.text;let Y,H=[0,0];if(O){const le=O.toString(),de=e.get("text-letter-spacing").evaluate(b,{},r.canonical)*qn,Ie=uf(le)?de:0,ke=e.get("text-anchor").evaluate(b,{},r.canonical),Xe=e.get("text-variable-anchor");if(!Xe){const qe=e.get("text-radial-offset").evaluate(b,{},r.canonical);H=qe?G_(ke,[qe*qn,Rf]):e.get("text-offset").evaluate(b,{},r.canonical).map(Ue=>Ue*qn)}let Qe=m?"center":e.get("text-justify").evaluate(b,{},r.canonical);const Ge=e.get("symbol-placement"),Fe=Ge==="point"?e.get("text-max-width").evaluate(b,{},r.canonical)*qn:0,De=()=>{r.bucket.allowVerticalPlacement&&al(le)&&(F.vertical=Zh(O,r.glyphMap,r.glyphPositions,r.imagePositions,k,Fe,d,ke,"left",Ie,H,u.WritingMode.vertical,!0,Ge,z,A))};if(!m&&Xe){const qe=Qe==="auto"?Xe.map(Pe=>Bf(Pe)):[Qe];let Ue=!1;for(let Pe=0;Pe<qe.length;Pe++){const ot=qe[Pe];if(!F.horizontal[ot])if(Ue)F.horizontal[ot]=F.horizontal[0];else{const nt=Zh(O,r.glyphMap,r.glyphPositions,r.imagePositions,k,Fe,d,"center",ot,Ie,H,u.WritingMode.horizontal,!1,Ge,z,A);nt&&(F.horizontal[ot]=nt,Ue=nt.positionedLines.length===1)}}De()}else{Qe==="auto"&&(Qe=Bf(ke));const qe=Zh(O,r.glyphMap,r.glyphPositions,r.imagePositions,k,Fe,d,ke,Qe,Ie,H,u.WritingMode.horizontal,!1,Ge,z,A);qe&&(F.horizontal[Qe]=qe),De(),al(le)&&m&&y&&(F.vertical=Zh(O,r.glyphMap,r.glyphPositions,r.imagePositions,k,Fe,d,ke,Qe,Ie,H,u.WritingMode.vertical,!1,Ge,z,A))}}let ue=!1;if(b.icon&&b.icon.name){const le=r.imageMap[b.icon.name];le&&(Y=o2(r.imagePositions[b.icon.name],e.get("icon-offset").evaluate(b,{},r.canonical),e.get("icon-anchor").evaluate(b,{},r.canonical)),ue=!!le.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=ue:r.bucket.sdfIcons!==ue&&Ee("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(le.pixelRatio!==r.bucket.pixelRatio||e.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const me=Z_(F.horizontal)||F.vertical;r.bucket.iconsInText=!!me&&me.iconsInText,(me||Y)&&p2(r.bucket,b,F,Y,r.imageMap,l,z,R,H,ue,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},u.perspective=function(r,e,a,l,d){var m,y=1/Math.tan(e/2);return r[0]=y/a,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=y,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,d!=null&&d!==1/0?(r[10]=(d+l)*(m=1/(l-d)),r[14]=2*d*l*m):(r[10]=-1,r[14]=-2*l),r},u.pick=function(r,e){const a={};for(let l=0;l<e.length;l++){const d=e[l];d in r&&(a[d]=r[d])}return a},u.plugin=Ur,u.pointGeometry=Ke,u.polygonIntersectsPolygon=Xy,u.potpack=C_,u.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],u.register=Ye,u.registerForPluginStateChange=function(r){return r({pluginStatus:pr,pluginURL:Qi}),Cu.on("pluginStateChange",r),r},u.renderColorRamp=s_,u.rotateX=function(r,e,a){var l=Math.sin(a),d=Math.cos(a),m=e[4],y=e[5],w=e[6],b=e[7],k=e[8],A=e[9],z=e[10],R=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=m*d+k*l,r[5]=y*d+A*l,r[6]=w*d+z*l,r[7]=b*d+R*l,r[8]=k*d-m*l,r[9]=A*d-y*l,r[10]=z*d-w*l,r[11]=R*d-b*l,r},u.rotateZ=function(r,e,a){var l=Math.sin(a),d=Math.cos(a),m=e[0],y=e[1],w=e[2],b=e[3],k=e[4],A=e[5],z=e[6],R=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=m*d+k*l,r[1]=y*d+A*l,r[2]=w*d+z*l,r[3]=b*d+R*l,r[4]=k*d-m*l,r[5]=A*d-y*l,r[6]=z*d-w*l,r[7]=R*d-b*l,r},u.scale=function(r,e,a){var l=a[0],d=a[1],m=a[2];return r[0]=e[0]*l,r[1]=e[1]*l,r[2]=e[2]*l,r[3]=e[3]*l,r[4]=e[4]*d,r[5]=e[5]*d,r[6]=e[6]*d,r[7]=e[7]*d,r[8]=e[8]*m,r[9]=e[9]*m,r[10]=e[10]*m,r[11]=e[11]*m,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},u.scale$1=function(r,e,a){return r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,r},u.setCacheLimits=function(r,e){en=r,Xr=e},u.setRTLTextPlugin=function(r,e,a=!1){if(pr===Tu||pr===Eu||pr===ku)throw new Error("setRTLTextPlugin cannot be called multiple times.");Qi=Ln.resolveURL(r),pr=Tu,Iu=e,so(),a||Ah()},u.spec=Te,u.sphericalToCartesian=function([r,e,a]){return e+=90,e*=Math.PI/180,a*=Math.PI/180,{x:r*Math.cos(e)*Math.sin(a),y:r*Math.sin(e)*Math.sin(a),z:r*Math.cos(a)}},u.sqrLen=function(r){var e=r[0],a=r[1];return e*e+a*a},u.sub=function(r,e,a){return r[0]=e[0]-a[0],r[1]=e[1]-a[1],r[2]=e[2]-a[2],r},u.toEvaluationFeature=ys,u.transformMat3=function(r,e,a){var l=e[0],d=e[1],m=e[2];return r[0]=l*a[0]+d*a[3]+m*a[6],r[1]=l*a[1]+d*a[4]+m*a[7],r[2]=l*a[2]+d*a[5]+m*a[8],r},u.transformMat4=Oh,u.transformMat4$1=function(r,e,a){var l=e[0],d=e[1];return r[0]=a[0]*l+a[4]*d+a[12],r[1]=a[1]*l+a[5]*d+a[13],r},u.translate=function(r,e,a){var l,d,m,y,w,b,k,A,z,R,F,O,Y=a[0],H=a[1],ue=a[2];return e===r?(r[12]=e[0]*Y+e[4]*H+e[8]*ue+e[12],r[13]=e[1]*Y+e[5]*H+e[9]*ue+e[13],r[14]=e[2]*Y+e[6]*H+e[10]*ue+e[14],r[15]=e[3]*Y+e[7]*H+e[11]*ue+e[15]):(d=e[1],m=e[2],y=e[3],w=e[4],b=e[5],k=e[6],A=e[7],z=e[8],R=e[9],F=e[10],O=e[11],r[0]=l=e[0],r[1]=d,r[2]=m,r[3]=y,r[4]=w,r[5]=b,r[6]=k,r[7]=A,r[8]=z,r[9]=R,r[10]=F,r[11]=O,r[12]=l*Y+w*H+z*ue+e[12],r[13]=d*Y+b*H+R*ue+e[13],r[14]=m*Y+k*H+F*ue+e[14],r[15]=y*Y+A*H+O*ue+e[15]),r},u.triggerPluginCompletionEvent=Ch,u.unicodeBlockLookup=je,u.uniqueId=function(){return ye++},u.validateCustomStyleLayer=function(r){const e=[],a=r.id;return a===void 0&&e.push({message:`layers.${a}: missing required property "id"`}),r.render===void 0&&e.push({message:`layers.${a}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&e.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),e},u.validateLight=xu,u.validateStyle=cs,u.vectorTile=ho,u.warnOnce=Ee,u.wrap=pe}),v(["./shared"],function(u){function L($){const C=typeof $;if(C==="number"||C==="boolean"||C==="string"||$==null)return JSON.stringify($);if(Array.isArray($)){let U="[";for(const K of $)U+=`${L(K)},`;return`${U}]`}const M=Object.keys($).sort();let N="{";for(let U=0;U<M.length;U++)N+=`${JSON.stringify(M[U])}:${L($[M[U]])},`;return`${N}}`}function q($){let C="";for(const M of u.refProperties)C+=`/${L($[M])}`;return C}class ne{constructor(C){this.keyCache={},C&&this.replace(C)}replace(C){this._layerConfigs={},this._layers={},this.update(C,[])}update(C,M){for(const U of C){this._layerConfigs[U.id]=U;const K=this._layers[U.id]=u.createStyleLayer(U);K._featureFilter=u.createFilter(K.filter),this.keyCache[U.id]&&delete this.keyCache[U.id]}for(const U of M)delete this.keyCache[U],delete this._layerConfigs[U],delete this._layers[U];this.familiesBySource={};const N=function(U,K){const ae={};for(let J=0;J<U.length;J++){const oe=K&&K[U[J].id]||q(U[J]);K&&(K[U[J].id]=oe);let _e=ae[oe];_e||(_e=ae[oe]=[]),_e.push(U[J])}const te=[];for(const J in ae)te.push(ae[J]);return te}(Object.values(this._layerConfigs),this.keyCache);for(const U of N){const K=U.map(Ce=>this._layers[Ce.id]),ae=K[0];if(ae.visibility==="none")continue;const te=ae.source||"";let J=this.familiesBySource[te];J||(J=this.familiesBySource[te]={});const oe=ae.sourceLayer||"_geojsonTileLayer";let _e=J[oe];_e||(_e=J[oe]=[]),_e.push(K)}}}class Q{constructor(C){const M={},N=[];for(const te in C){const J=C[te],oe=M[te]={};for(const _e in J){const Ce=J[+_e];if(!Ce||Ce.bitmap.width===0||Ce.bitmap.height===0)continue;const ge={x:0,y:0,w:Ce.bitmap.width+2,h:Ce.bitmap.height+2};N.push(ge),oe[_e]={rect:ge,metrics:Ce.metrics}}}const{w:U,h:K}=u.potpack(N),ae=new u.AlphaImage({width:U||1,height:K||1});for(const te in C){const J=C[te];for(const oe in J){const _e=J[+oe];if(!_e||_e.bitmap.width===0||_e.bitmap.height===0)continue;const Ce=M[te][oe].rect;u.AlphaImage.copy(_e.bitmap,ae,{x:0,y:0},{x:Ce.x+1,y:Ce.y+1},_e.bitmap)}}this.image=ae,this.positions=M}}u.register("GlyphAtlas",Q);class V{constructor(C){this.tileID=new u.OverscaledTileID(C.tileID.overscaledZ,C.tileID.wrap,C.tileID.canonical.z,C.tileID.canonical.x,C.tileID.canonical.y),this.uid=C.uid,this.zoom=C.zoom,this.pixelRatio=C.pixelRatio,this.tileSize=C.tileSize,this.source=C.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=C.showCollisionBoxes,this.collectResourceTiming=!!C.collectResourceTiming,this.returnDependencies=!!C.returnDependencies,this.promoteId=C.promoteId}parse(C,M,N,U,K){this.status="parsing",this.data=C,this.collisionBoxArray=new u.CollisionBoxArray;const ae=new u.DictionaryCoder(Object.keys(C.layers).sort()),te=new u.FeatureIndex(this.tileID,this.promoteId);te.bucketLayerIDs=[];const J={},oe={featureIndex:te,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:N},_e=M.familiesBySource[this.source];for(const ft in _e){const wt=C.layers[ft];if(!wt)continue;wt.version===1&&u.warnOnce(`Vector tile source "${this.source}" layer "${ft}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Mt=ae.encode(ft),qt=[];for(let Bn=0;Bn<wt.length;Bn++){const tn=wt.feature(Bn),Yn=te.getId(tn,ft);qt.push({feature:tn,id:Yn,index:Bn,sourceLayerIndex:Mt})}for(const Bn of _e[ft]){const tn=Bn[0];tn.source!==this.source&&u.warnOnce(`layer.source = ${tn.source} does not equal this.source = ${this.source}`),tn.minzoom&&this.zoom<Math.floor(tn.minzoom)||tn.maxzoom&&this.zoom>=tn.maxzoom||tn.visibility!=="none"&&(pe(Bn,this.zoom,N),(J[tn.id]=tn.createBucket({index:te.bucketLayerIDs.length,layers:Bn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Mt,sourceID:this.source})).populate(qt,oe,this.tileID.canonical),te.bucketLayerIDs.push(Bn.map(Yn=>Yn.id)))}}let Ce,ge,Je,et;const Ze=u.mapObject(oe.glyphDependencies,ft=>Object.keys(ft).map(Number));Object.keys(Ze).length?U.send("getGlyphs",{uid:this.uid,stacks:Ze},(ft,wt)=>{Ce||(Ce=ft,ge=wt,zt.call(this))}):ge={};const ut=Object.keys(oe.iconDependencies);ut.length?U.send("getImages",{icons:ut,source:this.source,tileID:this.tileID,type:"icons"},(ft,wt)=>{Ce||(Ce=ft,Je=wt,zt.call(this))}):Je={};const dt=Object.keys(oe.patternDependencies);function zt(){if(Ce)return K(Ce);if(ge&&Je&&et){const ft=new Q(ge),wt=new u.ImageAtlas(Je,et);for(const Mt in J){const qt=J[Mt];qt instanceof u.SymbolBucket?(pe(qt.layers,this.zoom,N),u.performSymbolLayout({bucket:qt,glyphMap:ge,glyphPositions:ft.positions,imageMap:Je,imagePositions:wt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):qt.hasPattern&&(qt instanceof u.LineBucket||qt instanceof u.FillBucket||qt instanceof u.FillExtrusionBucket)&&(pe(qt.layers,this.zoom,N),qt.addFeatures(oe,this.tileID.canonical,wt.patternPositions))}this.status="done",K(null,{buckets:Object.values(J).filter(Mt=>!Mt.isEmpty()),featureIndex:te,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ft.image,imageAtlas:wt,glyphMap:this.returnDependencies?ge:null,iconMap:this.returnDependencies?Je:null,glyphPositions:this.returnDependencies?ft.positions:null})}}dt.length?U.send("getImages",{icons:dt,source:this.source,tileID:this.tileID,type:"patterns"},(ft,wt)=>{Ce||(Ce=ft,et=wt,zt.call(this))}):et={},zt.call(this)}}function pe($,C,M){const N=new u.EvaluationParameters(C);for(const U of $)U.recalculate(N,M)}function be($,C){const M=u.getArrayBuffer($.request,(N,U,K,ae)=>{N?C(N):U&&C(null,{vectorTile:new u.vectorTile.VectorTile(new u.pbf(U)),rawData:U,cacheControl:K,expires:ae})});return()=>{M.cancel(),C()}}class ye{constructor(C,M,N,U){this.actor=C,this.layerIndex=M,this.availableImages=N,this.loadVectorData=U||be,this.loading={},this.loaded={}}loadTile(C,M){const N=C.uid;this.loading||(this.loading={});const U=!!(C&&C.request&&C.request.collectResourceTiming)&&new u.RequestPerformance(C.request),K=this.loading[N]=new V(C);K.abort=this.loadVectorData(C,(ae,te)=>{if(delete this.loading[N],ae||!te)return K.status="done",this.loaded[N]=K,M(ae);const J=te.rawData,oe={};te.expires&&(oe.expires=te.expires),te.cacheControl&&(oe.cacheControl=te.cacheControl);const _e={};if(U){const Ce=U.finish();Ce&&(_e.resourceTiming=JSON.parse(JSON.stringify(Ce)))}K.vectorTile=te.vectorTile,K.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ce,ge)=>{if(Ce||!ge)return M(Ce);M(null,u.extend({rawTileData:J.slice(0)},ge,oe,_e))}),this.loaded=this.loaded||{},this.loaded[N]=K})}reloadTile(C,M){const N=this.loaded,U=C.uid,K=this;if(N&&N[U]){const ae=N[U];ae.showCollisionBoxes=C.showCollisionBoxes;const te=(J,oe)=>{const _e=ae.reloadCallback;_e&&(delete ae.reloadCallback,ae.parse(ae.vectorTile,K.layerIndex,this.availableImages,K.actor,_e)),M(J,oe)};ae.status==="parsing"?ae.reloadCallback=te:ae.status==="done"&&(ae.vectorTile?ae.parse(ae.vectorTile,this.layerIndex,this.availableImages,this.actor,te):te())}}abortTile(C,M){const N=this.loading,U=C.uid;N&&N[U]&&N[U].abort&&(N[U].abort(),delete N[U]),M()}removeTile(C,M){const N=this.loaded,U=C.uid;N&&N[U]&&delete N[U],M()}}class ze{constructor(){this.loaded={}}loadTile(C,M){const{uid:N,encoding:U,rawImageData:K}=C,ae=u.isImageBitmap(K)?this.getImageData(K):K,te=new u.DEMData(N,ae,U);this.loaded=this.loaded||{},this.loaded[N]=te,M(null,te)}getImageData(C){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(C.width,C.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=C.width,this.offscreenCanvas.height=C.height,this.offscreenCanvasContext.drawImage(C,0,0,C.width,C.height);const M=this.offscreenCanvasContext.getImageData(-1,-1,C.width+2,C.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new u.RGBAImage({width:M.width,height:M.height},M.data)}removeTile(C){const M=this.loaded,N=C.uid;M&&M[N]&&delete M[N]}}var ee=function $(C,M){var N,U=C&&C.type;if(U==="FeatureCollection")for(N=0;N<C.features.length;N++)$(C.features[N],M);else if(U==="GeometryCollection")for(N=0;N<C.geometries.length;N++)$(C.geometries[N],M);else if(U==="Feature")$(C.geometry,M);else if(U==="Polygon")X(C.coordinates,M);else if(U==="MultiPolygon")for(N=0;N<C.coordinates.length;N++)X(C.coordinates[N],M);return C};function X($,C){if($.length!==0){ie($[0],C);for(var M=1;M<$.length;M++)ie($[M],!C)}}function ie($,C){for(var M=0,N=0,U=0,K=$.length,ae=K-1;U<K;ae=U++){var te=($[U][0]-$[ae][0])*($[ae][1]+$[U][1]),J=M+te;N+=Math.abs(M)>=Math.abs(te)?M-J+te:te-J+M,M=J}M+N>=0!=!!C&&$.reverse()}const xe=u.vectorTile.VectorTileFeature.prototype.toGeoJSON;class Ee{constructor(C){this._feature=C,this.extent=u.EXTENT,this.type=C.type,this.properties=C.tags,"id"in C&&!isNaN(C.id)&&(this.id=parseInt(C.id,10))}loadGeometry(){if(this._feature.type===1){const C=[];for(const M of this._feature.geometry)C.push([new u.pointGeometry(M[0],M[1])]);return C}{const C=[];for(const M of this._feature.geometry){const N=[];for(const U of M)N.push(new u.pointGeometry(U[0],U[1]));C.push(N)}return C}}toGeoJSON(C,M,N){return xe.call(this,C,M,N)}}class Oe{constructor(C){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=u.EXTENT,this.length=C.length,this._features=C}feature(C){return new Ee(this._features[C])}}var Ve={exports:{}},Le=u.pointGeometry,vt=u.vectorTile.VectorTileFeature,ht=Ht;function Ht($,C){this.options=C||{},this.features=$,this.length=$.length}function Kt($,C){this.id=typeof $.id=="number"?$.id:void 0,this.type=$.type,this.rawGeometry=$.type===1?[$.geometry]:$.geometry,this.properties=$.tags,this.extent=C||4096}Ht.prototype.feature=function($){return new Kt(this.features[$],this.options.extent)},Kt.prototype.loadGeometry=function(){var $=this.rawGeometry;this.geometry=[];for(var C=0;C<$.length;C++){for(var M=$[C],N=[],U=0;U<M.length;U++)N.push(new Le(M[U][0],M[U][1]));this.geometry.push(N)}return this.geometry},Kt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var $=this.geometry,C=1/0,M=-1/0,N=1/0,U=-1/0,K=0;K<$.length;K++)for(var ae=$[K],te=0;te<ae.length;te++){var J=ae[te];C=Math.min(C,J.x),M=Math.max(M,J.x),N=Math.min(N,J.y),U=Math.max(U,J.y)}return[C,N,M,U]},Kt.prototype.toGeoJSON=vt.prototype.toGeoJSON;var vn=u.pbf,cn=ht;function Ln($){var C=new vn;return function(M,N){for(var U in M.layers)N.writeMessage(3,Ke,M.layers[U])}($,C),C.finish()}function Ke($,C){var M;C.writeVarintField(15,$.version||1),C.writeStringField(1,$.name||""),C.writeVarintField(5,$.extent||4096);var N={keys:[],values:[],keycache:{},valuecache:{}};for(M=0;M<$.length;M++)N.feature=$.feature(M),C.writeMessage(2,hn,N);var U=N.keys;for(M=0;M<U.length;M++)C.writeStringField(3,U[M]);var K=N.values;for(M=0;M<K.length;M++)C.writeMessage(4,en,K[M])}function hn($,C){var M=$.feature;M.id!==void 0&&C.writeVarintField(1,M.id),C.writeMessage(2,$e,$),C.writeVarintField(3,M.type),C.writeMessage(4,Gt,M)}function $e($,C){var M=$.feature,N=$.keys,U=$.values,K=$.keycache,ae=$.valuecache;for(var te in M.properties){var J=M.properties[te],oe=K[te];if(J!==null){oe===void 0&&(N.push(te),K[te]=oe=N.length-1),C.writeVarint(oe);var _e=typeof J;_e!=="string"&&_e!=="boolean"&&_e!=="number"&&(J=JSON.stringify(J));var Ce=_e+":"+J,ge=ae[Ce];ge===void 0&&(U.push(J),ae[Ce]=ge=U.length-1),C.writeVarint(ge)}}}function st($,C){return(C<<3)+(7&$)}function pt($){return $<<1^$>>31}function Gt($,C){for(var M=$.loadGeometry(),N=$.type,U=0,K=0,ae=M.length,te=0;te<ae;te++){var J=M[te],oe=1;N===1&&(oe=J.length),C.writeVarint(st(1,oe));for(var _e=N===3?J.length-1:J.length,Ce=0;Ce<_e;Ce++){Ce===1&&N!==1&&C.writeVarint(st(2,_e-1));var ge=J[Ce].x-U,Je=J[Ce].y-K;C.writeVarint(pt(ge)),C.writeVarint(pt(Je)),U+=ge,K+=Je}N===3&&C.writeVarint(st(7,1))}}function en($,C){var M=typeof $;M==="string"?C.writeStringField(1,$):M==="boolean"?C.writeBooleanField(7,$):M==="number"&&($%1!=0?C.writeDoubleField(3,$):$<0?C.writeSVarintField(6,$):C.writeVarintField(5,$))}function Xr($,C,M,N,U,K){if(U-N<=M)return;const ae=N+U>>1;cr($,C,ae,N,U,K%2),Xr($,C,M,N,ae-1,K+1),Xr($,C,M,ae+1,U,K+1)}function cr($,C,M,N,U,K){for(;U>N;){if(U-N>600){const oe=U-N+1,_e=M-N+1,Ce=Math.log(oe),ge=.5*Math.exp(2*Ce/3),Je=.5*Math.sqrt(Ce*ge*(oe-ge)/oe)*(_e-oe/2<0?-1:1);cr($,C,M,Math.max(N,Math.floor(M-_e*ge/oe+Je)),Math.min(U,Math.floor(M+(oe-_e)*ge/oe+Je)),K)}const ae=C[2*M+K];let te=N,J=U;for(hr($,C,N,M),C[2*U+K]>ae&&hr($,C,N,U);te<J;){for(hr($,C,te,J),te++,J--;C[2*te+K]<ae;)te++;for(;C[2*J+K]>ae;)J--}C[2*N+K]===ae?hr($,C,N,J):(J++,hr($,C,J,U)),J<=M&&(N=J+1),M<=J&&(U=J-1)}}function hr($,C,M,N){Xn($,M,N),Xn(C,2*M,2*N),Xn(C,2*M+1,2*N+1)}function Xn($,C,M){const N=$[C];$[C]=$[M],$[M]=N}function br($,C,M,N){const U=$-M,K=C-N;return U*U+K*K}Ve.exports=Ln,Ve.exports.fromVectorTileJs=Ln,Ve.exports.fromGeojsonVt=function($,C){C=C||{};var M={};for(var N in $)M[N]=new cn($[N].features,C),M[N].name=N,M[N].version=C.version,M[N].extent=C.extent;return Ln({layers:M})},Ve.exports.GeoJSONWrapper=cn;const qi=$=>$[0],dr=$=>$[1];class Ga{constructor(C,M=qi,N=dr,U=64,K=Float64Array){this.nodeSize=U,this.points=C;const ae=C.length<65536?Uint16Array:Uint32Array,te=this.ids=new ae(C.length),J=this.coords=new K(2*C.length);for(let oe=0;oe<C.length;oe++)te[oe]=oe,J[2*oe]=M(C[oe]),J[2*oe+1]=N(C[oe]);Xr(te,J,U,0,te.length-1,0)}range(C,M,N,U){return function(K,ae,te,J,oe,_e,Ce){const ge=[0,K.length-1,0],Je=[];let et,Ze;for(;ge.length;){const ut=ge.pop(),dt=ge.pop(),zt=ge.pop();if(dt-zt<=Ce){for(let Mt=zt;Mt<=dt;Mt++)et=ae[2*Mt],Ze=ae[2*Mt+1],et>=te&&et<=oe&&Ze>=J&&Ze<=_e&&Je.push(K[Mt]);continue}const ft=Math.floor((zt+dt)/2);et=ae[2*ft],Ze=ae[2*ft+1],et>=te&&et<=oe&&Ze>=J&&Ze<=_e&&Je.push(K[ft]);const wt=(ut+1)%2;(ut===0?te<=et:J<=Ze)&&(ge.push(zt),ge.push(ft-1),ge.push(wt)),(ut===0?oe>=et:_e>=Ze)&&(ge.push(ft+1),ge.push(dt),ge.push(wt))}return Je}(this.ids,this.coords,C,M,N,U,this.nodeSize)}within(C,M,N){return function(U,K,ae,te,J,oe){const _e=[0,U.length-1,0],Ce=[],ge=J*J;for(;_e.length;){const Je=_e.pop(),et=_e.pop(),Ze=_e.pop();if(et-Ze<=oe){for(let wt=Ze;wt<=et;wt++)br(K[2*wt],K[2*wt+1],ae,te)<=ge&&Ce.push(U[wt]);continue}const ut=Math.floor((Ze+et)/2),dt=K[2*ut],zt=K[2*ut+1];br(dt,zt,ae,te)<=ge&&Ce.push(U[ut]);const ft=(Je+1)%2;(Je===0?ae-J<=dt:te-J<=zt)&&(_e.push(Ze),_e.push(ut-1),_e.push(ft)),(Je===0?ae+J>=dt:te+J>=zt)&&(_e.push(ut+1),_e.push(et),_e.push(ft))}return Ce}(this.ids,this.coords,C,M,N,this.nodeSize)}}const $o={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:$=>$},Ei=Math.fround||(Sr=new Float32Array(1),$=>(Sr[0]=+$,Sr[0]));var Sr;class jo{constructor(C){this.options=Hi(Object.create($o),C),this.trees=new Array(this.options.maxZoom+1)}load(C){const{log:M,minZoom:N,maxZoom:U,nodeSize:K}=this.options;M&&console.time("total time");const ae=`prepare ${C.length} points`;M&&console.time(ae),this.points=C;let te=[];for(let J=0;J<C.length;J++)C[J].geometry&&te.push(qa(C[J],J));this.trees[U+1]=new Ga(te,qo,ki,K,Float32Array),M&&console.timeEnd(ae);for(let J=U;J>=N;J--){const oe=+Date.now();te=this._cluster(te,J),this.trees[J]=new Ga(te,qo,ki,K,Float32Array),M&&console.log("z%d: %d clusters in %dms",J,te.length,+Date.now()-oe)}return M&&console.timeEnd("total time"),this}getClusters(C,M){let N=((C[0]+180)%360+360)%360-180;const U=Math.max(-90,Math.min(90,C[1]));let K=C[2]===180?180:((C[2]+180)%360+360)%360-180;const ae=Math.max(-90,Math.min(90,C[3]));if(C[2]-C[0]>=360)N=-180,K=180;else if(N>K){const _e=this.getClusters([N,U,180,ae],M),Ce=this.getClusters([-180,U,K,ae],M);return _e.concat(Ce)}const te=this.trees[this._limitZoom(M)],J=te.range(At(N),hi(ae),At(K),hi(U)),oe=[];for(const _e of J){const Ce=te.points[_e];oe.push(Ce.numPoints?Za(Ce):this.points[Ce.index])}return oe}getChildren(C){const M=this._getOriginId(C),N=this._getOriginZoom(C),U="No cluster with the specified id.",K=this.trees[N];if(!K)throw new Error(U);const ae=K.points[M];if(!ae)throw new Error(U);const te=this.options.radius/(this.options.extent*Math.pow(2,N-1)),J=K.within(ae.x,ae.y,te),oe=[];for(const _e of J){const Ce=K.points[_e];Ce.parentId===C&&oe.push(Ce.numPoints?Za(Ce):this.points[Ce.index])}if(oe.length===0)throw new Error(U);return oe}getLeaves(C,M,N){const U=[];return this._appendLeaves(U,C,M=M||10,N=N||0,0),U}getTile(C,M,N){const U=this.trees[this._limitZoom(C)],K=Math.pow(2,C),{extent:ae,radius:te}=this.options,J=te/ae,oe=(N-J)/K,_e=(N+1+J)/K,Ce={features:[]};return this._addTileFeatures(U.range((M-J)/K,oe,(M+1+J)/K,_e),U.points,M,N,K,Ce),M===0&&this._addTileFeatures(U.range(1-J/K,oe,1,_e),U.points,K,N,K,Ce),M===K-1&&this._addTileFeatures(U.range(0,oe,J/K,_e),U.points,-1,N,K,Ce),Ce.features.length?Ce:null}getClusterExpansionZoom(C){let M=this._getOriginZoom(C)-1;for(;M<=this.options.maxZoom;){const N=this.getChildren(C);if(M++,N.length!==1)break;C=N[0].properties.cluster_id}return M}_appendLeaves(C,M,N,U,K){const ae=this.getChildren(M);for(const te of ae){const J=te.properties;if(J&&J.cluster?K+J.point_count<=U?K+=J.point_count:K=this._appendLeaves(C,J.cluster_id,N,U,K):K<U?K++:C.push(te),C.length===N)break}return K}_addTileFeatures(C,M,N,U,K,ae){for(const te of C){const J=M[te],oe=J.numPoints;let _e,Ce,ge;if(oe)_e=Go(J),Ce=J.x,ge=J.y;else{const Ze=this.points[J.index];_e=Ze.properties,Ce=At(Ze.geometry.coordinates[0]),ge=hi(Ze.geometry.coordinates[1])}const Je={type:1,geometry:[[Math.round(this.options.extent*(Ce*K-N)),Math.round(this.options.extent*(ge*K-U))]],tags:_e};let et;oe?et=J.id:this.options.generateId?et=J.index:this.points[J.index].id&&(et=this.points[J.index].id),et!==void 0&&(Je.id=et),ae.features.push(Je)}}_limitZoom(C){return Math.max(this.options.minZoom,Math.min(Math.floor(+C),this.options.maxZoom+1))}_cluster(C,M){const N=[],{radius:U,extent:K,reduce:ae,minPoints:te}=this.options,J=U/(K*Math.pow(2,M));for(let oe=0;oe<C.length;oe++){const _e=C[oe];if(_e.zoom<=M)continue;_e.zoom=M;const Ce=this.trees[M+1],ge=Ce.within(_e.x,_e.y,J),Je=_e.numPoints||1;let et=Je;for(const Ze of ge){const ut=Ce.points[Ze];ut.zoom>M&&(et+=ut.numPoints||1)}if(et>Je&&et>=te){let Ze=_e.x*Je,ut=_e.y*Je,dt=ae&&Je>1?this._map(_e,!0):null;const zt=(oe<<5)+(M+1)+this.points.length;for(const ft of ge){const wt=Ce.points[ft];if(wt.zoom<=M)continue;wt.zoom=M;const Mt=wt.numPoints||1;Ze+=wt.x*Mt,ut+=wt.y*Mt,wt.parentId=zt,ae&&(dt||(dt=this._map(_e,!0)),ae(dt,this._map(wt)))}_e.parentId=zt,N.push(Zi(Ze/et,ut/et,zt,et,dt))}else if(N.push(_e),et>1)for(const Ze of ge){const ut=Ce.points[Ze];ut.zoom<=M||(ut.zoom=M,N.push(ut))}}return N}_getOriginId(C){return C-this.points.length>>5}_getOriginZoom(C){return(C-this.points.length)%32}_map(C,M){if(C.numPoints)return M?Hi({},C.properties):C.properties;const N=this.points[C.index].properties,U=this.options.map(N);return M&&U===N?Hi({},U):U}}function Zi($,C,M,N,U){return{x:Ei($),y:Ei(C),zoom:1/0,id:M,parentId:-1,numPoints:N,properties:U}}function qa($,C){const[M,N]=$.geometry.coordinates;return{x:Ei(At(M)),y:Ei(hi(N)),zoom:1/0,index:C,parentId:-1}}function Za($){return{type:"Feature",id:$.id,properties:Go($),geometry:{type:"Point",coordinates:[(C=$.x,360*(C-.5)),Wi($.y)]}};var C}function Go($){const C=$.numPoints,M=C>=1e4?`${Math.round(C/1e3)}k`:C>=1e3?Math.round(C/100)/10+"k":C;return Hi(Hi({},$.properties),{cluster:!0,cluster_id:$.id,point_count:C,point_count_abbreviated:M})}function At($){return $/360+.5}function hi($){const C=Math.sin($*Math.PI/180),M=.5-.25*Math.log((1+C)/(1-C))/Math.PI;return M<0?0:M>1?1:M}function Wi($){const C=(180-360*$)*Math.PI/180;return 360*Math.atan(Math.exp(C))/Math.PI-90}function Hi($,C){for(const M in C)$[M]=C[M];return $}function qo($){return $.x}function ki($){return $.y}function Ii($,C,M,N){for(var U,K=N,ae=M-C>>1,te=M-C,J=$[C],oe=$[C+1],_e=$[M],Ce=$[M+1],ge=C+3;ge<M;ge+=3){var Je=Wa($[ge],$[ge+1],J,oe,_e,Ce);if(Je>K)U=ge,K=Je;else if(Je===K){var et=Math.abs(ge-ae);et<te&&(U=ge,te=et)}}K>N&&(U-C>3&&Ii($,C,U,N),$[U+2]=K,M-U>3&&Ii($,U,M,N))}function Wa($,C,M,N,U,K){var ae=U-M,te=K-N;if(ae!==0||te!==0){var J=(($-M)*ae+(C-N)*te)/(ae*ae+te*te);J>1?(M=U,N=K):J>0&&(M+=ae*J,N+=te*J)}return(ae=$-M)*ae+(te=C-N)*te}function Ci($,C,M,N){var U={id:$===void 0?null:$,type:C,geometry:M,tags:N,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(K){var ae=K.geometry,te=K.type;if(te==="Point"||te==="MultiPoint"||te==="LineString")Te(K,ae);else if(te==="Polygon"||te==="MultiLineString")for(var J=0;J<ae.length;J++)Te(K,ae[J]);else if(te==="MultiPolygon")for(J=0;J<ae.length;J++)for(var oe=0;oe<ae[J].length;oe++)Te(K,ae[J][oe])}(U),U}function Te($,C){for(var M=0;M<C.length;M+=3)$.minX=Math.min($.minX,C[M]),$.minY=Math.min($.minY,C[M+1]),$.maxX=Math.max($.maxX,C[M]),$.maxY=Math.max($.maxY,C[M+1])}function Ne($,C,M,N){if(C.geometry){var U=C.geometry.coordinates,K=C.geometry.type,ae=Math.pow(M.tolerance/((1<<M.maxZoom)*M.extent),2),te=[],J=C.id;if(M.promoteId?J=C.properties[M.promoteId]:M.generateId&&(J=N||0),K==="Point")da(U,te);else if(K==="MultiPoint")for(var oe=0;oe<U.length;oe++)da(U[oe],te);else if(K==="LineString")Yr(U,te,ae,!1);else if(K==="MultiLineString"){if(M.lineMetrics){for(oe=0;oe<U.length;oe++)Yr(U[oe],te=[],ae,!1),$.push(Ci(J,"LineString",te,C.properties));return}Pt(U,te,ae,!1)}else if(K==="Polygon")Pt(U,te,ae,!0);else{if(K!=="MultiPolygon"){if(K==="GeometryCollection"){for(oe=0;oe<C.geometry.geometries.length;oe++)Ne($,{id:J,geometry:C.geometry.geometries[oe],properties:C.properties},M,N);return}throw new Error("Input data is not a valid GeoJSON object.")}for(oe=0;oe<U.length;oe++){var _e=[];Pt(U[oe],_e,ae,!0),te.push(_e)}}$.push(Ci(J,K,te,C.properties))}}function da($,C){C.push(Nr($[0])),C.push(Tr($[1])),C.push(0)}function Yr($,C,M,N){for(var U,K,ae=0,te=0;te<$.length;te++){var J=Nr($[te][0]),oe=Tr($[te][1]);C.push(J),C.push(oe),C.push(0),te>0&&(ae+=N?(U*oe-J*K)/2:Math.sqrt(Math.pow(J-U,2)+Math.pow(oe-K,2))),U=J,K=oe}var _e=C.length-3;C[2]=1,Ii(C,0,_e,M),C[_e+2]=1,C.size=Math.abs(ae),C.start=0,C.end=C.size}function Pt($,C,M,N){for(var U=0;U<$.length;U++){var K=[];Yr($[U],K,M,N),C.push(K)}}function Nr($){return $/360+.5}function Tr($){var C=Math.sin($*Math.PI/180),M=.5-.25*Math.log((1+C)/(1-C))/Math.PI;return M<0?0:M>1?1:M}function Er($,C,M,N,U,K,ae,te){if(N/=C,K>=(M/=C)&&ae<N)return $;if(ae<M||K>=N)return null;for(var J=[],oe=0;oe<$.length;oe++){var _e=$[oe],Ce=_e.geometry,ge=_e.type,Je=U===0?_e.minX:_e.minY,et=U===0?_e.maxX:_e.maxY;if(Je>=M&&et<N)J.push(_e);else if(!(et<M||Je>=N)){var Ze=[];if(ge==="Point"||ge==="MultiPoint")Xi(Ce,Ze,M,N,U);else if(ge==="LineString")Re(Ce,Ze,M,N,U,!1,te.lineMetrics);else if(ge==="MultiLineString")gt(Ce,Ze,M,N,U,!1);else if(ge==="Polygon")gt(Ce,Ze,M,N,U,!0);else if(ge==="MultiPolygon")for(var ut=0;ut<Ce.length;ut++){var dt=[];gt(Ce[ut],dt,M,N,U,!0),dt.length&&Ze.push(dt)}if(Ze.length){if(te.lineMetrics&&ge==="LineString"){for(ut=0;ut<Ze.length;ut++)J.push(Ci(_e.id,ge,Ze[ut],_e.tags));continue}ge!=="LineString"&&ge!=="MultiLineString"||(Ze.length===1?(ge="LineString",Ze=Ze[0]):ge="MultiLineString"),ge!=="Point"&&ge!=="MultiPoint"||(ge=Ze.length===3?"Point":"MultiPoint"),J.push(Ci(_e.id,ge,Ze,_e.tags))}}}return J.length?J:null}function Xi($,C,M,N,U){for(var K=0;K<$.length;K+=3){var ae=$[K+U];ae>=M&&ae<=N&&(C.push($[K]),C.push($[K+1]),C.push($[K+2]))}}function Re($,C,M,N,U,K,ae){for(var te,J,oe=xt($),_e=U===0?Yi:mt,Ce=$.start,ge=0;ge<$.length-3;ge+=3){var Je=$[ge],et=$[ge+1],Ze=$[ge+2],ut=$[ge+3],dt=$[ge+4],zt=U===0?Je:et,ft=U===0?ut:dt,wt=!1;ae&&(te=Math.sqrt(Math.pow(Je-ut,2)+Math.pow(et-dt,2))),zt<M?ft>M&&(J=_e(oe,Je,et,ut,dt,M),ae&&(oe.start=Ce+te*J)):zt>N?ft<N&&(J=_e(oe,Je,et,ut,dt,N),ae&&(oe.start=Ce+te*J)):jn(oe,Je,et,Ze),ft<M&&zt>=M&&(J=_e(oe,Je,et,ut,dt,M),wt=!0),ft>N&&zt<=N&&(J=_e(oe,Je,et,ut,dt,N),wt=!0),!K&&wt&&(ae&&(oe.end=Ce+te*J),C.push(oe),oe=xt($)),ae&&(Ce+=te)}var Mt=$.length-3;Je=$[Mt],et=$[Mt+1],Ze=$[Mt+2],(zt=U===0?Je:et)>=M&&zt<=N&&jn(oe,Je,et,Ze),Mt=oe.length-3,K&&Mt>=3&&(oe[Mt]!==oe[0]||oe[Mt+1]!==oe[1])&&jn(oe,oe[0],oe[1],oe[2]),oe.length&&C.push(oe)}function xt($){var C=[];return C.size=$.size,C.start=$.start,C.end=$.end,C}function gt($,C,M,N,U,K){for(var ae=0;ae<$.length;ae++)Re($[ae],C,M,N,U,K,!1)}function jn($,C,M,N){$.push(C),$.push(M),$.push(N)}function Yi($,C,M,N,U,K){var ae=(K-C)/(N-C);return $.push(K),$.push(M+(U-M)*ae),$.push(1),ae}function mt($,C,M,N,U,K){var ae=(K-M)/(U-M);return $.push(C+(N-C)*ae),$.push(K),$.push(1),ae}function Ai($,C){for(var M=[],N=0;N<$.length;N++){var U,K=$[N],ae=K.type;if(ae==="Point"||ae==="MultiPoint"||ae==="LineString")U=Rn(K.geometry,C);else if(ae==="MultiLineString"||ae==="Polygon"){U=[];for(var te=0;te<K.geometry.length;te++)U.push(Rn(K.geometry[te],C))}else if(ae==="MultiPolygon")for(U=[],te=0;te<K.geometry.length;te++){for(var J=[],oe=0;oe<K.geometry[te].length;oe++)J.push(Rn(K.geometry[te][oe],C));U.push(J)}M.push(Ci(K.id,ae,U,K.tags))}return M}function Rn($,C){var M=[];M.size=$.size,$.start!==void 0&&(M.start=$.start,M.end=$.end);for(var N=0;N<$.length;N+=3)M.push($[N]+C,$[N+1],$[N+2]);return M}function Ha($,C){if($.transformed)return $;var M,N,U,K=1<<$.z,ae=$.x,te=$.y;for(M=0;M<$.features.length;M++){var J=$.features[M],oe=J.geometry,_e=J.type;if(J.geometry=[],_e===1)for(N=0;N<oe.length;N+=2)J.geometry.push(Tn(oe[N],oe[N+1],C,K,ae,te));else for(N=0;N<oe.length;N++){var Ce=[];for(U=0;U<oe[N].length;U+=2)Ce.push(Tn(oe[N][U],oe[N][U+1],C,K,ae,te));J.geometry.push(Ce)}}return $.transformed=!0,$}function Tn($,C,M,N,U,K){return[Math.round(M*($*N-U)),Math.round(M*(C*N-K))]}function rr($,C,M,N,U){for(var K=C===U.maxZoom?0:U.tolerance/((1<<C)*U.extent),ae={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:M,y:N,z:C,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},te=0;te<$.length;te++){ae.numFeatures++,$t(ae,$[te],K,U);var J=$[te].minX,oe=$[te].minY,_e=$[te].maxX,Ce=$[te].maxY;J<ae.minX&&(ae.minX=J),oe<ae.minY&&(ae.minY=oe),_e>ae.maxX&&(ae.maxX=_e),Ce>ae.maxY&&(ae.maxY=Ce)}return ae}function $t($,C,M,N){var U=C.geometry,K=C.type,ae=[];if(K==="Point"||K==="MultiPoint")for(var te=0;te<U.length;te+=3)ae.push(U[te]),ae.push(U[te+1]),$.numPoints++,$.numSimplified++;else if(K==="LineString")Xa(ae,U,$,M,!1,!1);else if(K==="MultiLineString"||K==="Polygon")for(te=0;te<U.length;te++)Xa(ae,U[te],$,M,K==="Polygon",te===0);else if(K==="MultiPolygon")for(var J=0;J<U.length;J++){var oe=U[J];for(te=0;te<oe.length;te++)Xa(ae,oe[te],$,M,!0,te===0)}if(ae.length){var _e=C.tags||null;if(K==="LineString"&&N.lineMetrics){for(var Ce in _e={},C.tags)_e[Ce]=C.tags[Ce];_e.mapbox_clip_start=U.start/U.size,_e.mapbox_clip_end=U.end/U.size}var ge={geometry:ae,type:K==="Polygon"||K==="MultiPolygon"?3:K==="LineString"||K==="MultiLineString"?2:1,tags:_e};C.id!==null&&(ge.id=C.id),$.features.push(ge)}}function Xa($,C,M,N,U,K){var ae=N*N;if(N>0&&C.size<(U?ae:N))M.numPoints+=C.length/3;else{for(var te=[],J=0;J<C.length;J+=3)(N===0||C[J+2]>ae)&&(M.numSimplified++,te.push(C[J]),te.push(C[J+1])),M.numPoints++;U&&function(oe,_e){for(var Ce=0,ge=0,Je=oe.length,et=Je-2;ge<Je;et=ge,ge+=2)Ce+=(oe[ge]-oe[et])*(oe[ge+1]+oe[et+1]);if(Ce>0===_e)for(ge=0,Je=oe.length;ge<Je/2;ge+=2){var Ze=oe[ge],ut=oe[ge+1];oe[ge]=oe[Je-2-ge],oe[ge+1]=oe[Je-1-ge],oe[Je-2-ge]=Ze,oe[Je-1-ge]=ut}}(te,K),$.push(te)}}function di($,C){var M=(C=this.options=function(U,K){for(var ae in K)U[ae]=K[ae];return U}(Object.create(this.options),C)).debug;if(M&&console.time("preprocess data"),C.maxZoom<0||C.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(C.promoteId&&C.generateId)throw new Error("promoteId and generateId cannot be used together.");var N=function(U,K){var ae=[];if(U.type==="FeatureCollection")for(var te=0;te<U.features.length;te++)Ne(ae,U.features[te],K,te);else Ne(ae,U.type==="Feature"?U:{geometry:U},K);return ae}($,C);this.tiles={},this.tileCoords=[],M&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",C.indexMaxZoom,C.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),N=function(U,K){var ae=K.buffer/K.extent,te=U,J=Er(U,1,-1-ae,ae,0,-1,2,K),oe=Er(U,1,1-ae,2+ae,0,-1,2,K);return(J||oe)&&(te=Er(U,1,-ae,1+ae,0,-1,2,K)||[],J&&(te=Ai(J,1).concat(te)),oe&&(te=te.concat(Ai(oe,-1)))),te}(N,C),N.length&&this.splitTile(N,0,0,0),M&&(N.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function pa($,C,M){return 32*((1<<$)*M+C)+$}function fa($,C){const M=$.tileID.canonical;if(!this._geoJSONIndex)return C(null,null);const N=this._geoJSONIndex.getTile(M.z,M.x,M.y);if(!N)return C(null,null);const U=new Oe(N.features);let K=Ve.exports(U);K.byteOffset===0&&K.byteLength===K.buffer.byteLength||(K=new Uint8Array(K)),C(null,{vectorTile:U,rawData:K.buffer})}di.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},di.prototype.splitTile=function($,C,M,N,U,K,ae){for(var te=[$,C,M,N],J=this.options,oe=J.debug;te.length;){N=te.pop(),M=te.pop(),C=te.pop(),$=te.pop();var _e=1<<C,Ce=pa(C,M,N),ge=this.tiles[Ce];if(!ge&&(oe>1&&console.time("creation"),ge=this.tiles[Ce]=rr($,C,M,N,J),this.tileCoords.push({z:C,x:M,y:N}),oe)){oe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",C,M,N,ge.numFeatures,ge.numPoints,ge.numSimplified),console.timeEnd("creation"));var Je="z"+C;this.stats[Je]=(this.stats[Je]||0)+1,this.total++}if(ge.source=$,U){if(C===J.maxZoom||C===U)continue;var et=1<<U-C;if(M!==Math.floor(K/et)||N!==Math.floor(ae/et))continue}else if(C===J.indexMaxZoom||ge.numPoints<=J.indexMaxPoints)continue;if(ge.source=null,$.length!==0){oe>1&&console.time("clipping");var Ze,ut,dt,zt,ft,wt,Mt=.5*J.buffer/J.extent,qt=.5-Mt,Bn=.5+Mt,tn=1+Mt;Ze=ut=dt=zt=null,ft=Er($,_e,M-Mt,M+Bn,0,ge.minX,ge.maxX,J),wt=Er($,_e,M+qt,M+tn,0,ge.minX,ge.maxX,J),$=null,ft&&(Ze=Er(ft,_e,N-Mt,N+Bn,1,ge.minY,ge.maxY,J),ut=Er(ft,_e,N+qt,N+tn,1,ge.minY,ge.maxY,J),ft=null),wt&&(dt=Er(wt,_e,N-Mt,N+Bn,1,ge.minY,ge.maxY,J),zt=Er(wt,_e,N+qt,N+tn,1,ge.minY,ge.maxY,J),wt=null),oe>1&&console.timeEnd("clipping"),te.push(Ze||[],C+1,2*M,2*N),te.push(ut||[],C+1,2*M,2*N+1),te.push(dt||[],C+1,2*M+1,2*N),te.push(zt||[],C+1,2*M+1,2*N+1)}}},di.prototype.getTile=function($,C,M){var N=this.options,U=N.extent,K=N.debug;if($<0||$>24)return null;var ae=1<<$,te=pa($,C=(C%ae+ae)%ae,M);if(this.tiles[te])return Ha(this.tiles[te],U);K>1&&console.log("drilling down to z%d-%d-%d",$,C,M);for(var J,oe=$,_e=C,Ce=M;!J&&oe>0;)oe--,_e=Math.floor(_e/2),Ce=Math.floor(Ce/2),J=this.tiles[pa(oe,_e,Ce)];return J&&J.source?(K>1&&console.log("found parent tile z%d-%d-%d",oe,_e,Ce),K>1&&console.time("drilling down"),this.splitTile(J.source,oe,_e,Ce,$,C,M),K>1&&console.timeEnd("drilling down"),this.tiles[te]?Ha(this.tiles[te],U):null):null};class Ya extends ye{constructor(C,M,N,U){super(C,M,N,fa),U&&(this.loadGeoJSON=U)}loadData(C,M){var N;(N=this._pendingRequest)===null||N===void 0||N.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const U=!!(C&&C.request&&C.request.collectResourceTiming)&&new u.RequestPerformance(C.request);this._pendingCallback=M,this._pendingRequest=this.loadGeoJSON(C,(K,ae)=>{if(delete this._pendingCallback,delete this._pendingRequest,K||!ae)return M(K);if(typeof ae!="object")return M(new Error(`Input data given to '${C.source}' is not a valid GeoJSON object.`));{ee(ae,!0);try{if(C.filter){const J=u.createExpression(C.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(J.result==="error")throw new Error(J.value.map(_e=>`${_e.key}: ${_e.message}`).join(", "));ae={type:"FeatureCollection",features:ae.features.filter(_e=>J.value.evaluate({zoom:0},_e))}}this._geoJSONIndex=C.cluster?new jo(function({superclusterOptions:J,clusterProperties:oe}){if(!oe||!J)return J;const _e={},Ce={},ge={accumulated:null,zoom:0},Je={properties:null},et=Object.keys(oe);for(const Ze of et){const[ut,dt]=oe[Ze],zt=u.createExpression(dt),ft=u.createExpression(typeof ut=="string"?[ut,["accumulated"],["get",Ze]]:ut);_e[Ze]=zt.value,Ce[Ze]=ft.value}return J.map=Ze=>{Je.properties=Ze;const ut={};for(const dt of et)ut[dt]=_e[dt].evaluate(ge,Je);return ut},J.reduce=(Ze,ut)=>{Je.properties=ut;for(const dt of et)ge.accumulated=Ze[dt],Ze[dt]=Ce[dt].evaluate(ge,Je)},J}(C)).load(ae.features):function(J,oe){return new di(J,oe)}(ae,C.geojsonVtOptions)}catch(J){return M(J)}this.loaded={};const te={};if(U){const J=U.finish();J&&(te.resourceTiming={},te.resourceTiming[C.source]=JSON.parse(JSON.stringify(J)))}M(null,te)}})}reloadTile(C,M){const N=this.loaded;return N&&N[C.uid]?super.reloadTile(C,M):this.loadTile(C,M)}loadGeoJSON(C,M){if(C.request)return u.getJSON(C.request,M);if(typeof C.data=="string")try{M(null,JSON.parse(C.data))}catch{M(new Error(`Input data given to '${C.source}' is not a valid GeoJSON object.`))}else M(new Error(`Input data given to '${C.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(C,M){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),M()}getClusterExpansionZoom(C,M){try{M(null,this._geoJSONIndex.getClusterExpansionZoom(C.clusterId))}catch(N){M(N)}}getClusterChildren(C,M){try{M(null,this._geoJSONIndex.getChildren(C.clusterId))}catch(N){M(N)}}getClusterLeaves(C,M){try{M(null,this._geoJSONIndex.getLeaves(C.clusterId,C.limit,C.offset))}catch(N){M(N)}}}class ma{constructor(C){this.self=C,this.actor=new u.Actor(C,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ye,geojson:Ya},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(M,N)=>{if(this.workerSourceTypes[M])throw new Error(`Worker source with name "${M}" already registered.`);this.workerSourceTypes[M]=N},this.self.registerRTLTextPlugin=M=>{if(u.plugin.isParsed())throw new Error("RTL text plugin already registered.");u.plugin.applyArabicShaping=M.applyArabicShaping,u.plugin.processBidirectionalText=M.processBidirectionalText,u.plugin.processStyledBidirectionalText=M.processStyledBidirectionalText}}setReferrer(C,M){this.referrer=M}setImages(C,M,N){this.availableImages[C]=M;for(const U in this.workerSources[C]){const K=this.workerSources[C][U];for(const ae in K)K[ae].availableImages=M}N()}setLayers(C,M,N){this.getLayerIndex(C).replace(M),N()}updateLayers(C,M,N){this.getLayerIndex(C).update(M.layers,M.removedIds),N()}loadTile(C,M,N){this.getWorkerSource(C,M.type,M.source).loadTile(M,N)}loadDEMTile(C,M,N){this.getDEMWorkerSource(C,M.source).loadTile(M,N)}reloadTile(C,M,N){this.getWorkerSource(C,M.type,M.source).reloadTile(M,N)}abortTile(C,M,N){this.getWorkerSource(C,M.type,M.source).abortTile(M,N)}removeTile(C,M,N){this.getWorkerSource(C,M.type,M.source).removeTile(M,N)}removeDEMTile(C,M){this.getDEMWorkerSource(C,M.source).removeTile(M)}removeSource(C,M,N){if(!this.workerSources[C]||!this.workerSources[C][M.type]||!this.workerSources[C][M.type][M.source])return;const U=this.workerSources[C][M.type][M.source];delete this.workerSources[C][M.type][M.source],U.removeSource!==void 0?U.removeSource(M,N):N()}loadWorkerSource(C,M,N){try{this.self.importScripts(M.url),N()}catch(U){N(U.toString())}}syncRTLPluginState(C,M,N){try{u.plugin.setState(M);const U=u.plugin.getPluginURL();if(u.plugin.isLoaded()&&!u.plugin.isParsed()&&U!=null){this.self.importScripts(U);const K=u.plugin.isParsed();N(K?void 0:new Error(`RTL Text Plugin failed to import scripts from ${U}`),K)}}catch(U){N(U.toString())}}getAvailableImages(C){let M=this.availableImages[C];return M||(M=[]),M}getLayerIndex(C){let M=this.layerIndexes[C];return M||(M=this.layerIndexes[C]=new ne),M}getWorkerSource(C,M,N){if(this.workerSources[C]||(this.workerSources[C]={}),this.workerSources[C][M]||(this.workerSources[C][M]={}),!this.workerSources[C][M][N]){const U={send:(K,ae,te)=>{this.actor.send(K,ae,te,C)}};this.workerSources[C][M][N]=new this.workerSourceTypes[M](U,this.getLayerIndex(C),this.getAvailableImages(C))}return this.workerSources[C][M][N]}getDEMWorkerSource(C,M){return this.demWorkerSources[C]||(this.demWorkerSources[C]={}),this.demWorkerSources[C][M]||(this.demWorkerSources[C][M]=new ze),this.demWorkerSources[C][M]}enforceCacheSizeLimit(C,M){u.enforceCacheSizeLimit(M)}}return u.isWorker()&&(self.worker=new ma(self)),ma}),v(["./shared"],function(u){var L=q;function q(h){return!function(n){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var c,p,g=new Blob([""],{type:"text/javascript"}),x=URL.createObjectURL(g);try{p=new Worker(x),c=!0}catch{c=!1}return p&&p.terminate(),URL.revokeObjectURL(x),c}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var c=document.createElement("canvas");c.width=c.height=1;var p=c.getContext("2d");if(!p)return!1;var g=p.getImageData(0,0,1,1);return g&&g.width===c.width}()?(ne[o=n&&n.failIfMajorPerformanceCaveat]===void 0&&(ne[o]=function(c){var p,g=function(x){var S=document.createElement("canvas"),E=Object.create(q.webGLContextAttributes);return E.failIfMajorPerformanceCaveat=x,S.getContext("webgl",E)||S.getContext("experimental-webgl",E)}(c);if(!g)return!1;try{p=g.createShader(g.VERTEX_SHADER)}catch{return!1}return!(!p||g.isContextLost())&&(g.shaderSource(p,"void main() {}"),g.compileShader(p),g.getShaderParameter(p,g.COMPILE_STATUS)===!0)}(o)),ne[o]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var o}(h)}var ne={};function Q(h,n){if(Array.isArray(h)){if(!Array.isArray(n)||h.length!==n.length)return!1;for(let o=0;o<h.length;o++)if(!Q(h[o],n[o]))return!1;return!0}if(typeof h=="object"&&h!==null&&n!==null){if(typeof n!="object"||Object.keys(h).length!==Object.keys(n).length)return!1;for(const o in h)if(!Q(h[o],n[o]))return!1;return!0}return h===n}q.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class V{static testProp(n){if(!V.docStyle)return n[0];for(let o=0;o<n.length;o++)if(n[o]in V.docStyle)return n[o];return n[0]}static create(n,o,c){const p=window.document.createElement(n);return o!==void 0&&(p.className=o),c&&c.appendChild(p),p}static createNS(n,o){return window.document.createElementNS(n,o)}static disableDrag(){V.docStyle&&V.selectProp&&(V.userSelect=V.docStyle[V.selectProp],V.docStyle[V.selectProp]="none")}static enableDrag(){V.docStyle&&V.selectProp&&(V.docStyle[V.selectProp]=V.userSelect)}static setTransform(n,o){n.style[V.transformProp]=o}static addEventListener(n,o,c,p={}){n.addEventListener(o,c,"passive"in p?p:p.capture)}static removeEventListener(n,o,c,p={}){n.removeEventListener(o,c,"passive"in p?p:p.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",V.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",V.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",V.suppressClickInternal,!0)},0)}static mousePos(n,o){const c=n.getBoundingClientRect();return new u.pointGeometry(o.clientX-c.left-n.clientLeft,o.clientY-c.top-n.clientTop)}static touchPos(n,o){const c=n.getBoundingClientRect(),p=[];for(let g=0;g<o.length;g++)p.push(new u.pointGeometry(o[g].clientX-c.left-n.clientLeft,o[g].clientY-c.top-n.clientTop));return p}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}}V.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,V.selectProp=V.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),V.transformProp=V.testProp(["transform","WebkitTransform"]);class pe{constructor(n){this._transformRequestFn=n}transformRequest(n,o){return this._transformRequestFn&&this._transformRequestFn(n,o)||{url:n}}normalizeSpriteURL(n,o,c){const p=function(g){const x=g.match(be);if(!x)throw new Error(`Unable to parse URL "${g}"`);return{protocol:x[1],authority:x[2],path:x[3]||"/",params:x[4]?x[4].split("&"):[]}}(n);return p.path+=`${o}${c}`,function(g){const x=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${x}`}(p)}setTransformRequest(n){this._transformRequestFn=n}}const be=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class ye{constructor(n,o,c,p){this.context=n,this.format=c,this.texture=n.gl.createTexture(),this.update(o,p)}update(n,o,c){const{width:p,height:g}=n,x=!(this.size&&this.size[0]===p&&this.size[1]===g||c),{context:S}=this,{gl:E}=S;if(this.useMipmap=Boolean(o&&o.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!o||o.premultiply!==!1)),x)this.size=[p,g],n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||u.isImageBitmap(n)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,n):E.texImage2D(E.TEXTURE_2D,0,this.format,p,g,0,this.format,E.UNSIGNED_BYTE,n.data);else{const{x:I,y:P}=c||{x:0,y:0};n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||u.isImageBitmap(n)?E.texSubImage2D(E.TEXTURE_2D,0,I,P,E.RGBA,E.UNSIGNED_BYTE,n):E.texSubImage2D(E.TEXTURE_2D,0,I,P,p,g,E.RGBA,E.UNSIGNED_BYTE,n.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)}bind(n,o,c){const{context:p}=this,{gl:g}=p;g.bindTexture(g.TEXTURE_2D,this.texture),c!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=g.LINEAR),n!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,n),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,c||n),this.filter=n),o!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,o),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}function ze(h){const{userImage:n}=h;return!!(n&&n.render&&n.render())&&(h.data.replace(new Uint8Array(n.data.buffer)),!0)}class ee extends u.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:o,callback:c}of this.requestors)this._notify(o,c);this.requestors=[]}}getImage(n){return this.images[n]}addImage(n,o){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,o)&&(this.images[n]=o)}_validate(n,o){let c=!0;return this._validateStretch(o.stretchX,o.data&&o.data.width)||(this.fire(new u.ErrorEvent(new Error(`Image "${n}" has invalid "stretchX" value`))),c=!1),this._validateStretch(o.stretchY,o.data&&o.data.height)||(this.fire(new u.ErrorEvent(new Error(`Image "${n}" has invalid "stretchY" value`))),c=!1),this._validateContent(o.content,o)||(this.fire(new u.ErrorEvent(new Error(`Image "${n}" has invalid "content" value`))),c=!1),c}_validateStretch(n,o){if(!n)return!0;let c=0;for(const p of n){if(p[0]<c||p[1]<p[0]||o<p[1])return!1;c=p[1]}return!0}_validateContent(n,o){return!(n&&(n.length!==4||n[0]<0||o.data.width<n[0]||n[1]<0||o.data.height<n[1]||n[2]<0||o.data.width<n[2]||n[3]<0||o.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))}updateImage(n,o){const c=this.images[n];if(c.data.width!==o.data.width||c.data.height!==o.data.height)throw new Error(`size mismatch between old image (${c.data.width}x${c.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=c.version+1,this.images[n]=o,this.updatedImages[n]=!0}removeImage(n){const o=this.images[n];delete this.images[n],delete this.patterns[n],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n,o){let c=!0;if(!this.isLoaded())for(const p of n)this.images[p]||(c=!1);this.isLoaded()||c?this._notify(n,o):this.requestors.push({ids:n,callback:o})}_notify(n,o){const c={};for(const p of n){this.images[p]||this.fire(new u.Event("styleimagemissing",{id:p}));const g=this.images[p];g?c[p]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,hasRenderCallback:Boolean(g.userImage&&g.userImage.render)}:u.warnOnce(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}o(null,c)}getPixelSize(){const{width:n,height:o}=this.atlasImage;return{width:n,height:o}}getPattern(n){const o=this.patterns[n],c=this.getImage(n);if(!c)return null;if(o&&o.position.version===c.version)return o.position;if(o)o.position.version=c.version;else{const p={w:c.data.width+2,h:c.data.height+2,x:0,y:0},g=new u.ImagePosition(p,c);this.patterns[n]={bin:p,position:g}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const o=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ye(n,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const g in this.patterns)n.push(this.patterns[g].bin);const{w:o,h:c}=u.potpack(n),p=this.atlasImage;p.resize({width:o||1,height:c||1});for(const g in this.patterns){const{bin:x}=this.patterns[g],S=x.x+1,E=x.y+1,I=this.images[g].data,P=I.width,D=I.height;u.RGBAImage.copy(I,p,{x:0,y:0},{x:S,y:E},{width:P,height:D}),u.RGBAImage.copy(I,p,{x:0,y:D-1},{x:S,y:E-1},{width:P,height:1}),u.RGBAImage.copy(I,p,{x:0,y:0},{x:S,y:E+D},{width:P,height:1}),u.RGBAImage.copy(I,p,{x:P-1,y:0},{x:S-1,y:E},{width:1,height:D}),u.RGBAImage.copy(I,p,{x:0,y:0},{x:S+P,y:E},{width:1,height:D})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const o of n){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const c=this.images[o];c||u.warnOnce(`Image with ID: "${o}" was not found`),ze(c)&&this.updateImage(o,c)}}}const X=1e20;function ie(h,n,o,c,p,g,x,S,E){for(let I=n;I<n+c;I++)xe(h,o*g+I,g,p,x,S,E);for(let I=o;I<o+p;I++)xe(h,I*g+n,1,c,x,S,E)}function xe(h,n,o,c,p,g,x){g[0]=0,x[0]=-X,x[1]=X,p[0]=h[n];for(let S=1,E=0,I=0;S<c;S++){p[S]=h[n+S*o];const P=S*S;do{const D=g[E];I=(p[S]-p[D]+P-D*D)/(S-D)/2}while(I<=x[E]&&--E>-1);E++,g[E]=S,x[E]=I,x[E+1]=X}for(let S=0,E=0;S<c;S++){for(;x[E+1]<S;)E++;const I=g[E],P=S-I;h[n+S*o]=p[I]+P*P}}class Ee{constructor(n,o){this.requestManager=n,this.localIdeographFontFamily=o,this.entries={}}setURL(n){this.url=n}getGlyphs(n,o){const c=[];for(const p in n)for(const g of n[p])c.push({stack:p,id:g});u.asyncAll(c,({stack:p,id:g},x)=>{let S=this.entries[p];S||(S=this.entries[p]={glyphs:{},requests:{},ranges:{}});let E=S.glyphs[g];if(E!==void 0)return void x(null,{stack:p,id:g,glyph:E});if(E=this._tinySDF(S,p,g),E)return S.glyphs[g]=E,void x(null,{stack:p,id:g,glyph:E});const I=Math.floor(g/256);if(256*I>65535)return void x(new Error("glyphs > 65535 not supported"));if(S.ranges[I])return void x(null,{stack:p,id:g,glyph:E});let P=S.requests[I];P||(P=S.requests[I]=[],Ee.loadGlyphRange(p,I,this.url,this.requestManager,(D,B)=>{if(B){for(const Z in B)this._doesCharSupportLocalGlyph(+Z)||(S.glyphs[+Z]=B[+Z]);S.ranges[I]=!0}for(const Z of P)Z(D,B);delete S.requests[I]})),P.push((D,B)=>{D?x(D):B&&x(null,{stack:p,id:g,glyph:B[g]||null})})},(p,g)=>{if(p)o(p);else if(g){const x={};for(const{stack:S,id:E,glyph:I}of g)(x[S]||(x[S]={}))[E]=I&&{id:I.id,bitmap:I.bitmap.clone(),metrics:I.metrics};o(null,x)}})}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&(u.unicodeBlockLookup["CJK Unified Ideographs"](n)||u.unicodeBlockLookup["Hangul Syllables"](n)||u.unicodeBlockLookup.Hiragana(n)||u.unicodeBlockLookup.Katakana(n))}_tinySDF(n,o,c){const p=this.localIdeographFontFamily;if(!p||!this._doesCharSupportLocalGlyph(c))return;let g=n.tinySDF;if(!g){let S="400";/bold/i.test(o)?S="900":/medium/i.test(o)?S="500":/light/i.test(o)&&(S="200"),g=n.tinySDF=new Ee.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:p,fontWeight:S})}const x=g.draw(String.fromCharCode(c));return{id:c,bitmap:new u.AlphaImage({width:x.width||30,height:x.height||30},x.data),metrics:{width:x.glyphWidth||24,height:x.glyphHeight||24,left:x.glyphLeft||0,top:x.glyphTop-27||-8,advance:x.glyphAdvance||24}}}}Ee.loadGlyphRange=function(h,n,o,c,p){const g=256*n,x=g+255,S=c.transformRequest(o.replace("{fontstack}",h).replace("{range}",`${g}-${x}`),u.ResourceType.Glyphs);u.getArrayBuffer(S,(E,I)=>{if(E)p(E);else if(I){const P={};for(const D of u.parseGlyphPbf(I))P[D.id]=D;p(null,P)}})},Ee.TinySDF=class{constructor({fontSize:h=24,buffer:n=3,radius:o=8,cutoff:c=.25,fontFamily:p="sans-serif",fontWeight:g="normal",fontStyle:x="normal"}={}){this.buffer=n,this.cutoff=c,this.radius=o;const S=this.size=h+4*n,E=this._createCanvas(S),I=this.ctx=E.getContext("2d",{willReadFrequently:!0});I.font=`${x} ${g} ${h}px ${p}`,I.textBaseline="alphabetic",I.textAlign="left",I.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(h){const n=document.createElement("canvas");return n.width=n.height=h,n}draw(h){const{width:n,actualBoundingBoxAscent:o,actualBoundingBoxDescent:c,actualBoundingBoxLeft:p,actualBoundingBoxRight:g}=this.ctx.measureText(h),x=Math.ceil(o),S=Math.min(this.size-this.buffer,Math.ceil(g-p)),E=Math.min(this.size-this.buffer,x+Math.ceil(c)),I=S+2*this.buffer,P=E+2*this.buffer,D=Math.max(I*P,0),B=new Uint8ClampedArray(D),Z={data:B,width:I,height:P,glyphWidth:S,glyphHeight:E,glyphTop:x,glyphLeft:0,glyphAdvance:n};if(S===0||E===0)return Z;const{ctx:j,buffer:G,gridInner:re,gridOuter:se}=this;j.clearRect(G,G,S,E),j.fillText(h,G,G+x);const ce=j.getImageData(G,G,S,E);se.fill(X,0,D),re.fill(0,0,D);for(let W=0;W<E;W++)for(let fe=0;fe<S;fe++){const he=ce.data[4*(W*S+fe)+3]/255;if(he===0)continue;const we=(W+G)*I+fe+G;if(he===1)se[we]=0,re[we]=X;else{const Se=.5-he;se[we]=Se>0?Se*Se:0,re[we]=Se<0?Se*Se:0}}ie(se,0,0,I,P,I,this.f,this.v,this.z),ie(re,G,G,S,E,I,this.f,this.v,this.z);for(let W=0;W<D;W++){const fe=Math.sqrt(se[W])-Math.sqrt(re[W]);B[W]=Math.round(255-255*(fe/this.radius+this.cutoff))}return Z}};const Oe=new u.Properties({anchor:new u.DataConstantProperty(u.spec.light.anchor),position:new class{constructor(){this.specification=u.spec.light.position}possiblyEvaluate(h,n){return u.sphericalToCartesian(h.expression.evaluate(n))}interpolate(h,n,o){return{x:u.number(h.x,n.x,o),y:u.number(h.y,n.y,o),z:u.number(h.z,n.z,o)}}},color:new u.DataConstantProperty(u.spec.light.color),intensity:new u.DataConstantProperty(u.spec.light.intensity)}),Ve="-transition";class Le extends u.Evented{constructor(n){super(),this._transitionable=new u.Transitionable(Oe),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,o={}){if(!this._validate(u.validateLight,n,o))for(const c in n){const p=n[c];c.endsWith(Ve)?this._transitionable.setTransition(c.slice(0,-Ve.length),p):this._transitionable.setValue(c,p)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,o,c){return(!c||c.validate!==!1)&&u.emitValidationErrors(this,n.call(u.validateStyle,u.extend({value:o,style:{glyphs:!0,sprite:!0},styleSpec:u.spec})))}}class vt{constructor(n,o){this.width=n,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,o){const c=n.join(",")+String(o);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(n,o)),this.dashEntry[c]}getDashRanges(n,o,c){const p=[];let g=n.length%2==1?-n[n.length-1]*c:0,x=n[0]*c,S=!0;p.push({left:g,right:x,isDash:S,zeroLength:n[0]===0});let E=n[0];for(let I=1;I<n.length;I++){S=!S;const P=n[I];g=E*c,E+=P,x=E*c,p.push({left:g,right:x,isDash:S,zeroLength:P===0})}return p}addRoundDash(n,o,c){const p=o/2;for(let g=-c;g<=c;g++){const x=this.width*(this.nextRow+c+g);let S=0,E=n[S];for(let I=0;I<this.width;I++){I/E.right>1&&(E=n[++S]);const P=Math.abs(I-E.left),D=Math.abs(I-E.right),B=Math.min(P,D);let Z;const j=g/c*(p+1);if(E.isDash){const G=p-Math.abs(j);Z=Math.sqrt(B*B+G*G)}else Z=p-Math.sqrt(B*B+j*j);this.data[x+I]=Math.max(0,Math.min(255,Z+128))}}}addRegularDash(n){for(let S=n.length-1;S>=0;--S){const E=n[S],I=n[S+1];E.zeroLength?n.splice(S,1):I&&I.isDash===E.isDash&&(I.left=E.left,n.splice(S,1))}const o=n[0],c=n[n.length-1];o.isDash===c.isDash&&(o.left=c.left-this.width,c.right=o.right+this.width);const p=this.width*this.nextRow;let g=0,x=n[g];for(let S=0;S<this.width;S++){S/x.right>1&&(x=n[++g]);const E=Math.abs(S-x.left),I=Math.abs(S-x.right),P=Math.min(E,I);this.data[p+S]=Math.max(0,Math.min(255,(x.isDash?P:-P)+128))}}addDash(n,o){const c=o?7:0,p=2*c+1;if(this.nextRow+p>this.height)return u.warnOnce("LineAtlas out of space"),null;let g=0;for(let S=0;S<n.length;S++)g+=n[S];if(g!==0){const S=this.width/g,E=this.getDashRanges(n,this.width,S);o?this.addRoundDash(E,S,c):this.addRegularDash(E)}const x={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:g};return this.nextRow+=p,this.dirty=!0,x}bind(n){const o=n.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}class ht{constructor(n,o){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=u.uniqueId();const c=this.workerPool.acquire(this.id);for(let p=0;p<c.length;p++){const g=new ht.Actor(c[p],o,this.id);g.name=`Worker ${p}`,this.actors.push(g)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,o,c){u.asyncAll(this.actors,(p,g)=>{p.send(n,o,g)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ht(h,n,o){const c=function(p,g){if(p)return o(p);if(g){const x=u.pick(u.extend(g,h),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);g.vector_layers&&(x.vectorLayers=g.vector_layers,x.vectorLayerIds=x.vectorLayers.map(S=>S.id)),o(null,x)}};return h.url?u.getJSON(n.transformRequest(h.url,u.ResourceType.Source),c):u.exported.frame(()=>c(null,h))}ht.Actor=u.Actor;class Kt{constructor(n,o,c){this.bounds=u.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=o||0,this.maxzoom=c||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const o=Math.pow(2,n.z),c=Math.floor(u.mercatorXfromLng(this.bounds.getWest())*o),p=Math.floor(u.mercatorYfromLat(this.bounds.getNorth())*o),g=Math.ceil(u.mercatorXfromLng(this.bounds.getEast())*o),x=Math.ceil(u.mercatorYfromLat(this.bounds.getSouth())*o);return n.x>=c&&n.x<g&&n.y>=p&&n.y<x}}class vn extends u.Evented{constructor(n,o,c,p){if(super(),this.id=n,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.extend(this,u.pick(o,["url","scheme","tileSize","promoteId"])),this._options=u.extend({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p)}load(){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ht(this._options,this.map._requestManager,(n,o)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n?this.fire(new u.ErrorEvent(n)):o&&(u.extend(this,o),o.bounds&&(this.tileBounds=new Kt(o.bounds,this.minzoom,this.maxzoom)),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return u.extend({},this._options)}loadTile(n,o){const c=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(c,u.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function g(x,S){return delete n.request,n.aborted?o(null):x&&x.status!==404?o(x):(S&&S.resourceTiming&&(n.resourceTiming=S.resourceTiming),this.map._refreshExpiredTiles&&S&&n.setExpiryData(S),n.loadVectorData(S,this.map.painter),u.cacheEntryPossiblyAdded(this.dispatcher),o(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}p.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=o:n.request=n.actor.send("reloadTile",p,g.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",p,g.bind(this)))}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)}unloadTile(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class cn extends u.Evented{constructor(n,o,c,p){super(),this.id=n,this.dispatcher=c,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.extend({type:"raster"},o),u.extend(this,u.pick(o,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ht(this._options,this.map._requestManager,(n,o)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new u.ErrorEvent(n)):o&&(u.extend(this,o),o.bounds&&(this.tileBounds=new Kt(o.bounds,this.minzoom,this.maxzoom)),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return u.extend({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,o){const c=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.request=u.getImage(this.map._requestManager.transformRequest(c,u.ResourceType.Tile),(p,g,x)=>{if(delete n.request,n.aborted)n.state="unloaded",o(null);else if(p)n.state="errored",o(p);else if(g){this.map._refreshExpiredTiles&&n.setExpiryData(x);const S=this.map.painter.context,E=S.gl;n.texture=this.map.painter.getTileTexture(g.width),n.texture?n.texture.update(g,{useMipmap:!0}):(n.texture=new ye(S,g,E.RGBA,{useMipmap:!0}),n.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),S.extTextureFilterAnisotropic&&E.texParameterf(E.TEXTURE_2D,S.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,S.extTextureFilterAnisotropicMax)),n.state="loaded",u.cacheEntryPossiblyAdded(this.dispatcher),o(null)}})}abortTile(n,o){n.request&&(n.request.cancel(),delete n.request),o()}unloadTile(n,o){n.texture&&this.map.painter.saveTileTexture(n.texture),o()}hasTransition(){return!1}}let Ln;class Ke extends cn{constructor(n,o,c,p){super(n,o,c,p),this.type="raster-dem",this.maxzoom=22,this._options=u.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(n,o){const c=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function p(g,x){g&&(n.state="errored",o(g)),x&&(n.dem=x,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded",o(null))}n.request=u.getImage(this.map._requestManager.transformRequest(c,u.ResourceType.Tile),function(g,x){if(delete n.request,n.aborted)n.state="unloaded",o(null);else if(g)n.state="errored",o(g);else if(x){this.map._refreshExpiredTiles&&n.setExpiryData(x),delete x.cacheControl,delete x.expires;const S=u.isImageBitmap(x)&&(Ln==null&&(Ln=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ln)?x:u.exported.getImageData(x,1),E={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:S,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",E,p.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)}_getNeighboringTiles(n){const o=n.canonical,c=Math.pow(2,o.z),p=(o.x-1+c)%c,g=o.x===0?n.wrap-1:n.wrap,x=(o.x+1+c)%c,S=o.x+1===c?n.wrap+1:n.wrap,E={};return E[new u.OverscaledTileID(n.overscaledZ,g,o.z,p,o.y).key]={backfilled:!1},E[new u.OverscaledTileID(n.overscaledZ,S,o.z,x,o.y).key]={backfilled:!1},o.y>0&&(E[new u.OverscaledTileID(n.overscaledZ,g,o.z,p,o.y-1).key]={backfilled:!1},E[new u.OverscaledTileID(n.overscaledZ,n.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},E[new u.OverscaledTileID(n.overscaledZ,S,o.z,x,o.y-1).key]={backfilled:!1}),o.y+1<c&&(E[new u.OverscaledTileID(n.overscaledZ,g,o.z,p,o.y+1).key]={backfilled:!1},E[new u.OverscaledTileID(n.overscaledZ,n.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},E[new u.OverscaledTileID(n.overscaledZ,S,o.z,x,o.y+1).key]={backfilled:!1}),E}unloadTile(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})}}class hn extends u.Evented{constructor(n,o,c,p){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(p),this._data=o.data,this._options=u.extend({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const g=u.EXTENT/this.tileSize;this.workerOptions=u.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*g,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*g,extent:u.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:u.EXTENT,radius:(o.clusterRadius||50)*g,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._updateWorkerData("content"),this}getClusterExpansionZoom(n,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},o),this}getClusterChildren(n,o){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},o),this}getClusterLeaves(n,o,c,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:o,offset:c},p),this}_updateWorkerData(n){const o=u.extend({},this.workerOptions),c=this._data;typeof c=="string"?(o.request=this.map._requestManager.transformRequest(u.exported.resolveURL(c),u.ResourceType.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(c),this._pendingLoads++,this.fire(new u.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,o,(p,g)=>{if(this._pendingLoads--,this._removed||g&&g.abandoned)return void this.fire(new u.Event("dataabort",{dataType:"source",sourceDataType:n}));let x=null;if(g&&g.resourceTiming&&g.resourceTiming[this.id]&&(x=g.resourceTiming[this.id].slice(0)),p)return void this.fire(new u.ErrorEvent(p));const S={dataType:"source",sourceDataType:n};this._collectResourceTiming&&x&&x.length>0&&u.extend(S,{resourceTiming:x}),this.fire(new u.Event("data",S))})}loaded(){return this._pendingLoads===0}loadTile(n,o){const c=n.actor?"reloadTile":"loadTile";n.actor=this.actor;const p={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.request=this.actor.send(c,p,(g,x)=>(delete n.request,n.unloadVectorData(),n.aborted?o(null):g?o(g):(n.loadVectorData(x,this.map.painter,c==="reloadTile"),o(null))))}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0}unloadTile(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return u.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var $e=u.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class st extends u.Evented{constructor(n,o,c,p){super(),this.id=n,this.dispatcher=c,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=o}load(n,o){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this.url=this.options.url,u.getImage(this.map._requestManager.transformRequest(this.url,u.ResourceType.Image),(c,p)=>{this._loaded=!0,c?this.fire(new u.ErrorEvent(c)):p&&(this.image=p,n&&(this.coordinates=n),o&&o(),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}setCoordinates(n){this.coordinates=n;const o=n.map(u.MercatorCoordinate.fromLngLat);this.tileID=function(p){let g=1/0,x=1/0,S=-1/0,E=-1/0;for(const B of p)g=Math.min(g,B.x),x=Math.min(x,B.y),S=Math.max(S,B.x),E=Math.max(E,B.y);const I=Math.max(S-g,E-x),P=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),D=Math.pow(2,P);return new u.CanonicalTileID(P,Math.floor((g+S)/2*D),Math.floor((x+E)/2*D))}(o),this.minzoom=this.maxzoom=this.tileID.z;const c=o.map(p=>this.tileID.getTilePoint(p)._round());return this._boundsArray=new u.RasterBoundsArray,this._boundsArray.emplaceBack(c[0].x,c[0].y,0,0),this._boundsArray.emplaceBack(c[1].x,c[1].y,u.EXTENT,0),this._boundsArray.emplaceBack(c[3].x,c[3].y,0,u.EXTENT),this._boundsArray.emplaceBack(c[2].x,c[2].y,u.EXTENT,u.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,o=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,$e.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ye(n,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));for(const c in this.tiles){const p=this.tiles[c];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}}loadTile(n,o){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},o(null)):(n.state="errored",o(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class pt extends st{constructor(n,o,c,p){super(n,o,c,p),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const n=this.options;this.urls=[];for(const o of n.urls)this.urls.push(this.map._requestManager.transformRequest(o,u.ResourceType.Source).url);u.getVideo(this.urls,(o,c)=>{this._loaded=!0,o?this.fire(new u.ErrorEvent(o)):c&&(this.video=c,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const o=this.video.seekable;n<o.start(0)||n>o.end(0)?this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,o=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,$e.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new ye(n,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));for(const c in this.tiles){const p=this.tiles[c];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Gt extends st{constructor(n,o,c,p){super(n,o,c,p),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(x=>typeof x!="number"))||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${n}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${n}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,c=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,$e.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ye(o,this.canvas,c.RGBA,{premultiply:!0});for(const p in this.tiles){const g=this.tiles[p];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const en={vector:vn,raster:cn,"raster-dem":Ke,geojson:hn,video:pt,image:st,canvas:Gt};function Xr(h,n){const o=u.create();return u.translate(o,o,[1,1,0]),u.scale(o,o,[.5*h.width,.5*h.height,1]),u.multiply(o,o,h.calculatePosMatrix(n.toUnwrapped()))}function cr(h,n,o,c,p,g){const x=function(D,B,Z){if(D)for(const j of D){const G=B[j];if(G&&G.source===Z&&G.type==="fill-extrusion")return!0}else for(const j in B){const G=B[j];if(G.source===Z&&G.type==="fill-extrusion")return!0}return!1}(p&&p.layers,n,h.id),S=g.maxPitchScaleFactor(),E=h.tilesIn(c,S,x);E.sort(hr);const I=[];for(const D of E)I.push({wrappedTileID:D.tileID.wrapped().key,queryResults:D.tile.queryRenderedFeatures(n,o,h._state,D.queryGeometry,D.cameraQueryGeometry,D.scale,p,g,S,Xr(h.transform,D.tileID))});const P=function(D){const B={},Z={};for(const j of D){const G=j.queryResults,re=j.wrappedTileID,se=Z[re]=Z[re]||{};for(const ce in G){const W=G[ce],fe=se[ce]=se[ce]||{},he=B[ce]=B[ce]||[];for(const we of W)fe[we.featureIndex]||(fe[we.featureIndex]=!0,he.push(we))}}return B}(I);for(const D in P)P[D].forEach(B=>{const Z=B.feature,j=h.getFeatureState(Z.layer["source-layer"],Z.id);Z.source=Z.layer.source,Z.layer["source-layer"]&&(Z.sourceLayer=Z.layer["source-layer"]),Z.state=j});return P}function hr(h,n){const o=h.tileID,c=n.tileID;return o.overscaledZ-c.overscaledZ||o.canonical.y-c.canonical.y||o.wrap-c.wrap||o.canonical.x-c.canonical.x}class Xn{constructor(n,o){this.tileID=n,this.uid=u.uniqueId(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const o=n+this.timeAdded;o<u.exported.now()||this.fadeEndTime&&o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.textures.forEach(o=>n.saveTileTexture(o)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(n,o,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(p,g){const x={};if(!g)return x;for(const S of p){const E=S.layerIds.map(I=>g.getLayer(I)).filter(Boolean);if(E.length!==0){S.layers=E,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map(I=>E.filter(P=>P.id===I)[0]));for(const I of E)x[I.id]=S}}return x}(n.buckets,o.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const g=this.buckets[p];if(g instanceof u.SymbolBucket){if(this.hasSymbolBuckets=!0,!c)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const g=this.buckets[p];if(g instanceof u.SymbolBucket&&g.hasRTLText){this.hasRTLText=!0,u.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const p in this.buckets){const g=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(p).queryRadius(g))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new u.CollisionBoxArray}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const c in this.buckets){const p=this.buckets[c];p.uploadPending()&&p.upload(n)}const o=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ye(n,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ye(n,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,o,c,p,g,x,S,E,I,P){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:g,scale:x,tileSize:this.tileSize,pixelPosMatrix:P,transform:E,params:S,queryPadding:this.queryPadding*I},n,o,c):{}}querySourceFeatures(n,o){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const p=c.loadVTLayers(),g=o?o.sourceLayer:"",x=p._geojsonTileLayer||p[g];if(!x)return;const S=u.createFilter(o&&o.filter),{z:E,x:I,y:P}=this.tileID.canonical,D={z:E,x:I,y:P};for(let B=0;B<x.length;B++){const Z=x.feature(B);if(S.needGeometry){const re=u.toEvaluationFeature(Z,!0);if(!S.filter(new u.EvaluationParameters(this.tileID.overscaledZ),re,this.tileID.canonical))continue}else if(!S.filter(new u.EvaluationParameters(this.tileID.overscaledZ),Z))continue;const j=c.getId(Z,g),G=new u.GeoJSONFeature(Z,E,I,P,j);G.tile=D,n.push(G)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const o=this.expirationTime;if(n.cacheControl){const c=u.parseCacheControl(n.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const c=Date.now();let p=!1;if(this.expirationTime>c)p=!1;else if(o)if(this.expirationTime<o)p=!0;else{const g=this.expirationTime-o;g?this.expirationTime=c+Math.max(g,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const p in this.buckets){if(!o.style.hasLayer(p))continue;const g=this.buckets[p],x=g.layers[0].sourceLayer||"_geojsonTileLayer",S=c[x],E=n[x];if(!S||!E||Object.keys(E).length===0)continue;g.update(E,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});const I=o&&o.style&&o.style.getLayer(p);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<u.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=u.exported.now()+n}setDependencies(n,o){const c={};for(const p of o)c[p]=!0;this.dependencies[n]=c}hasDependency(n,o){for(const c of n){const p=this.dependencies[c];if(p){for(const g of o)if(p[g])return!0}}return!1}}class br{constructor(n,o){this.max=n,this.onRemove=o,this.reset()}reset(){for(const n in this.data)for(const o of this.data[n])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(n,o,c){const p=n.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const g={value:o,timeout:void 0};if(c!==void 0&&(g.timeout=setTimeout(()=>{this.remove(n,g)},c)),this.data[p].push(g),this.order.push(p),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const o=this.data[n].shift();return o.timeout&&clearTimeout(o.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),o.value}getByKey(n){const o=this.data[n];return o?o[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,o){if(!this.has(n))return this;const c=n.wrapped().key,p=o===void 0?0:this.data[c].indexOf(o),g=this.data[c][p];return this.data[c].splice(p,1),g.timeout&&clearTimeout(g.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(g.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(n){const o=[];for(const c in this.data)for(const p of this.data[c])n(p.value)||o.push(p);for(const c of o)this.remove(c.value.tileID,c)}}class qi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,o,c){const p=String(o);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][p]=this.stateChanges[n][p]||{},u.extend(this.stateChanges[n][p],c),this.deletedStates[n]===null){this.deletedStates[n]={};for(const g in this.state[n])g!==p&&(this.deletedStates[n][g]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][p]===null){this.deletedStates[n][p]={};for(const g in this.state[n][p])c[g]||(this.deletedStates[n][p][g]=null)}else for(const g in c)this.deletedStates[n]&&this.deletedStates[n][p]&&this.deletedStates[n][p][g]===null&&delete this.deletedStates[n][p][g]}removeFeatureState(n,o,c){if(this.deletedStates[n]===null)return;const p=String(o);if(this.deletedStates[n]=this.deletedStates[n]||{},c&&o!==void 0)this.deletedStates[n][p]!==null&&(this.deletedStates[n][p]=this.deletedStates[n][p]||{},this.deletedStates[n][p][c]=null);else if(o!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][p])for(c in this.deletedStates[n][p]={},this.stateChanges[n][p])this.deletedStates[n][p][c]=null;else this.deletedStates[n][p]=null;else this.deletedStates[n]=null}getState(n,o){const c=String(o),p=u.extend({},(this.state[n]||{})[c],(this.stateChanges[n]||{})[c]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const g=this.deletedStates[n][o];if(g===null)return{};for(const x in g)delete p[x]}return p}initializeTileState(n,o){n.setFeatureState(this.state,o)}coalesceChanges(n,o){const c={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const g={};for(const x in this.stateChanges[p])this.state[p][x]||(this.state[p][x]={}),u.extend(this.state[p][x],this.stateChanges[p][x]),g[x]=this.state[p][x];c[p]=g}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const g={};if(this.deletedStates[p]===null)for(const x in this.state[p])g[x]={},this.state[p][x]={};else for(const x in this.deletedStates[p]){if(this.deletedStates[p][x]===null)this.state[p][x]={};else for(const S of Object.keys(this.deletedStates[p][x]))delete this.state[p][x][S];g[x]=this.state[p][x]}c[p]=c[p]||{},u.extend(c[p],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const p in n)n[p].setFeatureState(c,o)}}class dr extends u.Evented{constructor(n,o,c){super(),this.id=n,this.dispatcher=c,this.on("data",p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(p,g,x,S){const E=new en[g.type](p,g,x,S);if(E.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${E.id}`);return u.bindAll(["load","abort","unload","serialize","prepare"],E),E}(n,o,c,this),this._tiles={},this._cache=new br(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new qi}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles){const o=this._tiles[n];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,o){return this._source.loadTile(n,o)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n,()=>{})}_abortTile(n){this._source.abortTile&&this._source.abortTile(n,()=>{}),this._source.fire(new u.Event("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const c=this._tiles[o];c.upload(n),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(Ga).map(n=>n.key)}getRenderableIds(n){const o=[];for(const c in this._tiles)this._isIdRenderable(c,n)&&o.push(this._tiles[c]);return n?o.sort((c,p)=>{const g=c.tileID,x=p.tileID,S=new u.pointGeometry(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),E=new u.pointGeometry(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-x.overscaledZ||E.y-S.y||E.x-S.x}).map(c=>c.tileID.key):o.map(c=>c.tileID).sort(Ga).map(c=>c.key)}hasRenderableParent(n){const o=this.findLoadedParent(n,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(n,o){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(o||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")}}_reloadTile(n,o){const c=this._tiles[n];c&&(c.state!=="loading"&&(c.state=o),this._loadTile(c,this._tileLoaded.bind(this,c,n,o)))}_tileLoaded(n,o,c,p){if(p)return n.state="errored",void(p.status!==404?this._source.fire(new u.ErrorEvent(p,{tile:n})):this.update(this.transform,this.terrain));n.timeAdded=u.exported.now(),c==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(o,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new u.Event("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const o=this.getRenderableIds();for(let p=0;p<o.length;p++){const g=o[p];if(n.neighboringTiles&&n.neighboringTiles[g]){const x=this.getTileByID(g);c(n,x),c(x,n)}}function c(p,g){p.needsHillshadePrepare=!0,p.needsTerrainPrepare=!0;let x=g.tileID.canonical.x-p.tileID.canonical.x;const S=g.tileID.canonical.y-p.tileID.canonical.y,E=Math.pow(2,p.tileID.canonical.z),I=g.tileID.key;x===0&&S===0||Math.abs(S)>1||(Math.abs(x)>1&&(Math.abs(x+E)===1?x+=E:Math.abs(x-E)===1&&(x-=E)),g.dem&&p.dem&&(p.dem.backfillBorder(g.dem,x,S),p.neighboringTiles&&p.neighboringTiles[I]&&(p.neighboringTiles[I].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,o,c,p){for(const g in this._tiles){let x=this._tiles[g];if(p[g]||!x.hasData()||x.tileID.overscaledZ<=o||x.tileID.overscaledZ>c)continue;let S=x.tileID;for(;x&&x.tileID.overscaledZ>o+1;){const I=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[I.key],x&&x.hasData()&&(S=I)}let E=S;for(;E.overscaledZ>o;)if(E=E.scaledTo(E.overscaledZ-1),n[E.key]){p[S.key]=S;break}}}findLoadedParent(n,o){if(n.key in this._loadedParentTiles){const c=this._loadedParentTiles[n.key];return c&&c.tileID.overscaledZ>=o?c:null}for(let c=n.overscaledZ-1;c>=o;c--){const p=n.scaledTo(c),g=this._getLoadedTile(p);if(g)return g}}_getLoadedTile(n){const o=this._tiles[n.key];return o&&o.hasData()?o:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const o=Math.ceil(n.width/this._source.tileSize)+1,c=Math.ceil(n.height/this._source.tileSize)+1,p=Math.floor(o*c*5),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(g)}handleWrapJump(n){const o=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,o){const c={};for(const p in this._tiles){const g=this._tiles[p];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+o),c[g.tileID.key]=g}this._tiles=c;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(p,this._tiles[p])}}update(n,o){if(this.transform=n,this.terrain=o,!this._sourceLoaded||this._paused)return;let c;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(I=>new u.OverscaledTileID(I.canonical.z,I.wrap,I.canonical.z,I.canonical.x,I.canonical.y)):(c=n.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o}),this._source.hasTile&&(c=c.filter(I=>this._source.hasTile(I)))):c=[];const p=n.coveringZoomLevel(this._source),g=Math.max(p-dr.maxOverzooming,this._source.minzoom),x=Math.max(p+dr.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const I={};for(const P of c)if(P.canonical.z>this._source.minzoom){const D=P.scaledTo(P.canonical.z-1);I[D.key]=D;const B=P.scaledTo(Math.max(this._source.minzoom,Math.min(P.canonical.z,5)));I[B.key]=B}c=c.concat(Object.values(I))}const S=this._updateRetainedTiles(c,p);if($o(this._source.type)){const I={},P={},D=Object.keys(S);for(const B of D){const Z=S[B],j=this._tiles[B];if(!j||j.fadeEndTime&&j.fadeEndTime<=u.exported.now())continue;const G=this.findLoadedParent(Z,g);G&&(this._addTile(G.tileID),I[G.tileID.key]=G.tileID),P[B]=Z}this._retainLoadedChildren(P,p,x,S);for(const B in I)S[B]||(this._coveredTiles[B]=!0,S[B]=I[B]);if(o){const B={},Z={};for(const j of c)this._tiles[j.key].hasData()?B[j.key]=j:Z[j.key]=j;for(const j in Z){const G=Z[j].children(this._source.maxzoom);this._tiles[G[0].key]&&this._tiles[G[1].key]&&this._tiles[G[2].key]&&this._tiles[G[3].key]&&(B[G[0].key]=S[G[0].key]=G[0],B[G[1].key]=S[G[1].key]=G[1],B[G[2].key]=S[G[2].key]=G[2],B[G[3].key]=S[G[3].key]=G[3],delete Z[j])}for(const j in Z){const G=this.findLoadedParent(Z[j],this._source.minzoom);if(G){B[G.tileID.key]=S[G.tileID.key]=G.tileID;for(const re in B)B[re].isChildOf(G.tileID)&&delete B[re]}}for(const j in this._tiles)B[j]||(this._coveredTiles[j]=!0)}}for(const I in S)this._tiles[I].clearFadeHold();const E=u.keysDifference(this._tiles,S);for(const I of E){const P=this._tiles[I];P.hasSymbolBuckets&&!P.holdingForFade()?P.setHoldDuration(this.map._fadeDuration):P.hasSymbolBuckets&&!P.symbolFadeFinished()||this._removeTile(I)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,o){const c={},p={},g=Math.max(o-dr.maxOverzooming,this._source.minzoom),x=Math.max(o+dr.maxUnderzooming,this._source.minzoom),S={};for(const E of n){const I=this._addTile(E);c[E.key]=E,I.hasData()||o<this._source.maxzoom&&(S[E.key]=E)}this._retainLoadedChildren(S,o,x,c);for(const E of n){let I=this._tiles[E.key];if(I.hasData())continue;if(o+1>this._source.maxzoom){const D=E.children(this._source.maxzoom)[0],B=this.getTile(D);if(B&&B.hasData()){c[D.key]=D;continue}}else{const D=E.children(this._source.maxzoom);if(c[D[0].key]&&c[D[1].key]&&c[D[2].key]&&c[D[3].key])continue}let P=I.wasRequested();for(let D=E.overscaledZ-1;D>=g;--D){const B=E.scaledTo(D);if(p[B.key]||(p[B.key]=!0,I=this.getTile(B),!I&&P&&(I=this._addTile(B)),I&&(c[B.key]=B,P=I.wasRequested(),I.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const o=[];let c,p=this._tiles[n].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){c=this._loadedParentTiles[p.key];break}o.push(p.key);const g=p.scaledTo(p.overscaledZ-1);if(c=this._getLoadedTile(g),c)break;p=g}for(const g of o)this._loadedParentTiles[g]=c}}_addTile(n){let o=this._tiles[n.key];if(o)return o;o=this._cache.getAndRemove(n),o&&(this._setTileReloadTimer(n.key,o),o.tileID=n,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,o)));const c=o;return o||(o=new Xn(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(o,this._tileLoaded.bind(this,o,n.key,o.state))),o.uses++,this._tiles[n.key]=o,c||this._source.fire(new u.Event("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(n,o){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const c=o.getExpiryTimeout();c&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},c))}_removeTile(n){const o=this._tiles[n];o&&(o.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,o,c){const p=[],g=this.transform;if(!g)return p;const x=c?g.getCameraQueryGeometry(n):n,S=n.map(j=>g.pointCoordinate(j,this.terrain)),E=x.map(j=>g.pointCoordinate(j,this.terrain)),I=this.getIds();let P=1/0,D=1/0,B=-1/0,Z=-1/0;for(const j of E)P=Math.min(P,j.x),D=Math.min(D,j.y),B=Math.max(B,j.x),Z=Math.max(Z,j.y);for(let j=0;j<I.length;j++){const G=this._tiles[I[j]];if(G.holdingForFade())continue;const re=G.tileID,se=Math.pow(2,g.zoom-G.tileID.overscaledZ),ce=o*G.queryPadding*u.EXTENT/G.tileSize/se,W=[re.getTilePoint(new u.MercatorCoordinate(P,D)),re.getTilePoint(new u.MercatorCoordinate(B,Z))];if(W[0].x-ce<u.EXTENT&&W[0].y-ce<u.EXTENT&&W[1].x+ce>=0&&W[1].y+ce>=0){const fe=S.map(we=>re.getTilePoint(we)),he=E.map(we=>re.getTilePoint(we));p.push({tile:G,tileID:re,queryGeometry:fe,cameraQueryGeometry:he,scale:se})}}return p}getVisibleCoordinates(n){const o=this.getRenderableIds(n).map(c=>this._tiles[c].tileID);for(const c of o)c.posMatrix=this.transform.calculatePosMatrix(c.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if($o(this._source.type))for(const n in this._tiles){const o=this._tiles[n];if(o.fadeEndTime!==void 0&&o.fadeEndTime>=u.exported.now())return!0}return!1}setFeatureState(n,o,c){this._state.updateState(n=n||"_geojsonTileLayer",o,c)}removeFeatureState(n,o,c){this._state.removeFeatureState(n=n||"_geojsonTileLayer",o,c)}getFeatureState(n,o){return this._state.getState(n=n||"_geojsonTileLayer",o)}setDependencies(n,o,c){const p=this._tiles[n];p&&p.setDependencies(o,c)}reloadTilesForDependencies(n,o){for(const c in this._tiles)this._tiles[c].hasDependency(n,o)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(n,o))}}function Ga(h,n){const o=Math.abs(2*h.wrap)-+(h.wrap<0),c=Math.abs(2*n.wrap)-+(n.wrap<0);return h.overscaledZ-n.overscaledZ||c-o||n.canonical.y-h.canonical.y||n.canonical.x-h.canonical.x}function $o(h){return h==="raster"||h==="image"||h==="video"}dr.maxOverzooming=10,dr.maxUnderzooming=3;const Ei="mapboxgl_preloaded_worker_pool";class Sr{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<Sr.workerCount;)this.workers.push(new Worker(xa.workerUrl));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ei]}numActive(){return Object.keys(this.active).length}}const jo=Math.floor(u.exported.hardwareConcurrency/2);let Zi;function qa(){return Zi||(Zi=new Sr),Zi}function Za(h,n){const o={};for(const c in h)c!=="ref"&&(o[c]=h[c]);return u.refProperties.forEach(c=>{c in n&&(o[c]=n[c])}),o}function Go(h){h=h.slice();const n=Object.create(null);for(let o=0;o<h.length;o++)n[h[o].id]=h[o];for(let o=0;o<h.length;o++)"ref"in h[o]&&(h[o]=Za(h[o],n[h[o].ref]));return h}Sr.workerCount=Math.max(Math.min(jo,6),1);const At={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function hi(h,n,o){o.push({command:At.addSource,args:[h,n[h]]})}function Wi(h,n,o){n.push({command:At.removeSource,args:[h]}),o[h]=!0}function Hi(h,n,o,c){Wi(h,o,c),hi(h,n,o)}function qo(h,n,o){let c;for(c in h[o])if(Object.prototype.hasOwnProperty.call(h[o],c)&&c!=="data"&&!Q(h[o][c],n[o][c]))return!1;for(c in n[o])if(Object.prototype.hasOwnProperty.call(n[o],c)&&c!=="data"&&!Q(h[o][c],n[o][c]))return!1;return!0}function ki(h,n,o,c,p,g){let x;for(x in n=n||{},h=h||{})Object.prototype.hasOwnProperty.call(h,x)&&(Q(h[x],n[x])||o.push({command:g,args:[c,x,n[x],p]}));for(x in n)Object.prototype.hasOwnProperty.call(n,x)&&!Object.prototype.hasOwnProperty.call(h,x)&&(Q(h[x],n[x])||o.push({command:g,args:[c,x,n[x],p]}))}function Ii(h){return h.id}function Wa(h,n){return h[n.id]=n,h}class Ci{constructor(n,o){this.reset(n,o)}reset(n,o){this.points=n||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=u.clamp(n,0,1);let o=1,c=this._distances[o];const p=n*this.paddedLength+this.padding;for(;c<p&&o<this._distances.length;)c=this._distances[++o];const g=o-1,x=this._distances[g],S=c-x,E=S>0?(p-x)/S:0;return this.points[g].mult(1-E).add(this.points[o].mult(E))}}function Te(h,n){let o=!0;return h==="always"||h!=="never"&&n!=="never"||(o=!1),o}class Ne{constructor(n,o,c){const p=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(n/c),this.yCellCount=Math.ceil(o/c);for(let x=0;x<this.xCellCount*this.yCellCount;x++)p.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=o,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,o,c,p,g){this._forEachCell(o,c,p,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(g)}insertCircle(n,o,c,p){this._forEachCell(o-p,c-p,o+p,c+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(o),this.circles.push(c),this.circles.push(p)}_insertBoxCell(n,o,c,p,g,x){this.boxCells[g].push(x)}_insertCircleCell(n,o,c,p,g,x){this.circleCells[g].push(x)}_query(n,o,c,p,g,x,S){if(c<0||n>this.width||p<0||o>this.height)return[];const E=[];if(n<=0&&o<=0&&this.width<=c&&this.height<=p){if(g)return[{key:null,x1:n,y1:o,x2:c,y2:p}];for(let I=0;I<this.boxKeys.length;I++)E.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){const P=this.circles[3*I],D=this.circles[3*I+1],B=this.circles[3*I+2];E.push({key:this.circleKeys[I],x1:P-B,y1:D-B,x2:P+B,y2:D+B})}}else this._forEachCell(n,o,c,p,this._queryCell,E,{hitTest:g,overlapMode:x,seenUids:{box:{},circle:{}}},S);return E}query(n,o,c,p){return this._query(n,o,c,p,!1,null)}hitTest(n,o,c,p,g,x){return this._query(n,o,c,p,!0,g,x).length>0}hitTestCircle(n,o,c,p,g){const x=n-c,S=n+c,E=o-c,I=o+c;if(S<0||x>this.width||I<0||E>this.height)return!1;const P=[];return this._forEachCell(x,E,S,I,this._queryCellCircle,P,{hitTest:!0,overlapMode:p,circle:{x:n,y:o,radius:c},seenUids:{box:{},circle:{}}},g),P.length>0}_queryCell(n,o,c,p,g,x,S,E){const{seenUids:I,hitTest:P,overlapMode:D}=S,B=this.boxCells[g];if(B!==null){const j=this.bboxes;for(const G of B)if(!I.box[G]){I.box[G]=!0;const re=4*G,se=this.boxKeys[G];if(n<=j[re+2]&&o<=j[re+3]&&c>=j[re+0]&&p>=j[re+1]&&(!E||E(se))&&(!P||!Te(D,se.overlapMode))&&(x.push({key:se,x1:j[re],y1:j[re+1],x2:j[re+2],y2:j[re+3]}),P))return!0}}const Z=this.circleCells[g];if(Z!==null){const j=this.circles;for(const G of Z)if(!I.circle[G]){I.circle[G]=!0;const re=3*G,se=this.circleKeys[G];if(this._circleAndRectCollide(j[re],j[re+1],j[re+2],n,o,c,p)&&(!E||E(se))&&(!P||!Te(D,se.overlapMode))){const ce=j[re],W=j[re+1],fe=j[re+2];if(x.push({key:se,x1:ce-fe,y1:W-fe,x2:ce+fe,y2:W+fe}),P)return!0}}}return!1}_queryCellCircle(n,o,c,p,g,x,S,E){const{circle:I,seenUids:P,overlapMode:D}=S,B=this.boxCells[g];if(B!==null){const j=this.bboxes;for(const G of B)if(!P.box[G]){P.box[G]=!0;const re=4*G,se=this.boxKeys[G];if(this._circleAndRectCollide(I.x,I.y,I.radius,j[re+0],j[re+1],j[re+2],j[re+3])&&(!E||E(se))&&!Te(D,se.overlapMode))return x.push(!0),!0}}const Z=this.circleCells[g];if(Z!==null){const j=this.circles;for(const G of Z)if(!P.circle[G]){P.circle[G]=!0;const re=3*G,se=this.circleKeys[G];if(this._circlesCollide(j[re],j[re+1],j[re+2],I.x,I.y,I.radius)&&(!E||E(se))&&!Te(D,se.overlapMode))return x.push(!0),!0}}}_forEachCell(n,o,c,p,g,x,S,E){const I=this._convertToXCellCoord(n),P=this._convertToYCellCoord(o),D=this._convertToXCellCoord(c),B=this._convertToYCellCoord(p);for(let Z=I;Z<=D;Z++)for(let j=P;j<=B;j++)if(g.call(this,n,o,c,p,this.xCellCount*j+Z,x,S,E))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,o,c,p,g,x){const S=p-n,E=g-o,I=c+x;return I*I>S*S+E*E}_circleAndRectCollide(n,o,c,p,g,x,S){const E=(x-p)/2,I=Math.abs(n-(p+E));if(I>E+c)return!1;const P=(S-g)/2,D=Math.abs(o-(g+P));if(D>P+c)return!1;if(I<=E||D<=P)return!0;const B=I-E,Z=D-P;return B*B+Z*Z<=c*c}}function da(h,n,o,c,p){const g=u.create();return n?(u.scale(g,g,[1/p,1/p,1]),o||u.rotateZ(g,g,c.angle)):u.multiply(g,c.labelPlaneMatrix,h),g}function Yr(h,n,o,c,p){if(n){const g=u.clone(h);return u.scale(g,g,[p,p,1]),o||u.rotateZ(g,g,-c.angle),g}return c.glCoordMatrix}function Pt(h,n,o){let c;o?(c=[h.x,h.y,o(h.x,h.y),1],u.transformMat4(c,c,n)):(c=[h.x,h.y,0,1],Ai(c,c,n));const p=c[3];return{point:new u.pointGeometry(c[0]/p,c[1]/p),signedDistanceFromCamera:p}}function Nr(h,n){return .5+h/n*.5}function Tr(h,n){const o=h[0]/h[3],c=h[1]/h[3];return o>=-n[0]&&o<=n[0]&&c>=-n[1]&&c<=n[1]}function Er(h,n,o,c,p,g,x,S,E,I){const P=c?h.textSizeData:h.iconSizeData,D=u.evaluateSizeForZoom(P,o.transform.zoom),B=[256/o.width*2+1,256/o.height*2+1],Z=c?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;Z.clear();const j=h.lineVertexArray,G=c?h.text.placedSymbolArray:h.icon.placedSymbolArray,re=o.transform.width/o.transform.height;let se=!1;for(let ce=0;ce<G.length;ce++){const W=G.get(ce);if(W.hidden||W.writingMode===u.WritingMode.vertical&&!se){mt(W.numGlyphs,Z);continue}let fe;if(se=!1,I?(fe=[W.anchorX,W.anchorY,I(W.anchorX,W.anchorY),1],u.transformMat4(fe,fe,n)):(fe=[W.anchorX,W.anchorY,0,1],Ai(fe,fe,n)),!Tr(fe,B)){mt(W.numGlyphs,Z);continue}const he=Nr(o.transform.cameraToCenterDistance,fe[3]),we=u.evaluateSizeForFeature(P,D,W),Se=x?we/he:we*he,Ae=new u.pointGeometry(W.anchorX,W.anchorY),ve=Pt(Ae,p,I).point,We={},Be=xt(W,Se,!1,S,n,p,g,h.glyphOffsetArray,j,Z,ve,Ae,We,re,E,I);se=Be.useVertical,(Be.notEnoughRoom||se||Be.needsFlipping&&xt(W,Se,!0,S,n,p,g,h.glyphOffsetArray,j,Z,ve,Ae,We,re,E,I).notEnoughRoom)&&mt(W.numGlyphs,Z)}c?h.text.dynamicLayoutVertexBuffer.updateData(Z):h.icon.dynamicLayoutVertexBuffer.updateData(Z)}function Xi(h,n,o,c,p,g,x,S,E,I,P,D,B){const Z=S.glyphStartIndex+S.numGlyphs,j=S.lineStartIndex,G=S.lineStartIndex+S.lineLength,re=n.getoffsetX(S.glyphStartIndex),se=n.getoffsetX(Z-1),ce=jn(h*re,o,c,p,g,x,S.segment,j,G,E,I,P,D,B);if(!ce)return null;const W=jn(h*se,o,c,p,g,x,S.segment,j,G,E,I,P,D,B);return W?{first:ce,last:W}:null}function Re(h,n,o,c){return h===u.WritingMode.horizontal&&Math.abs(o.y-n.y)>Math.abs(o.x-n.x)*c?{useVertical:!0}:(h===u.WritingMode.vertical?n.y<o.y:n.x>o.x)?{needsFlipping:!0}:null}function xt(h,n,o,c,p,g,x,S,E,I,P,D,B,Z,j,G){const re=n/24,se=h.lineOffsetX*re,ce=h.lineOffsetY*re;let W;if(h.numGlyphs>1){const fe=h.glyphStartIndex+h.numGlyphs,he=h.lineStartIndex,we=h.lineStartIndex+h.lineLength,Se=Xi(re,S,se,ce,o,P,D,h,E,g,B,j,G);if(!Se)return{notEnoughRoom:!0};const Ae=Pt(Se.first.point,x,G).point,ve=Pt(Se.last.point,x,G).point;if(c&&!o){const We=Re(h.writingMode,Ae,ve,Z);if(We)return We}W=[Se.first];for(let We=h.glyphStartIndex+1;We<fe-1;We++)W.push(jn(re*S.getoffsetX(We),se,ce,o,P,D,h.segment,he,we,E,g,B,j,G));W.push(Se.last)}else{if(c&&!o){const he=Pt(D,p,G).point,we=h.lineStartIndex+h.segment+1,Se=new u.pointGeometry(E.getx(we),E.gety(we)),Ae=Pt(Se,p,G),ve=Ae.signedDistanceFromCamera>0?Ae.point:gt(D,Se,he,1,p,G),We=Re(h.writingMode,he,ve,Z);if(We)return We}const fe=jn(re*S.getoffsetX(h.glyphStartIndex),se,ce,o,P,D,h.segment,h.lineStartIndex,h.lineStartIndex+h.lineLength,E,g,B,j,G);if(!fe)return{notEnoughRoom:!0};W=[fe]}for(const fe of W)u.addDynamicAttributes(I,fe.point,fe.angle);return{}}function gt(h,n,o,c,p,g){const x=Pt(h.add(h.sub(n)._unit()),p,g).point,S=o.sub(x);return o.add(S._mult(c/S.mag()))}function jn(h,n,o,c,p,g,x,S,E,I,P,D,B,Z){const j=c?h-n:h+n;let G=j>0?1:-1,re=0;c&&(G*=-1,re=Math.PI),G<0&&(re+=Math.PI);let se=G>0?S+x:S+x+1,ce=p,W=p,fe=0,he=0;const we=Math.abs(j),Se=[];for(;fe+he<=we;){if(se+=G,se<S||se>=E)return null;if(W=ce,Se.push(ce),ce=D[se],ce===void 0){const He=new u.pointGeometry(I.getx(se),I.gety(se)),yt=Pt(He,P,Z);if(yt.signedDistanceFromCamera>0)ce=D[se]=yt.point;else{const bt=se-G;ce=gt(fe===0?g:new u.pointGeometry(I.getx(bt),I.gety(bt)),He,W,we-fe+1,P,Z)}}fe+=he,he=W.dist(ce)}const Ae=(we-fe)/he,ve=ce.sub(W),We=ve.mult(Ae)._add(W);We._add(ve._unit()._perp()._mult(o*G));const Be=re+Math.atan2(ce.y-W.y,ce.x-W.x);return Se.push(We),{point:We,angle:B?Be:0,path:Se}}const Yi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function mt(h,n){for(let o=0;o<h;o++){const c=n.length;n.resize(c+4),n.float32.set(Yi,3*c)}}function Ai(h,n,o){const c=n[0],p=n[1];return h[0]=o[0]*c+o[4]*p+o[12],h[1]=o[1]*c+o[5]*p+o[13],h[3]=o[3]*c+o[7]*p+o[15],h}const Rn=100;class Ha{constructor(n,o=new Ne(n.width+200,n.height+200,25),c=new Ne(n.width+200,n.height+200,25)){this.transform=n,this.grid=o,this.ignoredGrid=c,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+Rn,this.screenBottomBoundary=n.height+Rn,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,o,c,p,g,x){const S=this.projectAndGetPerspectiveRatio(p,n.anchorPointX,n.anchorPointY,x),E=c*S.perspectiveRatio,I=n.x1*E+S.point.x,P=n.y1*E+S.point.y,D=n.x2*E+S.point.x,B=n.y2*E+S.point.y;return!this.isInsideGrid(I,P,D,B)||o!=="always"&&this.grid.hitTest(I,P,D,B,o,g)||S.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[I,P,D,B],offscreen:this.isOffscreen(I,P,D,B)}}placeCollisionCircles(n,o,c,p,g,x,S,E,I,P,D,B,Z,j){const G=[],re=new u.pointGeometry(o.anchorX,o.anchorY),se=Pt(re,x,j),ce=Nr(this.transform.cameraToCenterDistance,se.signedDistanceFromCamera),W=(P?g/ce:g*ce)/u.ONE_EM,fe=Pt(re,S,j).point,he=Xi(W,p,o.lineOffsetX*W,o.lineOffsetY*W,!1,fe,re,o,c,S,{},!1,j);let we=!1,Se=!1,Ae=!0;if(he){const ve=.5*B*ce+Z,We=new u.pointGeometry(-100,-100),Be=new u.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),He=new Ci,yt=he.first,bt=he.last;let at=[];for(let Ct=yt.path.length-1;Ct>=1;Ct--)at.push(yt.path[Ct]);for(let Ct=1;Ct<bt.path.length;Ct++)at.push(bt.path[Ct]);const Nt=2.5*ve;if(E){const Ct=at.map(Dt=>Pt(Dt,E,j));at=Ct.some(Dt=>Dt.signedDistanceFromCamera<=0)?[]:Ct.map(Dt=>Dt.point)}let Ut=[];if(at.length>0){const Ct=at[0].clone(),Dt=at[0].clone();for(let jt=1;jt<at.length;jt++)Ct.x=Math.min(Ct.x,at[jt].x),Ct.y=Math.min(Ct.y,at[jt].y),Dt.x=Math.max(Dt.x,at[jt].x),Dt.y=Math.max(Dt.y,at[jt].y);Ut=Ct.x>=We.x&&Dt.x<=Be.x&&Ct.y>=We.y&&Dt.y<=Be.y?[at]:Dt.x<We.x||Ct.x>Be.x||Dt.y<We.y||Ct.y>Be.y?[]:u.clipLine([at],We.x,We.y,Be.x,Be.y)}for(const Ct of Ut){He.reset(Ct,.25*ve);let Dt=0;Dt=He.length<=.5*ve?1:Math.ceil(He.paddedLength/Nt)+1;for(let jt=0;jt<Dt;jt++){const Fn=jt/Math.max(Dt-1,1),mi=He.lerp(Fn),Jr=mi.x+Rn,gi=mi.y+Rn;G.push(Jr,gi,ve,0);const ra=Jr-ve,Vr=gi-ve,fr=Jr+ve,Mi=gi+ve;if(Ae=Ae&&this.isOffscreen(ra,Vr,fr,Mi),Se=Se||this.isInsideGrid(ra,Vr,fr,Mi),n!=="always"&&this.grid.hitTestCircle(Jr,gi,ve,n,D)&&(we=!0,!I))return{circles:[],offscreen:!1,collisionDetected:we}}}}return{circles:!I&&we||!Se||ce<this.perspectiveRatioCutoff?[]:G,offscreen:Ae,collisionDetected:we}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[];let c=1/0,p=1/0,g=-1/0,x=-1/0;for(const P of n){const D=new u.pointGeometry(P.x+Rn,P.y+Rn);c=Math.min(c,D.x),p=Math.min(p,D.y),g=Math.max(g,D.x),x=Math.max(x,D.y),o.push(D)}const S=this.grid.query(c,p,g,x).concat(this.ignoredGrid.query(c,p,g,x)),E={},I={};for(const P of S){const D=P.key;if(E[D.bucketInstanceId]===void 0&&(E[D.bucketInstanceId]={}),E[D.bucketInstanceId][D.featureIndex])continue;const B=[new u.pointGeometry(P.x1,P.y1),new u.pointGeometry(P.x2,P.y1),new u.pointGeometry(P.x2,P.y2),new u.pointGeometry(P.x1,P.y2)];u.polygonIntersectsPolygon(o,B)&&(E[D.bucketInstanceId][D.featureIndex]=!0,I[D.bucketInstanceId]===void 0&&(I[D.bucketInstanceId]=[]),I[D.bucketInstanceId].push(D.featureIndex))}return I}insertCollisionBox(n,o,c,p,g,x){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:g,collisionGroupID:x,overlapMode:o},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,o,c,p,g,x){const S=c?this.ignoredGrid:this.grid,E={bucketInstanceId:p,featureIndex:g,collisionGroupID:x,overlapMode:o};for(let I=0;I<n.length;I+=4)S.insertCircle(E,n[I],n[I+1],n[I+2])}projectAndGetPerspectiveRatio(n,o,c,p){let g;return p?(g=[o,c,p(o,c),1],u.transformMat4(g,g,n)):(g=[o,c,0,1],Ai(g,g,n)),{point:new u.pointGeometry((g[0]/g[3]+1)/2*this.transform.width+Rn,(-g[1]/g[3]+1)/2*this.transform.height+Rn),perspectiveRatio:.5+this.transform.cameraToCenterDistance/g[3]*.5}}isOffscreen(n,o,c,p){return c<Rn||n>=this.screenRightBoundary||p<Rn||o>this.screenBottomBoundary}isInsideGrid(n,o,c,p){return c>=0&&n<this.gridRightBoundary&&p>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const n=u.identity([]);return u.translate(n,n,[-100,-100,0]),n}}function Tn(h,n,o){return n*(u.EXTENT/(h.tileSize*Math.pow(2,o-h.tileID.overscaledZ)))}class rr{constructor(n,o,c,p){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?o:-o))):p&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class $t{constructor(n,o,c,p,g){this.text=new rr(n?n.text:null,o,c,g),this.icon=new rr(n?n.icon:null,o,p,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Xa{constructor(n,o,c){this.text=n,this.icon=o,this.skipFade=c}}class di{constructor(){this.invProjMatrix=u.create(),this.viewportMatrix=u.create(),this.circles=[]}}class pa{constructor(n,o,c,p,g){this.bucketInstanceId=n,this.featureIndex=o,this.sourceLayerIndex=c,this.bucketIndex=p,this.tileID=g}}class fa{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const o=++this.maxGroupID;this.collisionGroups[n]={ID:o,predicate:c=>c.collisionGroupID===o}}return this.collisionGroups[n]}}function Ya(h,n,o,c,p){const{horizontalAlign:g,verticalAlign:x}=u.getAnchorAlignment(h),S=-(g-.5)*n,E=-(x-.5)*o,I=u.evaluateVariableOffset(h,c);return new u.pointGeometry(S+I[0]*p,E+I[1]*p)}function ma(h,n,o,c,p,g){const{x1:x,x2:S,y1:E,y2:I,anchorPointX:P,anchorPointY:D}=h,B=new u.pointGeometry(n,o);return c&&B._rotate(p?g:-g),{x1:x+B.x,y1:E+B.y,x2:S+B.x,y2:I+B.y,anchorPointX:P,anchorPointY:D}}class ${constructor(n,o,c,p,g){this.transform=n.clone(),this.terrain=o,this.collisionIndex=new Ha(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new fa(p),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,o,c,p){const g=c.getBucket(o),x=c.latestFeatureIndex;if(!g||!x||o.id!==g.layerIds[0])return;const S=c.collisionBoxArray,E=g.layers[0].layout,I=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),P=c.tileSize/u.EXTENT,D=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),B=E.get("text-pitch-alignment")==="map",Z=E.get("text-rotation-alignment")==="map",j=Tn(c,1,this.transform.zoom),G=da(D,B,Z,this.transform,j);let re=null;if(B){const ce=Yr(D,B,Z,this.transform,j);re=u.multiply([],this.transform.labelPlaneMatrix,ce)}this.retainedQueryData[g.bucketInstanceId]=new pa(g.bucketInstanceId,x,g.sourceLayerIndex,g.index,c.tileID);const se={bucket:g,layout:E,posMatrix:D,textLabelPlaneMatrix:G,labelToScreenMatrix:re,scale:I,textPixelRatio:P,holdingForFade:c.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:u.evaluateSizeForZoom(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(p)for(const ce of g.sortKeyRanges){const{sortKey:W,symbolInstanceStart:fe,symbolInstanceEnd:he}=ce;n.push({sortKey:W,symbolInstanceStart:fe,symbolInstanceEnd:he,parameters:se})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:se})}attemptAnchorPlacement(n,o,c,p,g,x,S,E,I,P,D,B,Z,j,G,re){const se=[B.textOffset0,B.textOffset1],ce=Ya(n,c,p,se,g),W=this.collisionIndex.placeCollisionBox(ma(o,ce.x,ce.y,x,S,this.transform.angle),D,E,I,P.predicate,re);if((!G||this.collisionIndex.placeCollisionBox(ma(G,ce.x,ce.y,x,S,this.transform.angle),D,E,I,P.predicate,re).box.length!==0)&&W.box.length>0){let fe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[B.crossTileID]&&this.prevPlacement.placements[B.crossTileID]&&this.prevPlacement.placements[B.crossTileID].text&&(fe=this.prevPlacement.variableOffsets[B.crossTileID].anchor),B.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[B.crossTileID]={textOffset:se,width:c,height:p,anchor:n,textBoxScale:g,prevAnchor:fe},this.markUsedJustification(Z,n,B,j),Z.allowVerticalPlacement&&(this.markUsedOrientation(Z,j,B),this.placedOrientations[B.crossTileID]=j),{shift:ce,placedGlyphBoxes:W}}}placeLayerBucketPart(n,o,c){const{bucket:p,layout:g,posMatrix:x,textLabelPlaneMatrix:S,labelToScreenMatrix:E,textPixelRatio:I,holdingForFade:P,collisionBoxArray:D,partiallyEvaluatedTextSize:B,collisionGroup:Z}=n.parameters,j=g.get("text-optional"),G=g.get("icon-optional"),re=u.getOverlapMode(g,"text-overlap","text-allow-overlap"),se=re==="always",ce=u.getOverlapMode(g,"icon-overlap","icon-allow-overlap"),W=ce==="always",fe=g.get("text-rotation-alignment")==="map",he=g.get("text-pitch-alignment")==="map",we=g.get("icon-text-fit")!=="none",Se=g.get("symbol-z-order")==="viewport-y",Ae=se&&(W||!p.hasIconData()||G),ve=W&&(se||!p.hasTextData()||j);!p.collisionArrays&&D&&p.deserializeCollisionBoxes(D);const We=(Be,He)=>{if(o[Be.crossTileID])return;if(P)return void(this.placements[Be.crossTileID]=new Xa(!1,!1,!1));let yt=!1,bt=!1,at=!0,Nt=null,Ut={box:null,offscreen:null},Ct={box:null,offscreen:null},Dt=null,jt=null,Fn=null,mi=0,Jr=0,gi=0;He.textFeatureIndex?mi=He.textFeatureIndex:Be.useRuntimeCollisionCircles&&(mi=Be.featureIndex),He.verticalTextFeatureIndex&&(Jr=He.verticalTextFeatureIndex);const ra=this.retainedQueryData[p.bucketInstanceId].tileID,Vr=this.terrain?(Pn,Et)=>this.terrain.getElevation(ra,Pn,Et):null;for(const Pn of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const Et=He[Pn];Et&&(Et.elevation=Vr?Vr(Et.anchorPointX,Et.anchorPointY):0)}const fr=He.textBox;if(fr){const Pn=Ot=>{let On=u.WritingMode.horizontal;if(p.allowVerticalPlacement&&!Ot&&this.prevPlacement){const Nn=this.prevPlacement.placedOrientations[Be.crossTileID];Nn&&(this.placedOrientations[Be.crossTileID]=Nn,On=Nn,this.markUsedOrientation(p,On,Be))}return On},Et=(Ot,On)=>{if(p.allowVerticalPlacement&&Be.numVerticalGlyphVertices>0&&He.verticalTextBox){for(const Nn of p.writingModes)if(Nn===u.WritingMode.vertical?(Ut=On(),Ct=Ut):Ut=Ot(),Ut&&Ut.box&&Ut.box.length)break}else Ut=Ot()};if(g.get("text-variable-anchor")){let Ot=g.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Be.crossTileID]){const on=this.prevPlacement.variableOffsets[Be.crossTileID];Ot.indexOf(on.anchor)>0&&(Ot=Ot.filter($r=>$r!==on.anchor),Ot.unshift(on.anchor))}const On=(on,$r,wa)=>{const zu=on.x2-on.x1,uo=on.y2-on.y1,Lh=Be.textBoxScale,Mu=we&&ce==="never"?$r:null;let ia={box:[],offscreen:!1};const ba=re!=="never"?2*Ot.length:Ot.length;for(let Sa=0;Sa<ba;++Sa){const ll=this.attemptAnchorPlacement(Ot[Sa%Ot.length],on,zu,uo,Lh,fe,he,I,x,Z,Sa>=Ot.length?re:"never",Be,p,wa,Mu,Vr);if(ll&&(ia=ll.placedGlyphBoxes,ia&&ia.box&&ia.box.length)){yt=!0,Nt=ll.shift;break}}return ia};Et(()=>On(fr,He.iconBox,u.WritingMode.horizontal),()=>{const on=He.verticalTextBox;return p.allowVerticalPlacement&&!(Ut&&Ut.box&&Ut.box.length)&&Be.numVerticalGlyphVertices>0&&on?On(on,He.verticalIconBox,u.WritingMode.vertical):{box:null,offscreen:null}}),Ut&&(yt=Ut.box,at=Ut.offscreen);const Nn=Pn(Ut&&Ut.box);if(!yt&&this.prevPlacement){const on=this.prevPlacement.variableOffsets[Be.crossTileID];on&&(this.variableOffsets[Be.crossTileID]=on,this.markUsedJustification(p,on.anchor,Be,Nn))}}else{const Ot=(On,Nn)=>{const on=this.collisionIndex.placeCollisionBox(On,re,I,x,Z.predicate,Vr);return on&&on.box&&on.box.length&&(this.markUsedOrientation(p,Nn,Be),this.placedOrientations[Be.crossTileID]=Nn),on};Et(()=>Ot(fr,u.WritingMode.horizontal),()=>{const On=He.verticalTextBox;return p.allowVerticalPlacement&&Be.numVerticalGlyphVertices>0&&On?Ot(On,u.WritingMode.vertical):{box:null,offscreen:null}}),Pn(Ut&&Ut.box&&Ut.box.length)}}if(Dt=Ut,yt=Dt&&Dt.box&&Dt.box.length>0,at=Dt&&Dt.offscreen,Be.useRuntimeCollisionCircles){const Pn=p.text.placedSymbolArray.get(Be.centerJustifiedTextSymbolIndex),Et=u.evaluateSizeForFeature(p.textSizeData,B,Pn),Ot=g.get("text-padding");jt=this.collisionIndex.placeCollisionCircles(re,Pn,p.lineVertexArray,p.glyphOffsetArray,Et,x,S,E,c,he,Z.predicate,Be.collisionCircleDiameter,Ot,Vr),jt.circles.length&&jt.collisionDetected&&!c&&u.warnOnce("Collisions detected, but collision boxes are not shown"),yt=se||jt.circles.length>0&&!jt.collisionDetected,at=at&&jt.offscreen}if(He.iconFeatureIndex&&(gi=He.iconFeatureIndex),He.iconBox){const Pn=Et=>{const Ot=we&&Nt?ma(Et,Nt.x,Nt.y,fe,he,this.transform.angle):Et;return this.collisionIndex.placeCollisionBox(Ot,ce,I,x,Z.predicate,Vr)};Ct&&Ct.box&&Ct.box.length&&He.verticalIconBox?(Fn=Pn(He.verticalIconBox),bt=Fn.box.length>0):(Fn=Pn(He.iconBox),bt=Fn.box.length>0),at=at&&Fn.offscreen}const Mi=j||Be.numHorizontalGlyphVertices===0&&Be.numVerticalGlyphVertices===0,sl=G||Be.numIconVertices===0;if(Mi||sl?sl?Mi||(bt=bt&&yt):yt=bt&&yt:bt=yt=bt&&yt,yt&&Dt&&Dt.box&&this.collisionIndex.insertCollisionBox(Dt.box,re,g.get("text-ignore-placement"),p.bucketInstanceId,Ct&&Ct.box&&Jr?Jr:mi,Z.ID),bt&&Fn&&this.collisionIndex.insertCollisionBox(Fn.box,ce,g.get("icon-ignore-placement"),p.bucketInstanceId,gi,Z.ID),jt&&(yt&&this.collisionIndex.insertCollisionCircles(jt.circles,re,g.get("text-ignore-placement"),p.bucketInstanceId,mi,Z.ID),c)){const Pn=p.bucketInstanceId;let Et=this.collisionCircleArrays[Pn];Et===void 0&&(Et=this.collisionCircleArrays[Pn]=new di);for(let Ot=0;Ot<jt.circles.length;Ot+=4)Et.circles.push(jt.circles[Ot+0]),Et.circles.push(jt.circles[Ot+1]),Et.circles.push(jt.circles[Ot+2]),Et.circles.push(jt.collisionDetected?1:0)}if(Be.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(p.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Be.crossTileID]=new Xa(yt||Ae,bt||ve,at||p.justReloaded),o[Be.crossTileID]=!0};if(Se){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Be=p.getSortedSymbolIndexes(this.transform.angle);for(let He=Be.length-1;He>=0;--He){const yt=Be[He];We(p.symbolInstances.get(yt),p.collisionArrays[yt])}}else for(let Be=n.symbolInstanceStart;Be<n.symbolInstanceEnd;Be++)We(p.symbolInstances.get(Be),p.collisionArrays[Be]);if(c&&p.bucketInstanceId in this.collisionCircleArrays){const Be=this.collisionCircleArrays[p.bucketInstanceId];u.invert(Be.invProjMatrix,x),Be.viewportMatrix=this.collisionIndex.getViewportMatrix()}p.justReloaded=!1}markUsedJustification(n,o,c,p){let g;g=p===u.WritingMode.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[u.getAnchorJustification(o)];const x=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const S of x)S>=0&&(n.text.placedSymbolArray.get(S).crossTileID=g>=0&&S!==g?0:c.crossTileID)}markUsedOrientation(n,o,c){const p=o===u.WritingMode.horizontal||o===u.WritingMode.horizontalOnly?o:0,g=o===u.WritingMode.vertical?o:0,x=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const S of x)n.text.placedSymbolArray.get(S).placedOrientation=p;c.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let c=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const p=o?o.symbolFadeChange(n):1,g=o?o.opacities:{},x=o?o.variableOffsets:{},S=o?o.placedOrientations:{};for(const E in this.placements){const I=this.placements[E],P=g[E];P?(this.opacities[E]=new $t(P,p,I.text,I.icon),c=c||I.text!==P.text.placed||I.icon!==P.icon.placed):(this.opacities[E]=new $t(null,p,I.text,I.icon,I.skipFade),c=c||I.text||I.icon)}for(const E in g){const I=g[E];if(!this.opacities[E]){const P=new $t(I,p,!1,!1);P.isHidden()||(this.opacities[E]=P,c=c||I.text.placed||I.icon.placed)}}for(const E in x)this.variableOffsets[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.variableOffsets[E]=x[E]);for(const E in S)this.placedOrientations[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.placedOrientations[E]=S[E]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:n)}updateLayerOpacities(n,o){const c={};for(const p of o){const g=p.getBucket(n);g&&p.latestFeatureIndex&&n.id===g.layerIds[0]&&this.updateBucketOpacities(g,c,p.collisionBoxArray)}}updateBucketOpacities(n,o,c){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const p=n.layers[0].layout,g=new $t(null,0,!1,!1,!0),x=p.get("text-allow-overlap"),S=p.get("icon-allow-overlap"),E=p.get("text-variable-anchor"),I=p.get("text-rotation-alignment")==="map",P=p.get("text-pitch-alignment")==="map",D=p.get("icon-text-fit")!=="none",B=new $t(null,0,x&&(S||!n.hasIconData()||p.get("icon-optional")),S&&(x||!n.hasTextData()||p.get("text-optional")),!0);!n.collisionArrays&&c&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(c);const Z=(j,G,re)=>{for(let se=0;se<G/4;se++)j.opacityVertexArray.emplaceBack(re)};for(let j=0;j<n.symbolInstances.length;j++){const G=n.symbolInstances.get(j),{numHorizontalGlyphVertices:re,numVerticalGlyphVertices:se,crossTileID:ce}=G;let W=this.opacities[ce];o[ce]?W=g:W||(W=B,this.opacities[ce]=W),o[ce]=!0;const fe=G.numIconVertices>0,he=this.placedOrientations[G.crossTileID],we=he===u.WritingMode.vertical,Se=he===u.WritingMode.horizontal||he===u.WritingMode.horizontalOnly;if(re>0||se>0){const Ae=oe(W.text);Z(n.text,re,we?_e:Ae),Z(n.text,se,Se?_e:Ae);const ve=W.text.isHidden();[G.rightJustifiedTextSymbolIndex,G.centerJustifiedTextSymbolIndex,G.leftJustifiedTextSymbolIndex].forEach(He=>{He>=0&&(n.text.placedSymbolArray.get(He).hidden=ve||we?1:0)}),G.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(G.verticalPlacedTextSymbolIndex).hidden=ve||Se?1:0);const We=this.variableOffsets[G.crossTileID];We&&this.markUsedJustification(n,We.anchor,G,he);const Be=this.placedOrientations[G.crossTileID];Be&&(this.markUsedJustification(n,"left",G,Be),this.markUsedOrientation(n,Be,G))}if(fe){const Ae=oe(W.icon),ve=!(D&&G.verticalPlacedIconSymbolIndex&&we);G.placedIconSymbolIndex>=0&&(Z(n.icon,G.numIconVertices,ve?Ae:_e),n.icon.placedSymbolArray.get(G.placedIconSymbolIndex).hidden=W.icon.isHidden()),G.verticalPlacedIconSymbolIndex>=0&&(Z(n.icon,G.numVerticalIconVertices,ve?_e:Ae),n.icon.placedSymbolArray.get(G.verticalPlacedIconSymbolIndex).hidden=W.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const Ae=n.collisionArrays[j];if(Ae){let ve=new u.pointGeometry(0,0);if(Ae.textBox||Ae.verticalTextBox){let Be=!0;if(E){const He=this.variableOffsets[ce];He?(ve=Ya(He.anchor,He.width,He.height,He.textOffset,He.textBoxScale),I&&ve._rotate(P?this.transform.angle:-this.transform.angle)):Be=!1}Ae.textBox&&C(n.textCollisionBox.collisionVertexArray,W.text.placed,!Be||we,ve.x,ve.y),Ae.verticalTextBox&&C(n.textCollisionBox.collisionVertexArray,W.text.placed,!Be||Se,ve.x,ve.y)}const We=Boolean(!Se&&Ae.verticalIconBox);Ae.iconBox&&C(n.iconCollisionBox.collisionVertexArray,W.icon.placed,We,D?ve.x:0,D?ve.y:0),Ae.verticalIconBox&&C(n.iconCollisionBox.collisionVertexArray,W.icon.placed,!We,D?ve.x:0,D?ve.y:0)}}}if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);if(n.bucketInstanceId in this.collisionCircleArrays){const j=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=j.invProjMatrix,n.placementViewportMatrix=j.viewportMatrix,n.collisionCircleArray=j.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,o){const c=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*c>n}setStale(){this.stale=!0}}function C(h,n,o,c,p){h.emplaceBack(n?1:0,o?1:0,c||0,p||0),h.emplaceBack(n?1:0,o?1:0,c||0,p||0),h.emplaceBack(n?1:0,o?1:0,c||0,p||0),h.emplaceBack(n?1:0,o?1:0,c||0,p||0)}const M=Math.pow(2,25),N=Math.pow(2,24),U=Math.pow(2,17),K=Math.pow(2,16),ae=Math.pow(2,9),te=Math.pow(2,8),J=Math.pow(2,1);function oe(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;const n=h.placed?1:0,o=Math.floor(127*h.opacity);return o*M+n*N+o*U+n*K+o*ae+n*te+o*J+n}const _e=0;class Ce{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,o,c,p,g){const x=this._bucketParts;for(;this._currentTileIndex<n.length;)if(o.getBucketParts(x,p,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((S,E)=>S.sortKey-E.sortKey));this._currentPartIndex<x.length;)if(o.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,g())return!0;return!1}}class ge{constructor(n,o,c,p,g,x,S,E){this.placement=new $(n,o,x,S,E),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(n,o,c){const p=u.exported.now(),g=()=>{const x=u.exported.now()-p;return!this._forceFullPlacement&&x>2};for(;this._currentPlacementIndex>=0;){const x=o[n[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=S)&&(!x.maxzoom||x.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new Ce(x)),this._inProgressLayer.continuePlacement(c[x.source],this.placement,this._showCollisionBoxes,x,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Je=512/u.EXTENT/2;class et{constructor(n,o,c){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=c;for(let p=0;p<o.length;p++){const g=o.get(p),x=g.key;this.indexedSymbolInstances[x]||(this.indexedSymbolInstances[x]=[]),this.indexedSymbolInstances[x].push({crossTileID:g.crossTileID,coord:this.getScaledCoordinates(g,n)})}}getScaledCoordinates(n,o){const c=Je/Math.pow(2,o.canonical.z-this.tileID.canonical.z);return{x:Math.floor((o.canonical.x*u.EXTENT+n.anchorX)*c),y:Math.floor((o.canonical.y*u.EXTENT+n.anchorY)*c)}}findMatches(n,o,c){const p=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let g=0;g<n.length;g++){const x=n.get(g);if(x.crossTileID)continue;const S=this.indexedSymbolInstances[x.key];if(!S)continue;const E=this.getScaledCoordinates(x,o);for(const I of S)if(Math.abs(I.coord.x-E.x)<=p&&Math.abs(I.coord.y-E.y)<=p&&!c[I.crossTileID]){c[I.crossTileID]=!0,x.crossTileID=I.crossTileID;break}}}}class Ze{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ut{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const o=Math.round((n-this.lng)/360);if(o!==0)for(const c in this.indexes){const p=this.indexes[c],g={};for(const x in p){const S=p[x];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+o),g[S.tileID.key]=S}this.indexes[c]=g}this.lng=n}addBucket(n,o,c){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let g=0;g<o.symbolInstances.length;g++)o.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const p=this.usedCrossTileIDs[n.overscaledZ];for(const g in this.indexes){const x=this.indexes[g];if(Number(g)>n.overscaledZ)for(const S in x){const E=x[S];E.tileID.isChildOf(n)&&E.findMatches(o.symbolInstances,n,p)}else{const S=x[n.scaledTo(Number(g)).key];S&&S.findMatches(o.symbolInstances,n,p)}}for(let g=0;g<o.symbolInstances.length;g++){const x=o.symbolInstances.get(g);x.crossTileID||(x.crossTileID=c.generate(),p[x.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new et(n,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(n,o){for(const c in o.indexedSymbolInstances)for(const p of o.indexedSymbolInstances[c])delete this.usedCrossTileIDs[n][p.crossTileID]}removeStaleBuckets(n){let o=!1;for(const c in this.indexes){const p=this.indexes[c];for(const g in p)n[p[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,p[g]),delete p[g],o=!0)}return o}}class dt{constructor(){this.layerIndexes={},this.crossTileIDs=new Ze,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,o,c){let p=this.layerIndexes[n.id];p===void 0&&(p=this.layerIndexes[n.id]=new ut);let g=!1;const x={};p.handleWrapJump(c);for(const S of o){const E=S.getBucket(n);E&&n.id===E.layerIds[0]&&(E.bucketInstanceId||(E.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(S.tileID,E,this.crossTileIDs)&&(g=!0),x[E.bucketInstanceId]=!0)}return p.removeStaleBuckets(x)&&(g=!0),g}pruneUnusedLayers(n){const o={};n.forEach(c=>{o[c]=!0});for(const c in this.layerIndexes)o[c]||delete this.layerIndexes[c]}}var zt=u.createLayout([{name:"a_pos",type:"Int16",components:2}]);class ft extends u.Evented{constructor(n){super(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=n._cache.max,n.usedForTerrain=!0,n.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const n in this._tiles){const o=this._tiles[n];o.textures.forEach(c=>c.destroy()),o.textures=[]}}update(n,o){this.sourceCache.update(n,o),this._renderableTilesKeys=[];for(const c of n.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o}))this._renderableTilesKeys.push(c.key),this._tiles[c.key]||(c.posMatrix=new Float64Array(16),u.ortho(c.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),this._tiles[c.key]=new Xn(c,this.tileSize))}removeOutdated(n){const o={};this.renderHistory=this.renderHistory.filter((c,p)=>this.renderHistory.indexOf(c)===p).slice(0,this.renderHistorySize);for(const c of this._renderableTilesKeys)o[c]=!0;for(const c of this.renderHistory)o[c]=!0;for(const c in this._tiles)o[c]||(this._tiles[c].clearTextures(n),delete this._tiles[c])}getRenderableTiles(){return this._renderableTilesKeys.map(n=>this.getTileByID(n))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n){const o={};for(const c of this._renderableTilesKeys){const p=this._tiles[c].tileID;if(p.canonical.equals(n.canonical)){const g=n.clone();g.posMatrix=new Float64Array(16),u.ortho(g.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),o[c]=g}else if(p.canonical.isChildOf(n.canonical)){const g=n.clone();g.posMatrix=new Float64Array(16);const x=p.canonical.z-n.canonical.z,S=p.canonical.x-(p.canonical.x>>x<<x),E=p.canonical.y-(p.canonical.y>>x<<x),I=u.EXTENT>>x;u.ortho(g.posMatrix,0,I,0,I,0,1),u.translate(g.posMatrix,g.posMatrix,[-S*I,-E*I,0]),o[c]=g}else if(n.canonical.isChildOf(p.canonical)){const g=n.clone();g.posMatrix=new Float64Array(16);const x=n.canonical.z-p.canonical.z,S=n.canonical.x-(n.canonical.x>>x<<x),E=n.canonical.y-(n.canonical.y>>x<<x),I=u.EXTENT>>x;u.ortho(g.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),u.translate(g.posMatrix,g.posMatrix,[S*I,E*I,0]),u.scale(g.posMatrix,g.posMatrix,[1/2**x,1/2**x,0]),o[c]=g}}return o}getSourceTile(n,o){const c=this.sourceCache._source;let p=n.overscaledZ-this.deltaZoom;if(p>c.maxzoom&&(p=c.maxzoom),p<c.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(p).key);let g=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!g||!g.dem)&&o)for(;p>=c.minzoom&&(!g||!g.dem);)g=this.sourceCache.getTileByID(n.scaledTo(p--).key);return g}tilesAfterTime(n=Date.now()){return Object.values(this._tiles).filter(o=>o.timeLoaded>=n)}}class wt{constructor(n,o,c){this.style=n,this.sourceCache=new ft(o),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.elevationOffset=typeof c.elevationOffset=="number"?c.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(n,o,c,p=u.EXTENT){if(!(o>=0&&o<p&&c>=0&&c<p))return this.elevationOffset;let g=0;const x=this.getTerrainData(n);if(x.tile&&x.tile.dem){const S=u.transformMat4$1([],[o/p*u.EXTENT,c/p*u.EXTENT],x.u_terrain_matrix),E=[S[0]*x.tile.dem.dim,S[1]*x.tile.dem.dim],I=[Math.floor(E[0]),Math.floor(E[1])],P=x.tile.dem.get(I[0],I[1]),D=x.tile.dem.get(I[0],I[1]+1),B=x.tile.dem.get(I[0]+1,I[1]),Z=x.tile.dem.get(I[0]+1,I[1]+1);g=u.number(u.number(P,D,E[0]-I[0]),u.number(B,Z,E[0]-I[0]),E[1]-I[1])}return g}rememberForRerender(n,o){for(const c in this.sourceCache._tiles){const p=this.sourceCache._tiles[c];(p.tileID.equals(o)||p.tileID.isChildOf(o))&&(n===this.sourceCache.sourceCache.id&&(p.timeLoaded=Date.now()),this._rerender[n]=this._rerender[n]||{},this._rerender[n][p.tileID.key]=!0)}}needsRerender(n,o){return this._rerender[n]&&this._rerender[n][o.key]}clearRerenderCache(){this._rerender={}}getElevation(n,o,c,p=u.EXTENT){return(this.getDEMElevation(n,o,c,p)+this.elevationOffset)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const p=this.style.map.painter.context,g=new u.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ye(p,g,p.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ye(p,new u.RGBAImage({width:1,height:1}),p.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.identity([])}const o=this.sourceCache.getSourceTile(n,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const p=this.style.map.painter.context;o.demTexture=this.style.map.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new ye(p,o.dem.getPixels(),p.gl.RGBA,{premultiply:!1}),o.demTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const c=o&&o+o.tileID.key+n.key;if(c&&!this._demMatrixCache[c]){const p=this.sourceCache.sourceCache._source.maxzoom;let g=n.canonical.z-o.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=p?g=n.canonical.z-p:u.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=n.canonical.x-(n.canonical.x>>g<<g),S=n.canonical.y-(n.canonical.y>>g<<g),E=u.fromScaling(new Float64Array(16),[1/(u.EXTENT<<g),1/(u.EXTENT<<g),0]);u.translate(E,E,[x*u.EXTENT,S*u.EXTENT,0]),this._demMatrixCache[n.key]={matrix:E,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getRTTFramebuffer(){const n=this.style.map.painter;if(!this._rttFramebuffer){const o=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=n.context.createFramebuffer(o,o,!0),this._rttFramebuffer.depthAttachment.set(n.context.createRenderbuffer(n.context.gl.DEPTH_COMPONENT16,o,o))}return this._rttFramebuffer}getFramebuffer(n){const o=this.style.map.painter,c=o.width/devicePixelRatio,p=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===p||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ye(o.context,{width:c,height:p,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ye(o.context,{width:c,height:p,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(c,p,!0),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,c,p))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,x=0;g<this._coordsTextureSize;g++)for(let S=0;S<this._coordsTextureSize;S++,x+=4)o[x+0]=255&S,o[x+1]=255&g,o[x+2]=S>>8<<4|g>>8,o[x+3]=0;const c=new u.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),p=new ye(n,c,n.gl.RGBA,{premultiply:!1});return p.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=p,p}pointCoordinate(n){const o=new Uint8Array(4),c=this.style.map.painter,p=c.context,g=p.gl;p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(n.x,c.height/devicePixelRatio-n.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,o),p.bindFramebuffer.set(null);const x=o[0]+(o[2]>>4<<8),S=o[1]+((15&o[2])<<8),E=this.coordsIndex[255-o[3]],I=E&&this.sourceCache.getTileByID(E);if(!I)return null;const P=this._coordsTextureSize,D=(1<<I.tileID.canonical.z)*P;return new u.MercatorCoordinate((I.tileID.canonical.x*P+x)/D,(I.tileID.canonical.y*P+S)/D,this.getElevation(I.tileID,x,S,P))}getTerrainMesh(){if(this._mesh)return this._mesh;const n=this.style.map.painter.context,o=new u.PosArray,c=new u.TriangleIndexArray,p=this.meshSize,g=u.EXTENT/p,x=p*p;for(let S=0;S<=p;S++)for(let E=0;E<=p;E++)o.emplaceBack(E*g,S*g);for(let S=0;S<x;S+=p+1)for(let E=0;E<p;E++)c.emplaceBack(E+S,p+E+S+1,p+E+S+2),c.emplaceBack(E+S,p+E+S+2,E+S+1);return this._mesh={indexBuffer:n.createIndexBuffer(c),vertexBuffer:n.createVertexBuffer(o,zt.members),segments:u.SegmentVector.simpleSegment(0,0,o.length,c.length)},this._mesh}getMinMaxElevation(n){const o=this.getTerrainData(n).tile,c={minElevation:null,maxElevation:null};return o&&o.dem&&(c.minElevation=(o.dem.min+this.elevationOffset)*this.exaggeration,c.maxElevation=(o.dem.max+this.elevationOffset)*this.exaggeration),c}}const Mt=(h,n)=>u.emitValidationErrors(h,n&&n.filter(o=>o.identifier!=="source.canvas")),qt=u.pick(At,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Bn=u.pick(At,["setCenter","setZoom","setBearing","setPitch"]),tn=function(){const h={},n=u.spec.$version;for(const o in u.spec.$root){const c=u.spec.$root[o];if(c.required){let p=null;p=o==="version"?n:c.type==="array"?[]:{},p!=null&&(h[o]=p)}}return h}();class Yn extends u.Evented{constructor(n,o={}){super(),this.map=n,this.dispatcher=new ht(qa(),this),this.imageManager=new ee,this.imageManager.setEventedParent(this),this.glyphManager=new Ee(n._requestManager,o.localIdeographFontFamily),this.lineAtlas=new vt(256,512),this.crossTileSymbolIndex=new dt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",u.getReferrer());const c=this;this._rtlTextPluginCallback=Yn.registerForPluginStateChange(p=>{c.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:p.pluginStatus,pluginURL:p.pluginURL},(g,x)=>{if(u.triggerPluginCompletionEvent(g),x&&x.every(S=>S))for(const S in c.sourceCaches)c.sourceCaches[S].reload()})}),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const g=this.sourceCaches[p.sourceId];if(!g)return;const x=g.getSource();if(x&&x.vectorLayerIds)for(const S in this._layers){const E=this._layers[S];E.source===x.id&&this._validateLayer(E)}})}loadURL(n,o={}){this.fire(new u.Event("dataloading",{dataType:"style"}));const c=typeof o.validate!="boolean"||o.validate,p=this.map._requestManager.transformRequest(n,u.ResourceType.Style);this._request=u.getJSON(p,(g,x)=>{this._request=null,g?this.fire(new u.ErrorEvent(g)):x&&this._load(x,c)})}loadJSON(n,o={}){this.fire(new u.Event("dataloading",{dataType:"style"})),this._request=u.exported.frame(()=>{this._request=null,this._load(n,o.validate!==!1)})}loadEmpty(){this.fire(new u.Event("dataloading",{dataType:"style"})),this._load(tn,!1)}_load(n,o){if(o&&Mt(this,u.validateStyle(n)))return;this._loaded=!0,this.stylesheet=n;for(const p in n.sources)this.addSource(p,n.sources[p],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);const c=Go(this.stylesheet.layers);this._order=c.map(p=>p.id),this._layers={},this._serializedLayers={};for(let p of c)p=u.createStyleLayer(p),p.setEventedParent(this,{layer:{id:p.id}}),this._layers[p.id]=p,this._serializedLayers[p.id]=p.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Le(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new u.Event("data",{dataType:"style"})),this.fire(new u.Event("style.load"))}_loadSprite(n){this._spriteRequest=function(o,c,p,g){let x,S,E;const I=p>1?"@2x":"";let P=u.getJSON(c.transformRequest(c.normalizeSpriteURL(o,I,".json"),u.ResourceType.SpriteJSON),(Z,j)=>{P=null,E||(E=Z,x=j,B())}),D=u.getImage(c.transformRequest(c.normalizeSpriteURL(o,I,".png"),u.ResourceType.SpriteImage),(Z,j)=>{D=null,E||(E=Z,S=j,B())});function B(){if(E)g(E);else if(x&&S){const Z=u.exported.getImageData(S),j={};for(const G in x){const{width:re,height:se,x:ce,y:W,sdf:fe,pixelRatio:he,stretchX:we,stretchY:Se,content:Ae}=x[G],ve=new u.RGBAImage({width:re,height:se});u.RGBAImage.copy(Z,ve,{x:ce,y:W},{x:0,y:0},{width:re,height:se}),j[G]={data:ve,pixelRatio:he,sdf:fe,stretchX:we,stretchY:Se,content:Ae}}g(null,j)}}return{cancel(){P&&(P.cancel(),P=null),D&&(D.cancel(),D=null)}}}(n,this.map._requestManager,this.map.getPixelRatio(),(o,c)=>{if(this._spriteRequest=null,o)this.fire(new u.ErrorEvent(o));else if(c)for(const p in c)this.imageManager.addImage(p,c[p]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))})}_validateLayer(n){const o=this.sourceCaches[n.source];if(!o)return;const c=n.sourceLayer;if(!c)return;const p=o.getSource();(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(c)===-1)&&this.fire(new u.ErrorEvent(new Error(`Source layer "${c}" does not exist on source "${p.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(n){const o=[];for(const c of n){const p=this._layers[c];p.type!=="custom"&&o.push(p.serialize())}return o}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const o=this._changed;if(this._changed){const p=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(p.length||g.length)&&this._updateWorkerLayers(p,g);for(const x in this._updatedSources){const S=this._updatedSources[x];if(S==="reload")this._reloadSource(x);else{if(S!=="clear")throw new Error(`Invalid action ${S}`);this._clearSource(x)}}this._updateTilesForChangedImages();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}const c={};for(const p in this.sourceCaches){const g=this.sourceCaches[p];c[p]=g.used,g.used=!1}for(const p of this._order){const g=this._layers[p];g.recalculate(n,this._availableImages),!g.isHidden(n.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}for(const p in c){const g=this.sourceCaches[p];c[p]!==g.used&&g.fire(new u.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:p}))}this.light.recalculate(n),this.z=n.zoom,o&&this.fire(new u.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateWorkerLayers(n,o){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(n){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),n){const o=this.sourceCaches[n.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${n.source}`);this.terrain=new wt(this,o,n),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=c=>{c.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=c=>{c.tile&&(c.sourceId===n.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(c.sourceId,c.tile.tileID)):c.source.type==="geojson"&&this.terrain.rememberForRerender(c.sourceId,c.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new u.Event("terrain",{terrain:n}))}setState(n){if(this._checkLoaded(),Mt(this,u.validateStyle(n)))return!1;(n=u.clone$1(n)).layers=Go(n.layers);const o=function(p,g){if(!p)return[{command:At.setStyle,args:[g]}];let x=[];try{if(!Q(p.version,g.version))return[{command:At.setStyle,args:[g]}];Q(p.center,g.center)||x.push({command:At.setCenter,args:[g.center]}),Q(p.zoom,g.zoom)||x.push({command:At.setZoom,args:[g.zoom]}),Q(p.bearing,g.bearing)||x.push({command:At.setBearing,args:[g.bearing]}),Q(p.pitch,g.pitch)||x.push({command:At.setPitch,args:[g.pitch]}),Q(p.sprite,g.sprite)||x.push({command:At.setSprite,args:[g.sprite]}),Q(p.glyphs,g.glyphs)||x.push({command:At.setGlyphs,args:[g.glyphs]}),Q(p.transition,g.transition)||x.push({command:At.setTransition,args:[g.transition]}),Q(p.light,g.light)||x.push({command:At.setLight,args:[g.light]});const S={},E=[];(function(P,D,B,Z){let j;for(j in D=D||{},P=P||{})Object.prototype.hasOwnProperty.call(P,j)&&(Object.prototype.hasOwnProperty.call(D,j)||Wi(j,B,Z));for(j in D)Object.prototype.hasOwnProperty.call(D,j)&&(Object.prototype.hasOwnProperty.call(P,j)?Q(P[j],D[j])||(P[j].type==="geojson"&&D[j].type==="geojson"&&qo(P,D,j)?B.push({command:At.setGeoJSONSourceData,args:[j,D[j].data]}):Hi(j,D,B,Z)):hi(j,D,B))})(p.sources,g.sources,E,S);const I=[];p.layers&&p.layers.forEach(P=>{S[P.source]?x.push({command:At.removeLayer,args:[P.id]}):I.push(P)}),x=x.concat(E),function(P,D,B){D=D||[];const Z=(P=P||[]).map(Ii),j=D.map(Ii),G=P.reduce(Wa,{}),re=D.reduce(Wa,{}),se=Z.slice(),ce=Object.create(null);let W,fe,he,we,Se,Ae,ve;for(W=0,fe=0;W<Z.length;W++)he=Z[W],Object.prototype.hasOwnProperty.call(re,he)?fe++:(B.push({command:At.removeLayer,args:[he]}),se.splice(se.indexOf(he,fe),1));for(W=0,fe=0;W<j.length;W++)he=j[j.length-1-W],se[se.length-1-W]!==he&&(Object.prototype.hasOwnProperty.call(G,he)?(B.push({command:At.removeLayer,args:[he]}),se.splice(se.lastIndexOf(he,se.length-fe),1)):fe++,Ae=se[se.length-W],B.push({command:At.addLayer,args:[re[he],Ae]}),se.splice(se.length-W,0,he),ce[he]=!0);for(W=0;W<j.length;W++)if(he=j[W],we=G[he],Se=re[he],!ce[he]&&!Q(we,Se))if(Q(we.source,Se.source)&&Q(we["source-layer"],Se["source-layer"])&&Q(we.type,Se.type)){for(ve in ki(we.layout,Se.layout,B,he,null,At.setLayoutProperty),ki(we.paint,Se.paint,B,he,null,At.setPaintProperty),Q(we.filter,Se.filter)||B.push({command:At.setFilter,args:[he,Se.filter]}),Q(we.minzoom,Se.minzoom)&&Q(we.maxzoom,Se.maxzoom)||B.push({command:At.setLayerZoomRange,args:[he,Se.minzoom,Se.maxzoom]}),we)Object.prototype.hasOwnProperty.call(we,ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?ki(we[ve],Se[ve],B,he,ve.slice(6),At.setPaintProperty):Q(we[ve],Se[ve])||B.push({command:At.setLayerProperty,args:[he,ve,Se[ve]]}));for(ve in Se)Object.prototype.hasOwnProperty.call(Se,ve)&&!Object.prototype.hasOwnProperty.call(we,ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?ki(we[ve],Se[ve],B,he,ve.slice(6),At.setPaintProperty):Q(we[ve],Se[ve])||B.push({command:At.setLayerProperty,args:[he,ve,Se[ve]]}))}else B.push({command:At.removeLayer,args:[he]}),Ae=se[se.lastIndexOf(he)+1],B.push({command:At.addLayer,args:[Se,Ae]})}(I,g.layers,x)}catch(S){console.warn("Unable to compute style diff:",S),x=[{command:At.setStyle,args:[g]}]}return x}(this.serialize(),n).filter(p=>!(p.command in Bn));if(o.length===0)return!1;const c=o.filter(p=>!(p.command in qt));if(c.length>0)throw new Error(`Unimplemented: ${c.map(p=>p.command).join(", ")}.`);return o.forEach(p=>{p.command!=="setTransition"&&this[p.command].apply(this,p.args)}),this.stylesheet=n,!0}addImage(n,o){if(this.getImage(n))return this.fire(new u.ErrorEvent(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,o),this._afterImageUpdated(n)}updateImage(n,o){this.imageManager.updateImage(n,o)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new u.ErrorEvent(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,o,c={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(u.validateStyle.source,`sources.${n}`,o,null,c))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const p=this.sourceCaches[n]=new dr(n,o,this.dispatcher);p.style=this,p.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:p.serialize(),sourceId:n})),p.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===n)return this.fire(new u.ErrorEvent(new Error(`Source "${n}" cannot be removed while layer "${c}" is using it.`)));const o=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],o.fire(new u.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,o){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const c=this.sourceCaches[n].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(o),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,o,c={}){this._checkLoaded();const p=n.id;if(this.getLayer(p))return void this.fire(new u.ErrorEvent(new Error(`Layer "${p}" already exists on this map.`)));let g;if(n.type==="custom"){if(Mt(this,u.validateCustomStyleLayer(n)))return;g=u.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(p,n.source),n=u.clone$1(n),n=u.extend(n,{source:p})),this._validate(u.validateStyle.layer,`layers.${p}`,n,{arrayIndex:-1},c))return;g=u.createStyleLayer(n),this._validateLayer(g),g.setEventedParent(this,{layer:{id:p}}),this._serializedLayers[g.id]=g.serialize()}const x=o?this._order.indexOf(o):this._order.length;if(o&&x===-1)this.fire(new u.ErrorEvent(new Error(`Cannot add layer "${p}" before non-existing layer "${o}".`)));else{if(this._order.splice(x,0,p),this._layerOrderChanged=!0,this._layers[p]=g,this._removedLayers[p]&&g.source&&g.type!=="custom"){const S=this._removedLayers[p];delete this._removedLayers[p],S.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(n,o){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new u.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===o)return;const c=this._order.indexOf(n);this._order.splice(c,1);const p=o?this._order.indexOf(o):this._order.length;o&&p===-1?this.fire(new u.ErrorEvent(new Error(`Cannot move layer "${n}" before non-existing layer "${o}".`))):(this._order.splice(p,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const o=this._layers[n];if(!o)return void this.fire(new u.ErrorEvent(new Error(`Cannot remove non-existing layer "${n}".`)));o.setEventedParent(null);const c=this._order.indexOf(n);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=o,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],o.onRemove&&o.onRemove(this.map)}getLayer(n){return this._layers[n]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,o,c){this._checkLoaded();const p=this.getLayer(n);p?p.minzoom===o&&p.maxzoom===c||(o!=null&&(p.minzoom=o),c!=null&&(p.maxzoom=c),this._updateLayer(p)):this.fire(new u.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,o,c={}){this._checkLoaded();const p=this.getLayer(n);if(p){if(!Q(p.filter,o))return o==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(u.validateStyle.filter,`layers.${p.id}.filter`,o,null,c)||(p.filter=u.clone$1(o),this._updateLayer(p)))}else this.fire(new u.ErrorEvent(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return u.clone$1(this.getLayer(n).filter)}setLayoutProperty(n,o,c,p={}){this._checkLoaded();const g=this.getLayer(n);g?Q(g.getLayoutProperty(o),c)||(g.setLayoutProperty(o,c,p),this._updateLayer(g)):this.fire(new u.ErrorEvent(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,o){const c=this.getLayer(n);if(c)return c.getLayoutProperty(o);this.fire(new u.ErrorEvent(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,o,c,p={}){this._checkLoaded();const g=this.getLayer(n);g?Q(g.getPaintProperty(o),c)||(g.setPaintProperty(o,c,p)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new u.ErrorEvent(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,o){return this.getLayer(n).getPaintProperty(o)}setFeatureState(n,o){this._checkLoaded();const c=n.source,p=n.sourceLayer,g=this.sourceCaches[c];if(g===void 0)return void this.fire(new u.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)));const x=g.getSource().type;x==="geojson"&&p?this.fire(new u.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||p?(n.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),g.setFeatureState(p,n.id,o)):this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,o){this._checkLoaded();const c=n.source,p=this.sourceCaches[c];if(p===void 0)return void this.fire(new u.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)));const g=p.getSource().type,x=g==="vector"?n.sourceLayer:void 0;g!=="vector"||x?o&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new u.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):p.removeFeatureState(x,n.id,o):this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const o=n.source,c=n.sourceLayer,p=this.sourceCaches[o];if(p!==void 0)return p.getSource().type!=="vector"||c?(n.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),p.getFeatureState(c,n.id)):void this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.ErrorEvent(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return u.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return u.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:u.mapObject(this.sourceCaches,n=>n.serialize()),layers:this._serializeLayers(this._order)},n=>n!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(n){const o=x=>this._layers[x].type==="fill-extrusion",c={},p=[];for(let x=this._order.length-1;x>=0;x--){const S=this._order[x];if(o(S)){c[S]=x;for(const E of n){const I=E[S];if(I)for(const P of I)p.push(P)}}}p.sort((x,S)=>S.intersectionZ-x.intersectionZ);const g=[];for(let x=this._order.length-1;x>=0;x--){const S=this._order[x];if(o(S))for(let E=p.length-1;E>=0;E--){const I=p[E].feature;if(c[I.layer.id]<x)break;g.push(I),p.pop()}else for(const E of n){const I=E[S];if(I)for(const P of I)g.push(P.feature)}}return g}queryRenderedFeatures(n,o,c){o&&o.filter&&this._validate(u.validateStyle.filter,"queryRenderedFeatures.filter",o.filter,null,o);const p={};if(o&&o.layers){if(!Array.isArray(o.layers))return this.fire(new u.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const x of o.layers){const S=this._layers[x];if(!S)return this.fire(new u.ErrorEvent(new Error(`The layer '${x}' does not exist in the map's style and cannot be queried for features.`))),[];p[S.source]=!0}}const g=[];o.availableImages=this._availableImages;for(const x in this.sourceCaches)o.layers&&!p[x]||g.push(cr(this.sourceCaches[x],this._layers,this._serializedLayers,n,o,c));return this.placement&&g.push(function(x,S,E,I,P,D,B){const Z={},j=D.queryRenderedSymbols(I),G=[];for(const re of Object.keys(j).map(Number))G.push(B[re]);G.sort(hr);for(const re of G){const se=re.featureIndex.lookupSymbolFeatures(j[re.bucketInstanceId],S,re.bucketIndex,re.sourceLayerIndex,P.filter,P.layers,P.availableImages,x);for(const ce in se){const W=Z[ce]=Z[ce]||[],fe=se[ce];fe.sort((he,we)=>{const Se=re.featureSortOrder;if(Se){const Ae=Se.indexOf(he.featureIndex);return Se.indexOf(we.featureIndex)-Ae}return we.featureIndex-he.featureIndex});for(const he of fe)W.push(he)}}for(const re in Z)Z[re].forEach(se=>{const ce=se.feature,W=E[x[re].source].getFeatureState(ce.layer["source-layer"],ce.id);ce.source=ce.layer.source,ce.layer["source-layer"]&&(ce.sourceLayer=ce.layer["source-layer"]),ce.state=W});return Z}(this._layers,this._serializedLayers,this.sourceCaches,n,o,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(n,o){o&&o.filter&&this._validate(u.validateStyle.filter,"querySourceFeatures.filter",o.filter,null,o);const c=this.sourceCaches[n];return c?function(p,g){const x=p.getRenderableIds().map(I=>p.getTileByID(I)),S=[],E={};for(let I=0;I<x.length;I++){const P=x[I],D=P.tileID.canonical.key;E[D]||(E[D]=!0,P.querySourceFeatures(S,g))}return S}(c,o):[]}addSourceType(n,o,c){return Yn.getSourceType(n)?c(new Error(`A source type called "${n}" already exists.`)):(Yn.setSourceType(n,o),o.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:o.workerSourceURL},c):c(null,null))}getLight(){return this.light.getLight()}setLight(n,o={}){this._checkLoaded();const c=this.light.getLight();let p=!1;for(const x in n)if(!Q(n[x],c[x])){p=!0;break}if(!p)return;const g={now:u.exported.now(),transition:u.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,o),this.light.updateTransitions(g)}_validate(n,o,c,p,g={}){return(!g||g.validate!==!1)&&Mt(this,n.call(u.validateStyle,u.extend({key:o,style:this.serialize(),value:c,styleSpec:u.spec},p)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),u.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this.sourceCaches){const o=this.sourceCaches[n];o.setEventedParent(null),o.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const o in this.sourceCaches)this.sourceCaches[o].update(n,this.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,o,c,p,g=!1){let x=!1,S=!1;const E={};for(const I of this._order){const P=this._layers[I];if(P.type!=="symbol")continue;if(!E[P.source]){const B=this.sourceCaches[P.source];E[P.source]=B.getRenderableIds(!0).map(Z=>B.getTileByID(Z)).sort((Z,j)=>j.tileID.overscaledZ-Z.tileID.overscaledZ||(Z.tileID.isLessThan(j.tileID)?-1:1))}const D=this.crossTileSymbolIndex.addLayer(P,E[P.source],n.center.lng);x=x||D}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(u.exported.now(),n.zoom))&&(this.pauseablePlacement=new ge(n,this.terrain,this._order,g,o,c,p,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,E),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(u.exported.now()),S=!0),x&&this.pauseablePlacement.placement.setStale()),S||x)for(const I of this._order){const P=this._layers[I];P.type==="symbol"&&this.placement.updateLayerOpacities(P,E[P.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(u.exported.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,o,c){this.imageManager.getImages(o.icons,c),this._updateTilesForChangedImages();const p=this.sourceCaches[o.source];p&&p.setDependencies(o.tileID.key,o.type,o.icons)}getGlyphs(n,o,c){this.glyphManager.getGlyphs(o.stacks,c)}getResource(n,o,c){return u.makeRequest(o,c)}}Yn.getSourceType=function(h){return en[h]},Yn.setSourceType=function(h,n){en[h]=n},Yn.registerForPluginStateChange=u.registerForPluginStateChange;var Ka="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const Zo={prelude:Zt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Zt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Zt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Zt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Zt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Zt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Zt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Zt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Zt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Zt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Zt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Zt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Zt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Zt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Zt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Zt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Zt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Zt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Zt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Zt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Zt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Zt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Zt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Zt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Ka),terrainDepth:Zt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Ka),terrainCoords:Zt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Ka)};function Zt(h,n){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=n.match(/attribute ([\w]+) ([\w]+)/g),p=h.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=g?g.concat(p):p,S={};return{fragmentSource:h=h.replace(o,(E,I,P,D,B)=>(S[B]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${B}
varying ${P} ${D} ${B};
#else
uniform ${P} ${D} u_${B};
#endif
`:`
#ifdef HAS_UNIFORM_u_${B}
    ${P} ${D} ${B} = u_${B};
#endif
`)),vertexSource:n=n.replace(o,(E,I,P,D,B)=>{const Z=D==="float"?"vec2":"vec4",j=B.match(/color/)?"color":Z;return S[B]?I==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
attribute ${P} ${Z} a_${B};
varying ${P} ${D} ${B};
#else
uniform ${P} ${D} u_${B};
#endif
`:j==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = a_${B};
#else
    ${P} ${D} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = unpack_mix_${j}(a_${B}, u_${B}_t);
#else
    ${P} ${D} ${B} = u_${B};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
attribute ${P} ${Z} a_${B};
#else
uniform ${P} ${D} u_${B};
#endif
`:j==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${P} ${D} ${B} = a_${B};
#else
    ${P} ${D} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${P} ${D} ${B} = unpack_mix_${j}(a_${B}, u_${B}_t);
#else
    ${P} ${D} ${B} = u_${B};
#endif
`}),staticAttributes:c,staticUniforms:x}}class Ql{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,o,c,p,g,x,S,E,I){this.context=n;let P=this.boundPaintVertexBuffers.length!==p.length;for(let D=0;!P&&D<p.length;D++)this.boundPaintVertexBuffers[D]!==p[D]&&(P=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===o&&this.boundLayoutVertexBuffer===c&&!P&&this.boundIndexBuffer===g&&this.boundVertexOffset===x&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===E&&this.boundDynamicVertexBuffer3===I?(n.bindVertexArrayOES.set(this.vao),S&&S.bind(),g&&g.dynamicDraw&&g.bind(),E&&E.bind(),I&&I.bind()):this.freshBind(o,c,p,g,x,S,E,I)}freshBind(n,o,c,p,g,x,S,E){let I;const P=n.numAttributes,D=this.context,B=D.gl;if(D.extVertexArrayObject)this.vao&&this.destroy(),this.vao=D.extVertexArrayObject.createVertexArrayOES(),D.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=n,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=p,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=S,this.boundDynamicVertexBuffer3=E;else{I=D.currentNumAttributes||0;for(let Z=P;Z<I;Z++)B.disableVertexAttribArray(Z)}o.enableAttributes(B,n);for(const Z of c)Z.enableAttributes(B,n);x&&x.enableAttributes(B,n),S&&S.enableAttributes(B,n),E&&E.enableAttributes(B,n),o.bind(),o.setVertexAttribPointers(B,n,g);for(const Z of c)Z.bind(),Z.setVertexAttribPointers(B,n,g);x&&(x.bind(),x.setVertexAttribPointers(B,n,g)),p&&p.bind(),S&&(S.bind(),S.setVertexAttribPointers(B,n,g)),E&&(E.bind(),E.setVertexAttribPointers(B,n,g)),D.currentNumAttributes=P}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function eu(h){const n=[];for(let o=0;o<h.length;o++){if(h[o]===null)continue;const c=h[o].split(" ");n.push(c.pop())}return n}class Yc{constructor(n,o,c,p,g,x,S){const E=n.gl;this.program=E.createProgram();const I=eu(c.staticAttributes),P=p?p.getBinderAttributes():[],D=I.concat(P),B=Zo.prelude.staticUniforms?eu(Zo.prelude.staticUniforms):[],Z=c.staticUniforms?eu(c.staticUniforms):[],j=p?p.getBinderUniforms():[],G=B.concat(Z).concat(j),re=[];for(const Se of G)re.indexOf(Se)<0&&re.push(Se);const se=p?p.defines():[];x&&se.push("#define OVERDRAW_INSPECTOR;"),S&&se.push("#define TERRAIN3D;");const ce=se.concat(Zo.prelude.fragmentSource,c.fragmentSource).join(`
`),W=se.concat(Zo.prelude.vertexSource,c.vertexSource).join(`
`),fe=E.createShader(E.FRAGMENT_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);E.shaderSource(fe,ce),E.compileShader(fe),E.attachShader(this.program,fe);const he=E.createShader(E.VERTEX_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);E.shaderSource(he,W),E.compileShader(he),E.attachShader(this.program,he),this.attributes={};const we={};this.numAttributes=D.length;for(let Se=0;Se<this.numAttributes;Se++)D[Se]&&(E.bindAttribLocation(this.program,Se,D[Se]),this.attributes[D[Se]]=Se);E.linkProgram(this.program),E.deleteShader(he),E.deleteShader(fe);for(let Se=0;Se<re.length;Se++){const Ae=re[Se];if(Ae&&!we[Ae]){const ve=E.getUniformLocation(this.program,Ae);ve&&(we[Ae]=ve)}}this.fixedUniforms=g(n,we),this.terrainUniforms=((Se,Ae)=>({u_depth:new u.Uniform1i(Se,Ae.u_depth),u_terrain:new u.Uniform1i(Se,Ae.u_terrain),u_terrain_dim:new u.Uniform1f(Se,Ae.u_terrain_dim),u_terrain_matrix:new u.UniformMatrix4f(Se,Ae.u_terrain_matrix),u_terrain_unpack:new u.Uniform4f(Se,Ae.u_terrain_unpack),u_terrain_offset:new u.Uniform1f(Se,Ae.u_terrain_offset),u_terrain_exaggeration:new u.Uniform1f(Se,Ae.u_terrain_exaggeration)}))(n,we),this.binderUniforms=p?p.getUniforms(n,we):[]}draw(n,o,c,p,g,x,S,E,I,P,D,B,Z,j,G,re,se,ce){const W=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(c),n.setStencilMode(p),n.setColorMode(g),n.setCullFace(x),E){n.activeTexture.set(W.TEXTURE2),W.bindTexture(W.TEXTURE_2D,E.depthTexture),n.activeTexture.set(W.TEXTURE3),W.bindTexture(W.TEXTURE_2D,E.texture);for(const he in this.terrainUniforms)this.terrainUniforms[he].set(E[he])}for(const he in this.fixedUniforms)this.fixedUniforms[he].set(S[he]);G&&G.setUniforms(n,this.binderUniforms,Z,{zoom:j});let fe=0;switch(o){case W.LINES:fe=2;break;case W.TRIANGLES:fe=3;break;case W.LINE_STRIP:fe=1}for(const he of B.get()){const we=he.vaos||(he.vaos={});(we[I]||(we[I]=new Ql)).bind(n,this,P,G?G.getPaintVertexBuffers():[],D,he.vertexOffset,re,se,ce),W.drawElements(o,he.primitiveLength*fe,W.UNSIGNED_SHORT,he.primitiveOffset*fe*2)}}}function Kc(h,n,o){const c=1/Tn(o,1,n.transform.tileZoom),p=Math.pow(2,o.tileID.overscaledZ),g=o.tileSize*Math.pow(2,n.transform.tileZoom)/p,x=g*(o.tileID.canonical.x+o.tileID.wrap*p),S=g*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[c,h.fromScale,h.toScale],u_fade:h.t,u_pixel_coord_upper:[x>>16,S>>16],u_pixel_coord_lower:[65535&x,65535&S]}}const tu=(h,n,o,c)=>{const p=n.style.light,g=p.properties.get("position"),x=[g.x,g.y,g.z],S=u.create$1();p.properties.get("anchor")==="viewport"&&u.fromRotation(S,-n.transform.angle),u.transformMat3(x,x,S);const E=p.properties.get("color");return{u_matrix:h,u_lightpos:x,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[E.r,E.g,E.b],u_vertical_gradient:+o,u_opacity:c}},qp=(h,n,o,c,p,g,x)=>u.extend(tu(h,n,o,c),Kc(g,n,x),{u_height_factor:-Math.pow(2,p.overscaledZ)/x.tileSize/8}),$s=h=>({u_matrix:h}),nu=(h,n,o,c)=>u.extend($s(h),Kc(o,n,c)),Jc=(h,n)=>({u_matrix:h,u_world:n}),Qc=(h,n,o,c,p)=>u.extend(nu(h,n,o,c),{u_world:p}),eh=(h,n,o,c)=>{const p=h.transform;let g,x;if(c.paint.get("circle-pitch-alignment")==="map"){const S=Tn(o,1,p.zoom);g=!0,x=[S,S]}else g=!1,x=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:h.translatePosMatrix(n.posMatrix,o,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+g,u_device_pixel_ratio:h.pixelRatio,u_extrude_scale:x}},ga=(h,n,o)=>{const c=Tn(o,1,n.zoom),p=Math.pow(2,n.zoom-o.tileID.overscaledZ),g=o.tileID.overscaleFactor();return{u_matrix:h,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[n.pixelsToGLUnits[0]/(c*p),n.pixelsToGLUnits[1]/(c*p)],u_overscale_factor:g}},Wo=(h,n,o=1)=>({u_matrix:h,u_color:n,u_overlay:0,u_overlay_scale:o}),Ja=h=>({u_matrix:h}),js=(h,n,o,c)=>({u_matrix:h,u_extrude_scale:Tn(n,1,o),u_intensity:c});function Gs(h,n){const o=Math.pow(2,n.canonical.z),c=n.canonical.y;return[new u.MercatorCoordinate(0,c/o).toLngLat().lat,new u.MercatorCoordinate(0,(c+1)/o).toLngLat().lat]}const Qa=(h,n,o,c)=>{const p=h.transform;return{u_matrix:Xo(h,n,o,c),u_ratio:1/Tn(n,1,p.zoom),u_device_pixel_ratio:h.pixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},ru=(h,n,o,c,p)=>u.extend(Qa(h,n,o,p),{u_image:0,u_image_height:c}),qs=(h,n,o,c,p)=>{const g=h.transform,x=nn(n,g);return{u_matrix:Xo(h,n,o,p),u_texsize:n.imageAtlasTexture.size,u_ratio:1/Tn(n,1,g.zoom),u_device_pixel_ratio:h.pixelRatio,u_image:0,u_scale:[x,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Ho=(h,n,o,c,p,g)=>{const x=h.lineAtlas,S=nn(n,h.transform),E=o.layout.get("line-cap")==="round",I=x.getDash(c.from,E),P=x.getDash(c.to,E),D=I.width*p.fromScale,B=P.width*p.toScale;return u.extend(Qa(h,n,o,g),{u_patternscale_a:[S/D,-I.height/2],u_patternscale_b:[S/B,-P.height/2],u_sdfgamma:x.width/(256*Math.min(D,B)*h.pixelRatio)/2,u_image:0,u_tex_y_a:I.y,u_tex_y_b:P.y,u_mix:p.t})};function nn(h,n){return 1/Tn(h,1,n.tileZoom)}function Xo(h,n,o,c){return h.translatePosMatrix(c?c.posMatrix:n.tileID.posMatrix,n,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const th=(h,n,o,c,p)=>{return{u_matrix:h,u_tl_parent:n,u_scale_parent:o,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(x=p.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(g=p.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:nh(p.paint.get("raster-hue-rotate"))};var g,x};function nh(h){h*=Math.PI/180;const n=Math.sin(h),o=Math.cos(h);return[(2*o+1)/3,(-Math.sqrt(3)*n-o+1)/3,(Math.sqrt(3)*n-o+1)/3]}const iu=(h,n,o,c,p,g,x,S,E,I)=>{const P=p.transform;return{u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:P.cameraToCenterDistance,u_pitch:P.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:P.width/P.height,u_fade_change:p.options.fadeDuration?p.symbolFadeChange:1,u_matrix:g,u_label_plane_matrix:x,u_coord_matrix:S,u_is_text:+E,u_pitch_with_map:+c,u_texsize:I,u_texture:0}},Zs=(h,n,o,c,p,g,x,S,E,I,P)=>{const D=p.transform;return u.extend(iu(h,n,o,c,p,g,x,S,E,I),{u_gamma_scale:c?Math.cos(D._pitch)*D.cameraToCenterDistance:1,u_device_pixel_ratio:p.pixelRatio,u_is_halo:+P})},rh=(h,n,o,c,p,g,x,S,E,I)=>u.extend(Zs(h,n,o,c,p,g,x,S,!0,E,!0),{u_texsize_icon:I,u_texture_icon:1}),Zp=(h,n,o)=>({u_matrix:h,u_opacity:n,u_color:o}),Wp=(h,n,o,c,p,g)=>u.extend(function(x,S,E,I){const P=E.imageManager.getPattern(x.from.toString()),D=E.imageManager.getPattern(x.to.toString()),{width:B,height:Z}=E.imageManager.getPixelSize(),j=Math.pow(2,I.tileID.overscaledZ),G=I.tileSize*Math.pow(2,E.transform.tileZoom)/j,re=G*(I.tileID.canonical.x+I.tileID.wrap*j),se=G*I.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:P.tl,u_pattern_br_a:P.br,u_pattern_tl_b:D.tl,u_pattern_br_b:D.br,u_texsize:[B,Z],u_mix:S.t,u_pattern_size_a:P.displaySize,u_pattern_size_b:D.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/Tn(I,1,E.transform.tileZoom),u_pixel_coord_upper:[re>>16,se>>16],u_pixel_coord_lower:[65535&re,65535&se]}}(c,g,o,p),{u_matrix:h,u_opacity:n}),au={fillExtrusion:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_lightpos:new u.Uniform3f(h,n.u_lightpos),u_lightintensity:new u.Uniform1f(h,n.u_lightintensity),u_lightcolor:new u.Uniform3f(h,n.u_lightcolor),u_vertical_gradient:new u.Uniform1f(h,n.u_vertical_gradient),u_opacity:new u.Uniform1f(h,n.u_opacity)}),fillExtrusionPattern:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_lightpos:new u.Uniform3f(h,n.u_lightpos),u_lightintensity:new u.Uniform1f(h,n.u_lightintensity),u_lightcolor:new u.Uniform3f(h,n.u_lightcolor),u_vertical_gradient:new u.Uniform1f(h,n.u_vertical_gradient),u_height_factor:new u.Uniform1f(h,n.u_height_factor),u_image:new u.Uniform1i(h,n.u_image),u_texsize:new u.Uniform2f(h,n.u_texsize),u_pixel_coord_upper:new u.Uniform2f(h,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,n.u_pixel_coord_lower),u_scale:new u.Uniform3f(h,n.u_scale),u_fade:new u.Uniform1f(h,n.u_fade),u_opacity:new u.Uniform1f(h,n.u_opacity)}),fill:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix)}),fillPattern:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_image:new u.Uniform1i(h,n.u_image),u_texsize:new u.Uniform2f(h,n.u_texsize),u_pixel_coord_upper:new u.Uniform2f(h,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,n.u_pixel_coord_lower),u_scale:new u.Uniform3f(h,n.u_scale),u_fade:new u.Uniform1f(h,n.u_fade)}),fillOutline:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_world:new u.Uniform2f(h,n.u_world)}),fillOutlinePattern:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_world:new u.Uniform2f(h,n.u_world),u_image:new u.Uniform1i(h,n.u_image),u_texsize:new u.Uniform2f(h,n.u_texsize),u_pixel_coord_upper:new u.Uniform2f(h,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,n.u_pixel_coord_lower),u_scale:new u.Uniform3f(h,n.u_scale),u_fade:new u.Uniform1f(h,n.u_fade)}),circle:(h,n)=>({u_camera_to_center_distance:new u.Uniform1f(h,n.u_camera_to_center_distance),u_scale_with_map:new u.Uniform1i(h,n.u_scale_with_map),u_pitch_with_map:new u.Uniform1i(h,n.u_pitch_with_map),u_extrude_scale:new u.Uniform2f(h,n.u_extrude_scale),u_device_pixel_ratio:new u.Uniform1f(h,n.u_device_pixel_ratio),u_matrix:new u.UniformMatrix4f(h,n.u_matrix)}),collisionBox:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_camera_to_center_distance:new u.Uniform1f(h,n.u_camera_to_center_distance),u_pixels_to_tile_units:new u.Uniform1f(h,n.u_pixels_to_tile_units),u_extrude_scale:new u.Uniform2f(h,n.u_extrude_scale),u_overscale_factor:new u.Uniform1f(h,n.u_overscale_factor)}),collisionCircle:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_inv_matrix:new u.UniformMatrix4f(h,n.u_inv_matrix),u_camera_to_center_distance:new u.Uniform1f(h,n.u_camera_to_center_distance),u_viewport_size:new u.Uniform2f(h,n.u_viewport_size)}),debug:(h,n)=>({u_color:new u.UniformColor(h,n.u_color),u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_overlay:new u.Uniform1i(h,n.u_overlay),u_overlay_scale:new u.Uniform1f(h,n.u_overlay_scale)}),clippingMask:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix)}),heatmap:(h,n)=>({u_extrude_scale:new u.Uniform1f(h,n.u_extrude_scale),u_intensity:new u.Uniform1f(h,n.u_intensity),u_matrix:new u.UniformMatrix4f(h,n.u_matrix)}),heatmapTexture:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_world:new u.Uniform2f(h,n.u_world),u_image:new u.Uniform1i(h,n.u_image),u_color_ramp:new u.Uniform1i(h,n.u_color_ramp),u_opacity:new u.Uniform1f(h,n.u_opacity)}),hillshade:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_image:new u.Uniform1i(h,n.u_image),u_latrange:new u.Uniform2f(h,n.u_latrange),u_light:new u.Uniform2f(h,n.u_light),u_shadow:new u.UniformColor(h,n.u_shadow),u_highlight:new u.UniformColor(h,n.u_highlight),u_accent:new u.UniformColor(h,n.u_accent)}),hillshadePrepare:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_image:new u.Uniform1i(h,n.u_image),u_dimension:new u.Uniform2f(h,n.u_dimension),u_zoom:new u.Uniform1f(h,n.u_zoom),u_unpack:new u.Uniform4f(h,n.u_unpack)}),line:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_ratio:new u.Uniform1f(h,n.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,n.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(h,n.u_units_to_pixels)}),lineGradient:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_ratio:new u.Uniform1f(h,n.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,n.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(h,n.u_units_to_pixels),u_image:new u.Uniform1i(h,n.u_image),u_image_height:new u.Uniform1f(h,n.u_image_height)}),linePattern:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_texsize:new u.Uniform2f(h,n.u_texsize),u_ratio:new u.Uniform1f(h,n.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,n.u_device_pixel_ratio),u_image:new u.Uniform1i(h,n.u_image),u_units_to_pixels:new u.Uniform2f(h,n.u_units_to_pixels),u_scale:new u.Uniform3f(h,n.u_scale),u_fade:new u.Uniform1f(h,n.u_fade)}),lineSDF:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_ratio:new u.Uniform1f(h,n.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,n.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(h,n.u_units_to_pixels),u_patternscale_a:new u.Uniform2f(h,n.u_patternscale_a),u_patternscale_b:new u.Uniform2f(h,n.u_patternscale_b),u_sdfgamma:new u.Uniform1f(h,n.u_sdfgamma),u_image:new u.Uniform1i(h,n.u_image),u_tex_y_a:new u.Uniform1f(h,n.u_tex_y_a),u_tex_y_b:new u.Uniform1f(h,n.u_tex_y_b),u_mix:new u.Uniform1f(h,n.u_mix)}),raster:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_tl_parent:new u.Uniform2f(h,n.u_tl_parent),u_scale_parent:new u.Uniform1f(h,n.u_scale_parent),u_buffer_scale:new u.Uniform1f(h,n.u_buffer_scale),u_fade_t:new u.Uniform1f(h,n.u_fade_t),u_opacity:new u.Uniform1f(h,n.u_opacity),u_image0:new u.Uniform1i(h,n.u_image0),u_image1:new u.Uniform1i(h,n.u_image1),u_brightness_low:new u.Uniform1f(h,n.u_brightness_low),u_brightness_high:new u.Uniform1f(h,n.u_brightness_high),u_saturation_factor:new u.Uniform1f(h,n.u_saturation_factor),u_contrast_factor:new u.Uniform1f(h,n.u_contrast_factor),u_spin_weights:new u.Uniform3f(h,n.u_spin_weights)}),symbolIcon:(h,n)=>({u_is_size_zoom_constant:new u.Uniform1i(h,n.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(h,n.u_is_size_feature_constant),u_size_t:new u.Uniform1f(h,n.u_size_t),u_size:new u.Uniform1f(h,n.u_size),u_camera_to_center_distance:new u.Uniform1f(h,n.u_camera_to_center_distance),u_pitch:new u.Uniform1f(h,n.u_pitch),u_rotate_symbol:new u.Uniform1i(h,n.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(h,n.u_aspect_ratio),u_fade_change:new u.Uniform1f(h,n.u_fade_change),u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(h,n.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(h,n.u_coord_matrix),u_is_text:new u.Uniform1i(h,n.u_is_text),u_pitch_with_map:new u.Uniform1i(h,n.u_pitch_with_map),u_texsize:new u.Uniform2f(h,n.u_texsize),u_texture:new u.Uniform1i(h,n.u_texture)}),symbolSDF:(h,n)=>({u_is_size_zoom_constant:new u.Uniform1i(h,n.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(h,n.u_is_size_feature_constant),u_size_t:new u.Uniform1f(h,n.u_size_t),u_size:new u.Uniform1f(h,n.u_size),u_camera_to_center_distance:new u.Uniform1f(h,n.u_camera_to_center_distance),u_pitch:new u.Uniform1f(h,n.u_pitch),u_rotate_symbol:new u.Uniform1i(h,n.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(h,n.u_aspect_ratio),u_fade_change:new u.Uniform1f(h,n.u_fade_change),u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(h,n.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(h,n.u_coord_matrix),u_is_text:new u.Uniform1i(h,n.u_is_text),u_pitch_with_map:new u.Uniform1i(h,n.u_pitch_with_map),u_texsize:new u.Uniform2f(h,n.u_texsize),u_texture:new u.Uniform1i(h,n.u_texture),u_gamma_scale:new u.Uniform1f(h,n.u_gamma_scale),u_device_pixel_ratio:new u.Uniform1f(h,n.u_device_pixel_ratio),u_is_halo:new u.Uniform1i(h,n.u_is_halo)}),symbolTextAndIcon:(h,n)=>({u_is_size_zoom_constant:new u.Uniform1i(h,n.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(h,n.u_is_size_feature_constant),u_size_t:new u.Uniform1f(h,n.u_size_t),u_size:new u.Uniform1f(h,n.u_size),u_camera_to_center_distance:new u.Uniform1f(h,n.u_camera_to_center_distance),u_pitch:new u.Uniform1f(h,n.u_pitch),u_rotate_symbol:new u.Uniform1i(h,n.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(h,n.u_aspect_ratio),u_fade_change:new u.Uniform1f(h,n.u_fade_change),u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(h,n.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(h,n.u_coord_matrix),u_is_text:new u.Uniform1i(h,n.u_is_text),u_pitch_with_map:new u.Uniform1i(h,n.u_pitch_with_map),u_texsize:new u.Uniform2f(h,n.u_texsize),u_texsize_icon:new u.Uniform2f(h,n.u_texsize_icon),u_texture:new u.Uniform1i(h,n.u_texture),u_texture_icon:new u.Uniform1i(h,n.u_texture_icon),u_gamma_scale:new u.Uniform1f(h,n.u_gamma_scale),u_device_pixel_ratio:new u.Uniform1f(h,n.u_device_pixel_ratio),u_is_halo:new u.Uniform1i(h,n.u_is_halo)}),background:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_opacity:new u.Uniform1f(h,n.u_opacity),u_color:new u.UniformColor(h,n.u_color)}),backgroundPattern:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_opacity:new u.Uniform1f(h,n.u_opacity),u_image:new u.Uniform1i(h,n.u_image),u_pattern_tl_a:new u.Uniform2f(h,n.u_pattern_tl_a),u_pattern_br_a:new u.Uniform2f(h,n.u_pattern_br_a),u_pattern_tl_b:new u.Uniform2f(h,n.u_pattern_tl_b),u_pattern_br_b:new u.Uniform2f(h,n.u_pattern_br_b),u_texsize:new u.Uniform2f(h,n.u_texsize),u_mix:new u.Uniform1f(h,n.u_mix),u_pattern_size_a:new u.Uniform2f(h,n.u_pattern_size_a),u_pattern_size_b:new u.Uniform2f(h,n.u_pattern_size_b),u_scale_a:new u.Uniform1f(h,n.u_scale_a),u_scale_b:new u.Uniform1f(h,n.u_scale_b),u_pixel_coord_upper:new u.Uniform2f(h,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,n.u_pixel_coord_lower),u_tile_units_to_pixels:new u.Uniform1f(h,n.u_tile_units_to_pixels)}),terrain:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_texture:new u.Uniform1i(h,n.u_texture)}),terrainDepth:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix)}),terrainCoords:(h,n)=>({u_matrix:new u.UniformMatrix4f(h,n.u_matrix),u_texture:new u.Uniform1i(h,n.u_texture),u_terrain_coords_id:new u.Uniform1f(h,n.u_terrain_coords_id)})};class ou{constructor(n,o,c){this.context=n;const p=n.gl;this.buffer=p.createBuffer(),this.dynamicDraw=Boolean(c),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const su={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class lu{constructor(n,o,c,p){this.length=o.length,this.attributes=c,this.itemSize=o.bytesPerElement,this.dynamicDraw=p,this.context=n;const g=n.gl;this.buffer=g.createBuffer(),n.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,o){for(let c=0;c<this.attributes.length;c++){const p=o.attributes[this.attributes[c].name];p!==void 0&&n.enableVertexAttribArray(p)}}setVertexAttribPointers(n,o,c){for(let p=0;p<this.attributes.length;p++){const g=this.attributes[p],x=o.attributes[g.name];x!==void 0&&n.vertexAttribPointer(x,g.components,n[su[g.type]],!1,this.itemSize,g.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Bt{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ih extends Bt{getDefault(){return u.Color.transparent}set(n){const o=this.current;(n.r!==o.r||n.g!==o.g||n.b!==o.b||n.a!==o.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Hp extends Bt{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Yo extends Bt{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class Ko extends Bt{getDefault(){return[!0,!0,!0,!0]}set(n){const o=this.current;(n[0]!==o[0]||n[1]!==o[1]||n[2]!==o[2]||n[3]!==o[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class ah extends Bt{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class kr extends Bt{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class uu extends Bt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const o=this.current;(n.func!==o.func||n.ref!==o.ref||n.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Ws extends Bt{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const o=this.current;(n[0]!==o[0]||n[1]!==o[1]||n[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Hs extends Bt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;n?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=n,this.dirty=!1}}class cu extends Bt{getDefault(){return[0,1]}set(n){const o=this.current;(n[0]!==o[0]||n[1]!==o[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class hu extends Bt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;n?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=n,this.dirty=!1}}class Xs extends Bt{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class du extends Bt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;n?o.enable(o.BLEND):o.disable(o.BLEND),this.current=n,this.dirty=!1}}class pu extends Bt{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const o=this.current;(n[0]!==o[0]||n[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class Ys extends Bt{getDefault(){return u.Color.transparent}set(n){const o=this.current;(n.r!==o.r||n.g!==o.g||n.b!==o.b||n.a!==o.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class oh extends Bt{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class sh extends Bt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;n?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=n,this.dirty=!1}}class eo extends Bt{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class Xp extends Bt{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class Yp extends Bt{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class Kp extends Bt{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Jp extends Bt{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const o=this.current;(n[0]!==o[0]||n[1]!==o[1]||n[2]!==o[2]||n[3]!==o[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Qp extends Bt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class ef extends Bt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class fu extends Bt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Ks extends Bt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class mu extends Bt{getDefault(){return null}set(n){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class gu extends Bt{constructor(n){super(n),this.vao=n.extVertexArrayObject}getDefault(){return null}set(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)}}class to extends Bt{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class lh extends Bt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class uh extends Bt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Js extends Bt{constructor(n,o){super(n),this.context=n,this.parent=o}getDefault(){return null}}class ya extends Js{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class ch extends Js{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class no{constructor(n,o,c,p){this.context=n,this.width=o,this.height=c;const g=n.gl,x=this.framebuffer=g.createFramebuffer();if(this.colorAttachment=new ya(n,x),p&&(this.depthAttachment=new ch(n,x)),g.checkFramebufferStatus(g.FRAMEBUFFER)!==g.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const n=this.context.gl,o=this.colorAttachment.get();if(o&&n.deleteTexture(o),this.depthAttachment){const c=this.depthAttachment.get();c&&n.deleteRenderbuffer(c)}n.deleteFramebuffer(this.framebuffer)}}class Jt{constructor(n,o,c){this.blendFunction=n,this.blendColor=o,this.mask=c}}Jt.Replace=[1,0],Jt.disabled=new Jt(Jt.Replace,u.Color.transparent,[!1,!1,!1,!1]),Jt.unblended=new Jt(Jt.Replace,u.Color.transparent,[!0,!0,!0,!0]),Jt.alphaBlended=new Jt([1,771],u.Color.transparent,[!0,!0,!0,!0]);class hh{constructor(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ih(this),this.clearDepth=new Hp(this),this.clearStencil=new Yo(this),this.colorMask=new Ko(this),this.depthMask=new ah(this),this.stencilMask=new kr(this),this.stencilFunc=new uu(this),this.stencilOp=new Ws(this),this.stencilTest=new Hs(this),this.depthRange=new cu(this),this.depthTest=new hu(this),this.depthFunc=new Xs(this),this.blend=new du(this),this.blendFunc=new pu(this),this.blendColor=new Ys(this),this.blendEquation=new oh(this),this.cullFace=new sh(this),this.cullFaceSide=new eo(this),this.frontFace=new Xp(this),this.program=new Yp(this),this.activeTexture=new Kp(this),this.viewport=new Jp(this),this.bindFramebuffer=new Qp(this),this.bindRenderbuffer=new ef(this),this.bindTexture=new fu(this),this.bindVertexBuffer=new Ks(this),this.bindElementBuffer=new mu(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new gu(this),this.pixelStoreUnpack=new to(this),this.pixelStoreUnpackPremultiplyAlpha=new lh(this),this.pixelStoreUnpackFlipY=new uh(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,o){return new ou(this,n,o)}createVertexBuffer(n,o,c){return new lu(this,n,o,c)}createRenderbuffer(n,o,c){const p=this.gl,g=p.createRenderbuffer();return this.bindRenderbuffer.set(g),p.renderbufferStorage(p.RENDERBUFFER,n,o,c),this.bindRenderbuffer.set(null),g}createFramebuffer(n,o,c){return new no(this,n,o,c)}clear({color:n,depth:o}){const c=this.gl;let p=0;n&&(p|=c.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(p|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),c.clear(p)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){Q(n.blendFunction,Jt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class It{constructor(n,o,c){this.func=n,this.mask=o,this.range=c}}It.ReadOnly=!1,It.ReadWrite=!0,It.disabled=new It(519,It.ReadOnly,[0,1]);const Ft=7680;class Xt{constructor(n,o,c,p,g,x){this.test=n,this.ref=o,this.mask=c,this.fail=p,this.depthFail=g,this.pass=x}}Xt.disabled=new Xt({func:519,mask:0},0,0,Ft,Ft,Ft);class rn{constructor(n,o,c){this.enable=n,this.mode=o,this.frontFace=c}}let Jo;function ro(h,n,o,c,p,g,x){const S=h.context,E=S.gl,I=h.useProgram("collisionBox"),P=[];let D=0,B=0;for(let W=0;W<c.length;W++){const fe=c[W],he=n.getTile(fe),we=he.getBucket(o);if(!we)continue;let Se=fe.posMatrix;p[0]===0&&p[1]===0||(Se=h.translatePosMatrix(fe.posMatrix,he,p,g));const Ae=x?we.textCollisionBox:we.iconCollisionBox,ve=we.collisionCircleArray;if(ve.length>0){const We=u.create(),Be=Se;u.mul(We,we.placementInvProjMatrix,h.transform.glCoordMatrix),u.mul(We,We,we.placementViewportMatrix),P.push({circleArray:ve,circleOffset:B,transform:Be,invTransform:We,coord:fe}),D+=ve.length/4,B=D}Ae&&I.draw(S,E.LINES,It.disabled,Xt.disabled,h.colorModeForRenderPass(),rn.disabled,ga(Se,h.transform,he),h.style.terrain&&h.style.terrain.getTerrainData(fe),o.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,null,h.transform.zoom,null,null,Ae.collisionVertexBuffer)}if(!x||!P.length)return;const Z=h.useProgram("collisionCircle"),j=new u.CollisionCircleLayoutArray;j.resize(4*D),j._trim();let G=0;for(const W of P)for(let fe=0;fe<W.circleArray.length/4;fe++){const he=4*fe,we=W.circleArray[he+0],Se=W.circleArray[he+1],Ae=W.circleArray[he+2],ve=W.circleArray[he+3];j.emplace(G++,we,Se,Ae,ve,0),j.emplace(G++,we,Se,Ae,ve,1),j.emplace(G++,we,Se,Ae,ve,2),j.emplace(G++,we,Se,Ae,ve,3)}(!Jo||Jo.length<2*D)&&(Jo=function(W){const fe=2*W,he=new u.QuadTriangleArray;he.resize(fe),he._trim();for(let we=0;we<fe;we++){const Se=6*we;he.uint16[Se+0]=4*we+0,he.uint16[Se+1]=4*we+1,he.uint16[Se+2]=4*we+2,he.uint16[Se+3]=4*we+2,he.uint16[Se+4]=4*we+3,he.uint16[Se+5]=4*we+0}return he}(D));const re=S.createIndexBuffer(Jo,!0),se=S.createVertexBuffer(j,u.collisionCircleLayout.members,!0);for(const W of P){const fe={u_matrix:W.transform,u_inv_matrix:W.invTransform,u_camera_to_center_distance:(ce=h.transform).cameraToCenterDistance,u_viewport_size:[ce.width,ce.height]};Z.draw(S,E.TRIANGLES,It.disabled,Xt.disabled,h.colorModeForRenderPass(),rn.disabled,fe,h.style.terrain&&h.style.terrain.getTerrainData(W.coord),o.id,se,re,u.SegmentVector.simpleSegment(0,2*W.circleOffset,W.circleArray.length,W.circleArray.length/2),null,h.transform.zoom,null,null,null)}var ce;se.destroy(),re.destroy()}rn.disabled=new rn(!1,1029,2305),rn.backCCW=new rn(!0,1029,2305);const tf=u.identity(new Float32Array(16));function nf(h,n,o,c,p,g){const{horizontalAlign:x,verticalAlign:S}=u.getAnchorAlignment(h),E=-(x-.5)*n,I=-(S-.5)*o,P=u.evaluateVariableOffset(h,c);return new u.pointGeometry((E/p+P[0])*g,(I/p+P[1])*g)}function dh(h,n,o,c,p,g,x,S,E,I,P){const D=h.text.placedSymbolArray,B=h.text.dynamicLayoutVertexArray,Z=h.icon.dynamicLayoutVertexArray,j={};B.clear();for(let G=0;G<D.length;G++){const re=D.get(G),se=h.allowVerticalPlacement&&!re.placedOrientation,ce=re.hidden||!re.crossTileID||se?null:c[re.crossTileID];if(ce){const W=new u.pointGeometry(re.anchorX,re.anchorY),fe=Pt(W,o?x:g,P),he=Nr(p.cameraToCenterDistance,fe.signedDistanceFromCamera);let we=u.evaluateSizeForFeature(h.textSizeData,E,re)*he/u.ONE_EM;o&&(we*=h.tilePixelRatio/S);const{width:Se,height:Ae,anchor:ve,textOffset:We,textBoxScale:Be}=ce,He=nf(ve,Se,Ae,We,Be,we),yt=o?Pt(W.add(He),g,P).point:fe.point.add(n?He.rotate(-p.angle):He),bt=h.allowVerticalPlacement&&re.placedOrientation===u.WritingMode.vertical?Math.PI/2:0;for(let at=0;at<re.numGlyphs;at++)u.addDynamicAttributes(B,yt,bt);I&&re.associatedIconIndex>=0&&(j[re.associatedIconIndex]={shiftedAnchor:yt,angle:bt})}else mt(re.numGlyphs,B)}if(I){Z.clear();const G=h.icon.placedSymbolArray;for(let re=0;re<G.length;re++){const se=G.get(re);if(se.hidden)mt(se.numGlyphs,Z);else{const ce=j[re];if(ce)for(let W=0;W<se.numGlyphs;W++)u.addDynamicAttributes(Z,ce.shiftedAnchor,ce.angle);else mt(se.numGlyphs,Z)}}h.icon.dynamicLayoutVertexBuffer.updateData(Z)}h.text.dynamicLayoutVertexBuffer.updateData(B)}function rf(h,n,o){return o.iconsInText&&n?"symbolTextAndIcon":h?"symbolSDF":"symbolIcon"}function Qs(h,n,o,c,p,g,x,S,E,I,P,D){const B=h.context,Z=B.gl,j=h.transform,G=S==="map",re=E==="map",se=S!=="viewport"&&o.layout.get("symbol-placement")!=="point",ce=G&&!re&&!se,W=!o.layout.get("symbol-sort-key").isConstant();let fe=!1;const he=h.depthModeForSublayer(0,It.ReadOnly),we=o.layout.get("text-variable-anchor"),Se=[];for(const Ae of c){const ve=n.getTile(Ae),We=ve.getBucket(o);if(!We)continue;const Be=p?We.text:We.icon;if(!Be||!Be.segments.get().length)continue;const He=Be.programConfigurations.get(o.id),yt=p||We.sdfIcons,bt=p?We.textSizeData:We.iconSizeData,at=re||j.pitch!==0,Nt=h.useProgram(rf(yt,p,We),He),Ut=u.evaluateSizeForZoom(bt,j.zoom),Ct=h.style.terrain&&h.style.terrain.getTerrainData(Ae);let Dt,jt,Fn,mi,Jr=[0,0],gi=null;if(p){if(jt=ve.glyphAtlasTexture,Fn=Z.LINEAR,Dt=ve.glyphAtlasTexture.size,We.iconsInText){Jr=ve.imageAtlasTexture.size,gi=ve.imageAtlasTexture;const $r=bt.kind==="composite"||bt.kind==="camera";mi=at||h.options.rotating||h.options.zooming||$r?Z.LINEAR:Z.NEAREST}}else{const $r=o.layout.get("icon-size").constantOr(0)!==1||We.iconsNeedLinear;jt=ve.imageAtlasTexture,Fn=yt||h.options.rotating||h.options.zooming||$r||at?Z.LINEAR:Z.NEAREST,Dt=ve.imageAtlasTexture.size}const ra=Tn(ve,1,h.transform.zoom),Vr=da(Ae.posMatrix,re,G,h.transform,ra),fr=Yr(Ae.posMatrix,re,G,h.transform,ra),Mi=we&&We.hasTextData(),sl=o.layout.get("icon-text-fit")!=="none"&&Mi&&We.hasIconData();if(se){const $r=h.style.terrain?(zu,uo)=>h.style.terrain.getElevation(Ae,zu,uo):null,wa=o.layout.get("text-rotation-alignment")==="map";Er(We,Ae.posMatrix,h,p,Vr,fr,re,I,wa,$r)}const Pn=h.translatePosMatrix(Ae.posMatrix,ve,g,x),Et=se||p&&we||sl?tf:Vr,Ot=h.translatePosMatrix(fr,ve,g,x,!0),On=yt&&o.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Nn;Nn=yt?We.iconsInText?rh(bt.kind,Ut,ce,re,h,Pn,Et,Ot,Dt,Jr):Zs(bt.kind,Ut,ce,re,h,Pn,Et,Ot,p,Dt,!0):iu(bt.kind,Ut,ce,re,h,Pn,Et,Ot,p,Dt);const on={program:Nt,buffers:Be,uniformValues:Nn,atlasTexture:jt,atlasTextureIcon:gi,atlasInterpolation:Fn,atlasInterpolationIcon:mi,isSDF:yt,hasHalo:On};if(W&&We.canOverlap){fe=!0;const $r=Be.segments.get();for(const wa of $r)Se.push({segments:new u.SegmentVector([wa]),sortKey:wa.sortKey,state:on,terrainData:Ct})}else Se.push({segments:Be.segments,sortKey:0,state:on,terrainData:Ct})}fe&&Se.sort((Ae,ve)=>Ae.sortKey-ve.sortKey);for(const Ae of Se){const ve=Ae.state;if(B.activeTexture.set(Z.TEXTURE0),ve.atlasTexture.bind(ve.atlasInterpolation,Z.CLAMP_TO_EDGE),ve.atlasTextureIcon&&(B.activeTexture.set(Z.TEXTURE1),ve.atlasTextureIcon&&ve.atlasTextureIcon.bind(ve.atlasInterpolationIcon,Z.CLAMP_TO_EDGE)),ve.isSDF){const We=ve.uniformValues;ve.hasHalo&&(We.u_is_halo=1,Qo(ve.buffers,Ae.segments,o,h,ve.program,he,P,D,We,Ae.terrainData)),We.u_is_halo=0}Qo(ve.buffers,Ae.segments,o,h,ve.program,he,P,D,ve.uniformValues,Ae.terrainData)}}function Qo(h,n,o,c,p,g,x,S,E,I){const P=c.context;p.draw(P,P.gl.TRIANGLES,g,x,S,rn.disabled,E,I,o.id,h.layoutVertexBuffer,h.indexBuffer,n,o.paint,c.transform.zoom,h.programConfigurations.get(o.id),h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer)}function es(h,n,o,c,p,g,x){const S=h.context.gl,E=o.paint.get("fill-pattern"),I=E&&E.constantOr(1),P=o.getCrossfadeParameters();let D,B,Z,j,G;x?(B=I&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",D=S.LINES):(B=I?"fillPattern":"fill",D=S.TRIANGLES);for(const re of c){const se=n.getTile(re);if(I&&!se.patternsLoaded())continue;const ce=se.getBucket(o);if(!ce)continue;const W=ce.programConfigurations.get(o.id),fe=h.useProgram(B,W),he=h.style.terrain&&h.style.terrain.getTerrainData(re);I&&(h.context.activeTexture.set(S.TEXTURE0),se.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),W.updatePaintBuffers(P));const we=E.constantOr(null);if(we&&se.imageAtlas){const ve=se.imageAtlas,We=ve.patternPositions[we.to.toString()],Be=ve.patternPositions[we.from.toString()];We&&Be&&W.setConstantPatternPositions(We,Be)}const Se=he?re:null,Ae=h.translatePosMatrix(Se?Se.posMatrix:re.posMatrix,se,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(x){j=ce.indexBuffer2,G=ce.segments2;const ve=[S.drawingBufferWidth,S.drawingBufferHeight];Z=B==="fillOutlinePattern"&&I?Qc(Ae,h,P,se,ve):Jc(Ae,ve)}else j=ce.indexBuffer,G=ce.segments,Z=I?nu(Ae,h,P,se):$s(Ae);fe.draw(h.context,D,p,h.stencilModeForClipping(re),g,rn.disabled,Z,he,o.id,ce.layoutVertexBuffer,j,G,o.paint,h.transform.zoom,W)}}function ts(h,n,o,c,p,g,x){const S=h.context,E=S.gl,I=o.paint.get("fill-extrusion-pattern"),P=I.constantOr(1),D=o.getCrossfadeParameters(),B=o.paint.get("fill-extrusion-opacity");for(const Z of c){const j=n.getTile(Z),G=j.getBucket(o);if(!G)continue;const re=h.style.terrain&&h.style.terrain.getTerrainData(Z),se=G.programConfigurations.get(o.id),ce=h.useProgram(P?"fillExtrusionPattern":"fillExtrusion",se);P&&(h.context.activeTexture.set(E.TEXTURE0),j.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),se.updatePaintBuffers(D));const W=I.constantOr(null);if(W&&j.imageAtlas){const Se=j.imageAtlas,Ae=Se.patternPositions[W.to.toString()],ve=Se.patternPositions[W.from.toString()];Ae&&ve&&se.setConstantPatternPositions(Ae,ve)}const fe=h.translatePosMatrix(Z.posMatrix,j,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),he=o.paint.get("fill-extrusion-vertical-gradient"),we=P?qp(fe,h,he,B,Z,D,j):tu(fe,h,he,B);ce.draw(S,S.gl.TRIANGLES,p,g,x,rn.backCCW,we,re,o.id,G.layoutVertexBuffer,G.indexBuffer,G.segments,o.paint,h.transform.zoom,se,h.style.terrain&&G.centroidVertexBuffer)}}function yu(h,n,o,c,p,g,x){const S=h.context,E=S.gl,I=o.fbo;if(!I)return;const P=h.useProgram("hillshade"),D=h.style.terrain&&h.style.terrain.getTerrainData(n);S.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,I.colorAttachment.get()),P.draw(S,E.TRIANGLES,p,g,x,rn.disabled,((B,Z,j,G)=>{const re=j.paint.get("hillshade-shadow-color"),se=j.paint.get("hillshade-highlight-color"),ce=j.paint.get("hillshade-accent-color");let W=j.paint.get("hillshade-illumination-direction")*(Math.PI/180);j.paint.get("hillshade-illumination-anchor")==="viewport"&&(W-=B.transform.angle);const fe=!B.options.moving;return{u_matrix:G?G.posMatrix:B.transform.calculatePosMatrix(Z.tileID.toUnwrapped(),fe),u_image:0,u_latrange:Gs(0,Z.tileID),u_light:[j.paint.get("hillshade-exaggeration"),W],u_shadow:re,u_highlight:se,u_accent:ce}})(h,o,c,D?n:null),D,c.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}function ph(h,n,o,c,p,g){const x=h.context,S=x.gl,E=n.dem;if(E&&E.data){const I=E.dim,P=E.stride,D=E.getPixels();if(x.activeTexture.set(S.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||h.getTileTexture(P),n.demTexture){const Z=n.demTexture;Z.update(D,{premultiply:!1}),Z.bind(S.NEAREST,S.CLAMP_TO_EDGE)}else n.demTexture=new ye(x,D,S.RGBA,{premultiply:!1}),n.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);x.activeTexture.set(S.TEXTURE0);let B=n.fbo;if(!B){const Z=new ye(x,{width:I,height:I,data:null},S.RGBA);Z.bind(S.LINEAR,S.CLAMP_TO_EDGE),B=n.fbo=x.createFramebuffer(I,I,!0),B.colorAttachment.set(Z.texture)}x.bindFramebuffer.set(B.framebuffer),x.viewport.set([0,0,I,I]),h.useProgram("hillshadePrepare").draw(x,S.TRIANGLES,c,p,g,rn.disabled,((Z,j)=>{const G=j.stride,re=u.create();return u.ortho(re,0,u.EXTENT,-u.EXTENT,0,0,1),u.translate(re,re,[0,-u.EXTENT,0]),{u_matrix:re,u_image:1,u_dimension:[G,G],u_zoom:Z.overscaledZ,u_unpack:j.getUnpackVector()}})(n.tileID,E),null,o.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function el(h,n,o,c,p,g){const x=c.paint.get("raster-fade-duration");if(!g&&x>0){const S=u.exported.now(),E=(S-h.timeAdded)/x,I=n?(S-n.timeAdded)/x:-1,P=o.getSource(),D=p.coveringZoomLevel({tileSize:P.tileSize,roundZoom:P.roundZoom}),B=!n||Math.abs(n.tileID.overscaledZ-D)>Math.abs(h.tileID.overscaledZ-D),Z=B&&h.refreshedUponExpiration?1:u.clamp(B?E:1-I,0,1);return h.refreshedUponExpiration&&E>=1&&(h.refreshedUponExpiration=!1),n?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}const tl=new u.Color(1,0,0,1),Kr=new u.Color(0,1,0,1),fh=new u.Color(0,0,1,1),_u=new u.Color(1,0,1,1),mh=new u.Color(0,1,1,1);function _a(h,n,o,c){io(h,0,n+o/2,h.transform.width,o,c)}function ns(h,n,o,c){io(h,n-o/2,0,o,h.transform.height,c)}function io(h,n,o,c,p,g){const x=h.context,S=x.gl;S.enable(S.SCISSOR_TEST),S.scissor(n*h.pixelRatio,o*h.pixelRatio,c*h.pixelRatio,p*h.pixelRatio),x.clear({color:g}),S.disable(S.SCISSOR_TEST)}function af(h,n,o){const c=h.context,p=c.gl,g=o.posMatrix,x=h.useProgram("debug"),S=It.disabled,E=Xt.disabled,I=h.colorModeForRenderPass(),P="$debug",D=h.style.terrain&&h.style.terrain.getTerrainData(o);c.activeTexture.set(p.TEXTURE0),h.emptyTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE);const B=n.getTileByID(o.key).latestRawTileData,Z=Math.floor((B&&B.byteLength||0)/1024),j=n.getTile(o).tileSize,G=512/Math.min(j,512)*(o.overscaledZ/h.transform.zoom)*.5;let re=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(re+=` => ${o.overscaledZ}`),function(se,ce){se.initDebugOverlayCanvas();const W=se.debugOverlayCanvas,fe=se.context.gl,he=se.debugOverlayCanvas.getContext("2d");he.clearRect(0,0,W.width,W.height),he.shadowColor="white",he.shadowBlur=2,he.lineWidth=1.5,he.strokeStyle="white",he.textBaseline="top",he.font="bold 36px Open Sans, sans-serif",he.fillText(ce,5,5),he.strokeText(ce,5,5),se.debugOverlayTexture.update(W),se.debugOverlayTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE)}(h,`${re} ${Z}kB`),x.draw(c,p.TRIANGLES,S,E,Jt.alphaBlended,rn.disabled,Wo(g,u.Color.transparent,G),null,P,h.debugBuffer,h.quadTriangleIndexBuffer,h.debugSegments),x.draw(c,p.LINE_STRIP,S,E,I,rn.disabled,Wo(g,u.Color.red),D,P,h.debugBuffer,h.tileBorderIndexBuffer,h.debugSegments)}function nl(h,n,o){const c=h.context,p=c.gl,g=h.colorModeForRenderPass(),x=new It(p.LEQUAL,It.ReadWrite,h.depthRangeFor3D),S=h.useProgram("terrain"),E=n.getTerrainMesh(),I=n.getTerrainData(o.tileID);c.bindFramebuffer.set(null),c.viewport.set([0,0,h.width,h.height]),c.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,n.getRTTFramebuffer().colorAttachment.get());const P=h.transform.calculatePosMatrix(o.tileID.toUnwrapped());S.draw(c,p.TRIANGLES,x,Xt.disabled,g,rn.backCCW,{u_matrix:P,u_texture:0},I,"terrain",E.vertexBuffer,E.indexBuffer,E.segments)}function gh(h,n,o,c){const p=h.context,g=o.tileSize*n.qualityFactor;o.textures[c]||(o.textures[c]=h.getTileTexture(g)||new ye(p,{width:g,height:g,data:null},p.gl.RGBA),o.textures[c].bind(p.gl.LINEAR,p.gl.CLAMP_TO_EDGE),c===0&&n.sourceCache.renderHistory.unshift(o.tileID.key));const x=n.getRTTFramebuffer();x.colorAttachment.set(o.textures[c].texture),p.bindFramebuffer.set(x.framebuffer),p.viewport.set([0,0,g,g])}class yh{constructor(n){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=n,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=n.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const n=this.painter.style,o=n.terrain;for(const c in n.sourceCaches){this._coordsDescendingInv[c]={};const p=n.sourceCaches[c].getVisibleCoordinates();for(const g of p){const x=o.sourceCache.getTerrainCoords(g);for(const S in x)this._coordsDescendingInv[c][S]||(this._coordsDescendingInv[c][S]=[]),this._coordsDescendingInv[c][S].push(x[S])}}for(const c of n._order){const p=n._layers[c],g=p.source;if(this._renderToTexture[p.type]&&!this._coordsDescendingInvStr[g]){this._coordsDescendingInvStr[g]={};for(const x in this._coordsDescendingInv[g])this._coordsDescendingInvStr[g][x]=this._coordsDescendingInv[g][x].map(S=>S.key).sort().join()}}return this._renderableTiles.forEach(c=>{for(const p in this._coordsDescendingInvStr){const g=this._coordsDescendingInvStr[p][c.tileID.key];g&&g!==c.textureCoords[p]&&c.clearTextures(this.painter),o.needsRerender(p,c.tileID)&&c.clearTextures(this.painter)}this._rerender[c.tileID.key]=!c.textures.length}),o.clearRerenderCache(),o.sourceCache.removeOutdated(this.painter),this}renderLayer(n){const o=n.type,c=this.painter,p=c.style._order,g=c.currentLayer,x=g+1===p.length;if(this._renderToTexture[o]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=o,this._stacks[this._stacks.length-1].push(p[g]),!x))return!0;if(this._renderToTexture[this._prevType]||o==="hillshade"||this._renderToTexture[o]&&x){this._prevType=o;const S=this._stacks.length-1,E=this._stacks[S]||[];for(const I of this._renderableTiles){if(gh(c,c.style.terrain,I,S),this._rerender[I.tileID.key]){c.context.clear({color:u.Color.transparent});for(let P=0;P<E.length;P++){const D=c.style._layers[E[P]],B=D.source?this._coordsDescendingInv[D.source][I.tileID.key]:[I.tileID];c._renderTileClippingMasks(D,B),c.renderLayer(c,c.style.sourceCaches[D.source],D,B),D.source&&(I.textureCoords[D.source]=this._coordsDescendingInvStr[D.source][I.tileID.key])}}nl(c,c.style.terrain,I)}if(o==="hillshade"){this._stacks.push([p[g]]);for(const I of this._renderableTiles){const P=this._coordsDescendingInv[n.source][I.tileID.key];gh(c,c.style.terrain,I,this._stacks.length-1),c.context.clear({color:u.Color.transparent}),c._renderTileClippingMasks(n,P),c.renderLayer(c,c.style.sourceCaches[n.source],n,P),nl(c,c.style.terrain,I)}return!0}return this._renderToTexture[o]}return!1}}const rs={symbol:function(h,n,o,c,p){if(h.renderPass!=="translucent")return;const g=Xt.disabled,x=h.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(S,E,I,P,D,B,Z){const j=E.transform,G=D==="map",re=B==="map";for(const se of S){const ce=P.getTile(se),W=ce.getBucket(I);if(!W||!W.text||!W.text.segments.get().length)continue;const fe=u.evaluateSizeForZoom(W.textSizeData,j.zoom),he=Tn(ce,1,E.transform.zoom),we=da(se.posMatrix,re,G,E.transform,he),Se=I.layout.get("icon-text-fit")!=="none"&&W.hasIconData();if(fe){const Ae=Math.pow(2,j.zoom-ce.tileID.overscaledZ);dh(W,G,re,Z,j,we,se.posMatrix,Ae,fe,Se,E.style.terrain?(ve,We)=>E.style.terrain.getElevation(se,ve,We):null)}}}(c,h,o,n,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),p),o.paint.get("icon-opacity").constantOr(1)!==0&&Qs(h,n,o,c,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),g,x),o.paint.get("text-opacity").constantOr(1)!==0&&Qs(h,n,o,c,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),g,x),n.map.showCollisionBoxes&&(ro(h,n,o,c,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),ro(h,n,o,c,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))},circle:function(h,n,o,c){if(h.renderPass!=="translucent")return;const p=o.paint.get("circle-opacity"),g=o.paint.get("circle-stroke-width"),x=o.paint.get("circle-stroke-opacity"),S=!o.layout.get("circle-sort-key").isConstant();if(p.constantOr(1)===0&&(g.constantOr(1)===0||x.constantOr(1)===0))return;const E=h.context,I=E.gl,P=h.depthModeForSublayer(0,It.ReadOnly),D=Xt.disabled,B=h.colorModeForRenderPass(),Z=[];for(let j=0;j<c.length;j++){const G=c[j],re=n.getTile(G),se=re.getBucket(o);if(!se)continue;const ce=se.programConfigurations.get(o.id),W=h.useProgram("circle",ce),fe=se.layoutVertexBuffer,he=se.indexBuffer,we=h.style.terrain&&h.style.terrain.getTerrainData(G),Se={programConfiguration:ce,program:W,layoutVertexBuffer:fe,indexBuffer:he,uniformValues:eh(h,G,re,o),terrainData:we};if(S){const Ae=se.segments.get();for(const ve of Ae)Z.push({segments:new u.SegmentVector([ve]),sortKey:ve.sortKey,state:Se})}else Z.push({segments:se.segments,sortKey:0,state:Se})}S&&Z.sort((j,G)=>j.sortKey-G.sortKey);for(const j of Z){const{programConfiguration:G,program:re,layoutVertexBuffer:se,indexBuffer:ce,uniformValues:W,terrainData:fe}=j.state;re.draw(E,I.TRIANGLES,P,D,B,rn.disabled,W,fe,o.id,se,ce,j.segments,o.paint,h.transform.zoom,G)}},heatmap:function(h,n,o,c){if(o.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){const p=h.context,g=p.gl,x=Xt.disabled,S=new Jt([g.ONE,g.ONE],u.Color.transparent,[!0,!0,!0,!0]);(function(E,I,P){const D=E.gl;E.activeTexture.set(D.TEXTURE1),E.viewport.set([0,0,I.width/4,I.height/4]);let B=P.heatmapFbo;if(B)D.bindTexture(D.TEXTURE_2D,B.colorAttachment.get()),E.bindFramebuffer.set(B.framebuffer);else{const Z=D.createTexture();D.bindTexture(D.TEXTURE_2D,Z),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_S,D.CLAMP_TO_EDGE),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_T,D.CLAMP_TO_EDGE),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MIN_FILTER,D.LINEAR),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MAG_FILTER,D.LINEAR),B=P.heatmapFbo=E.createFramebuffer(I.width/4,I.height/4,!1),function(j,G,re,se){const ce=j.gl;ce.texImage2D(ce.TEXTURE_2D,0,ce.RGBA,G.width/4,G.height/4,0,ce.RGBA,j.extRenderToTextureHalfFloat?j.extTextureHalfFloat.HALF_FLOAT_OES:ce.UNSIGNED_BYTE,null),se.colorAttachment.set(re)}(E,I,Z,B)}})(p,h,o),p.clear({color:u.Color.transparent});for(let E=0;E<c.length;E++){const I=c[E];if(n.hasRenderableParent(I))continue;const P=n.getTile(I),D=P.getBucket(o);if(!D)continue;const B=D.programConfigurations.get(o.id),Z=h.useProgram("heatmap",B),{zoom:j}=h.transform;Z.draw(p,g.TRIANGLES,It.disabled,x,S,rn.disabled,js(I.posMatrix,P,j,o.paint.get("heatmap-intensity")),null,o.id,D.layoutVertexBuffer,D.indexBuffer,D.segments,o.paint,h.transform.zoom,B)}p.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),function(p,g){const x=p.context,S=x.gl,E=g.heatmapFbo;if(!E)return;x.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,E.colorAttachment.get()),x.activeTexture.set(S.TEXTURE1);let I=g.colorRampTexture;I||(I=g.colorRampTexture=new ye(x,g.colorRamp,S.RGBA)),I.bind(S.LINEAR,S.CLAMP_TO_EDGE),p.useProgram("heatmapTexture").draw(x,S.TRIANGLES,It.disabled,Xt.disabled,p.colorModeForRenderPass(),rn.disabled,((P,D,B,Z)=>{const j=u.create();u.ortho(j,0,P.width,P.height,0,0,1);const G=P.context.gl;return{u_matrix:j,u_world:[G.drawingBufferWidth,G.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:D.paint.get("heatmap-opacity")}})(p,g),null,g.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments,g.paint,p.transform.zoom)}(h,o))},line:function(h,n,o,c){if(h.renderPass!=="translucent")return;const p=o.paint.get("line-opacity"),g=o.paint.get("line-width");if(p.constantOr(1)===0||g.constantOr(1)===0)return;const x=h.depthModeForSublayer(0,It.ReadOnly),S=h.colorModeForRenderPass(),E=o.paint.get("line-dasharray"),I=o.paint.get("line-pattern"),P=I.constantOr(1),D=o.paint.get("line-gradient"),B=o.getCrossfadeParameters(),Z=P?"linePattern":E?"lineSDF":D?"lineGradient":"line",j=h.context,G=j.gl;let re=!0;for(const se of c){const ce=n.getTile(se);if(P&&!ce.patternsLoaded())continue;const W=ce.getBucket(o);if(!W)continue;const fe=W.programConfigurations.get(o.id),he=h.context.program.get(),we=h.useProgram(Z,fe),Se=re||we.program!==he,Ae=h.style.terrain&&h.style.terrain.getTerrainData(se),ve=I.constantOr(null);if(ve&&ce.imageAtlas){const He=ce.imageAtlas,yt=He.patternPositions[ve.to.toString()],bt=He.patternPositions[ve.from.toString()];yt&&bt&&fe.setConstantPatternPositions(yt,bt)}const We=Ae?se:null,Be=P?qs(h,ce,o,B,We):E?Ho(h,ce,o,E,B,We):D?ru(h,ce,o,W.lineClipsArray.length,We):Qa(h,ce,o,We);if(P)j.activeTexture.set(G.TEXTURE0),ce.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),fe.updatePaintBuffers(B);else if(E&&(Se||h.lineAtlas.dirty))j.activeTexture.set(G.TEXTURE0),h.lineAtlas.bind(j);else if(D){const He=W.gradients[o.id];let yt=He.texture;if(o.gradientVersion!==He.version){let bt=256;if(o.stepInterpolant){const at=n.getSource().maxzoom,Nt=se.canonical.z===at?Math.ceil(1<<h.transform.maxZoom-se.canonical.z):1;bt=u.clamp(u.nextPowerOfTwo(W.maxLineLength/u.EXTENT*1024*Nt),256,j.maxTextureSize)}He.gradient=u.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:bt,image:He.gradient||void 0,clips:W.lineClipsArray}),He.texture?He.texture.update(He.gradient):He.texture=new ye(j,He.gradient,G.RGBA),He.version=o.gradientVersion,yt=He.texture}j.activeTexture.set(G.TEXTURE0),yt.bind(o.stepInterpolant?G.NEAREST:G.LINEAR,G.CLAMP_TO_EDGE)}we.draw(j,G.TRIANGLES,x,h.stencilModeForClipping(se),S,rn.disabled,Be,Ae,o.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,o.paint,h.transform.zoom,fe,W.layoutVertexBuffer2),re=!1}},fill:function(h,n,o,c){const p=o.paint.get("fill-color"),g=o.paint.get("fill-opacity");if(g.constantOr(1)===0)return;const x=h.colorModeForRenderPass(),S=o.paint.get("fill-pattern"),E=h.opaquePassEnabledForLayer()&&!S.constantOr(1)&&p.constantOr(u.Color.transparent).a===1&&g.constantOr(0)===1?"opaque":"translucent";if(h.renderPass===E){const I=h.depthModeForSublayer(1,h.renderPass==="opaque"?It.ReadWrite:It.ReadOnly);es(h,n,o,c,I,x,!1)}if(h.renderPass==="translucent"&&o.paint.get("fill-antialias")){const I=h.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,It.ReadOnly);es(h,n,o,c,I,x,!0)}},"fill-extrusion":function(h,n,o,c){const p=o.paint.get("fill-extrusion-opacity");if(p!==0&&h.renderPass==="translucent"){const g=new It(h.context.gl.LEQUAL,It.ReadWrite,h.depthRangeFor3D);if(p!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))ts(h,n,o,c,g,Xt.disabled,Jt.disabled),ts(h,n,o,c,g,h.stencilModeFor3D(),h.colorModeForRenderPass());else{const x=h.colorModeForRenderPass();ts(h,n,o,c,g,Xt.disabled,x)}}},hillshade:function(h,n,o,c){if(h.renderPass!=="offscreen"&&h.renderPass!=="translucent")return;const p=h.context,g=h.depthModeForSublayer(0,It.ReadOnly),x=h.colorModeForRenderPass(),[S,E]=h.renderPass==="translucent"?h.stencilConfigForOverlap(c):[{},c];for(const I of E){const P=n.getTile(I);P.needsHillshadePrepare!==void 0&&P.needsHillshadePrepare&&h.renderPass==="offscreen"?ph(h,P,o,g,Xt.disabled,x):h.renderPass==="translucent"&&yu(h,I,P,o,g,S[I.overscaledZ],x)}p.viewport.set([0,0,h.width,h.height])},raster:function(h,n,o,c){if(h.renderPass!=="translucent"||o.paint.get("raster-opacity")===0||!c.length)return;const p=h.context,g=p.gl,x=n.getSource(),S=h.useProgram("raster"),E=h.colorModeForRenderPass(),[I,P]=x instanceof st?[{},c]:h.stencilConfigForOverlap(c),D=P[P.length-1].overscaledZ,B=!h.options.moving;for(const Z of P){const j=h.depthModeForSublayer(Z.overscaledZ-D,o.paint.get("raster-opacity")===1?It.ReadWrite:It.ReadOnly,g.LESS),G=n.getTile(Z);G.registerFadeDuration(o.paint.get("raster-fade-duration"));const re=n.findLoadedParent(Z,0),se=el(G,re,n,o,h.transform,h.style.terrain);let ce,W;const fe=o.paint.get("raster-resampling")==="nearest"?g.NEAREST:g.LINEAR;p.activeTexture.set(g.TEXTURE0),G.texture.bind(fe,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST),p.activeTexture.set(g.TEXTURE1),re?(re.texture.bind(fe,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST),ce=Math.pow(2,re.tileID.overscaledZ-G.tileID.overscaledZ),W=[G.tileID.canonical.x*ce%1,G.tileID.canonical.y*ce%1]):G.texture.bind(fe,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST);const he=h.style.terrain&&h.style.terrain.getTerrainData(Z),we=he?Z:null,Se=we?we.posMatrix:h.transform.calculatePosMatrix(Z.toUnwrapped(),B),Ae=th(Se,W||[0,0],ce||1,se,o);x instanceof st?S.draw(p,g.TRIANGLES,j,Xt.disabled,E,rn.disabled,Ae,he,o.id,x.boundsBuffer,h.quadTriangleIndexBuffer,x.boundsSegments):S.draw(p,g.TRIANGLES,j,I[Z.overscaledZ],E,rn.disabled,Ae,he,o.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}},background:function(h,n,o,c){const p=o.paint.get("background-color"),g=o.paint.get("background-opacity");if(g===0)return;const x=h.context,S=x.gl,E=h.transform,I=E.tileSize,P=o.paint.get("background-pattern");if(h.isPatternMissing(P))return;const D=!P&&p.a===1&&g===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==D)return;const B=Xt.disabled,Z=h.depthModeForSublayer(0,D==="opaque"?It.ReadWrite:It.ReadOnly),j=h.colorModeForRenderPass(),G=h.useProgram(P?"backgroundPattern":"background"),re=c||E.coveringTiles({tileSize:I,terrain:h.style.terrain});P&&(x.activeTexture.set(S.TEXTURE0),h.imageManager.bind(h.context));const se=o.getCrossfadeParameters();for(const ce of re){const W=c?ce.posMatrix:h.transform.calculatePosMatrix(ce.toUnwrapped()),fe=P?Wp(W,g,h,P,{tileID:ce,tileSize:I},se):Zp(W,g,p),he=h.style.terrain&&h.style.terrain.getTerrainData(ce);G.draw(x,S.TRIANGLES,Z,B,j,rn.disabled,fe,he,o.id,h.tileExtentBuffer,h.quadTriangleIndexBuffer,h.tileExtentSegments)}},debug:function(h,n,o){for(let c=0;c<o.length;c++)af(h,n,o[c])},custom:function(h,n,o){const c=h.context,p=o.implementation;if(h.renderPass==="offscreen"){const g=p.prerender;g&&(h.setCustomLayerDefaults(),c.setColorMode(h.colorModeForRenderPass()),g.call(p,c.gl,h.transform.customLayerMatrix()),c.setDirty(),h.setBaseState())}else if(h.renderPass==="translucent"){h.setCustomLayerDefaults(),c.setColorMode(h.colorModeForRenderPass()),c.setStencilMode(Xt.disabled);const g=p.renderingMode==="3d"?new It(h.context.gl.LEQUAL,It.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,It.ReadOnly);c.setDepthMode(g),p.render(c.gl,h.transform.customLayerMatrix()),c.setDirty(),h.setBaseState(),c.bindFramebuffer.set(null)}}};class vu{constructor(n,o){this.context=new hh(n),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.create(),renderTime:0},this.setup(),this.numSublayers=dr.maxUnderzooming+dr.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new dt,this.gpuTimers={}}resize(n,o,c){if(this.width=n*c,this.height=o*c,this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style._order)this.style._layers[p].resize()}setup(){const n=this.context,o=new u.PosArray;o.emplaceBack(0,0),o.emplaceBack(u.EXTENT,0),o.emplaceBack(0,u.EXTENT),o.emplaceBack(u.EXTENT,u.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(o,zt.members),this.tileExtentSegments=u.SegmentVector.simpleSegment(0,0,4,2);const c=new u.PosArray;c.emplaceBack(0,0),c.emplaceBack(u.EXTENT,0),c.emplaceBack(0,u.EXTENT),c.emplaceBack(u.EXTENT,u.EXTENT),this.debugBuffer=n.createVertexBuffer(c,zt.members),this.debugSegments=u.SegmentVector.simpleSegment(0,0,4,5);const p=new u.RasterBoundsArray;p.emplaceBack(0,0,0,0),p.emplaceBack(u.EXTENT,0,u.EXTENT,0),p.emplaceBack(0,u.EXTENT,0,u.EXTENT),p.emplaceBack(u.EXTENT,u.EXTENT,u.EXTENT,u.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(p,$e.members),this.rasterBoundsSegments=u.SegmentVector.simpleSegment(0,0,4,2);const g=new u.PosArray;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(g,zt.members),this.viewportSegments=u.SegmentVector.simpleSegment(0,0,4,2);const x=new u.LineStripIndexArray;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(x);const S=new u.TriangleIndexArray;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S),this.emptyTexture=new ye(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);const E=this.context.gl;this.stencilClearMode=new Xt({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)}clearStencil(){const n=this.context,o=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=u.create();u.ortho(c,0,this.width,this.height,0,0,1),u.scale(c,c,[o.drawingBufferWidth,o.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,o.TRIANGLES,It.disabled,this.stencilClearMode,Jt.disabled,rn.disabled,Ja(c),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,o){if(this.currentStencilSource===n.source||!n.isTileClipped()||!o||!o.length)return;this.currentStencilSource=n.source;const c=this.context,p=c.gl;this.nextStencilID+o.length>256&&this.clearStencil(),c.setColorMode(Jt.disabled),c.setDepthMode(It.disabled);const g=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const x of o){const S=this._tileClippingMaskIDs[x.key]=this.nextStencilID++,E=this.style.terrain&&this.style.terrain.getTerrainData(x);g.draw(c,p.TRIANGLES,It.disabled,new Xt({func:p.ALWAYS,mask:0},S,255,p.KEEP,p.KEEP,p.REPLACE),Jt.disabled,rn.disabled,Ja(x.posMatrix),E,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,o=this.context.gl;return new Xt({func:o.NOTEQUAL,mask:255},n,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(n){const o=this.context.gl;return new Xt({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,o.KEEP,o.KEEP,o.REPLACE)}stencilConfigForOverlap(n){const o=this.context.gl,c=n.sort((x,S)=>S.overscaledZ-x.overscaledZ),p=c[c.length-1].overscaledZ,g=c[0].overscaledZ-p+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();const x={};for(let S=0;S<g;S++)x[S+p]=new Xt({func:o.GEQUAL,mask:255},S+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=g,[x,c]}return[{[p]:Xt.disabled},c]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new Jt([n.CONSTANT_COLOR,n.ONE],new u.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Jt.unblended:Jt.alphaBlended}depthModeForSublayer(n,o,c){if(!this.opaquePassEnabledForLayer())return It.disabled;const p=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new It(c||this.context.gl.LEQUAL,o,[p,p])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,o){this.style=n,this.options=o,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(u.exported.now()),this.imageManager.beginFrame();const c=this.style._order,p=this.style.sourceCaches,g=this.style.terrain&&new yh(this);for(const I in p){const P=p[I];P.used&&P.prepare(this.context)}const x={},S={},E={};for(const I in p){const P=p[I];x[I]=P.getVisibleCoordinates(),S[I]=x[I].slice().reverse(),E[I]=P.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let I=0;I<c.length;I++)if(this.style._layers[c[I]].is3D()){this.opaquePassCutoff=I;break}if(g){this.opaquePassCutoff=0;const I=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!u.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||I.length)&&(u.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(P,D){const B=P.context,Z=B.gl,j=Jt.unblended,G=new It(Z.LEQUAL,It.ReadWrite,[0,1]),re=D.getTerrainMesh(),se=D.sourceCache.getRenderableTiles(),ce=P.useProgram("terrainDepth");B.bindFramebuffer.set(D.getFramebuffer("depth").framebuffer),B.viewport.set([0,0,P.width/devicePixelRatio,P.height/devicePixelRatio]),B.clear({color:u.Color.transparent,depth:1});for(const W of se){const fe=D.getTerrainData(W.tileID),he=P.transform.calculatePosMatrix(W.tileID.toUnwrapped());ce.draw(B,Z.TRIANGLES,G,Xt.disabled,j,rn.backCCW,{u_matrix:he},fe,"terrain",re.vertexBuffer,re.indexBuffer,re.segments)}B.bindFramebuffer.set(null),B.viewport.set([0,0,P.width,P.height])}(this,this.style.terrain),function(P,D){const B=P.context,Z=B.gl,j=Jt.unblended,G=new It(Z.LEQUAL,It.ReadWrite,[0,1]),re=D.getTerrainMesh(),se=D.getCoordsTexture(),ce=D.sourceCache.getRenderableTiles(),W=P.useProgram("terrainCoords");B.bindFramebuffer.set(D.getFramebuffer("coords").framebuffer),B.viewport.set([0,0,P.width/devicePixelRatio,P.height/devicePixelRatio]),B.clear({color:u.Color.transparent,depth:1}),D.coordsIndex=[];for(const fe of ce){const he=D.getTerrainData(fe.tileID);B.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,se.texture);const we=P.transform.calculatePosMatrix(fe.tileID.toUnwrapped());W.draw(B,Z.TRIANGLES,G,Xt.disabled,j,rn.backCCW,{u_matrix:we,u_terrain_coords_id:(255-D.coordsIndex.length)/255,u_texture:0},he,"terrain",re.vertexBuffer,re.indexBuffer,re.segments),D.coordsIndex.push(fe.tileID.key)}B.bindFramebuffer.set(null),B.viewport.set([0,0,P.width,P.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const I of c){const P=this.style._layers[I];if(!P.hasOffscreenPass()||P.isHidden(this.transform.zoom))continue;const D=S[P.source];(P.type==="custom"||D.length)&&this.renderLayer(this,p[P.source],P,D)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?u.Color.black:u.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!g)for(this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const I=this.style._layers[c[this.currentLayer]],P=p[I.source],D=x[I.source];this._renderTileClippingMasks(I,D),this.renderLayer(this,P,I,D)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const I=this.style._layers[c[this.currentLayer]],P=p[I.source];if(g&&g.renderLayer(I))continue;const D=(I.type==="symbol"?E:S)[I.source];this._renderTileClippingMasks(I,x[I.source]),this.renderLayer(this,P,I,D)}if(this.options.showTileBoundaries){let I,P;Object.values(this.style._layers).forEach(D=>{D.source&&!D.isHidden(this.transform.zoom)&&(D.source!==(P&&P.id)&&(P=this.style.sourceCaches[D.source]),(!I||I.getSource().maxzoom<P.getSource().maxzoom)&&(I=P))}),I&&rs.debug(this,I,I.getVisibleCoordinates())}this.options.showPadding&&function(I){const P=I.transform.padding;_a(I,I.transform.height-(P.top||0),3,tl),_a(I,P.bottom||0,3,Kr),ns(I,P.left||0,3,fh),ns(I,I.transform.width-(P.right||0),3,_u);const D=I.transform.centerPoint;(function(B,Z,j,G){io(B,Z-1,j-10,2,20,G),io(B,Z-10,j-1,20,2,G)})(I,D.x,I.transform.height-D.y,mh)}(this),this.context.setDefault()}renderLayer(n,o,c,p){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(p||[]).length)&&(this.id=c.id,this.gpuTimingStart(c),rs[c.type](n,o,c,p,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;let c=this.gpuTimers[n.id];c||(c=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:o.createQueryEXT()}),c.calls++,o.beginQueryEXT(o.TIME_ELAPSED_EXT,c.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}queryGpuTimers(n){const o={};for(const c in n){const p=n[c],g=this.context.extTimerQuery,x=g.getQueryObjectEXT(p.query,g.QUERY_RESULT_EXT)/1e6;g.deleteQueryEXT(p.query),o[c]=x}return o}translatePosMatrix(n,o,c,p,g){if(!c[0]&&!c[1])return n;const x=g?p==="map"?this.transform.angle:0:p==="viewport"?-this.transform.angle:0;if(x){const I=Math.sin(x),P=Math.cos(x);c=[c[0]*P-c[1]*I,c[0]*I+c[1]*P]}const S=[g?c[0]:Tn(o,c[0],this.transform.zoom),g?c[1]:Tn(o,c[1],this.transform.zoom),0],E=new Float32Array(16);return u.translate(E,n,S),E}saveTileTexture(n){const o=this._tileTextures[n.size[0]];o?o.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const o=this._tileTextures[n];return o&&o.length>0?o.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const o=this.imageManager.getPattern(n.from.toString()),c=this.imageManager.getPattern(n.to.toString());return!o||!c}useProgram(n,o){this.cache=this.cache||{};const c=n+(o?o.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[c]||(this.cache[c]=new Yc(this.context,n,Zo[n],o,au[n],this._showOverdrawInspector,this.style.terrain)),this.cache[c]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ye(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class rl{constructor(n,o){this.points=n,this.planes=o}static fromInvProjectionMatrix(n,o,c){const p=Math.pow(2,c),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const E=1/(S=u.transformMat4([],S,n))[3]/o*p;return u.mul$1(S,S,[E,E,1/S[3],E])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const E=u.sub([],g[S[0]],g[S[1]]),I=u.sub([],g[S[2]],g[S[1]]),P=u.normalize([],u.cross([],E,I)),D=-u.dot(P,g[S[1]]);return P.concat(D)});return new rl(g,x)}}class is{constructor(n,o){this.min=n,this.max=o,this.center=u.scale$1([],u.add([],this.min,this.max),.5)}quadrant(n){const o=[n%2==0,n<2],c=u.clone$2(this.min),p=u.clone$2(this.max);for(let g=0;g<o.length;g++)c[g]=o[g]?this.min[g]:this.center[g],p[g]=o[g]?this.center[g]:this.max[g];return p[2]=this.max[2],new is(c,p)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersects(n){const o=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let c=!0;for(let p=0;p<n.planes.length;p++){const g=n.planes[p];let x=0;for(let S=0;S<o.length;S++)u.dot$1(g,o[S])>=0&&x++;if(x===0)return 0;x!==o.length&&(c=!1)}if(c)return 2;for(let p=0;p<3;p++){let g=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let S=0;S<n.points.length;S++){const E=n.points[S][p]-this.min[p];g=Math.min(g,E),x=Math.max(x,E)}if(x<0||g>this.max[p]-this.min[p])return 0}return 1}}class ao{constructor(n=0,o=0,c=0,p=0){if(isNaN(n)||n<0||isNaN(o)||o<0||isNaN(c)||c<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=o,this.left=c,this.right=p}interpolate(n,o,c){return o.top!=null&&n.top!=null&&(this.top=u.number(n.top,o.top,c)),o.bottom!=null&&n.bottom!=null&&(this.bottom=u.number(n.bottom,o.bottom,c)),o.left!=null&&n.left!=null&&(this.left=u.number(n.left,o.left,c)),o.right!=null&&n.right!=null&&(this.right=u.number(n.right,o.right,c)),this}getCenter(n,o){const c=u.clamp((this.left+n-this.right)/2,0,n),p=u.clamp((this.top+o-this.bottom)/2,0,o);return new u.pointGeometry(c,p)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new ao(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class as{constructor(n,o,c,p,g){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=g===void 0||!!g,this._minZoom=n||0,this._maxZoom=o||22,this._minPitch=c==null?0:c,this._maxPitch=p==null?60:p,this.setMaxBounds(),this.width=0,this.height=0,this._center=new u.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ao,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const n=new as(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n._elevation=this._elevation,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(n){const o=-u.wrap(n,-180,180)*Math.PI/180;var c;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=(c=new u.ARRAY_TYPE(4),u.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c),function(p,g,x){var S=g[0],E=g[1],I=g[2],P=g[3],D=Math.sin(x),B=Math.cos(x);p[0]=S*B+I*D,p[1]=E*B+P*D,p[2]=S*-D+I*B,p[3]=E*-D+P*B}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const o=u.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(n){const o=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,o,c){this._unmodified=!1,this._edgeInsets.interpolate(n,o,c),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const o=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,o)}getVisibleUnwrappedCoordinates(n){const o=[new u.UnwrappedTileID(0,n)];if(this._renderWorldCopies){const c=this.pointCoordinate(new u.pointGeometry(0,0)),p=this.pointCoordinate(new u.pointGeometry(this.width,0)),g=this.pointCoordinate(new u.pointGeometry(this.width,this.height)),x=this.pointCoordinate(new u.pointGeometry(0,this.height)),S=Math.floor(Math.min(c.x,p.x,g.x,x.x)),E=Math.floor(Math.max(c.x,p.x,g.x,x.x)),I=1;for(let P=S-I;P<=E+I;P++)P!==0&&o.push(new u.UnwrappedTileID(P,n))}return o}coveringTiles(n){var o,c;let p=this.coveringZoomLevel(n);const g=p;if(n.minzoom!==void 0&&p<n.minzoom)return[];n.maxzoom!==void 0&&p>n.maxzoom&&(p=n.maxzoom);const x=this.pointCoordinate(this.getCameraPoint()),S=u.MercatorCoordinate.fromLngLat(this.center),E=Math.pow(2,p),I=[E*x.x,E*x.y,0],P=[E*S.x,E*S.y,0],D=rl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p);let B=n.minzoom||0;!n.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(B=p);const Z=n.terrain?2/Math.min(this.tileSize,n.tileSize)*this.tileSize:3,j=W=>({aabb:new is([W*E,0,0],[(W+1)*E,E,0]),zoom:0,x:0,y:0,wrap:W,fullyVisible:!1}),G=[],re=[],se=p,ce=n.reparseOverscaled?g:p;if(this._renderWorldCopies)for(let W=1;W<=3;W++)G.push(j(-W)),G.push(j(W));for(G.push(j(0));G.length>0;){const W=G.pop(),fe=W.x,he=W.y;let we=W.fullyVisible;if(!we){const He=W.aabb.intersects(D);if(He===0)continue;we=He===2}const Se=n.terrain?I:P,Ae=W.aabb.distanceX(Se),ve=W.aabb.distanceY(Se),We=Math.max(Math.abs(Ae),Math.abs(ve)),Be=Z+(1<<se-W.zoom)-2;if(W.zoom===se||We>Be&&W.zoom>=B){const He=se-W.zoom,yt=I[0]-.5-(fe<<He),bt=I[1]-.5-(he<<He);re.push({tileID:new u.OverscaledTileID(W.zoom===se?ce:W.zoom,W.wrap,W.zoom,fe,he),distanceSq:u.sqrLen([P[0]-.5-fe,P[1]-.5-he]),tileDistanceToCamera:Math.sqrt(yt*yt+bt*bt)})}else for(let He=0;He<4;He++){const yt=(fe<<1)+He%2,bt=(he<<1)+(He>>1),at=W.zoom+1;let Nt=W.aabb.quadrant(He);if(n.terrain){const Ut=new u.OverscaledTileID(at,W.wrap,at,yt,bt),Ct=n.terrain.getMinMaxElevation(Ut),Dt=(o=Ct.minElevation)!==null&&o!==void 0?o:this.elevation,jt=(c=Ct.maxElevation)!==null&&c!==void 0?c:this.elevation;Nt=new is([Nt.min[0],Nt.min[1],Dt],[Nt.max[0],Nt.max[1],jt])}G.push({aabb:Nt,zoom:at,x:yt,y:bt,wrap:W.wrap,fullyVisible:we})}}return re.sort((W,fe)=>W.distanceSq-fe.distanceSq).map(W=>W.tileID)}resize(n,o){this.width=n,this.height=o,this.pixelsToGLUnits=[2/n,-2/o],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const o=u.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new u.pointGeometry(u.mercatorXfromLng(n.lng)*this.worldSize,u.mercatorYfromLat(o)*this.worldSize)}unproject(n){return new u.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(n){this.freezeElevation||(this.elevation=n?this.getElevation(this._center,n):0)}getElevation(n,o){const c=u.MercatorCoordinate.fromLngLat(n),p=(1<<this.tileZoom)*u.EXTENT,g=c.x*p,x=c.y*p,S=Math.floor(g/u.EXTENT),E=Math.floor(x/u.EXTENT),I=new u.OverscaledTileID(this.tileZoom,0,this.tileZoom,S,E);return o.getElevation(I,g%u.EXTENT,x%u.EXTENT,u.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(n){const o=this.pointLocation(this.centerPoint,n),c=this.getElevation(o,n);if(!(this.elevation-c))return;const p=this.getCameraPosition(),g=u.MercatorCoordinate.fromLngLat(p.lngLat,p.altitude),x=u.MercatorCoordinate.fromLngLat(o,c),S=g.x-x.x,E=g.y-x.y,I=g.z-x.z,P=Math.sqrt(S*S+E*E+I*I),D=this.scaleZoom(this.cameraToCenterDistance/P/this.tileSize);this._elevation=c,this._center=o,this.zoom=D}setLocationAtPoint(n,o){const c=this.pointCoordinate(o),p=this.pointCoordinate(this.centerPoint),g=this.locationCoordinate(n),x=new u.MercatorCoordinate(g.x-(c.x-p.x),g.y-(c.y-p.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(n,o){return o?this.coordinatePoint(this.locationCoordinate(n),this.getElevation(n,o),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(n))}pointLocation(n,o){return this.coordinateLocation(this.pointCoordinate(n,o))}locationCoordinate(n){return u.MercatorCoordinate.fromLngLat(n)}coordinateLocation(n){return n&&n.toLngLat()}pointCoordinate(n,o){if(o){const B=o.pointCoordinate(n);if(B!=null)return B}const c=[n.x,n.y,0,1],p=[n.x,n.y,1,1];u.transformMat4(c,c,this.pixelMatrixInverse),u.transformMat4(p,p,this.pixelMatrixInverse);const g=c[3],x=p[3],S=c[1]/g,E=p[1]/x,I=c[2]/g,P=p[2]/x,D=I===P?0:(0-I)/(P-I);return new u.MercatorCoordinate(u.number(c[0]/g,p[0]/x,D)/this.worldSize,u.number(S,E,D)/this.worldSize)}coordinatePoint(n,o=0,c=this.pixelMatrix){const p=[n.x*this.worldSize,n.y*this.worldSize,o,1];return u.transformMat4(p,p,c),new u.pointGeometry(p[0]/p[3],p[1]/p[3])}getBounds(){const n=Math.max(0,this.height/2-this.getHorizon());return new u.LngLatBounds().extend(this.pointLocation(new u.pointGeometry(0,n))).extend(this.pointLocation(new u.pointGeometry(this.width,n))).extend(this.pointLocation(new u.pointGeometry(this.width,this.height))).extend(this.pointLocation(new u.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new u.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(n,o=!1){const c=n.key,p=o?this._alignedPosMatrixCache:this._posMatrixCache;if(p[c])return p[c];const g=n.canonical,x=this.worldSize/this.zoomScale(g.z),S=g.x+Math.pow(2,g.z)*n.wrap,E=u.identity(new Float64Array(16));return u.translate(E,E,[S*x,g.y*x,0]),u.scale(E,E,[x/u.EXTENT,x/u.EXTENT,1]),u.multiply(E,o?this.alignedProjMatrix:this.projMatrix,E),p[c]=new Float32Array(E),p[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let n,o,c,p,g=-90,x=90,S=-180,E=180;const I=this.size,P=this._unmodified;if(this.latRange){const Z=this.latRange;g=u.mercatorYfromLat(Z[1])*this.worldSize,x=u.mercatorYfromLat(Z[0])*this.worldSize,n=x-g<I.y?I.y/(x-g):0}if(this.lngRange){const Z=this.lngRange;S=u.wrap(u.mercatorXfromLng(Z[0])*this.worldSize,0,this.worldSize),E=u.wrap(u.mercatorXfromLng(Z[1])*this.worldSize,0,this.worldSize),E<S&&(E+=this.worldSize),o=E-S<I.x?I.x/(E-S):0}const D=this.point,B=Math.max(o||0,n||0);if(B)return this.center=this.unproject(new u.pointGeometry(o?(E+S)/2:D.x,n?(x+g)/2:D.y)),this.zoom+=this.scaleZoom(B),this._unmodified=P,void(this._constraining=!1);if(this.latRange){const Z=D.y,j=I.y/2;Z-j<g&&(p=g+j),Z+j>x&&(p=x-j)}if(this.lngRange){const Z=(S+E)/2,j=u.wrap(D.x,Z-this.worldSize/2,Z+this.worldSize/2),G=I.x/2;j-G<S&&(c=S+G),j+G>E&&(c=E-G)}c===void 0&&p===void 0||(this.center=this.unproject(new u.pointGeometry(c!==void 0?c:D.x,p!==void 0?p:D.y)).wrap()),this._unmodified=P,this._constraining=!1}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,o=this.point.x,c=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=u.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let p=u.identity(new Float64Array(16));u.scale(p,p,[this.width/2,-this.height/2,1]),u.translate(p,p,[1,-1,0]),this.labelPlaneMatrix=p,p=u.identity(new Float64Array(16)),u.scale(p,p,[1,-1,1]),u.translate(p,p,[-1,-1,0]),u.scale(p,p,[2/this.width,2/this.height,1]),this.glCoordMatrix=p,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const g=Math.PI/2+this._pitch,x=this._fov*(.5+n.y/this.height),S=Math.sin(x)*this.cameraToSeaLevelDistance/Math.sin(u.clamp(Math.PI-g-x,.01,Math.PI-.01)),E=this.getHorizon(),I=2*Math.atan(E/this.cameraToCenterDistance)*(.5+n.y/(2*E)),P=Math.sin(I)*this.cameraToSeaLevelDistance/Math.sin(u.clamp(Math.PI-g-I,.01,Math.PI-.01)),D=Math.cos(Math.PI/2-this._pitch)*S+this.cameraToSeaLevelDistance,B=Math.cos(Math.PI/2-this._pitch)*P+this.cameraToSeaLevelDistance,Z=1.01*Math.min(D,B),j=this.height/50;p=new Float64Array(16),u.perspective(p,this._fov,this.width/this.height,j,Z),p[8]=2*-n.x/this.width,p[9]=2*n.y/this.height,u.scale(p,p,[1,-1,1]),u.translate(p,p,[0,0,-this.cameraToCenterDistance]),u.rotateX(p,p,this._pitch),u.rotateZ(p,p,this.angle),u.translate(p,p,[-o,-c,0]),this.mercatorMatrix=u.scale([],p,[this.worldSize,this.worldSize,this.worldSize]),u.scale(p,p,[1,1,this._pixelPerMeter]),this.pixelMatrix=u.multiply(new Float64Array(16),this.labelPlaneMatrix,p),u.translate(p,p,[0,0,-this.elevation]),this.projMatrix=p,this.invProjMatrix=u.invert([],p),this.pixelMatrix3D=u.multiply(new Float64Array(16),this.labelPlaneMatrix,p);const G=this.width%2/2,re=this.height%2/2,se=Math.cos(this.angle),ce=Math.sin(this.angle),W=o-Math.round(o)+se*G+ce*re,fe=c-Math.round(c)+se*re+ce*G,he=new Float64Array(p);if(u.translate(he,he,[W>.5?W-1:W,fe>.5?fe-1:fe,0]),this.alignedProjMatrix=he,p=u.invert(new Float64Array(16),this.pixelMatrix),!p)throw new Error("failed to invert matrix");this.pixelMatrixInverse=p,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const n=this.pointCoordinate(new u.pointGeometry(0,0)),o=[n.x*this.worldSize,n.y*this.worldSize,0,1];return u.transformMat4(o,o,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.pointGeometry(0,n))}getCameraQueryGeometry(n){const o=this.getCameraPoint();if(n.length===1)return[n[0],o];{let c=o.x,p=o.y,g=o.x,x=o.y;for(const S of n)c=Math.min(c,S.x),p=Math.min(p,S.y),g=Math.max(g,S.x),x=Math.max(x,S.y);return[new u.pointGeometry(c,p),new u.pointGeometry(g,p),new u.pointGeometry(g,x),new u.pointGeometry(c,x),new u.pointGeometry(c,p)]}}}class _h{constructor(n){this._hashName=n&&encodeURIComponent(n),u.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(o,c){let p=!1,g=null;const x=()=>{g=null,p&&(o(),g=setTimeout(x,300),p=!1)};return()=>(p=!0,g||x(),g)}(this._updateHashUnthrottled.bind(this))}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(n){const o=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,p=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,p),x=Math.round(o.lng*g)/g,S=Math.round(o.lat*g)/g,E=this._map.getBearing(),I=this._map.getPitch();let P="";if(P+=n?`/${x}/${S}/${c}`:`${c}/${S}/${x}`,(E||I)&&(P+="/"+Math.round(10*E)/10),I&&(P+=`/${Math.round(I)}`),this._hashName){const D=this._hashName;let B=!1;const Z=window.location.hash.slice(1).split("&").map(j=>{const G=j.split("=")[0];return G===D?(B=!0,`${G}=${P}`):j}).filter(j=>j);return B||Z.push(`${D}=${P}`),`#${Z.join("&")}`}return`#${P}`}_getCurrentHash(){const n=window.location.hash.replace("#","");if(this._hashName){let o;return n.split("&").map(c=>c.split("=")).forEach(c=>{c[0]===this._hashName&&(o=c)}),(o&&o[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._getCurrentHash();if(n.length>=3&&!n.some(o=>isNaN(o))){const o=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:o,pitch:+(n[4]||0)}),!0}return!1}_updateHashUnthrottled(){const n=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,n)}catch{}}}const os={linearity:.3,easing:u.bezier(0,0,.3,1)},vh=u.extend({deceleration:2500,maxSpeed:1400},os),xh=u.extend({deceleration:20,maxSpeed:1400},os),wh=u.extend({deceleration:1e3,maxSpeed:360},os),oo=u.extend({deceleration:1e3,maxSpeed:90},os);class bh{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:u.exported.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,o=u.exported.now();for(;n.length>0&&o-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,pan:new u.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:g}of this._inertiaBuffer)o.zoom+=g.zoomDelta||0,o.bearing+=g.bearingDelta||0,o.pitch+=g.pitchDelta||0,g.panDelta&&o.pan._add(g.panDelta),g.around&&(o.around=g.around),g.pinchAround&&(o.pinchAround=g.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(o.pan.mag()){const g=ls(o.pan.mag(),c,u.extend({},vh,n||{}));p.offset=o.pan.mult(g.amount/o.pan.mag()),p.center=this._map.transform.center,ss(p,g)}if(o.zoom){const g=ls(o.zoom,c,xh);p.zoom=this._map.transform.zoom+g.amount,ss(p,g)}if(o.bearing){const g=ls(o.bearing,c,wh);p.bearing=this._map.transform.bearing+u.clamp(g.amount,-179,179),ss(p,g)}if(o.pitch){const g=ls(o.pitch,c,oo);p.pitch=this._map.transform.pitch+g.amount,ss(p,g)}if(p.zoom||p.bearing){const g=o.pinchAround===void 0?o.around:o.pinchAround;p.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),u.extend(p,{noMoveStart:!0})}}function ss(h,n){(!h.duration||h.duration<n.duration)&&(h.duration=n.duration,h.easing=n.easing)}function ls(h,n,o){const{maxSpeed:c,linearity:p,deceleration:g}=o,x=u.clamp(h*p/(n/1e3),-c,c),S=Math.abs(x)/(g*p);return{easing:o.easing,duration:1e3*S,amount:x*(S/2)}}class Ir extends u.Event{constructor(n,o,c,p={}){const g=V.mousePos(o.getCanvasContainer(),c),x=o.unproject(g);super(n,u.extend({point:g,lngLat:x,originalEvent:c},p)),this._defaultPrevented=!1,this.target=o}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class us extends u.Event{constructor(n,o,c){const p=n==="touchend"?c.changedTouches:c.touches,g=V.touchPos(o.getCanvasContainer(),p),x=g.map(E=>o.unproject(E)),S=g.reduce((E,I,P,D)=>E.add(I.div(D.length)),new u.pointGeometry(0,0));super(n,{points:g,point:S,lngLats:x,lngLat:o.unproject(S),originalEvent:c}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Cr extends u.Event{constructor(n,o,c){super(n,{originalEvent:c}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class of{constructor(n,o){this._map=n,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new Cr(n.type,this._map,n))}mousedown(n,o){return this._mousedownPos=o,this._firePreventable(new Ir(n.type,this._map,n))}mouseup(n){this._map.fire(new Ir(n.type,this._map,n))}click(n,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new Ir(n.type,this._map,n))}dblclick(n){return this._firePreventable(new Ir(n.type,this._map,n))}mouseover(n){this._map.fire(new Ir(n.type,this._map,n))}mouseout(n){this._map.fire(new Ir(n.type,this._map,n))}touchstart(n){return this._firePreventable(new us(n.type,this._map,n))}touchmove(n){this._map.fire(new us(n.type,this._map,n))}touchend(n){this._map.fire(new us(n.type,this._map,n))}touchcancel(n){this._map.fire(new us(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ki{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new Ir(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ir("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new Ir(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Sh{constructor(n,o){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,o){this.isEnabled()&&n.shiftKey&&n.button===0&&(V.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(n,o){if(!this._active)return;const c=o;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const p=this._startPos;this._lastPos=c,this._box||(this._box=V.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const g=Math.min(p.x,c.x),x=Math.max(p.x,c.x),S=Math.min(p.y,c.y),E=Math.max(p.y,c.y);V.setTransform(this._box,`translate(${g}px,${S}px)`),this._box.style.width=x-g+"px",this._box.style.height=E-S+"px"}mouseupWindow(n,o){if(!this._active||n.button!==0)return;const c=this._startPos,p=o;if(this.reset(),V.suppressClick(),c.x!==p.x||c.y!==p.y)return this._map.fire(new u.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:g=>g.fitScreenCoordinates(c,p,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(V.remove(this._box),this._box=null),V.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,o){return this._map.fire(new u.Event(n,{originalEvent:o}))}}function Pi(h,n){if(h.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${h.length}, points ${n.length}`);const o={};for(let c=0;c<h.length;c++)o[h[c].identifier]=n[c];return o}class cs{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,o,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),c.length===this.numTouches&&(this.centroid=function(p){const g=new u.pointGeometry(0,0);for(const x of p)g._add(x);return g.div(p.length)}(o),this.touches=Pi(c,o)))}touchmove(n,o,c){if(this.aborted||!this.centroid)return;const p=Pi(c,o);for(const g in this.touches){const x=this.touches[g],S=p[g];(!S||S.dist(x)>30)&&(this.aborted=!0)}}touchend(n,o,c){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class xu{constructor(n){this.singleTap=new cs(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,o,c){this.singleTap.touchstart(n,o,c)}touchmove(n,o,c){this.singleTap.touchmove(n,o,c)}touchend(n,o,c){const p=this.singleTap.touchend(n,o,c);if(p){const g=n.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(p)<30;if(g&&x||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class sf{constructor(){this._zoomIn=new xu({numTouches:1,numTaps:2}),this._zoomOut=new xu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,o,c){this._zoomIn.touchstart(n,o,c),this._zoomOut.touchstart(n,o,c)}touchmove(n,o,c){this._zoomIn.touchmove(n,o,c),this._zoomOut.touchmove(n,o,c)}touchend(n,o,c){const p=this._zoomIn.touchend(n,o,c),g=this._zoomOut.touchend(n,o,c);return p?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()+1,around:x.unproject(p)},{originalEvent:n})}):g?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()-1,around:x.unproject(g)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const lf={0:1,2:2};class il{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(n,o){return!1}_move(n,o){return{}}mousedown(n,o){if(this._lastPoint)return;const c=V.mouseButton(n);this._correctButton(n,c)&&(this._lastPoint=o,this._eventButton=c)}mousemoveWindow(n,o){const c=this._lastPoint;if(c){if(n.preventDefault(),function(p,g){const x=lf[g];return p.buttons===void 0||(p.buttons&x)!==x}(n,this._eventButton))this.reset();else if(this._moved||!(o.dist(c)<this._clickTolerance))return this._moved=!0,this._lastPoint=o,this._move(c,o)}}mouseupWindow(n){this._lastPoint&&V.mouseButton(n)===this._eventButton&&(this._moved&&V.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hs extends il{mousedown(n,o){super.mousedown(n,o),this._lastPoint&&(this._active=!0)}_correctButton(n,o){return o===0&&!n.ctrlKey}_move(n,o){return{around:o,panDelta:o.sub(n)}}}class zi extends il{_correctButton(n,o){return o===0&&n.ctrlKey||o===2}_move(n,o){const c=.8*(o.x-n.x);if(c)return this._active=!0,{bearingDelta:c}}contextmenu(n){n.preventDefault()}}class Ye extends il{_correctButton(n,o){return o===0&&n.ctrlKey||o===2}_move(n,o){const c=-.5*(o.y-n.y);if(c)return this._active=!0,{pitchDelta:c}}contextmenu(n){n.preventDefault()}}class Th{constructor(n,o){this._minTouches=n.cooperativeGestures?2:1,this._clickTolerance=n.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(n,o,c){return this._calculateTransform(n,o,c)}touchmove(n,o,c){if(this._map._cooperativeGestures&&(this._minTouches===2&&c.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(n,!1,c.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(c.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,o,c)}touchend(n,o,c){this._calculateTransform(n,o,c),this._active&&c.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,o,c){c.length>0&&(this._active=!0);const p=Pi(c,o),g=new u.pointGeometry(0,0),x=new u.pointGeometry(0,0);let S=0;for(const I in p){const P=p[I],D=this._touches[I];D&&(g._add(P),x._add(P.sub(D)),S++,p[I]=P)}if(this._touches=p,S<this._minTouches||!x.mag())return;const E=x.div(S);return this._sum._add(E),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(S),panDelta:E}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class va{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(n){}_move(n,o,c){return{}}touchstart(n,o,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([o[0],o[1]]))}touchmove(n,o,c){if(!this._firstTwoTouches)return;n.preventDefault();const[p,g]=this._firstTwoTouches,x=Ji(c,o,p),S=Ji(c,o,g);if(!x||!S)return;const E=this._aroundCenter?null:x.add(S).div(2);return this._move([x,S],E,n)}touchend(n,o,c){if(!this._firstTwoTouches)return;const[p,g]=this._firstTwoTouches,x=Ji(c,o,p),S=Ji(c,o,g);x&&S||(this._active&&V.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ji(h,n,o){for(let c=0;c<h.length;c++)if(h[c].identifier===o)return n[c]}function wu(h,n){return Math.log(h/n)/Math.LN2}class je extends va{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,o){const c=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(wu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:wu(this._distance,c),pinchAround:o}}}function al(h,n){return 180*h.angleWith(n)/Math.PI}class uf extends va{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,o){const c=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:al(this._vector,c),pinchAround:o}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const o=25/(Math.PI*this._minDiameter)*360,c=al(n,this._startVector);return Math.abs(c)<o}}function bu(h){return Math.abs(h.y)>Math.abs(h.x)}class Su extends va{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,o,c){super.touchstart(n,o,c),this._currentTouchCount=c.length}_start(n){this._lastPoints=n,bu(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,o,c){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const p=n[0].sub(this._lastPoints[0]),g=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,g,c.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(p.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(n,o,c){if(this._valid!==void 0)return this._valid;const p=n.mag()>=2,g=o.mag()>=2;if(!p&&!g)return;if(!p||!g)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const x=n.y>0==o.y>0;return bu(n)&&bu(o)&&x}}const Eh={panStep:100,bearingStep:15,pitchStep:10};class kh{constructor(){const n=Eh;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let o=0,c=0,p=0,g=0,x=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?c=-1:(n.preventDefault(),g=-1);break;case 39:n.shiftKey?c=1:(n.preventDefault(),g=1);break;case 38:n.shiftKey?p=1:(n.preventDefault(),x=-1);break;case 40:n.shiftKey?p=-1:(n.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(c=0,p=0),{cameraAnimation:S=>{const E=S.getZoom();S.easeTo({duration:300,easeId:"keyboardHandler",easing:cf,zoom:o?Math.round(E)+o*(n.shiftKey?2:1):E,bearing:S.getBearing()+c*this._bearingStep,pitch:S.getPitch()+p*this._pitchStep,offset:[-g*this._panStep,-x*this._panStep],center:S.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function cf(h){return h*(2-h)}const Ih=4.000244140625;class Tu{constructor(n,o){this._map=n,this._el=n.getCanvasContainer(),this._handler=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,u.bindAll(["_onTimeout"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;n.preventDefault()}let o=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const c=u.exported.now(),p=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,o!==0&&o%Ih==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(p*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),n.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=n,this._delta-=o,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=V.mousePos(this._el,n);this._around=u.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(o)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform;if(this._delta!==0){const S=this._type==="wheel"&&Math.abs(this._delta)>Ih?this._wheelZoomRate:this._defaultZoomRate;let E=2/(1+Math.exp(-Math.abs(this._delta*S)));this._delta<0&&E!==0&&(E=1/E);const I=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(I*E))),this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom=="number"?this._targetZoom:n.zoom,c=this._startZoom,p=this._easing;let g,x=!1;if(this._type==="wheel"&&c&&p){const S=Math.min((u.exported.now()-this._lastWheelEventTime)/200,1),E=p(S);g=u.number(c,o,E),S<1?this._frameId||(this._frameId=!0):x=!0}else g=o,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!x,zoomDelta:g-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let o=u.ease;if(this._prevEase){const c=this._prevEase,p=(u.exported.now()-c.start)/c.duration,g=c.easing(p+.01)-c.easing(p),x=.27/Math.sqrt(g*g+1e-4)*.01,S=Math.sqrt(.0729-x*x);o=u.bezier(x,S,.25,1)}return this._prevEase={start:u.exported.now(),duration:n,easing:o},o}reset(){this._active=!1}}class Eu{constructor(n,o){this._clickZoom=n,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ku{constructor(){this.reset()}reset(){this._active=!1}dblclick(n,o){return n.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:c.getZoom()+(n.shiftKey?-1:1),around:c.unproject(o)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Iu{constructor(){this._tap=new xu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(n,o,c){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?c.length>0&&(this._swipePoint=o[0],this._swipeTouch=c[0].identifier):this._tap.touchstart(n,o,c))}touchmove(n,o,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const p=o[0],g=p.y-this._swipePoint.y;return this._swipePoint=p,n.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(n,o,c)}touchend(n,o,c){this._tapTime?this._swipePoint&&c.length===0&&this.reset():this._tap.touchend(n,o,c)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pr{constructor(n,o,c){this._el=n,this._mousePan=o,this._touchPan=c}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Qi{constructor(n,o,c){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=o,this._mousePitch=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ch{constructor(n,o,c,p){this._el=n,this._touchZoom=o,this._touchRotate=c,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const so=h=>h.zoom||h.drag||h.pitch||h.rotate;class Cu extends u.Event{}function ds(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class Ah{constructor(n,o){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new bh(n),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o),u.bindAll(["handleEvent","handleWindowEvent"],this);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,g,x]of this._listeners)V.addEventListener(p,g,p===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[n,o,c]of this._listeners)V.removeEventListener(n,o,n===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(n){const o=this._map,c=o.getCanvasContainer();this._add("mapEvent",new of(o,n));const p=o.boxZoom=new Sh(o,n);this._add("boxZoom",p);const g=new sf,x=new ku;o.doubleClickZoom=new Eu(x,g),this._add("tapZoom",g),this._add("clickZoom",x);const S=new Iu;this._add("tapDragZoom",S);const E=o.touchPitch=new Su(o);this._add("touchPitch",E);const I=new zi(n),P=new Ye(n);o.dragRotate=new Qi(n,I,P),this._add("mouseRotate",I,["mousePitch"]),this._add("mousePitch",P,["mouseRotate"]);const D=new hs(n),B=new Th(n,o);o.dragPan=new pr(c,D,B),this._add("mousePan",D),this._add("touchPan",B,["touchZoom","touchRotate"]);const Z=new uf,j=new je;o.touchZoomRotate=new Ch(c,j,Z,S),this._add("touchRotate",Z,["touchPan","touchZoom"]),this._add("touchZoom",j,["touchPan","touchRotate"]);const G=o.scrollZoom=new Tu(o,this);this._add("scrollZoom",G,["mousePan"]);const re=o.keyboard=new kh;this._add("keyboard",re),this._add("blockableMapEvent",new Ki(o));for(const se of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[se]&&o[se].enable(n[se])}_add(n,o,c){this._handlers.push({handlerName:n,handler:o,allowed:c}),this._handlersById[n]=o}stop(n){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(so(this._eventsInProgress))||this.isZooming()}_blockedByActive(n,o,c){for(const p in n)if(p!==c&&(!o||o.indexOf(p)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const o=[];for(const c of n)this._el.contains(c.target)&&o.push(c);return o}handleEvent(n,o){if(n.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const c=n.type==="renderFrame"?void 0:n,p={needsRenderFrame:!1},g={},x={},S=n.touches,E=S?this._getMapTouches(S):void 0,I=E?V.touchPos(this._el,E):V.mousePos(this._el,n);for(const{handlerName:B,handler:Z,allowed:j}of this._handlers){if(!Z.isEnabled())continue;let G;this._blockedByActive(x,j,B)?Z.reset():Z[o||n.type]&&(G=Z[o||n.type](n,I,E),this.mergeHandlerResult(p,g,G,B,c),G&&G.needsRenderFrame&&this._triggerRenderFrame()),(G||Z.isActive())&&(x[B]=Z)}const P={};for(const B in this._previousActiveHandlers)x[B]||(P[B]=c);this._previousActiveHandlers=x,(Object.keys(P).length||ds(p))&&(this._changes.push([p,g,P]),this._triggerRenderFrame()),(Object.keys(x).length||ds(p))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:D}=p;D&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],D(this._map))}mergeHandlerResult(n,o,c,p,g){if(!c)return;u.extend(n,c);const x={handlerName:p,originalEvent:c.originalEvent||g};c.zoomDelta!==void 0&&(o.zoom=x),c.panDelta!==void 0&&(o.drag=x),c.pitchDelta!==void 0&&(o.pitch=x),c.bearingDelta!==void 0&&(o.rotate=x)}_applyChanges(){const n={},o={},c={};for(const[p,g,x]of this._changes)p.panDelta&&(n.panDelta=(n.panDelta||new u.pointGeometry(0,0))._add(p.panDelta)),p.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+p.pitchDelta),p.around!==void 0&&(n.around=p.around),p.pinchAround!==void 0&&(n.pinchAround=p.pinchAround),p.noInertia&&(n.noInertia=p.noInertia),u.extend(o,g),u.extend(c,x);this._updateMapTransform(n,o,c),this._changes=[]}_updateMapTransform(n,o,c){const p=this._map,g=p.transform,x=p.style&&p.style.terrain;if(!(ds(n)||x&&this._drag))return this._fireEvents(o,c,!0);let{panDelta:S,zoomDelta:E,bearingDelta:I,pitchDelta:P,around:D,pinchAround:B}=n;B!==void 0&&(D=B),p._stop(!0),D=D||p.transform.centerPoint;const Z=g.pointLocation(S?D.sub(S):D);I&&(g.bearing+=I),P&&(g.pitch+=P),E&&(g.zoom+=E),x?o.drag&&!this._drag?(this._drag={center:g.centerPoint,lngLat:g.pointLocation(D),point:D,handlerName:o.drag.handlerName},p.fire(new u.Event("freezeElevation",{freeze:!0}))):this._drag&&c[this._drag.handlerName]?(p.fire(new u.Event("freezeElevation",{freeze:!1})),this._drag=null):o.drag&&this._drag&&(g.center=g.pointLocation(g.centerPoint.sub(S))):g.setLocationAtPoint(Z,D),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(o,c,!0)}_fireEvents(n,o,c){const p=so(this._eventsInProgress),g=so(n),x={};for(const P in n){const{originalEvent:D}=n[P];this._eventsInProgress[P]||(x[`${P}start`]=D),this._eventsInProgress[P]=n[P]}!p&&g&&this._fireEvent("movestart",g.originalEvent);for(const P in x)this._fireEvent(P,x[P]);g&&this._fireEvent("move",g.originalEvent);for(const P in n){const{originalEvent:D}=n[P];this._fireEvent(P,D)}const S={};let E;for(const P in this._eventsInProgress){const{handlerName:D,originalEvent:B}=this._eventsInProgress[P];this._handlersById[D].isActive()||(delete this._eventsInProgress[P],E=o[D]||B,S[`${P}end`]=E)}for(const P in S)this._fireEvent(P,S[P]);const I=so(this._eventsInProgress);if(c&&(p||g)&&!I){this._updatingCamera=!0;const P=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),D=B=>B!==0&&-this._bearingSnap<B&&B<this._bearingSnap;P?(D(P.bearing||this._map.getBearing())&&(P.bearing=0),this._map.easeTo(P,{originalEvent:E})):(this._map.fire(new u.Event("moveend",{originalEvent:E})),D(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,o){this._map.fire(new u.Event(n,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new Cu("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ur={extend:(h,...n)=>u.extend(h,...n),run(h){h()},logToElement(h,n=!1,o="log"){const c=window.document.getElementById(o);c&&(n&&(c.innerHTML=""),c.innerHTML+=`<br>${h}`)}};class an extends u.Evented{constructor(n,o){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=o.bearingSnap,u.bindAll(["_renderFrameCallback"],this)}getCenter(){return new u.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(n,o){return this.jumpTo({center:n},o)}panBy(n,o,c){return n=u.pointGeometry.convert(n).mult(-1),this.panTo(this.transform.center,u.extend({offset:n},o),c)}panTo(n,o,c){return this.easeTo(u.extend({center:n},o),c)}getZoom(){return this.transform.zoom}setZoom(n,o){return this.jumpTo({zoom:n},o),this}zoomTo(n,o,c){return this.easeTo(u.extend({zoom:n},o),c)}zoomIn(n,o){return this.zoomTo(this.getZoom()+1,n,o),this}zoomOut(n,o){return this.zoomTo(this.getZoom()-1,n,o),this}getBearing(){return this.transform.bearing}setBearing(n,o){return this.jumpTo({bearing:n},o),this}getPadding(){return this.transform.padding}setPadding(n,o){return this.jumpTo({padding:n},o),this}rotateTo(n,o,c){return this.easeTo(u.extend({bearing:n},o),c)}resetNorth(n,o){return this.rotateTo(0,u.extend({duration:1e3},n),o),this}resetNorthPitch(n,o){return this.easeTo(u.extend({bearing:0,pitch:0,duration:1e3},n),o),this}snapToNorth(n,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,o):this}getPitch(){return this.transform.pitch}setPitch(n,o){return this.jumpTo({pitch:n},o),this}cameraForBounds(n,o){n=u.LngLatBounds.convert(n);const c=o&&o.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),c,o)}_cameraForBoxAndBearing(n,o,c,p){const g={top:0,bottom:0,right:0,left:0};if(typeof(p=u.extend({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},p)).padding=="number"){const he=p.padding;p.padding={top:he,bottom:he,right:he,left:he}}p.padding=u.extend(g,p.padding);const x=this.transform,S=x.padding,E=x.project(u.LngLat.convert(n)),I=x.project(u.LngLat.convert(o)),P=E.rotate(-c*Math.PI/180),D=I.rotate(-c*Math.PI/180),B=new u.pointGeometry(Math.max(P.x,D.x),Math.max(P.y,D.y)),Z=new u.pointGeometry(Math.min(P.x,D.x),Math.min(P.y,D.y)),j=B.sub(Z),G=(x.width-(S.left+S.right+p.padding.left+p.padding.right))/j.x,re=(x.height-(S.top+S.bottom+p.padding.top+p.padding.bottom))/j.y;if(re<0||G<0)return void u.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const se=Math.min(x.scaleZoom(x.scale*Math.min(G,re)),p.maxZoom),ce=u.pointGeometry.convert(p.offset),W=new u.pointGeometry((p.padding.left-p.padding.right)/2,(p.padding.top-p.padding.bottom)/2).rotate(c*Math.PI/180),fe=ce.add(W).mult(x.scale/x.zoomScale(se));return{center:x.unproject(E.add(I).div(2).sub(fe)),zoom:se,bearing:c}}fitBounds(n,o,c){return this._fitInternal(this.cameraForBounds(n,o),o,c)}fitScreenCoordinates(n,o,c,p,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(u.pointGeometry.convert(n)),this.transform.pointLocation(u.pointGeometry.convert(o)),c,p),p,g)}_fitInternal(n,o,c){return n?(delete(o=u.extend(n,o)).padding,o.linear?this.easeTo(o,c):this.flyTo(o,c)):this}jumpTo(n,o){this.stop();const c=this.transform;let p=!1,g=!1,x=!1;return"zoom"in n&&c.zoom!==+n.zoom&&(p=!0,c.zoom=+n.zoom),n.center!==void 0&&(c.center=u.LngLat.convert(n.center)),"bearing"in n&&c.bearing!==+n.bearing&&(g=!0,c.bearing=+n.bearing),"pitch"in n&&c.pitch!==+n.pitch&&(x=!0,c.pitch=+n.pitch),n.padding==null||c.isPaddingEqual(n.padding)||(c.padding=n.padding),this.fire(new u.Event("movestart",o)).fire(new u.Event("move",o)),p&&this.fire(new u.Event("zoomstart",o)).fire(new u.Event("zoom",o)).fire(new u.Event("zoomend",o)),g&&this.fire(new u.Event("rotatestart",o)).fire(new u.Event("rotate",o)).fire(new u.Event("rotateend",o)),x&&this.fire(new u.Event("pitchstart",o)).fire(new u.Event("pitch",o)).fire(new u.Event("pitchend",o)),this.fire(new u.Event("moveend",o))}calculateCameraOptionsFromTo(n,o,c,p=0){const g=u.MercatorCoordinate.fromLngLat(n,o),x=u.MercatorCoordinate.fromLngLat(c,p),S=x.x-g.x,E=x.y-g.y,I=x.z-g.z,P=Math.hypot(S,E,I);if(P===0)throw new Error("Can't calculate camera options with same From and To");const D=Math.hypot(S,E),B=this.transform.scaleZoom(this.transform.cameraToCenterDistance/P/this.transform.tileSize),Z=180*Math.atan2(S,-E)/Math.PI;let j=180*Math.acos(D/P)/Math.PI;return j=I<0?90-j:90+j,{center:x.toLngLat(),zoom:B,pitch:j,bearing:Z}}easeTo(n,o){this._stop(!1,n.easeId),((n=u.extend({offset:[0,0],duration:500,easing:u.ease},n)).animate===!1||!n.essential&&u.exported.prefersReducedMotion)&&(n.duration=0);const c=this.transform,p=this.getZoom(),g=this.getBearing(),x=this.getPitch(),S=this.getPadding(),E="zoom"in n?+n.zoom:p,I="bearing"in n?this._normalizeBearing(n.bearing,g):g,P="pitch"in n?+n.pitch:x,D="padding"in n?n.padding:c.padding,B=u.pointGeometry.convert(n.offset);let Z=c.centerPoint.add(B);const j=c.pointLocation(Z),G=u.LngLat.convert(n.center||j);this._normalizeCenter(G);const re=c.project(j),se=c.project(G).sub(re),ce=c.zoomScale(E-p);let W,fe;n.around&&(W=u.LngLat.convert(n.around),fe=c.locationPoint(W));const he={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||E!==p,this._rotating=this._rotating||g!==I,this._pitching=this._pitching||P!==x,this._padding=!c.isPaddingEqual(D),this._easeId=n.easeId,this._prepareEase(o,n.noMoveStart,he),this._ease(we=>{if(this._zooming&&(c.zoom=u.number(p,E,we)),this._rotating&&(c.bearing=u.number(g,I,we)),this._pitching&&(c.pitch=u.number(x,P,we)),this._padding&&(c.interpolatePadding(S,D,we),Z=c.centerPoint.add(B)),W)c.setLocationAtPoint(W,fe);else{const Se=c.zoomScale(c.zoom-p),Ae=E>p?Math.min(2,ce):Math.max(.5,ce),ve=Math.pow(Ae,1-we),We=c.unproject(re.add(se.mult(we*ve)).mult(Se));c.setLocationAtPoint(c.renderWorldCopies?We.wrap():We,Z)}this._fireMoveEvents(o)},we=>{this._afterEase(o,we)},n),this}_prepareEase(n,o,c={}){this._moving=!0,this.fire(new u.Event("freezeElevation",{freeze:!0})),o||c.moving||this.fire(new u.Event("movestart",n)),this._zooming&&!c.zooming&&this.fire(new u.Event("zoomstart",n)),this._rotating&&!c.rotating&&this.fire(new u.Event("rotatestart",n)),this._pitching&&!c.pitching&&this.fire(new u.Event("pitchstart",n))}_fireMoveEvents(n){this.fire(new u.Event("move",n)),this._zooming&&this.fire(new u.Event("zoom",n)),this._rotating&&this.fire(new u.Event("rotate",n)),this._pitching&&this.fire(new u.Event("pitch",n))}_afterEase(n,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId,this.fire(new u.Event("freezeElevation",{freeze:!1}));const c=this._zooming,p=this._rotating,g=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,c&&this.fire(new u.Event("zoomend",n)),p&&this.fire(new u.Event("rotateend",n)),g&&this.fire(new u.Event("pitchend",n)),this.fire(new u.Event("moveend",n))}flyTo(n,o){if(!n.essential&&u.exported.prefersReducedMotion){const at=u.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(at,o)}this.stop(),n=u.extend({offset:[0,0],speed:1.2,curve:1.42,easing:u.ease},n);const c=this.transform,p=this.getZoom(),g=this.getBearing(),x=this.getPitch(),S=this.getPadding(),E="zoom"in n?u.clamp(+n.zoom,c.minZoom,c.maxZoom):p,I="bearing"in n?this._normalizeBearing(n.bearing,g):g,P="pitch"in n?+n.pitch:x,D="padding"in n?n.padding:c.padding,B=c.zoomScale(E-p),Z=u.pointGeometry.convert(n.offset);let j=c.centerPoint.add(Z);const G=c.pointLocation(j),re=u.LngLat.convert(n.center||G);this._normalizeCenter(re);const se=c.project(G),ce=c.project(re).sub(se);let W=n.curve;const fe=Math.max(c.width,c.height),he=fe/B,we=ce.mag();if("minZoom"in n){const at=u.clamp(Math.min(n.minZoom,p,E),c.minZoom,c.maxZoom),Nt=fe/c.zoomScale(at-p);W=Math.sqrt(Nt/we*2)}const Se=W*W;function Ae(at){const Nt=(he*he-fe*fe+(at?-1:1)*Se*Se*we*we)/(2*(at?he:fe)*Se*we);return Math.log(Math.sqrt(Nt*Nt+1)-Nt)}function ve(at){return(Math.exp(at)-Math.exp(-at))/2}function We(at){return(Math.exp(at)+Math.exp(-at))/2}const Be=Ae(0);let He=function(at){return We(Be)/We(Be+W*at)},yt=function(at){return fe*((We(Be)*(ve(Nt=Be+W*at)/We(Nt))-ve(Be))/Se)/we;var Nt},bt=(Ae(1)-Be)/W;if(Math.abs(we)<1e-6||!isFinite(bt)){if(Math.abs(fe-he)<1e-6)return this.easeTo(n,o);const at=he<fe?-1:1;bt=Math.abs(Math.log(he/fe))/W,yt=function(){return 0},He=function(Nt){return Math.exp(at*W*Nt)}}return n.duration="duration"in n?+n.duration:1e3*bt/("screenSpeed"in n?+n.screenSpeed/W:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=g!==I,this._pitching=P!==x,this._padding=!c.isPaddingEqual(D),this._prepareEase(o,!1),this._ease(at=>{const Nt=at*bt,Ut=1/He(Nt);c.zoom=at===1?E:p+c.scaleZoom(Ut),this._rotating&&(c.bearing=u.number(g,I,at)),this._pitching&&(c.pitch=u.number(x,P,at)),this._padding&&(c.interpolatePadding(S,D,at),j=c.centerPoint.add(Z));const Ct=at===1?re:c.unproject(se.add(ce.mult(yt(Nt))).mult(Ut));c.setLocationAtPoint(c.renderWorldCopies?Ct.wrap():Ct,j),this._fireMoveEvents(o)},()=>this._afterEase(o),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,o){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const c=this._onEaseEnd;delete this._onEaseEnd,c.call(this,o)}if(!n){const c=this.handlers;c&&c.stop(!1)}return this}_ease(n,o,c){c.animate===!1||c.duration===0?(n(1),o()):(this._easeStart=u.exported.now(),this._easeOptions=c,this._onEaseFrame=n,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((u.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,o){n=u.wrap(n,-180,180);const c=Math.abs(n-o);return Math.abs(n-360-o)<c&&(n-=360),Math.abs(n+360-o)<c&&(n+=360),n}_normalizeCenter(n){const o=this.transform;if(!o.renderWorldCopies||o.lngRange)return;const c=n.lng-o.center.lng;n.lng+=c>180?-360:c<-180?360:0}}class ps{constructor(n={}){this.options=n,u.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options&&this.options.compact,this._container=V.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=V.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=V.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){V.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,o){const c=this._map._getUIString(`AttributionControl.${o}`);n.title=c,n.setAttribute("aria-label",c)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"&&n.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(p=>typeof p!="string"?"":p)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const o=this._map.style.sourceCaches;for(const p in o){const g=o[p];if(g.used||g.usedForTerrain){const x=g.getSource();x.attribution&&n.indexOf(x.attribution)<0&&n.push(x.attribution)}}n=n.filter(p=>String(p).trim()),n.sort((p,g)=>p.length-g.length),n=n.filter((p,g)=>{for(let x=g+1;x<n.length;x++)if(n[x].indexOf(p)>=0)return!1;return!0});const c=n.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,n.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class ol{constructor(n={}){this.options=n,u.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=V.create("div","maplibregl-ctrl mapboxgl-ctrl");const o=V.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){V.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const n=this._container.children;if(n.length){const o=n[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&o.classList.add("maplibregl-compact","mapboxgl-compact"):o.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class Ph{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const o=++this._id;return this._queue.push({callback:n,id:o,cancelled:!1}),o}remove(n){const o=this._currentlyRunning,c=o?this._queue.concat(o):this._queue;for(const p of c)if(p.id===n)return void(p.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const c of o)if(!c.cancelled&&(c.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const zh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},Mh={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},hf={showCompass:!0,showZoom:!0,visualizePitch:!1};class pi{constructor(n,o,c=!1){this._clickTolerance=10,this.element=o,this.mouseRotate=new zi({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,c&&(this.mousePitch=new Ye({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),u.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),V.addEventListener(o,"mousedown",this.mousedown),V.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),V.addEventListener(o,"touchmove",this.touchmove),V.addEventListener(o,"touchend",this.touchend),V.addEventListener(o,"touchcancel",this.reset)}down(n,o){this.mouseRotate.mousedown(n,o),this.mousePitch&&this.mousePitch.mousedown(n,o),V.disableDrag()}move(n,o){const c=this.map,p=this.mouseRotate.mousemoveWindow(n,o);if(p&&p.bearingDelta&&c.setBearing(c.getBearing()+p.bearingDelta),this.mousePitch){const g=this.mousePitch.mousemoveWindow(n,o);g&&g.pitchDelta&&c.setPitch(c.getPitch()+g.pitchDelta)}}off(){const n=this.element;V.removeEventListener(n,"mousedown",this.mousedown),V.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),V.removeEventListener(n,"touchmove",this.touchmove),V.removeEventListener(n,"touchend",this.touchend),V.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){V.enableDrag(),V.removeEventListener(window,"mousemove",this.mousemove),V.removeEventListener(window,"mouseup",this.mouseup)}mousedown(n){this.down(u.extend({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),V.mousePos(this.element,n)),V.addEventListener(window,"mousemove",this.mousemove),V.addEventListener(window,"mouseup",this.mouseup)}mousemove(n){this.move(n,V.mousePos(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=V.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=V.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function fs(h,n,o){if(h=new u.LngLat(h.lng,h.lat),n){const c=new u.LngLat(h.lng-360,h.lat),p=new u.LngLat(h.lng+360,h.lat),g=o.locationPoint(h).distSqr(n);o.locationPoint(c).distSqr(n)<g?h=c:o.locationPoint(p).distSqr(n)<g&&(h=p)}for(;Math.abs(h.lng-o.center.lng)>180;){const c=o.locationPoint(h);if(c.x>=0&&c.y>=0&&c.x<=o.width&&c.y<=o.height)break;h.lng>o.center.lng?h.lng-=360:h.lng+=360}return h}const tt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ct(h,n,o){const c=h.classList;for(const p in tt)c.remove(`maplibregl-${o}-anchor-${p}`,`mapboxgl-${o}-anchor-${p}`);c.add(`maplibregl-${o}-anchor-${n}`,`mapboxgl-${o}-anchor-${n}`)}class lo extends u.Evented{constructor(n,o){if(super(),(n instanceof HTMLElement||o)&&(n=u.extend({element:n},o)),u.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=u.pointGeometry.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=V.create("div"),this._element.setAttribute("aria-label","Map marker");const c=V.createNS("http://www.w3.org/2000/svg","svg"),p=41,g=27;c.setAttributeNS(null,"display","block"),c.setAttributeNS(null,"height",`${p}px`),c.setAttributeNS(null,"width",`${g}px`),c.setAttributeNS(null,"viewBox",`0 0 ${g} ${p}`);const x=V.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const S=V.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const E=V.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"transform","translate(3.0, 29.0)"),E.setAttributeNS(null,"fill","#000000");const I=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ce of I){const W=V.createNS("http://www.w3.org/2000/svg","ellipse");W.setAttributeNS(null,"opacity","0.04"),W.setAttributeNS(null,"cx","10.5"),W.setAttributeNS(null,"cy","5.80029008"),W.setAttributeNS(null,"rx",ce.rx),W.setAttributeNS(null,"ry",ce.ry),E.appendChild(W)}const P=V.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill",this._color);const D=V.createNS("http://www.w3.org/2000/svg","path");D.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),P.appendChild(D);const B=V.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"opacity","0.25"),B.setAttributeNS(null,"fill","#000000");const Z=V.createNS("http://www.w3.org/2000/svg","path");Z.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),B.appendChild(Z);const j=V.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"transform","translate(6.0, 7.0)"),j.setAttributeNS(null,"fill","#FFFFFF");const G=V.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(8.0, 8.0)");const re=V.createNS("http://www.w3.org/2000/svg","circle");re.setAttributeNS(null,"fill","#000000"),re.setAttributeNS(null,"opacity","0.25"),re.setAttributeNS(null,"cx","5.5"),re.setAttributeNS(null,"cy","5.5"),re.setAttributeNS(null,"r","5.4999962");const se=V.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#FFFFFF"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962"),G.appendChild(re),G.appendChild(se),S.appendChild(E),S.appendChild(P),S.appendChild(B),S.appendChild(j),S.appendChild(G),c.appendChild(S),c.setAttributeNS(null,"height",p*this._scale+"px"),c.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(c),this._offset=u.pointGeometry.convert(n&&n.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",c=>{c.preventDefault()}),this._element.addEventListener("mousedown",c=>{c.preventDefault()}),ct(this._element,this._anchor,"marker"),this._popup=null}addTo(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),V.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=u.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const p=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(n){const o=n.code,c=n.charCode||n.keyCode;o!=="Space"&&o!=="Enter"&&c!==32&&c!==13||this.togglePopup()}_onMapClick(n){const o=n.originalEvent.target,c=this._element;this._popup&&(o===c||c.contains(o))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this}_update(n){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=fs(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let o="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?o=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(o=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let c="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?c="rotateX(0deg)":this._pitchAlignment==="map"&&(c=`rotateX(${this._map.getPitch()}deg)`),n&&n.type!=="moveend"||(this._pos=this._pos.round()),V.setTransform(this._element,`${tt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${c} ${o}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const p=this._map.unproject(this._pos),g=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=p.distanceTo(this._lngLat)>20*g?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(n){return this._offset=u.pointGeometry.convert(n),this._update(),this}_onMove(n){if(!this._isDragging){const o=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=o}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.Event("dragstart"))),this.fire(new u.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.Event("dragend")),this._state="inactive"}_addDragHandler(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Au={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ea,Gn=0,ta=!1;const fi={maxWidth:100,unit:"metric"};function Dh(h,n,o){const c=o&&o.maxWidth||100,p=h._container.clientHeight/2,g=h.unproject([0,p]),x=h.unproject([c,p]),S=g.distanceTo(x);if(o&&o.unit==="imperial"){const E=3.2808*S;E>5280?na(n,c,E/5280,h._getUIString("ScaleControl.Miles")):na(n,c,E,h._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?na(n,c,S/1852,h._getUIString("ScaleControl.NauticalMiles")):S>=1e3?na(n,c,S/1e3,h._getUIString("ScaleControl.Kilometers")):na(n,c,S,h._getUIString("ScaleControl.Meters"))}function na(h,n,o,c){const p=function(g){const x=Math.pow(10,`${Math.floor(g)}`.length-1);let S=g/x;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(E){const I=Math.pow(10,Math.ceil(-Math.log(E)/Math.LN10));return Math.round(E*I)/I}(S),x*S}(o);h.style.width=n*(p/o)+"px",h.innerHTML=`${p}&nbsp;${c}`}const gn={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},En=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Pu(h){if(h){if(typeof h=="number"){const n=Math.round(Math.sqrt(.5*Math.pow(h,2)));return{center:new u.pointGeometry(0,0),top:new u.pointGeometry(0,h),"top-left":new u.pointGeometry(n,n),"top-right":new u.pointGeometry(-n,n),bottom:new u.pointGeometry(0,-h),"bottom-left":new u.pointGeometry(n,-n),"bottom-right":new u.pointGeometry(-n,-n),left:new u.pointGeometry(h,0),right:new u.pointGeometry(-h,0)}}if(h instanceof u.pointGeometry||Array.isArray(h)){const n=u.pointGeometry.convert(h);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:u.pointGeometry.convert(h.center||[0,0]),top:u.pointGeometry.convert(h.top||[0,0]),"top-left":u.pointGeometry.convert(h["top-left"]||[0,0]),"top-right":u.pointGeometry.convert(h["top-right"]||[0,0]),bottom:u.pointGeometry.convert(h.bottom||[0,0]),"bottom-left":u.pointGeometry.convert(h["bottom-left"]||[0,0]),"bottom-right":u.pointGeometry.convert(h["bottom-right"]||[0,0]),left:u.pointGeometry.convert(h.left||[0,0]),right:u.pointGeometry.convert(h.right||[0,0])}}return Pu(new u.pointGeometry(0,0))}const xa={supported:L,setRTLTextPlugin:u.setRTLTextPlugin,getRTLTextPluginStatus:u.getRTLTextPluginStatus,Map:class extends an{constructor(h){var n;if(u.PerformanceUtils.mark(u.PerformanceMarkers.create),(h=u.extend({},Mh,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new as(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),{bearingSnap:h.bearingSnap}),this._interactive=h.interactive,this._cooperativeGestures=h.cooperativeGestures,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._crossSourceCollisions=h.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=h.collectResourceTiming,this._renderTaskQueue=new Ph,this._controls=[],this._mapId=u.uniqueId(),this._locale=u.extend({},zh,h.locale),this._clickTolerance=h.clickTolerance,this._pixelRatio=(n=h.pixelRatio)!==null&&n!==void 0?n:devicePixelRatio,this._requestManager=new pe(h.transformRequest),typeof h.container=="string"){if(this._container=document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(h.maxBounds&&this.setMaxBounds(h.maxBounds),u.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Ah(this,h),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=h.hash&&new _h(typeof h.hash=="string"&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,u.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localIdeographFontFamily:h.localIdeographFontFamily}),h.attributionControl&&this.addControl(new ps({customAttribution:h.customAttribution})),h.maplibreLogo&&this.addControl(new ol,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new u.Event(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new u.Event(`${o.dataType}dataloading`,o))}),this.on("dataabort",o=>{this.fire(new u.Event("sourcedataabort",o))})}_getMapId(){return this._mapId}addControl(h,n){if(n===void 0&&(n=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=h.onAdd(this);this._controls.push(h);const c=this._controlPositions[n];return n.indexOf("bottom")!==-1?c.insertBefore(o,c.firstChild):c.appendChild(o),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(h);return n>-1&&this._controls.splice(n,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}calculateCameraOptionsFromTo(h,n,o,c){return c==null&&this.style.terrain&&(c=this.transform.getElevation(o,this.style.terrain)),super.calculateCameraOptionsFromTo(h,n,o,c)}resize(h){const n=this._containerDimensions(),o=n[0],c=n[1];this._resizeCanvas(o,c,this.getPixelRatio()),this.transform.resize(o,c),this.painter.resize(o,c,this.getPixelRatio());const p=!this._moving;return p&&(this.stop(),this.fire(new u.Event("movestart",h)).fire(new u.Event("move",h))),this.fire(new u.Event("resize",h)),p&&this.fire(new u.Event("moveend",h)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(h){const[n,o]=this._containerDimensions();this._pixelRatio=h,this._resizeCanvas(n,o,h),this.painter.resize(n,o,h)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(h){return this.transform.setMaxBounds(u.LngLatBounds.convert(h)),this._update()}setMinZoom(h){if((h=h==null?-2:h)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h&&this.setZoom(h),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h==null?22:h)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h&&this.setZoom(h),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h==null?0:h)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h&&this.setPitch(h),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h==null?60:h)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h&&this.setPitch(h),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this._update()}project(h){return this.transform.locationPoint(u.LngLat.convert(h),this.style&&this.style.terrain)}unproject(h){return this.transform.pointLocation(u.pointGeometry.convert(h),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(h,n,o){if(h==="mouseenter"||h==="mouseover"){let c=!1;return{layer:n,listener:o,delegates:{mousemove:g=>{const x=this.getLayer(n)?this.queryRenderedFeatures(g.point,{layers:[n]}):[];x.length?c||(c=!0,o.call(this,new Ir(h,this,g.originalEvent,{features:x}))):c=!1},mouseout:()=>{c=!1}}}}if(h==="mouseleave"||h==="mouseout"){let c=!1;return{layer:n,listener:o,delegates:{mousemove:x=>{(this.getLayer(n)?this.queryRenderedFeatures(x.point,{layers:[n]}):[]).length?c=!0:c&&(c=!1,o.call(this,new Ir(h,this,x.originalEvent)))},mouseout:x=>{c&&(c=!1,o.call(this,new Ir(h,this,x.originalEvent)))}}}}{const c=p=>{const g=this.getLayer(n)?this.queryRenderedFeatures(p.point,{layers:[n]}):[];g.length&&(p.features=g,o.call(this,p),delete p.features)};return{layer:n,listener:o,delegates:{[h]:c}}}}on(h,n,o){if(o===void 0)return super.on(h,n);const c=this._createDelegatedListener(h,n,o);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(c);for(const p in c.delegates)this.on(p,c.delegates[p]);return this}once(h,n,o){if(o===void 0)return super.once(h,n);const c=this._createDelegatedListener(h,n,o);for(const p in c.delegates)this.once(p,c.delegates[p]);return this}off(h,n,o){return o===void 0?super.off(h,n):(this._delegatedListeners&&this._delegatedListeners[h]&&(c=>{const p=this._delegatedListeners[h];for(let g=0;g<p.length;g++){const x=p[g];if(x.layer===n&&x.listener===o){for(const S in x.delegates)this.off(S,x.delegates[S]);return p.splice(g,1),this}}})(),this)}queryRenderedFeatures(h,n){if(!this.style)return[];let o;if(n!==void 0||h===void 0||h instanceof u.pointGeometry||Array.isArray(h)||(n=h,h=void 0),n=n||{},(h=h||[[0,0],[this.transform.width,this.transform.height]])instanceof u.pointGeometry||typeof h[0]=="number")o=[u.pointGeometry.convert(h)];else{const c=u.pointGeometry.convert(h[0]),p=u.pointGeometry.convert(h[1]);o=[c,new u.pointGeometry(p.x,c.y),p,new u.pointGeometry(c.x,p.y),c]}return this.style.queryRenderedFeatures(o,n,this.transform)}querySourceFeatures(h,n){return this.style.querySourceFeatures(h,n)}setStyle(h,n){return(n=u.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&h?(this._diffStyle(h,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(h,n))}setTransformRequest(h){return this._requestManager.setTransformRequest(h),this}_getUIString(h){const n=this._locale[h];if(n==null)throw new Error(`Missing UI string '${h}'`);return n}_updateStyle(h,n){return this.style&&(this.style.setEventedParent(null),this.style._remove()),h?(this.style=new Yn(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof h=="string"?this.style.loadURL(h):this.style.loadJSON(h),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Yn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(h,n){if(typeof h=="string"){const o=this._requestManager.transformRequest(h,u.ResourceType.Style);u.getJSON(o,(c,p)=>{c?this.fire(new u.ErrorEvent(c)):p&&this._updateDiff(p,n)})}else typeof h=="object"&&this._updateDiff(h,n)}_updateDiff(h,n){try{this.style.setState(h)&&this._update(!0)}catch(o){u.warnOnce(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(h,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.warnOnce("There is no style added to the map.")}addSource(h,n){return this._lazyInitEmptyStyle(),this.style.addSource(h,n),this._update(!0)}isSourceLoaded(h){const n=this.style&&this.style.sourceCaches[h];if(n!==void 0)return n.loaded();this.fire(new u.ErrorEvent(new Error(`There is no source with ID '${h}'`)))}setTerrain(h){return this.style.setTerrain(h),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const h=this.style&&this.style.sourceCaches;for(const n in h){const o=h[n]._tiles;for(const c in o){const p=o[c];if(p.state!=="loaded"&&p.state!=="errored")return!1}}return!0}addSourceType(h,n,o){return this._lazyInitEmptyStyle(),this.style.addSourceType(h,n,o)}removeSource(h){return this.style.removeSource(h),this._update(!0)}getSource(h){return this.style.getSource(h)}addImage(h,n,{pixelRatio:o=1,sdf:c=!1,stretchX:p,stretchY:g,content:x}={}){if(this._lazyInitEmptyStyle(),n instanceof HTMLImageElement||u.isImageBitmap(n)){const{width:S,height:E,data:I}=u.exported.getImageData(n);this.style.addImage(h,{data:new u.RGBAImage({width:S,height:E},I),pixelRatio:o,stretchX:p,stretchY:g,content:x,sdf:c,version:0})}else{if(n.width===void 0||n.height===void 0)return this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:S,height:E,data:I}=n,P=n;this.style.addImage(h,{data:new u.RGBAImage({width:S,height:E},new Uint8Array(I)),pixelRatio:o,stretchX:p,stretchY:g,content:x,sdf:c,version:0,userImage:P}),P.onAdd&&P.onAdd(this,h)}}}updateImage(h,n){const o=this.style.getImage(h);if(!o)return this.fire(new u.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=n instanceof HTMLImageElement||u.isImageBitmap(n)?u.exported.getImageData(n):n,{width:p,height:g,data:x}=c;if(p===void 0||g===void 0)return this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==o.data.width||g!==o.data.height)return this.fire(new u.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const S=!(n instanceof HTMLImageElement||u.isImageBitmap(n));o.data.replace(x,S),this.style.updateImage(h,o)}hasImage(h){return h?!!this.style.getImage(h):(this.fire(new u.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,n){u.getImage(this._requestManager.transformRequest(h,u.ResourceType.Image),n)}listImages(){return this.style.listImages()}addLayer(h,n){return this._lazyInitEmptyStyle(),this.style.addLayer(h,n),this._update(!0)}moveLayer(h,n){return this.style.moveLayer(h,n),this._update(!0)}removeLayer(h){return this.style.removeLayer(h),this._update(!0)}getLayer(h){return this.style.getLayer(h)}setLayerZoomRange(h,n,o){return this.style.setLayerZoomRange(h,n,o),this._update(!0)}setFilter(h,n,o={}){return this.style.setFilter(h,n,o),this._update(!0)}getFilter(h){return this.style.getFilter(h)}setPaintProperty(h,n,o,c={}){return this.style.setPaintProperty(h,n,o,c),this._update(!0)}getPaintProperty(h,n){return this.style.getPaintProperty(h,n)}setLayoutProperty(h,n,o,c={}){return this.style.setLayoutProperty(h,n,o,c),this._update(!0)}getLayoutProperty(h,n){return this.style.getLayoutProperty(h,n)}setLight(h,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(h,n),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(h,n){return this.style.setFeatureState(h,n),this._update()}removeFeatureState(h,n){return this.style.removeFeatureState(h,n),this._update()}getFeatureState(h){return this.style.getFeatureState(h)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let h=0,n=0;return this._container&&(h=this._container.clientWidth||400,n=this._container.clientHeight||300),[h,n]}_setupContainer(){const h=this._container;h.classList.add("maplibregl-map","mapboxgl-map");const n=this._canvasContainer=V.create("div","maplibregl-canvas-container mapboxgl-canvas-container",h);this._interactive&&n.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=V.create("canvas","maplibregl-canvas mapboxgl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const o=this._containerDimensions();this._resizeCanvas(o[0],o[1],this.getPixelRatio());const c=this._controlContainer=V.create("div","maplibregl-control-container mapboxgl-control-container",h),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(g=>{p[g]=V.create("div",`maplibregl-ctrl-${g} mapboxgl-ctrl-${g}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const h=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=V.create("div","maplibregl-cooperative-gesture-screen",h);let n="Control",o=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(o=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map",n="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${o}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",c=>{c.key===n&&(this._metaPress=!0)}),document.addEventListener("keyup",c=>{c.key===n&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",c=>{this._onCooperativeGesture(c,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(h,n,o){this._canvas.width=o*h,this._canvas.height=o*n,this._canvas.style.width=`${h}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const h=u.extend({},L.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);n?(this.painter=new vu(n,this.transform),u.exported$1.testSupport(n)):this.fire(new u.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new u.Event("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new u.Event("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(h,n,o){return!n&&o<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_render(h){let n,o=0;const c=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(n=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,n),o=u.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(h),this._removed)return;let p=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const x=this.transform.zoom,S=u.exported.now();this.style.zoomHistory.update(x,S);const E=new u.EvaluationParameters(x,{now:S,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),I=E.crossFadingFactor();I===1&&I===this._crossFadingFactor||(p=!0,this._crossFadingFactor=I),this.style.update(E)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new u.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.PerformanceUtils.mark(u.PerformanceMarkers.load),this.fire(new u.Event("load"))),this.style&&(this.style.hasTransitions()||p)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const x=u.exported.now()-o;c.endQueryEXT(c.TIME_ELAPSED_EXT,n),setTimeout(()=>{const S=c.getQueryObjectEXT(n,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(n),this.fire(new u.Event("gpu-timing-frame",{cpuTime:x,gpuTime:S}))},50)}if(this.listens("gpu-timing-layer")){const x=this.painter.collectGpuTimers();setTimeout(()=>{const S=this.painter.queryGpuTimers(x);this.fire(new u.Event("gpu-timing-layer",{layerTimes:S}))},50)}const g=this._sourcesDirty||this._styleDirty||this._placementDirty;return g||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.Event("idle")),!this._loaded||this._fullyLoaded||g||(this._fullyLoaded=!0,u.PerformanceUtils.mark(u.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),V.remove(this._canvasContainer),V.remove(this._controlContainer),this._cooperativeGestures&&V.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),u.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new u.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=u.exported.frame(h=>{u.PerformanceUtils.frame(h),this._frame=null,this._render(h)}))}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}_setCacheLimits(h,n){u.setCacheLimits(h,n)}get version(){return"2.4.0"}},NavigationControl:class{constructor(h){this.options=u.extend({},hf,h),this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(u.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),V.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),V.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(u.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=V.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map.getZoom(),n=h===this._map.getMaxZoom(),o=h===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())}_rotateCompassArrow(){const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=h}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new pi(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){V.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(h,n){const o=V.create("button",h,this._container);return o.type="button",o.addEventListener("click",n),o}_setButtonTitle(h,n){const o=this._map._getUIString(`NavigationControl.${n}`);h.title=o,h.setAttribute("aria-label",o)}},GeolocateControl:class extends u.Evented{constructor(h){super(),this.options=u.extend({},Au,h),u.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(h){var n;return this._map=h,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),n=this._setupUI,ea!==void 0?n(ea):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(o=>{ea=o.state!=="denied",n(ea)}):(ea=!!window.navigator.geolocation,n(ea)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),V.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Gn=0,ta=!1}_isOutOfMapMaxBounds(h){const n=this._map.getMaxBounds(),o=h.coords;return n&&(o.longitude<n.getWest()||o.longitude>n.getEast()||o.latitude<n.getSouth()||o.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new u.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new u.Event("geolocate",h)),this._finish()}}_updateCamera(h){const n=new u.LngLat(h.coords.longitude,h.coords.latitude),o=h.coords.accuracy,c=this._map.getBearing(),p=u.extend({bearing:c},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(o),p,{geolocateSource:!0})}_updateMarker(h){if(h){const n=new u.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map._container.clientHeight/2,n=this._map.unproject([0,h]),o=this._map.unproject([1,h]),c=n.distanceTo(o),p=Math.ceil(2*this._accuracy/c);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&ta)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new u.Event("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=V.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),V.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",h===!1){u.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=V.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new lo(this._dotElement),this._circleElement=V.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new lo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new u.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return u.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Gn--,ta=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new u.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let h;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Gn++,Gn>1?(h={maximumAge:6e5,timeout:0},ta=!0):(h=this.options.positionOptions,ta=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,h)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:ps,LogoControl:ol,ScaleControl:class{constructor(h){this.options=u.extend({},fi,h),u.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Dh(this._map,this._container,this.options)}onAdd(h){return this._map=h,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){V.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(h){this.options.unit=h,Dh(this._map,this._container,this.options)}},FullscreenControl:class{constructor(h){this._fullscreen=!1,h&&h.container&&(h.container instanceof HTMLElement?this._container=h.container:u.warnOnce("Full screen control 'container' must be a DOM element.")),u.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=V.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",u.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){V.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=V.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);V.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.title=h}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(h){this.options=h,u.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(h){return this._map=h,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=V.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),V.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){V.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends u.Evented{constructor(h){super(),this.options=u.extend(Object.create(gn),h),u.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new u.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&V.remove(this._content),this._container&&(V.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new u.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=u.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(document.createTextNode(h))}setHTML(h){const n=document.createDocumentFragment(),o=document.createElement("body");let c;for(o.innerHTML=h;c=o.firstChild,c;)n.appendChild(c);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=V.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(h),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(h){this._container&&this._container.classList.add(h)}removeClassName(h){this._container&&this._container.classList.remove(h)}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){if(this._container)return this._container.classList.toggle(h)}_createCloseButton(){this.options.closeButton&&(this._closeButton=V.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(h){this._update(h.point)}_onMouseMove(h){this._update(h.point)}_onDrag(h){this._update(h.point)}_update(h){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=V.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=V.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(g=>this._container.classList.add(g)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=fs(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!h))return;const n=this._pos=this._trackPointer&&h?h:this._map.project(this._lngLat);let o=this.options.anchor;const c=Pu(this.options.offset);if(!o){const g=this._container.offsetWidth,x=this._container.offsetHeight;let S;S=n.y+c.bottom.y<x?["top"]:n.y>this._map.transform.height-x?["bottom"]:[],n.x<g/2?S.push("left"):n.x>this._map.transform.width-g/2&&S.push("right"),o=S.length===0?"bottom":S.join("-")}const p=n.add(c[o]).round();V.setTransform(this._container,`${tt[o]} translate(${p.x}px,${p.y}px)`),ct(this._container,o,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(En);h&&h.focus()}_onClose(){this.remove()}},Marker:lo,Style:Yn,LngLat:u.LngLat,LngLatBounds:u.LngLatBounds,Point:u.pointGeometry,MercatorCoordinate:u.MercatorCoordinate,Evented:u.Evented,AJAXError:u.AJAXError,config:u.config,CanvasSource:Gt,GeoJSONSource:hn,ImageSource:st,RasterDEMTileSource:Ke,RasterTileSource:cn,VectorTileSource:vn,VideoSource:pt,prewarm:function(){qa().acquire(Ei)},clearPrewarmedResources:function(){const h=Zi;h&&(h.isPreloaded()&&h.numActive()===1?(h.release(Ei),Zi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return Sr.workerCount},set workerCount(h){Sr.workerCount=h},get maxParallelImageRequests(){return u.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){u.config.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){u.clearTileCache(h)},workerUrl:"",addProtocol(h,n){u.config.REGISTERED_PROTOCOLS[h]=n},removeProtocol(h){delete u.config.REGISTERED_PROTOCOLS[h]}};return Ur.extend(xa,{isSafari:u.isSafari,getPerformanceMetrics:u.PerformanceUtils.getPerformanceMetrics}),xa});var T=_;return T})})(Vw);const Ad=Vw.exports;function jw(t){var i,s,f="";if(typeof t=="string"||typeof t=="number")f+=t;else if(typeof t=="object")if(Array.isArray(t))for(i=0;i<t.length;i++)t[i]&&(s=jw(t[i]))&&(f&&(f+=" "),f+=s);else for(i in t)t[i]&&(f&&(f+=" "),f+=i);return f}function Eo(){for(var t,i,s=0,f="";s<arguments.length;)(t=arguments[s++])&&(i=jw(t))&&(f&&(f+=" "),f+=i);return f}var Vp={exports:{}},$p={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jk=_t.exports,Qk=Symbol.for("react.element"),eI=Symbol.for("react.fragment"),tI=Object.prototype.hasOwnProperty,nI=Jk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,rI={key:!0,ref:!0,__self:!0,__source:!0};function Gw(t,i,s){var f,_={},v=null,T=null;s!==void 0&&(v=""+s),i.key!==void 0&&(v=""+i.key),i.ref!==void 0&&(T=i.ref);for(f in i)tI.call(i,f)&&!rI.hasOwnProperty(f)&&(_[f]=i[f]);if(t&&t.defaultProps)for(f in i=t.defaultProps,i)_[f]===void 0&&(_[f]=i[f]);return{$$typeof:Qk,type:t,key:v,ref:T,props:_,_owner:nI.current}}$p.Fragment=eI;$p.jsx=Gw;$p.jsxs=Gw;(function(t){t.exports=$p})(Vp);const iI=Vp.exports.Fragment,Tt=Vp.exports.jsx,Lr=Vp.exports.jsxs,qd=t=>typeof t=="number"&&!isNaN(t),wp=t=>typeof t=="string",ai=t=>typeof t=="function",Zd=t=>wp(t)||ai(t)?t:null,Im=t=>_t.exports.isValidElement(t)||wp(t)||ai(t)||qd(t);function aI(t,i,s){s===void 0&&(s=300);const{scrollHeight:f,style:_}=t;requestAnimationFrame(()=>{_.minHeight="initial",_.height=f+"px",_.transition=`all ${s}ms`,requestAnimationFrame(()=>{_.height="0",_.padding="0",_.margin="0",setTimeout(i,s)})})}function jp(t){let{enter:i,exit:s,appendPosition:f=!1,collapse:_=!0,collapseDuration:v=300}=t;return function(T){let{children:u,position:L,preventExitTransition:q,done:ne,nodeRef:Q,isIn:V}=T;const pe=f?`${i}--${L}`:i,be=f?`${s}--${L}`:s,ye=_t.exports.useRef(0);return _t.exports.useLayoutEffect(()=>{const ze=Q.current,ee=pe.split(" "),X=ie=>{ie.target===Q.current&&(ze.dispatchEvent(new Event("d")),ze.removeEventListener("animationend",X),ze.removeEventListener("animationcancel",X),ye.current===0&&ie.type!=="animationcancel"&&ze.classList.remove(...ee))};ze.classList.add(...ee),ze.addEventListener("animationend",X),ze.addEventListener("animationcancel",X)},[]),_t.exports.useEffect(()=>{const ze=Q.current,ee=()=>{ze.removeEventListener("animationend",ee),_?aI(ze,ne,v):ne()};V||(q?ee():(ye.current=1,ze.className+=` ${be}`,ze.addEventListener("animationend",ee)))},[V]),Ms.createElement(Ms.Fragment,null,u)}}function X0(t,i){return{content:t.content,containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,status:i}}const Cs={list:new Map,emitQueue:new Map,on(t,i){return this.list.has(t)||this.list.set(t,[]),this.list.get(t).push(i),this},off(t,i){if(i){const s=this.list.get(t).filter(f=>f!==i);return this.list.set(t,s),this}return this.list.delete(t),this},cancelEmit(t){const i=this.emitQueue.get(t);return i&&(i.forEach(clearTimeout),this.emitQueue.delete(t)),this},emit(t){this.list.has(t)&&this.list.get(t).forEach(i=>{const s=setTimeout(()=>{i(...[].slice.call(arguments,1))},0);this.emitQueue.has(t)||this.emitQueue.set(t,[]),this.emitQueue.get(t).push(s)})}},Pd=t=>{let{theme:i,type:s,...f}=t;return Tt("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:i==="colored"?"currentColor":`var(--toastify-icon-color-${s})`,...f})},Cm={info:function(t){return Tt(Pd,{...t,children:Tt("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"})})},warning:function(t){return Tt(Pd,{...t,children:Tt("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"})})},success:function(t){return Tt(Pd,{...t,children:Tt("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"})})},error:function(t){return Tt(Pd,{...t,children:Tt("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"})})},spinner:function(){return Tt("div",{className:"Toastify__spinner"})}};function oI(t){const[,i]=_t.exports.useReducer(pe=>pe+1,0),[s,f]=_t.exports.useState([]),_=_t.exports.useRef(null),v=_t.exports.useRef(new Map).current,T=pe=>s.indexOf(pe)!==-1,u=_t.exports.useRef({toastKey:1,displayedToast:0,count:0,queue:[],props:t,containerId:null,isToastActive:T,getToast:pe=>v.get(pe)}).current;function L(pe){let{containerId:be}=pe;const{limit:ye}=u.props;!ye||be&&u.containerId!==be||(u.count-=u.queue.length,u.queue=[])}function q(pe){f(be=>pe==null?[]:be.filter(ye=>ye!==pe))}function ne(){const{toastContent:pe,toastProps:be,staleId:ye}=u.queue.shift();V(pe,be,ye)}function Q(pe,be){let{delay:ye,staleId:ze,...ee}=be;if(!Im(pe)||function(Kt){return!_.current||u.props.enableMultiContainer&&Kt.containerId!==u.props.containerId||v.has(Kt.toastId)&&Kt.updateId==null}(ee))return;const{toastId:X,updateId:ie,data:xe}=ee,{props:Ee}=u,Oe=()=>q(X),Ve=ie==null;Ve&&u.count++;const Le={...Ee,style:Ee.toastStyle,key:u.toastKey++,...ee,toastId:X,updateId:ie,data:xe,closeToast:Oe,isIn:!1,className:Zd(ee.className||Ee.toastClassName),bodyClassName:Zd(ee.bodyClassName||Ee.bodyClassName),progressClassName:Zd(ee.progressClassName||Ee.progressClassName),autoClose:!ee.isLoading&&(vt=ee.autoClose,ht=Ee.autoClose,vt===!1||qd(vt)&&vt>0?vt:ht),deleteToast(){const Kt=X0(v.get(X),"removed");v.delete(X),Cs.emit(4,Kt);const vn=u.queue.length;if(u.count=X==null?u.count-u.displayedToast:u.count-1,u.count<0&&(u.count=0),vn>0){const cn=X==null?u.props.limit:1;if(vn===1||cn===1)u.displayedToast++,ne();else{const Ln=cn>vn?vn:cn;u.displayedToast=Ln;for(let Ke=0;Ke<Ln;Ke++)ne()}}else i()}};var vt,ht;Le.iconOut=function(Kt){let{theme:vn,type:cn,isLoading:Ln,icon:Ke}=Kt,hn=null;const $e={theme:vn,type:cn};return Ke===!1||(ai(Ke)?hn=Ke($e):_t.exports.isValidElement(Ke)?hn=_t.exports.cloneElement(Ke,$e):wp(Ke)||qd(Ke)?hn=Ke:Ln?hn=Cm.spinner():(st=>st in Cm)(cn)&&(hn=Cm[cn]($e))),hn}(Le),ai(ee.onOpen)&&(Le.onOpen=ee.onOpen),ai(ee.onClose)&&(Le.onClose=ee.onClose),Le.closeButton=Ee.closeButton,ee.closeButton===!1||Im(ee.closeButton)?Le.closeButton=ee.closeButton:ee.closeButton===!0&&(Le.closeButton=!Im(Ee.closeButton)||Ee.closeButton);let Ht=pe;_t.exports.isValidElement(pe)&&!wp(pe.type)?Ht=_t.exports.cloneElement(pe,{closeToast:Oe,toastProps:Le,data:xe}):ai(pe)&&(Ht=pe({closeToast:Oe,toastProps:Le,data:xe})),Ee.limit&&Ee.limit>0&&u.count>Ee.limit&&Ve?u.queue.push({toastContent:Ht,toastProps:Le,staleId:ze}):qd(ye)?setTimeout(()=>{V(Ht,Le,ze)},ye):V(Ht,Le,ze)}function V(pe,be,ye){const{toastId:ze}=be;ye&&v.delete(ye);const ee={content:pe,props:be};v.set(ze,ee),f(X=>[...X,ze].filter(ie=>ie!==ye)),Cs.emit(4,X0(ee,ee.props.updateId==null?"added":"updated"))}return _t.exports.useEffect(()=>(u.containerId=t.containerId,Cs.cancelEmit(3).on(0,Q).on(1,pe=>_.current&&q(pe)).on(5,L).emit(2,u),()=>{v.clear(),Cs.emit(3,u)}),[]),_t.exports.useEffect(()=>{u.props=t,u.isToastActive=T,u.displayedToast=s.length}),{getToastToRender:function(pe){const be=new Map,ye=Array.from(v.values());return t.newestOnTop&&ye.reverse(),ye.forEach(ze=>{const{position:ee}=ze.props;be.has(ee)||be.set(ee,[]),be.get(ee).push(ze)}),Array.from(be,ze=>pe(ze[0],ze[1]))},containerRef:_,isToastActive:T}}function Y0(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientX:t.clientX}function K0(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientY:t.clientY}function sI(t){const[i,s]=_t.exports.useState(!1),[f,_]=_t.exports.useState(!1),v=_t.exports.useRef(null),T=_t.exports.useRef({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,u=_t.exports.useRef(t),{autoClose:L,pauseOnHover:q,closeToast:ne,onClick:Q,closeOnClick:V}=t;function pe(xe){if(t.draggable){xe.nativeEvent.type==="touchstart"&&xe.nativeEvent.preventDefault(),T.didMove=!1,document.addEventListener("mousemove",ee),document.addEventListener("mouseup",X),document.addEventListener("touchmove",ee),document.addEventListener("touchend",X);const Ee=v.current;T.canCloseOnClick=!0,T.canDrag=!0,T.boundingRect=Ee.getBoundingClientRect(),Ee.style.transition="",T.x=Y0(xe.nativeEvent),T.y=K0(xe.nativeEvent),t.draggableDirection==="x"?(T.start=T.x,T.removalDistance=Ee.offsetWidth*(t.draggablePercent/100)):(T.start=T.y,T.removalDistance=Ee.offsetHeight*(t.draggablePercent===80?1.5*t.draggablePercent:t.draggablePercent/100))}}function be(xe){if(T.boundingRect){const{top:Ee,bottom:Oe,left:Ve,right:Le}=T.boundingRect;xe.nativeEvent.type!=="touchend"&&t.pauseOnHover&&T.x>=Ve&&T.x<=Le&&T.y>=Ee&&T.y<=Oe?ze():ye()}}function ye(){s(!0)}function ze(){s(!1)}function ee(xe){const Ee=v.current;T.canDrag&&Ee&&(T.didMove=!0,i&&ze(),T.x=Y0(xe),T.y=K0(xe),T.delta=t.draggableDirection==="x"?T.x-T.start:T.y-T.start,T.start!==T.x&&(T.canCloseOnClick=!1),Ee.style.transform=`translate${t.draggableDirection}(${T.delta}px)`,Ee.style.opacity=""+(1-Math.abs(T.delta/T.removalDistance)))}function X(){document.removeEventListener("mousemove",ee),document.removeEventListener("mouseup",X),document.removeEventListener("touchmove",ee),document.removeEventListener("touchend",X);const xe=v.current;if(T.canDrag&&T.didMove&&xe){if(T.canDrag=!1,Math.abs(T.delta)>T.removalDistance)return _(!0),void t.closeToast();xe.style.transition="transform 0.2s, opacity 0.2s",xe.style.transform=`translate${t.draggableDirection}(0)`,xe.style.opacity="1"}}_t.exports.useEffect(()=>{u.current=t}),_t.exports.useEffect(()=>(v.current&&v.current.addEventListener("d",ye,{once:!0}),ai(t.onOpen)&&t.onOpen(_t.exports.isValidElement(t.children)&&t.children.props),()=>{const xe=u.current;ai(xe.onClose)&&xe.onClose(_t.exports.isValidElement(xe.children)&&xe.children.props)}),[]),_t.exports.useEffect(()=>(t.pauseOnFocusLoss&&(document.hasFocus()||ze(),window.addEventListener("focus",ye),window.addEventListener("blur",ze)),()=>{t.pauseOnFocusLoss&&(window.removeEventListener("focus",ye),window.removeEventListener("blur",ze))}),[t.pauseOnFocusLoss]);const ie={onMouseDown:pe,onTouchStart:pe,onMouseUp:be,onTouchEnd:be};return L&&q&&(ie.onMouseEnter=ze,ie.onMouseLeave=ye),V&&(ie.onClick=xe=>{Q&&Q(xe),T.canCloseOnClick&&ne()}),{playToast:ye,pauseToast:ze,isRunning:i,preventExitTransition:f,toastRef:v,eventHandlers:ie}}function qw(t){let{closeToast:i,theme:s,ariaLabel:f="close"}=t;return Tt("button",{className:`Toastify__close-button Toastify__close-button--${s}`,type:"button",onClick:_=>{_.stopPropagation(),i(_)},"aria-label":f,children:Tt("svg",{"aria-hidden":"true",viewBox:"0 0 14 16",children:Tt("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})})})}function lI(t){let{delay:i,isRunning:s,closeToast:f,type:_="default",hide:v,className:T,style:u,controlledProgress:L,progress:q,rtl:ne,isIn:Q,theme:V}=t;const pe=v||L&&q===0,be={...u,animationDuration:`${i}ms`,animationPlayState:s?"running":"paused",opacity:pe?0:1};L&&(be.transform=`scaleX(${q})`);const ye=Eo("Toastify__progress-bar",L?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${V}`,`Toastify__progress-bar--${_}`,{"Toastify__progress-bar--rtl":ne}),ze=ai(T)?T({rtl:ne,type:_,defaultClassName:ye}):Eo(ye,T);return Ms.createElement("div",{role:"progressbar","aria-hidden":pe?"true":"false","aria-label":"notification timer",className:ze,style:be,[L&&q>=1?"onTransitionEnd":"onAnimationEnd"]:L&&q<1?null:()=>{Q&&f()}})}const uI=t=>{const{isRunning:i,preventExitTransition:s,toastRef:f,eventHandlers:_}=sI(t),{closeButton:v,children:T,autoClose:u,onClick:L,type:q,hideProgressBar:ne,closeToast:Q,transition:V,position:pe,className:be,style:ye,bodyClassName:ze,bodyStyle:ee,progressClassName:X,progressStyle:ie,updateId:xe,role:Ee,progress:Oe,rtl:Ve,toastId:Le,deleteToast:vt,isIn:ht,isLoading:Ht,iconOut:Kt,closeOnClick:vn,theme:cn}=t,Ln=Eo("Toastify__toast",`Toastify__toast-theme--${cn}`,`Toastify__toast--${q}`,{"Toastify__toast--rtl":Ve},{"Toastify__toast--close-on-click":vn}),Ke=ai(be)?be({rtl:Ve,position:pe,type:q,defaultClassName:Ln}):Eo(Ln,be),hn=!!Oe||!u,$e={closeToast:Q,type:q,theme:cn};let st=null;return v===!1||(st=ai(v)?v($e):_t.exports.isValidElement(v)?_t.exports.cloneElement(v,$e):qw($e)),Ms.createElement(V,{isIn:ht,done:vt,position:pe,preventExitTransition:s,nodeRef:f},Lr("div",{id:Le,onClick:L,className:Ke,..._,style:ye,ref:f,children:[Lr("div",{...ht&&{role:Ee},className:ai(ze)?ze({type:q}):Eo("Toastify__toast-body",ze),style:ee,children:[Kt!=null&&Tt("div",{className:Eo("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!Ht}),children:Kt}),Tt("div",{children:T})]}),st,Tt(lI,{...xe&&!hn?{key:`pb-${xe}`}:{},rtl:Ve,theme:cn,delay:u,isRunning:i,isIn:ht,closeToast:Q,hide:ne,type:q,style:ie,className:X,controlledProgress:hn,progress:Oe||0})]}))},Gp=function(t,i){return i===void 0&&(i=!1),{enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:i}},cI=jp(Gp("bounce",!0));jp(Gp("slide",!0));jp(Gp("zoom"));jp(Gp("flip"));const Fg=_t.exports.forwardRef((t,i)=>{const{getToastToRender:s,containerRef:f,isToastActive:_}=oI(t),{className:v,style:T,rtl:u,containerId:L}=t;function q(ne){const Q=Eo("Toastify__toast-container",`Toastify__toast-container--${ne}`,{"Toastify__toast-container--rtl":u});return ai(v)?v({position:ne,rtl:u,defaultClassName:Q}):Eo(Q,Zd(v))}return _t.exports.useEffect(()=>{i&&(i.current=f.current)},[]),Tt("div",{ref:f,className:"Toastify",id:L,children:s((ne,Q)=>{const V=Q.length?{...T}:{...T,pointerEvents:"none"};return Tt("div",{className:q(ne),style:V,children:Q.map((pe,be)=>{let{content:ye,props:ze}=pe;return _t.exports.createElement(uI,{...ze,isIn:_(ze.toastId),style:{...ze.style,"--nth":be+1,"--len":Q.length},key:`toast-${ze.key}`},ye)})},`container-${ne}`)})})});Fg.displayName="ToastContainer",Fg.defaultProps={position:"top-right",transition:cI,autoClose:5e3,closeButton:qw,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};let J0,Am=new Map,Q0=[];Cs.on(2,t=>{J0=t.containerId||t,Am.set(J0,t),Q0.forEach(i=>{Cs.emit(0,i.content,i.options)}),Q0=[]}).on(3,t=>{Am.delete(t.containerId||t),Am.size===0&&Cs.off(0).off(1).off(5)});function hI(t){const i=_t.exports.useRef(null),s=_t.exports.useRef(null),[f,_]=_t.exports.useState(!1),[v,T]=_t.exports.useState({lng:23.061283454082968,lat:38.17137059297082}),[u,L]=_t.exports.useState(5.8),q=t.basemap,ne=t.terrain;function Q(){if(!!s.current&&(console.log(`1. map.current.setSource is a ${typeof s.current.setSource}`),typeof s.current.setSource!="function")){console.log(`2. map.current.setSource is a ${typeof s.current.setSource}`);return}}function V(){!s.current||!f||(ne?s.current.setTerrain({source:"terrainSource",exaggeration:1.3}):s.current.setTerrain(null))}return _t.exports.useEffect(()=>{Q()},[q]),_t.exports.useEffect(()=>{V()},[ne]),_t.exports.useEffect(()=>{s.current||(s.current=new Ad.Map({container:i.current,style:"map_conf.json",center:v,zoom:u,hash:!0,preferWebGL:!0}),s.current.addControl(new Ad.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0})),s.current.addControl(new Ad.ScaleControl({maxWidth:200,unit:"metric"},"bottomright")),s.current.addControl(new Ad.TerrainControl({source:"terrainSource",exaggeration:1})),window.map=s.current)},[q,s.current]),_t.exports.useEffect(()=>{s.current&&s.current.on("idle",()=>{_(!0)})},[s]),Lr(iI,{children:[Tt("div",{ref:i,id:"map"}),Tt(Fg,{position:"bottom-right",autoClose:5e3,theme:"colored",pauseOnFocusLoss:!0})]})}function dI(){const[t,i]=_t.exports.useState(!1),[s,f]=_t.exports.useState("bing");function _(u){f(u.target.value)}function v(){document.getElementsByClassName("mapboxgl-ctrl-geolocate")[0].click()}function T(u){i(u.target.checked),console.log(t)}return Lr("div",{className:"drawer drawer-mobile",style:{position:"absolute"},children:[Tt("input",{id:"my-drawer-2",type:"checkbox",className:"drawer-toggle"}),Lr("div",{className:"drawer-content flex flex-col items-center justify-center",children:[Lr("label",{htmlFor:"my-drawer-2",className:"btn btn-circle  lg:hidden",style:{zIndex:1e3,position:"absolute",top:0,left:0,margin:"10px"},children:[Tt(zs,{icon:Xk})," "]}),Tt(hI,{terrain:t,basemap:s})]}),Lr("div",{className:"drawer-side shadow shadow-lg",children:[Tt("label",{htmlFor:"my-drawer-2",className:"drawer-overlay"}),Tt("div",{className:"menu p-4 w-60 bg-base-100 ",children:Lr("div",{className:"h-full",style:{display:"flex",flexDirection:"column"},children:[Tt("label",{htmlFor:"my-drawer-2",className:"btn btn-circle btn-outline lg:hidden ",style:{alignSelf:"end"},children:Tt("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Tt("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),Tt("h1",{className:"font-bold",style:{marginBottom:"40px"},children:"Terra Pindus"}),Lr("ul",{style:{display:"flex",flexDirection:"column"},children:[Lr("li",{className:"prose mt-5",children:[Tt("h5",{children:"Basemap"}),Lr("select",{className:"select select-bordered w-full max-w-xs prose",onChange:_,children:[Tt("option",{value:"bing",children:"   Bing"}),Tt("option",{value:"ktima",children:"            Cadastre"}),Tt("option",{value:"esri",children:"            ESRI"}),Tt("option",{value:"thunderforest",children:"            OSM"})]})]}),Tt("div",{className:"divider"}),Tt("li",{children:Lr("a",{onClick:v,children:[" ",Tt(zs,{icon:Kk}),"My Location"]})})]}),Lr("ul",{style:{display:"flex",flexDirection:"column",marginTop:"auto"},children:[Lr("li",{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:["3D  ",Tt("input",{type:"checkbox",className:"toggle",checked:t,onChange:T})]}),Tt("div",{className:"divider"}),Tt("li",{children:Lr("a",{children:[" ",Tt(zs,{icon:Yk})," \u0395\u03AF\u03C3\u03BF\u03B4\u03BF\u03C2   "]})})]})]})})]})]})}function pI(){return _t.exports.useState(0),Tt("div",{className:"App",children:Tt(dI,{})})}Pm.createRoot(document.getElementById("root")).render(Tt(Ms.StrictMode,{children:Tt(pI,{})}));
